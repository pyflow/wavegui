{"version":3,"sources":["editing.ts","ui.ts","card_menu.tsx","intl.ts","layout.tsx","theme.ts","breadcrumbs.tsx","simplify.ts","canvas.tsx","chat.tsx","defs.ts","markdown.tsx","tooltip.tsx","button.tsx","checkbox.tsx","checklist.tsx","choice_group.tsx","color_picker.tsx","combobox.tsx","date_picker.tsx","dropdown.tsx","expander.tsx","file_upload.tsx","frame.tsx","image.tsx","label.tsx","link.tsx","markup.tsx","message_bar.tsx","plot.tsx","picker.tsx","progress.tsx","range_slider.tsx","separator.tsx","slider.tsx","spinbox.tsx","stats.tsx","stepper.tsx","icon_table_cell_type.tsx","parts/progress_arc.tsx","progress_table_cell_type.tsx","table.tsx","tabs.tsx","template.tsx","text.tsx","textbox.tsx","toggle.tsx","vega.tsx","form.tsx","persona.tsx","dialog.tsx","notification.ts","script.ts","side_panel.tsx","tracking.ts","meta.tsx","editor.tsx","flex.tsx","footer.tsx","graphics.tsx","grid.tsx","nav.tsx","header.tsx","parts/progress_bar.tsx","large_bar_stat.tsx","large_stat.tsx","list.tsx","list_item1.tsx","none.tsx","pixel_art.tsx","repeat.tsx","section.tsx","parts/microarea.tsx","parts/microbars.tsx","small_series_stat.tsx","small_stat.tsx","stat_list.tsx","stat_table.tsx","tab.tsx","tall_gauge_stat.tsx","tall_series_stat.tsx","toolbar.tsx","wide_bar_stat.tsx","wide_gauge_stat.tsx","wide_info.tsx","wide_series_stat.tsx","logo.tsx","page.tsx","app.tsx","login.tsx","router.tsx","serviceWorker.ts","index.tsx"],"names":["EditorActionT","noAction","t","None","pickCard","Pick","editorActionB","box","layoutDefs","name","layout","breakpoint","min_height","zones","direction","size","defaultLayoutDef","bond","ctor","props","model","arrows","self","Object","keys","forEach","k","v","boxed","push","on","_","setState","state","this","init","update","dispose","render","React","_wave","args","contentB","argsB","busyB","config","username","editable","jump","key","value","startsWith","window","location","hash","substr","wave","debounce","timeout","f","clearTimeout","setTimeout","h","length","d","a","clearRec","throttle","wait","fork","Error","emit","source","data","event","events","css","stylesheet","menu","position","top","right","$nest","width","height","padding","icon","userSelect","target","boxSizing","cursor","opacity","toContextMenuItem","c","text","label","iconProps","iconName","undefined","title","caption","subMenuProps","items","map","onClick","Delete","deleteCard","Edit","CardMenu","commands","changedB","canEdit","hiddenB","show","hide","cmds","hidden","className","data-test","ref","Icon","ContextualMenu","onItemClick","onDismiss","intlCache","createIntlCache","intl","createIntl","locale","navigator","language","messages","onError","isBareExpr","s","test","Handlebars","registerHelper","opts","b","replace","m","toUpperCase","parseInt","kvToOpts","type","formatDate","formatTime","formatNumber","CardEffect","isFormatExpr","charAt","parseFormat","invocation","match","compile","bare","format","px","x","pc","rem","clas","names","join","border","thickness","color","margin","cssVar","cssVarValue","prop","substring","getComputedStyle","document","documentElement","getPropertyValue","trim","formItemWidth","includes","spectrum","amber","azure","black","blue","brown","cyan","gray","green","indigo","lime","mint","orange","pink","purple","red","tangerine","teal","violet","white","yellow","themes","default","palette","card","page","fluentPalette","themePrimary","themeLighterAlt","themeLighter","themeLight","themeTertiary","themeSecondary","themeDarkAlt","themeDark","themeDarker","neutralLighterAlt","neutralLighter","neutralLight","neutralQuaternaryAlt","neutralQuaternary","neutralTertiaryAlt","neutralTertiary","neutralSecondary","neutralPrimaryAlt","neutralPrimary","neutralDark","dark","neon","themeB","defaultTheme","themeName","theme","body","style","setProperty","hex","exec","rgb","r","g","alpha","i","Fluent","defaultCardStyle","effect","Normal","cards","register","lookup","newCardRegistry","substitute","formatString","defaultValue","Format","CardView","Tag","view","Repeat","unpack","xid","changed","badPlacement","left","grid","uw","uh","cols","rows","gap","scale","innerWidth","innerHeight","unitWidth","unitHeight","unitInnerWidth","unitInnerHeight","place","split","slice","normalize","parseI","y","w","isNaN","slot","bottom","placeOnGrid","rescale","clientWidth","clientHeight","Math","min","inset","overflow","newGrid","transition","display","flexDirection","flexGrow","normal","backgroundColor","boxShadow","raised","flat","getCardEffectClass","getCardStyle","Raised","Flat","GridLayout","cs","hasEditor","find","children","placement","zIndex","id","justifyContent","View","styles","root","Transparent","P","getSqDist","p1","p2","dx","dy","getSqSegDist","p","P0","simplifyDouglasPeucker","points","sqTolerance","last","simplified","simplifyDPStep","first","maxSqDist","index","sqDist","simplify","tolerance","highestQuality","prevPoint","point","newPoints","len","simplifyRadialDist","ShapeT","layers","marshalPoints","ps","fs","Array","unmarshalPoints","j","n","newCanvas","_alpha","el","createElement","getContext","dpr","devicePixelRatio","bspr","webkitBackingStorePixelRatio","mozBackingStorePixelRatio","msBackingStorePixelRatio","oBackingStorePixelRatio","backingStorePixelRatio","outline","byteToHex","toString","hexmap","Map","set","inks","shapeKeysB","shapesB","shapeB","Curve","colorB","lineWidthB","clearB","layersRef","createRef","initPenStyle","lineJoin","lineCap","dot","lw","hlw","floor","fillRect","line","overlaps","beginPath","moveTo","lineTo","stroke","strokeRect","pline","pts","Line","Rect","SolidRect","lineWidth","layersEl","current","fgC","bgC","htC","fgEl","fg","bg","ht","appendChild","hitmap","gx","ratio","mru","dict","put","get","img","getImageData","clear","newHitmap","clearRect","setAttr","syncAttr","track2","done","shape","l","marshalShape","draw","Date","toISOString","JSON","stringify","strokeStyle","fillStyle","onMouseMove","e","getBoundingClientRect","p0","shapeKeys","move","clientX","clientY","onMouseUp","removeEventListener","addEventListener","to","shapes","ks","clearAttrs","shapeDict","parse","sort","CommandBar","ariaLabel","history","message","header","marginBottom","user","marginRight","date","paddingLeft","borderLeft","ChatInputField","inputB","useState","setValue","onChange","useCallback","_event","newValue","TextField","multiline","autoAdjustHeight","onKeyUp","input","_keys","messagesRef","scroll","scrollTop","scrollHeight","cap","capacity","cm","u","time","toLocaleString","cardDefs","markdown","textDecoration","table","borderCollapse","tr","borderBottom","th","textAlign","td","maxWidth","maxHeight","MarkdownIt","html","linkify","typographer","Markdown","dangerouslySetInnerHTML","__html","defaultRenderer","renderer","rules","tokens","idx","options","env","linkOpenToken","hrefAttr","attrGet","attrPush","content","container","alignItems","alignContent","element","fontWeight","fontSize","marginLeft","XToolTip","showIcon","expand","tooltipProps","onRenderContent","buttons","overflowX","justifications","start","end","center","between","around","XButton","visible","link","disabled","primary","minWidth","useEffect","btnProps","secondaryText","XButtons","justify","button","filter","Boolean","tooltip","horizontal","horizontalAlign","childrenGap","XStandAloneButton","XCheckbox","inputProps","defaultIndeterminate","indeterminate","defaultChecked","_e","checked","trigger","toolbar","inline","flexWrap","XChecklist","defaultSelection","useMemo","Set","values","getMappedChoices","choices","selected","has","setChoices","capture","select","_choices","variant","XChoiceGroup","required","defaultSelectedKey","option","XColorPicker","normalizedWidth","minMaxWidth","columnCount","selectedId","colorCells","onColorChanged","_id","colorRectangle","str","XCombobox","setText","placeholder","autoComplete","allowFreeform","errorMessage","error","_index","pad2","XDatePicker","defaultVal","parsedVal","ss","ymd","parseDate","callout","selectors","background","onSelectDate","val","getFullYear","getMonth","getDate","XDropdown","isMultivalued","selection","from","selectedOptions","setSelectedOptions","add","delete","selectedOpts","multiSelect","selectedKeys","o","selectionArr","expanderOpen","expanderClosed","XExpander","expanded","isOpen","setIsOpen","uploadInput","upload","uploadDragging","uploadLabel","borderRadius","uploadMessageBar","uploadRemove","convertMegabytesToBytes","bytes","XFileUpload","isDragging","setIsDragging","files","setFiles","percentComplete","setPercentComplete","setError","successMsg","setSuccessMsg","maxFileSizeBytes","max_file_size","maxSizeBytes","max_size","fileExtensions","file_extensions","formData","FormData","append","makeRequest","Promise","resolve","reject","xhr","XMLHttpRequest","open","onprogress","loaded","total","send","onreadystatechange","readyState","DONE","status","responseText","validateFiles","fileArr","multiple","notAllowedFiles","fileName","allowedExtension","toLowerCase","endsWith","isFileTypeAllowed","maxSizePerFileExceededFiles","reduce","errMsg","onIsDragging","preventDefault","stopPropagation","onIsNotDragging","onDismissError","onDismissSuccess","uploadClasses","onDragStart","onDragEnter","onDragEnd","onDragLeave","onDrop","dataTransfer","onDragOver","messageBarType","isMultiline","success","pointerEvents","description","toFixed","verticalAlign","splice","nowrap","accept","htmlFor","marginTop","fixrefs","protocol","host","URL","createObjectURL","Blob","InlineFrame","path","src","frameBorder","XFrame","objectFit","XImage","image","alt","XLabel","XLink","download","_label","_target","onBtnClick","onLinkClick","ev","href","XMarkup","MarkupCard","SpaceT","messageBar","toMessageBarType","warning","severeWarning","blocked","info","XMessageBar","pickerSuggestionsProps","suggestionsHeaderText","noResultsFoundText","XPicker","tags","selectedTags","setSelectedTags","removeButtonAriaLabel","onResolveSuggestions","filterText","isAlreadySelected","itemLimit","max_choices","selectedItems","onEmptyResolveSuggestions","cat10","registerInteraction","action","processing","leading","trailing","isF","isS","parseInts","convertToDates","ds","convertToPairs","f0","f1","xyVariants","xyExtra","makeXYProps","makeXYExtraProps","makeFormattables","xs","xProps","yProps","xExtraProps","yExtraProps","otherProps","formattables","scaleTypeOf","marks","attr","field","spaceTypes","cc","CC","dd","DD","tt","TT","dc","DC","cd","CD","tc","TC","ct","CT","TD","dt","DT","dummyDatum","makeFormatFunc","datum","transposeMark","mark","tmp","refactorMark","plainAttr","fieldAttr","formatAttr","expr","fmts","fmt","refactorData","x_scale","x_field","x0_field","x0","y_scale","y_field","y0_field","y0","x1_field","x2_field","y1_field","y2_field","makeNote","fill_color","fill_opacity","stroke_color","stroke_opacity","stroke_size","stroke_dash","ref_stroke_color","ref_stroke_opacity","ref_stroke_dash","ref_stroke_size","label_fill_color","label_fill_opacity","label_stroke_color","label_stroke_opacity","label_stroke_size","label_font_size","label_font_weight","label_line_height","label_align","labelStyle","makeTextStyle","shapeStyle","makeShapeStyle","lineStyle","makeGeom","color_field","color_range","color_domain","shape_field","shape_range","size_field","size_range","stack","dodge","dodge_field","curve","label_field","label_format","label_offset","label_offset_x","label_offset_y","label_rotation","label_position","label_overlap","adjust","marginRatio","dodgeBy","fields","colors","domain_colors","acc","callback","offset","offsetX","offsetY","i_label_rotation","autoRotate","rotate","PI","cfg","fill","fillOpacity","strokeOpacity","lineDash","font_size","font_weight","line_height","align","u_font_weight","parseU","lineHeight","makeScale","typ","max","nice","axis","autoHide","fixScaleType","formatter","alias","makeCoord","space","coord","getCoordType","transpose","actions","makeChart","coordinate","scales","axes","x_format","x_title","x_min","x_max","x_nice","x_axis","y_format","y_title","y_min","y_max","y_nice","y_axis","makeScales","geometries","annotations","makeMarks","autoFit","animate","interactions","showCrosshairs","crosshairs","plot","XVisualization","useRef","currentChart","currentPlot","checkDimensionsPostInit","destroy","raw_data","spaceTypeOf","chart","Chart","interaction","gEvent","originalEvent","stateStatus","changeData","XProgress","XRangeSlider","step","min_value","max_value","_val","val_range","onChanged","ranged","defaultLowerValue","separator","XSeparator","XSlider","_value","buttonProps","showValue","originFromZero","XSpinbox","setVal","precision","groups","String","calculatePrecision","parseValue","exp","pow","round","precisionRound","isFinite","handleOnChange","Number","debouncedHandleOnchange","persist","onIncrement","onDecrement","stats","stat","lhs","statCaption","XStats","statStyle","justification","icon_color","FontIcon","stepNumber","iconStyles","XStepper","steps","Fragment","grow","stepIdx","paddingRight","block","XIconTableCellType","ProgressArc","setContent","renderViz","diameter","outerRadius","innerRadius","d3","startAngle","endAngle","bar","viewBox","transform","onResize","useLayoutEffect","percentContainer","percent","XProgressTableCellType","progress","sortableHeader","sortingIcon","hideCellGroupCollapse","checkboxVisibilityMap","always","onHover","sortingF","column","sortAsc","rowA","rowB","dataType","formatNum","num","DataTable","onFilterChange","filteredItems","selectedFilters","isMultiple","isSearchable","reset","colContextMenuList","setColContextMenuList","selectedFiltersRef","onColumnClick","getAttribute","onColumnContextMenu","isSortable","setColumns","columns","col","min_width","max_width","fieldName","headerClassName","sortable","iconClassName","columnActionsMode","filterable","hasDropdown","clickable","cellType","cell_type","data_type","isResizable","primaryColumnKey","onRenderMenuList","listProps","paddingTop","paddingBottom","directionalHint","bottomLeftEdge","gapSpace","isBeakVisible","onRenderDetailsHeader","stickyPosition","Header","isScrollSynced","row","toCSV","cells","blob","url","click","revokeObjectURL","constrainMode","unconstrained","layoutMode","fixedColumns","selectionMode","none","selectionPreservedOnEmptyClick","onItemInvoked","item","onRenderRow","cell","alignSelf","checkCell","onRenderItemColumn","onRenderDetailsFooter","isFilterable","some","downloadable","resettable","footerItems","buttonStyles","Footer","whiteSpace","primarySet","checkboxVisibility","checkbox_visibility","XTable","setFilteredItems","searchableKeys","searchable","searchStr","setSearchStr","setSelectedFilters","setGroups","groupByKey","setGroupByKey","groupByOptions","groupable","every","filterKey","filterVal","makeGroups","prevSum","groupedBy","rv","groupedByKeys","prevKey","startIndex","count","isCollapsed","name1","name2","numName1","numName2","dateName1","dateName2","initGroups","flatMap","arr","search","searchString","_searchStr","onSearchChange","filters","newFilters","onSelectionChanged","getSelection","group","setKeySelected","dataTableProps","topToolbarHeight","rowHeight","footerHeight","computeHeight","selectedKey","scrollbarVisibility","auto","pivot","minHeight","overflowY","XTabs","tabs","itemIcon","itemKey","headerText","linkFormat","links","XTemplate","template","textVariants","xl","XText","menuName","XTextbox","mask","readOnly","readonly","fieldGroup","prefix","suffix","password","XToggle","onText","offText","inlineLabel","XVegaVisualization","spec","specification","vegaEmbed","mode","defaultStyle","autosize","resize","discreteWidth","discreteHeight","continuousWidth","continuousHeight","catch","console","XComponentAlignment","fluentSizes","size48","size56","size72","size100","size120","XPersona","subtitle","tertiaryText","imageUrl","imageInitials","initials","initialsColor","initials_color","defaults","vertical","horizontalRight","XComponents","alignment","components","componentKey","visibleStyles","data-visible","Left","Right","XInline","XComponent","text_xl","text_l","text_m","text_s","text_xs","message_bar","textbox","checkbox","toggle","choice_group","dropdown","checklist","combobox","slider","spinbox","date_picker","color_picker","file_upload","expander","frame","markup","picker","range_slider","stepper","visualization","vega_visualization","persona","dialogB","closable","blocking","dialogContentProps","close","largeHeader","modalProps","isBlocking","showNotification","notificationText","Notification","permission","requestPermission","executableScriptElement","installedScripts","installScript","remove","createTextNode","hasModules","paths","hasModule","hasTargets","selector","getElementById","querySelector","sidePanelB","custom","customWidth","tracker","gtag","sanitize","sendEvent","windowTitleB","windowIconB","iconLink","touchIconLink","layoutsB","preload","refresh","notification","redirect","layouts","dialog","side_panel","scripts","script","stylesheets","origin","pathname","disconnect","async","dataLayer","arguments","setupTracker","asynchronous","cross_origin","referrer_policy","integrity","crossOrigin","referrerPolicy","installScripts","requires","targets","resolved","tries","setInterval","clearInterval","executeScript","styleEl","media","innerText","head","linkEl","rel","as","fab","panelActions","cardIcon","cardCaption","textOverflow","labelize","cardDefLookup","toDict","parsePx","getActiveLayout","identifyLayoutDef","ld","separatorStyle","Divider","spinBoxStyle","labelWrapper","SpinBox","onBlur","AttrPanelView","attrs","isNew","original","changes","collectZones","zoneNames","zone","cardName","save","goBack","abort","onChangeCardName","renderFooter","zoneOptions","changeBox","setBox","unsetBox","zone0","order0","order","size0","width0","height0","isLightDismiss","onRenderFooterContent","isFooterAtBottom","ConfirmDialog","acceptCaption","cancelCaption","onAccept","cancel","DialogType","subText","main","PageSetupView","pageSetupB","pageSetup","layoutOptions","onLayoutChange","_ev","def","layoutDef","onWidthChange","LayoutPicker","visibleB","addCard","Add","WaveEventType","Page","getActivePage","del","directions","alignments","baseline","stretch","wrappings","toFlexStyle","wrap","item_view","item_props","extract","extra","nums","zip","zip3","curves","basis","cardinal","smooth","linear","natural","ret0","get0","get1","get2","renderEl","toAttributes","r1","r2","a1","a2","radial","angle","radius","y1","x1","view_box","stage","scene","stageEls","sceneEls","isArray","ths","trs","tds","XNav","hideNav","collapseByDefault","collapsed","Nav","iconSize","burger","rhs","Navigation","isOpenB","Panel","PanelType","smallFixedNear","hasCloseButton","navB","showNav","nav","rail","ProgressBar","aux_value","captions","plot_color","value_caption","aux_value_caption","canvas","pixelSize","swatches","borderTop","pixel","brush","pixels","odd","defaultColorAt","paint","form","MicroArea","zeroValue","minY","maxY","scaleX","domain","range","scaleY","fcurve","ln","defined","ar","strokeLinejoin","strokeLinecap","strokeWidth","MicroBars","category","paddingInner","rects","plot_type","plot_data","plot_category","plot_value","plot_zero_value","plot_curve","auxValue","listName","list","itemName","value_color","borderSpacing","tbody","thead","tableName","rowName","PivotLinkFormat","PivotItem","Pivot","value_overlay","overflowProps","toCommands","toCommand","iconOnly","overflow_items","secondary_items","overflowCommands","farCommands","overflowItems","overflowButtonProps","farItems","imgSpecified","backgroundSize","backgroundRepeat","backgroundPosition","stateName","backgroundImage","live","letterSpacing","Logo","presetBreakpoints","breakpointsB","layoutB","resizedB","parseBreakpoint","badSlot","parseBoxes","specs","NaN","parseBox","bps","nextLayout","mq","matchMedia","listener","matches","bp","addListener","removeListener","flex","toSectionStyle","toSlotStyle","findSection","section","sections","FlexSection","cardslots","cardslot","FlexLayout","layoutIndex","toSection","max_height","editor","sortCardsInSection","PageLayout","metaCard","onMetaCardChanged","segregate","metas","app","centerFullHeight","freeOverlay","busyOverlay","notFoundOverlay","BusyOverlay","large","NotFoundOverlay","pickingLayoutB","App","onHashChanged","onMdLinkClick","detail","connect","Exception","Disconnect","Reset","reload","Config","Data","applyTheme","code","WaveErrorCode","PageNotFound","retry","login","Login","queryString","method","CompoundButton","Router","routes","exact","hostname","loadTheme","defaultFontStyle","fontFamily","initializeIcons","ReactDOM","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.cc2a4da7.chunk.js","sourcesContent":["// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, box, S, U } from 'h2o-wave'\nimport { Layout } from \"./meta\"\n\nexport type CardAttr = {\n  name: S\n  optional: B\n} & ({\n  t: 'box'\n  value: S // JSON-stringified FlexBox\n} | {\n  t: 'textbox'\n  value: S\n} | {\n  t: 'textarea'\n  value: S\n} | {\n  t: 'spinbox'\n  value: U\n  min: U\n  max: U\n  step: U\n} | {\n  t: 'record'\n  value: any\n})\n\nexport type CardDef = {\n  icon: S\n  view: S\n  attrs: CardAttr[]\n}\n\nexport enum EditorActionT { None, Pick, Add, Edit, Delete }\nexport type NoAction = { t: EditorActionT.None }\nexport type PickCard = { t: EditorActionT.Pick }\nexport type AddCard = { t: EditorActionT.Add, view: S }\nexport type EditCard = { t: EditorActionT.Edit, name: S }\nexport type DeleteCard = { t: EditorActionT.Delete, name: S }\nexport type EditorAction = NoAction | PickCard | AddCard | EditCard | DeleteCard\nexport const\n  noAction: EditorAction = { t: EditorActionT.None },\n  pickCard: EditorAction = { t: EditorActionT.Pick },\n  editorActionB = box<EditorAction>(noAction),\n  editCard = (name: S) => {\n    editorActionB({ t: EditorActionT.Edit, name })\n  },\n  deleteCard = (name: S) => {\n    editorActionB({ t: EditorActionT.Delete, name })\n  }\n\nexport type LayoutDef = {\n  name: S\n  layout: Layout\n}\n\nexport const\n  layoutDefs: LayoutDef[] = [\n    {\n      name: 'Sidebar on Left',\n      layout: {\n        name: 'hsbf',\n        breakpoint: 'xs',\n        min_height: '512px',\n        zones: [\n          { name: 'Header', },\n          {\n            name: 'Main',\n            direction: 'row',\n            zones: [\n              { name: 'Sidebar', size: '256px' },\n              { name: 'Body' },\n            ],\n          },\n          { name: 'Footer' },\n        ]\n      }\n    },\n    {\n      name: 'Sidebar on Right',\n      layout: {\n        name: 'hbsf',\n        breakpoint: 'xs',\n        min_height: '512px',\n        zones: [\n          { name: 'Header', },\n          {\n            name: 'Main',\n            direction: 'row',\n            zones: [\n              { name: 'Body' },\n              { name: 'Sidebar', size: '256px' },\n            ],\n          },\n          { name: 'Footer' },\n        ]\n      }\n    },\n    {\n      name: 'No Sidebar',\n      layout: {\n        name: 'hbf',\n        breakpoint: 'xs',\n        min_height: '512px',\n        zones: [\n          { name: 'Header', },\n          { name: 'Body' },\n          { name: 'Footer' },\n        ],\n      }\n    },\n    {\n      name: 'Body Only',\n      layout: {\n        name: 'b',\n        breakpoint: 'xs',\n        zones: [\n          { name: 'Body' },\n        ],\n      }\n    },\n  ],\n  defaultLayoutDef = layoutDefs[0]\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, box, boxed, ChangeSet, connect, Dict, Disposable, on, Rec, S, U, Wave, WaveEvent, WaveEventType } from 'h2o-wave'\nimport * as React from 'react'\n\n//\n// React Component + Dataflow\n//\n\ninterface Renderable {\n  render(): JSX.Element\n  init?(): void\n  update?(): void\n  dispose?(): void\n}\n\nexport function bond<TProps, TState extends Renderable>(ctor: (props: TProps) => TState) {\n  return class extends React.Component<TProps> {\n    private readonly model: TState\n    private readonly arrows: Disposable[]\n    constructor(props: TProps) {\n      super(props)\n\n      const\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        self = this,\n        model = ctor(props),\n        arrows: Disposable[] = []\n\n      Object.keys(model).forEach(k => {\n        if (k === 'render' || k === 'dispose' || k === 'init' || k === 'update') return\n        const v = (model as any)[k]\n        if (boxed(v)) arrows.push(on(v, _ => self.setState({})))\n      })\n\n      this.model = model\n      this.arrows = arrows\n      this.state = {}\n    }\n    componentDidMount() {\n      if (this.model.init) this.model.init()\n    }\n    componentDidUpdate() {\n      if (this.model.update) this.model.update()\n    }\n    componentWillUnmount() {\n      if (this.model.dispose) this.model.dispose()\n      for (const a of this.arrows) a.dispose()\n    }\n    render() {\n      return this.model.render()\n    }\n  }\n}\n\nlet _wave: Wave | null = null\n\nconst\n  args: Rec = {},\n  clearRec = (a: Rec) => {\n    for (const k in a) delete a[k]\n  }\n\nexport const\n  contentB = box<WaveEvent | null>(null),\n  argsB = box<any>({}),\n  busyB = box<B>(false),\n  config = {\n    username: '',\n    editable: false,\n  },\n  jump = (key: any, value: any) => {\n    if (value.startsWith('#')) {\n      window.location.hash = value.substr(1)\n      return\n    }\n    if (key) {\n      wave.args[key] = value\n    } else {\n      wave.args[value] = true\n    }\n    wave.push()\n  },\n  debounce = (timeout: U, f: (...args: any[]) => void) => {\n    let t: number | null = null\n    return (...args: any[]) => {\n      if (t) window.clearTimeout(t)\n      t = window.setTimeout(() => { f(...args); t = null }, timeout)\n    }\n  },\n  throttle = (timeout: U, f: (...args: any[]) => void) => {\n    let wait = false\n    return (...args: any[]) => {\n      if (wait) return\n      f(...args)\n      wait = true\n      window.setTimeout(() => { wait = false }, timeout)\n    }\n  },\n  listen = () => {\n    _wave = connect(e => {\n      switch (e.t) {\n        case WaveEventType.Page:\n        case WaveEventType.Error:\n        case WaveEventType.Exception:\n        case WaveEventType.Disconnect:\n          contentB(e)\n          break\n        case WaveEventType.Reset:\n          window.location.reload()\n          break\n        case WaveEventType.Config:\n          config.username = e.username\n          config.editable = e.editable\n          break\n        case WaveEventType.Data:\n          busyB(false)\n          break\n      }\n    })\n  },\n  push = () => {\n    if (!_wave) return\n\n    // Unconditionally set location hash so that the app doesn't have to track changes.\n    const h = window.location.hash\n    if (h?.length > 1) args['#'] = h.substr(1)\n\n    const d: Dict<any> = { ...args } // shallow clone\n    clearRec(args) // clear\n    _wave.push(d) // push clone\n    busyB(true)\n    argsB(d)\n  },\n  wave = { // Public API\n    args,\n    debounce,\n    throttle,\n    push,\n    fork: (): ChangeSet => {\n      if (!_wave) throw new Error('not initialized')\n      return _wave.fork()\n    },\n    emit: (source: S, name: S, data: any) => {\n      const\n        event: Dict<any> = {},\n        events: Dict<any> = {}\n      event[name] = data\n      events[source] = event\n      args[''] = events // '' is special-cased in clients\n      push()\n    }\n  };\n\n(window as any).wave = wave\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { ContextualMenu, Icon, IContextualMenuItem } from '@fluentui/react'\nimport * as React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { deleteCard, editCard } from './editing'\nimport { B, box, Box, S } from 'h2o-wave'\nimport { Command } from './toolbar'\nimport { bond, wave } from './ui'\n\nconst\n  css = stylesheet({\n    menu: {\n      position: 'absolute',\n      top: 0, right: 0,\n      $nest: {\n        '>div:first-child': {\n          width: 32, height: 32,\n          padding: 8,\n        },\n      },\n    },\n    icon: {\n      userSelect: 'none',\n    },\n    target: {\n      boxSizing: 'border-box',\n      cursor: 'pointer',\n      opacity: 0.5,\n      $nest: {\n        '&:hover': {\n          opacity: 1,\n        },\n      },\n    }\n  })\n\nconst\n  editCommand = '__edit__',\n  deleteCommand = '__delete__',\n  toContextMenuItem = (c: Command): IContextualMenuItem => {\n    const\n      onClick = () => {\n        if (c.name === editCommand) {\n          if (c.value) editCard(c.value)\n          return\n        }\n        if (c.name === deleteCommand) {\n          if (c.value) deleteCard(c.value)\n          return\n        }\n        if (c.name.startsWith('#')) {\n          window.location.hash = c.name.substr(1)\n          return\n        }\n        wave.args[c.name] = c.value ?? c.data ?? true\n        wave.push()\n      }\n    return {\n      key: c.name,\n      text: c.label || c.name || 'Untitled',\n      iconProps: c.icon ? { iconName: c.icon } : undefined,\n      title: c.caption || undefined,\n      subMenuProps: c.items ? { items: c.items.map(toContextMenuItem) } : undefined,\n      onClick,\n    }\n  }\n\nexport const\n  CardMenu = bond(({ commands, name, changedB, canEdit }: { commands: Command[] | null, name?: S, changedB?: Box<B>, canEdit?: B }) => {\n    const\n      target = React.createRef<HTMLDivElement>(),\n      hiddenB = box(true),\n      show = () => hiddenB(false),\n      hide = () => hiddenB(true),\n      render = () => {\n        const cmds = commands ?? []\n        if (canEdit) {\n          cmds.push(\n            { name: editCommand, label: 'Edit this card', icon: 'Edit', value: name },\n            { name: deleteCommand, label: 'Delete this card', icon: 'Delete', value: name },\n          )\n        }\n        const\n          hidden = hiddenB(),\n          items = cmds.map(toContextMenuItem)\n        return items.length ? (\n          <div className={css.menu} data-test={name}>\n            <div className={css.target} ref={target} onClick={show}>\n              <Icon className={css.icon} iconName='MoreVertical' />\n            </div>\n            <ContextualMenu target={target} items={items} hidden={hidden} onItemClick={hide} onDismiss={hide} />\n          </div>\n        ) : <></>\n      }\n    return { render, changedB, hiddenB }\n  })","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, S } from 'h2o-wave'\nimport Handlebars from 'handlebars'\nimport { createIntl, createIntlCache } from 'react-intl'\n\nconst intlCache = createIntlCache() // prevents memory leaks per docs\nexport const intl = createIntl({\n  locale: navigator.language,\n  messages: {},\n  // Since we generate format messages on the fly, ignore all errors.\n  // The intl lib requires messages to be initialized in advance,\n  // Otherwise, it throws console.errors for each missing id, each time format() is called.\n  // As of this implementation, there's no formal way to disable that behavior.\n  onError: () => { /* noop */ },\n}, intlCache)\n\nconst\n  snakeToCamel = (s: S): S => s.replace(/(_\\w)/g, m => m[1].toUpperCase()),\n  kvToOpts = (a: any): any => {\n    const b: any = {}\n    for (const k in a) {\n      const v = a[k]\n      b[snakeToCamel(k)] =\n        (v === 'true')\n          ? true\n          : v === 'false'\n            ? false\n            : /^\\d+$/.test(v)\n              ? parseInt(v, 10)\n              : v\n    }\n    return b\n  },\n  isBareExpr = (s: S): B => /^\\w+$/.test(s)\n\nHandlebars.registerHelper('intl', (v: any, { hash: opts }: any) => {\n  opts = kvToOpts(opts)\n  const t = opts.type\n  return t === 'date'\n    ? intl.formatDate(v, opts)\n    : t === 'time'\n      ? intl.formatTime(v, opts)\n      : t === 'number' || typeof v === 'number'\n        ? intl.formatNumber(v, opts)\n        : v\n})\n\nexport type Fmt = (datum: any, value?: any) => S\n\nexport const\n  isFormatExpr = (f: any): B => typeof f === 'string' && f.length > 1 && f.charAt(0) === '=' && f.charAt(1) !== '=',\n  parseFormat = (s: S): [S, HandlebarsTemplateDelegate<any> | undefined] | null => {\n    if (!isFormatExpr(s)) return null\n\n    // \"=foo\"\n    s = s.substr(1) // lop off leading '='\n\n    // \"foo\"\n    if (isBareExpr(s)) return [s, undefined]\n\n    // \"{{func foo-bar ...\"\n    const invocation = s.match(/\\{\\{\\s*(\\w+)\\s+(\\S+)/)\n    if (invocation) return [invocation[2], compile(s)]\n\n    // \"{{foo-bar ...\"\n    const bare = s.match(/\\{\\{\\s*(\\S+)/)\n    if (bare) return [bare[1], undefined]\n\n    return null\n  },\n  compile = (s: S): any => Handlebars.compile(s),\n  format = (s: S, data: any): S => {\n    if (isBareExpr(s)) s = '{{' + s + '}}'\n    const t = compile(s)\n    return t ? t(data) : s\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, box, Card, Dict, F, Model, parseI, Rec, S, U, unpack, xid } from 'h2o-wave'\nimport { default as React } from 'react'\nimport { stylesheet } from 'typestyle'\nimport { CardMenu } from './card_menu'\nimport { format, isFormatExpr } from './intl'\nimport { clas, cssVar, margin } from './theme'\n\ntype Slot = {\n  left: U\n  top: U\n  width?: U\n  height?: U\n  right?: U\n  bottom?: U\n}\n\n\nexport enum CardEffect { Transparent, Normal, Raised, Flat }\n\nexport type CardStyle = {\n  effect: CardEffect\n  overflow?: B\n}\n\nconst\n  defaultCardStyle: CardStyle = { effect: CardEffect.Normal },\n  newCardRegistry = () => {\n    const\n      m: Dict<{ ctor: typeof React.Component, style: CardStyle }> = {},\n      register = (name: S, ctor: typeof React.Component, style: CardStyle = defaultCardStyle) => (\n        m[name] = { ctor, style }\n      ),\n      lookup = (name: S) => m[name] || m['']\n    return { register, lookup }\n  }\n\nexport const\n  cards = newCardRegistry(),\n  substitute = (formatString?: S, data?: Rec, defaultValue: any = null) => {\n    return (formatString !== undefined && formatString !== null)\n      ? isFormatExpr(formatString)\n        ? format(formatString.substr(1), data)\n        : formatString\n      : (defaultValue !== undefined && defaultValue !== null)\n        ? defaultValue\n        : null\n  },\n  Format = ({ data, defaultValue: v, format: f, className }: { data?: Rec, defaultValue?: any, format?: S, className?: S }) => {\n    const x = substitute(f, data, v)\n    if (x == null) return null\n    if (className) return <div className={className}>{x}</div>\n    return <>{x}</>\n  },\n  CardView = ({ card }: { card: Model<any> }) => {\n    const Tag = cards.lookup(card.state.view).ctor\n    return <Tag {...card} />\n  },\n  Repeat = ({ view, props, data }: { view: S | any, props: any, data: any }) => {\n    const items = unpack<Rec[]>(data).map((r, i) => {\n      const card: Model<any> = {\n        name: xid(),\n        state: { ...unpack<Rec>(props), view, data: r },\n        changed: box<B>(),\n      }\n      return <CardView key={i} card={card} />\n    })\n    return <>{items}</>\n  }\n\ntype Size = [U, U]\n\nconst\n  badPlacement: Slot = { left: 0, top: 0, width: 0, height: 0 },\n  newGrid = (uw: U, uh: U, cols: U, rows: U, gap: U) => {\n    let scale = 1\n    const\n      iw = uw - 2 * gap, // unit inner width\n      ih = uh - 2 * gap, // unit inner height\n      width = uw * cols + gap * (cols + 1),\n      height = uh * rows + gap * (rows + 1),\n      giw = width - 2 * gap,\n      gih = height - 2 * gap,\n      placeOnGrid = (x: U, y: U, w: U, h: U): Slot => {\n        const\n          slot: Slot = {\n            left: x * (uw + gap),\n            top: y * (uh + gap),\n          }\n        if (w > 0) {\n          slot.width = w * uw + (w - 1) * gap\n        } else {\n          slot.right = -(w + 1) * (uw + gap)\n        }\n        if (h > 0) {\n          slot.height = h * uh + (h - 1) * gap\n        } else {\n          slot.bottom = -(h + 1) * (uh + gap)\n        }\n        return slot\n      },\n      normalize = (s: S): S[] => {\n        const x = s.trim().split(/\\s+/g)\n        switch (x.length) {\n          case 1: return ['1', '1', s, s]\n          case 2: return ['1', '1', ...x]\n          case 3: return [...x, x[2]]\n          case 4: return x\n          default: return x.slice(0, 4)\n        }\n      },\n      place = (s: S): Slot => {\n        if (!s) return badPlacement\n        const [x, y, w, h] = normalize(s).map(parseI)\n        if (isNaN(x) || isNaN(y) || isNaN(w) || isNaN(h)) return badPlacement\n        return placeOnGrid(x - 1, y - 1, w, h)\n      },\n      getWindowSize = (): Size => ([\n        window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth,\n        window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight\n      ]),\n      rescale = (): F => {\n        const [w, h] = getWindowSize()\n        scale = Math.min(w / width, h / height)\n        return scale\n      },\n      inset: React.CSSProperties = ({ position: 'absolute', left: gap, top: gap, right: gap, bottom: gap, overflow: 'auto' })\n    return {\n      width, height,\n      innerWidth: giw, innerHeight: gih,\n      unitWidth: uw, unitHeight: uh,\n      unitInnerWidth: iw, unitInnerHeight: ih,\n      gap, place, scale, rescale, inset,\n    }\n  }\n\nexport const\n  grid = newGrid(134, 76, 12, 10, 15) // approx 1800x930\n\nconst\n  css = stylesheet({\n    grid: {\n      position: 'relative',\n      boxSizing: 'border-box',\n      width: grid.innerWidth,\n      margin: margin(grid.gap),\n    },\n    slot: {\n      boxSizing: 'border-box',\n      transition: 'box-shadow 0.3s cubic-bezier(.25,.8,.25,1)',\n      overflow: 'auto',\n      display: 'flex',\n      flexDirection: 'column',\n      $nest: {\n        '>*:first-child': {\n          boxSizing: 'border-box',\n          flexGrow: 1, // Expand vertically\n        }\n      }\n    },\n    normal: {\n      backgroundColor: cssVar('$card'),\n      boxShadow: `0px 3px 5px ${cssVar('$text0')}`,\n      $nest: {\n        '&:hover': {\n          boxShadow: `0px 12px 20px ${cssVar('$text2')}`,\n        }\n      },\n    },\n    raised: {\n      color: cssVar('$card'),\n      backgroundColor: cssVar('$themePrimary'),\n      boxShadow: `0px 3px 7px ${cssVar('$text3')}`,\n    },\n    flat: {\n      backgroundColor: cssVar('$card'),\n      boxShadow: `0px 3px 5px ${cssVar('$text0')}`,\n    },\n  }),\n  getCardEffectClass = (c: Card) => {\n    const { effect } = getCardStyle(c)\n    return clas(css.slot, effect === CardEffect.Normal\n      ? css.normal\n      : effect === CardEffect.Raised\n        ? css.raised\n        : effect == CardEffect.Flat\n          ? css.flat : '')\n  }\n\nexport const\n  getCardStyle = (c: Card): CardStyle => cards.lookup(c.state.view).style,\n  GridLayout = ({ name, cards: cs }: { name: S, cards: Card[] }) => {\n    const\n      hasEditor = cs.find(c => c.state.view === 'editor') ? true : false,\n      children = cs.map(c => {\n        const\n          placement = grid.place(c.state.box),\n          { left, top, right, bottom, width, height } = placement,\n          display = placement === badPlacement ? c.state.view === 'editor' ? undefined : 'none' : undefined,\n          zIndex = c.name === '__unhandled_error__' ? 1 : 'initial'\n        return (\n          <div key={c.id} className={getCardEffectClass(c)} style={{ display, position: 'absolute', left, top, right, bottom, width, height, zIndex }}>\n            <CardView card={c} />\n            <CardMenu name={c.name} commands={c.state.commands} changedB={c.changed} canEdit={hasEditor} />\n          </div>\n        )\n      })\n    return (\n      <div data-test={name} className={css.grid}>\n        {children}\n      </div>\n    )\n  }\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from \"@fluentui/react\"\nimport { box, Dict, F, I, on, S, U } from 'h2o-wave'\n\ninterface Palette {\n  text: S\n  card: S\n  page: S\n}\n\ninterface Theme {\n  palette: Palette\n  fluentPalette: Partial<Fluent.IPalette>\n}\n\nexport const\n  px = (x: I) => `${x}px`,\n  pc = (x: F) => `${x}%`,\n  rem = (x: F) => `${x}rem`,\n  clas = (...names: S[]) => names.join(' '),\n  border = (thickness: U, color: S) => `${thickness}px solid ${color}`,\n  dashed = (thickness: U, color: S) => `${thickness}px dashed ${color}`,\n  padding = (...t: I[]) => t.map(px).join(' '),\n  margin = padding,\n  centerMixin = () => ({ display: 'flex', alignItems: 'center', justifyContent: 'center' }),\n  // if color starts with $, treat  it like a css var, otherwise treat it like a regular color.\n  // TODO this is ugly - why does the argument need a '$' prefix?\n  cssVar = (color = '$gray') => color.startsWith('$') ? `var(--${color.substr(1)}, var(--gray))` : color,\n  cssVarValue = (prop: S) => {\n    if (!prop.startsWith('$')) return prop\n    prop = prop.substring(1)\n    return getComputedStyle(document.documentElement).getPropertyValue(`--${prop}`).trim()\n  },\n  // The width is applied to both form item container and component root which is a problem for percentages.\n  // E.g. 50% width on both form container and component results in 25% of total form width instead of 50% (component takes 50% of 50% of the form = 25% total).\n  formItemWidth = (width?: S) => width?.includes('%') ? '100%' : width,\n  spectrum: Dict<S> = {\n    amber: '#ffc107',\n    azure: '#03a9f4',\n    black: '#000',\n    blue: '#2196f3',\n    brown: '#795548',\n    cyan: '#00bcd4',\n    gray: '#9e9e9e',\n    green: '#8bc34a',\n    indigo: '#3f51b5',\n    lime: '#cddc39',\n    mint: '#4caf50',\n    orange: '#ff9800',\n    pink: '#e91e63',\n    purple: '#9c27b0',\n    red: '#f44336',\n    tangerine: '#ff5722',\n    teal: '#009688',\n    violet: '#673ab7',\n    white: '#fff',\n    yellow: '#ffeb3b',\n  },\n  // Src: https://gomakethings.com/dynamically-changing-the-text-color-based-on-background-color-contrast-with-vanilla-js/\n  getContrast = (color: S) => {\n    if (color.startsWith('$')) color = cssVarValue(color)\n    if (color.startsWith('#')) color = color.slice(1)\n    if (color.length === 3) color = color.split('').map(hex => `${hex}${hex}`).join('')\n\n    const\n      r = parseInt(color.substr(0, 2), 16),\n      g = parseInt(color.substr(2, 2), 16),\n      b = parseInt(color.substr(4, 2), 16),\n      yiq = ((r * 299) + (g * 587) + (b * 114)) / 1000\n\n    return yiq >= 128 ? 'black' : 'white'\n  }\n\nconst\n  themes: Dict<Theme> = {\n    default: {\n      palette: {\n        text: '#323130',\n        card: '#ffffff',\n        page: '#f5f5f5',\n      },\n      fluentPalette: {\n        themePrimary: '#000000',\n        themeLighterAlt: '#898989',\n        themeLighter: '#737373',\n        themeLight: '#595959',\n        themeTertiary: '#373737',\n        themeSecondary: '#2f2f2f',\n        themeDarkAlt: '#252525',\n        themeDark: '#151515',\n        themeDarker: '#0b0b0b',\n        neutralLighterAlt: '#faf9f8',\n        neutralLighter: '#f3f2f1',\n        neutralLight: '#edebe9',\n        neutralQuaternaryAlt: '#e1dfdd',\n        neutralQuaternary: '#d0d0d0',\n        neutralTertiaryAlt: '#c8c6c4',\n        neutralTertiary: '#a19f9d',\n        neutralSecondary: '#605e5c',\n        neutralPrimaryAlt: '#3b3a39',\n        neutralPrimary: '#323130',\n        neutralDark: '#201f1e',\n        black: '#000000',\n        white: '#ffffff',\n      },\n    },\n    dark: {\n      palette: {\n        text: '#ffffff',\n        card: '#21252b',\n        page: '#282c34',\n      },\n      fluentPalette: {\n        // TODO: Generate dark fluent color palette.\n      },\n    },\n    neon: {\n      palette: {\n        text: '#ffffff',\n        card: '#0d0e0f',\n        page: '#1b1d1f',\n      },\n      fluentPalette: {\n        themePrimary: '#cddc39',\n        themeLighterAlt: '#080902',\n        themeLighter: '#202309',\n        themeLight: '#3d4211',\n        themeTertiary: '#7a8422',\n        themeSecondary: '#b3c132',\n        themeDarkAlt: '#d0df4a',\n        themeDark: '#d7e464',\n        themeDarker: '#e1eb8a',\n        neutralLighterAlt: '#1a1c1e',\n        neutralLighter: '#191b1d',\n        neutralLight: '#181a1c',\n        neutralQuaternaryAlt: '#17181a',\n        neutralQuaternary: '#161719',\n        neutralTertiaryAlt: '#151618',\n        neutralTertiary: '#c8c8c8',\n        neutralSecondary: '#d0d0d0',\n        neutralPrimaryAlt: '#dadada',\n        neutralPrimary: '#ffffff',\n        neutralDark: '#f4f4f4',\n        black: '#f8f8f8',\n        white: '#1b1d1f',\n      },\n    },\n  },\n  rgb = (hex: S): [U, U, U] => {\n    const x = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex)\n    return x ? [parseInt(x[1], 16), parseInt(x[2], 16), parseInt(x[3], 16)] : [0, 0, 0]\n  }\n\nexport const\n  defaultThemeName = 'default',\n  themeB = box(defaultThemeName),\n  defaultTheme = themes[defaultThemeName]\n\n\non(themeB, themeName => {\n  const\n    theme = themes[themeName] ?? themes[defaultThemeName],\n    { palette, fluentPalette } = theme\n\n  // TODO: Resolve the any.\n  // TODO: This is polluting the global namespace.\n  Object.keys(palette).forEach(k => document.body.style.setProperty(`--${k}`, (palette as any)[k]))\n  Object.keys(fluentPalette).forEach(k => document.body.style.setProperty(`--${k}`, (fluentPalette as any)[k]))\n\n  // Update text tones.\n  if (palette.text) {\n    const [r, g, b] = rgb(palette.text)\n    let alpha = 0.05\n    for (let i = 0; i < 10; i++) {\n      document.body.style.setProperty(`--text${i}`, `rgba(${r},${g},${b},${alpha})`)\n      alpha += i === 0 ? 0.05 : 0.1\n    }\n  }\n\n  // Change global Fluent theme.\n  Fluent.loadTheme({ palette: fluentPalette })\n})\n\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { Id, Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { CardEffect, cards } from './layout'\nimport { bond, wave } from './ui'\n\n/** Create a breadcrumb for a `h2o_wave.types.BreadcrumbsCard()`. */\ninterface Breadcrumb {\n  /** The name of this item. Prefix the name with a '#' to trigger hash-change navigation. */\n  name: Id\n  /** The label to display. */\n  label: S\n}\n/**\n * Create a card containing breadcrumbs.\n * Breadcrumbs should be used as a navigational aid in your app or site.\n * They indicate the current pages location within a hierarchy and help\n * the user understand where they are in relation to the rest of that hierarchy.\n * They also afford one-click access to higher levels of that hierarchy.\n * Breadcrumbs are typically placed, in horizontal form, under the masthead\n * or navigation of an experience, above the primary content area.\n */\ninterface State {\n  /** A list of `h2o_wave.types.Breadcrumb` instances to display. See `h2o_wave.ui.breadcrumb()` */\n  items: Breadcrumb[]\n}\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n    },\n  })\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      items = state.items.map(({ name, label }) => ({\n        key: name,\n        text: label,\n        onClick: () => {\n          if (name.startsWith('#')) {\n            window.location.hash = name.substr(1)\n            return\n          }\n          wave.args[name] = true\n          wave.push()\n        }\n      }\n      )),\n      render = () => (\n        <div data-test={name} className={css.card}>\n          <Fluent.Breadcrumb items={items} styles={{ root: { margin: 0 } }} />\n        </div>\n      )\n\n    return { render, changed }\n  })\n\ncards.register('breadcrumbs', View, { effect: CardEffect.Transparent })","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n// \n// Simplify.js, ported to TypeScript, with minor refactoring.\n// Original implementation: mourner.github.io/simplify-js\n// BSD 2-Clause \"Simplified\" License\n//\n\n/*\nCopyright (c) 2017, Vladimir Agafonkin\nAll rights reserved.\n\nRedistribution and use in source and binary forms, with or without modification, are\npermitted provided that the following conditions are met:\n\n   1. Redistributions of source code must retain the above copyright notice, this list of\n      conditions and the following disclaimer.\n\n   2. Redistributions in binary form must reproduce the above copyright notice, this list\n      of conditions and the following disclaimer in the documentation and/or other materials\n      provided with the distribution.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND ANY\nEXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF\nMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE\nCOPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\nEXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\nSUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)\nHOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR\nTORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\nSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n/*\n (c) 2017, Vladimir Agafonkin\n Simplify.js, a high-performance JS polyline simplification library\n mourner.github.io/simplify-js\n*/\n\nimport { B, F, U } from 'h2o-wave'\n\nexport class P {\n  constructor(readonly x: F, readonly y: F) { }\n}\n\n// to suit your point format, run search/replace for '.x' and '.y';\n// for 3D version, see 3d branch (configurability would draw significant performance overhead)\n\n// square distance between 2 points\nfunction getSqDist(p1: P, p2: P) {\n  const\n    dx = p1.x - p2.x,\n    dy = p1.y - p2.y\n  return dx * dx + dy * dy\n}\n\n// square distance from a point to a segment\nfunction getSqSegDist(p: P, p1: P, p2: P) {\n  let\n    x = p1.x,\n    y = p1.y,\n    dx = p2.x - x,\n    dy = p2.y - y\n\n  if (dx !== 0 || dy !== 0) {\n    const t = ((p.x - x) * dx + (p.y - y) * dy) / (dx * dx + dy * dy)\n\n    if (t > 1) {\n      x = p2.x\n      y = p2.y\n    } else if (t > 0) {\n      x += dx * t\n      y += dy * t\n    }\n  }\n\n  dx = p.x - x\n  dy = p.y - y\n\n  return dx * dx + dy * dy\n}\n// rest of the code doesn't care about point format\n\n// basic distance-based simplification\nconst P0: P = { x: 0, y: 0 }\nfunction simplifyRadialDist(points: P[], sqTolerance: F) {\n  let\n    prevPoint = points[0],\n    point: P = P0\n\n  const\n    newPoints = [prevPoint]\n\n  for (let i = 1, len = points.length; i < len; i++) {\n    point = points[i]\n    if (getSqDist(point, prevPoint) > sqTolerance) {\n      newPoints.push(point)\n      prevPoint = point\n    }\n  }\n\n  if (prevPoint !== point) newPoints.push(point)\n\n  return newPoints\n}\n\nfunction simplifyDPStep(points: P[], first: U, last: U, sqTolerance: F, simplified: P[]) {\n  let\n    maxSqDist = sqTolerance,\n    index: U = 0\n\n  for (let i = first + 1; i < last; i++) {\n    const sqDist = getSqSegDist(points[i], points[first], points[last])\n    if (sqDist > maxSqDist) {\n      index = i\n      maxSqDist = sqDist\n    }\n  }\n\n  if (maxSqDist > sqTolerance) {\n    if (index - first > 1) simplifyDPStep(points, first, index, sqTolerance, simplified)\n    simplified.push(points[index])\n    if (last - index > 1) simplifyDPStep(points, index, last, sqTolerance, simplified)\n  }\n}\n\n// simplification using Ramer-Douglas-Peucker algorithm\nfunction simplifyDouglasPeucker(points: P[], sqTolerance: F) {\n  const\n    last = points.length - 1,\n    simplified = [points[0]]\n  simplifyDPStep(points, 0, last, sqTolerance, simplified)\n  simplified.push(points[last])\n  return simplified\n}\n\n// both algorithms combined for awesome performance\nexport function simplify(points: P[], tolerance: F, highestQuality: B) {\n  if (points.length <= 2) return points\n  const sqTolerance = tolerance !== undefined ? tolerance * tolerance : 1\n  points = highestQuality ? points : simplifyRadialDist(points, sqTolerance)\n  points = simplifyDouglasPeucker(points, sqTolerance)\n  return points\n}\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { CommandBar, ICommandBarItemProps } from '@fluentui/react'\nimport { B, box, ChangeSet, Dict, F, Model, on, Rec, S, to, U } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, grid } from './layout'\nimport { P, simplify } from './simplify'\nimport { px, spectrum } from './theme'\nimport { bond, wave } from './ui'\n\ndeclare global {\n  interface CanvasRenderingContext2D {\n    webkitBackingStorePixelRatio: number\n    mozBackingStorePixelRatio: number\n    msBackingStorePixelRatio: number\n    oBackingStorePixelRatio: number\n    backingStorePixelRatio: number\n  }\n}\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n      overflow: 'auto',\n    },\n    layers: {\n      position: 'relative',\n    }\n  })\n\n/**\n * WARNING: Experimental and subject to change.\n * Do not use in production sites!\n *\n * Create a card that displays a drawing canvas (whiteboard).\n * :icon \"EditCreate\"\n */\ninterface State {\n  /**\n   * The title for this card.\n   * :t \"textbox\"\n   * :value \"Untitled Canvas\"\n   */\n  title: S\n  /**\n   * Canvas width, in pixels.\n   * :t \"spinbox\"\n   * :value 400\n   * :min 400\n   * :max 2048\n   * :step 50\n   */\n  width: U\n  /**\n   * Canvas height, in pixels.\n   * :t \"spinbox\"\n   * :value 300\n   * :min 300\n   * :max 1536\n   * :step 50\n   */\n  height: U\n  /**\n   * The data for this card.\n   * :t \"record\"\n   * :value {}\n   */\n  data: Rec\n}\n\ntype G = CanvasRenderingContext2D\n\nclass Color { constructor(public r: U, public g: U, public b: U, public a: U) { } }\n\ntype Canvas = {\n  el: HTMLCanvasElement\n  g: G\n  w: U\n  h: U\n  r: F\n}\n\ntype Hitmap = {\n  put(index: number): S\n  test(x: number, y: number): number | undefined\n  clear(): void\n}\n\nenum ShapeT { None, Curve, Line, Rect, SolidRect }\n\ntype Nothing = {\n  t: ShapeT.None\n}\n\ntype Curve = {\n  t: ShapeT.Curve\n  p: F[] // points\n  c: S // color\n  l: U // linewidth\n}\n\ntype Line = {\n  t: ShapeT.Line\n  p: F[] // points\n  c: S // color\n  l: U // linewidth\n}\n\ntype Rect = {\n  t: ShapeT.Rect\n  p: F[] // points\n  c: S // color\n  l: U // linewidth\n}\n\ntype SolidRect = {\n  t: ShapeT.SolidRect\n  p: F[] // points\n  c: S // color\n}\n\ntype Shape = Nothing | Curve | Line | Rect | SolidRect\n\n\nexport const\n  marshalPoints = (ps: P[]): F[] => {\n    const fs = new Array<F>(ps.length * 2)\n    let i = 0\n    for (const p of ps) {\n      fs[i++] = p.x\n      fs[i++] = p.y\n    }\n    return fs\n  },\n  unmarshalPoints = (fs: F[]): P[] => {\n    const ps = new Array<P>(fs.length / 2)\n    let i = 0\n    for (let j = 0, n = ps.length; j < n; j++) {\n      ps[j] = new P(fs[i++], fs[i++])\n    }\n    return ps\n  },\n\n  newCanvas = (w: U, h: U, _alpha: B): Canvas => {\n    const\n      el = document.createElement('canvas'),\n      g = el.getContext('2d', { alpha: true })\n\n    if (!g) throw new Error('failed obtaining canvas context')\n\n    const\n      dpr = window.devicePixelRatio || 1,\n      bspr = g.webkitBackingStorePixelRatio\n        || g.mozBackingStorePixelRatio\n        || g.msBackingStorePixelRatio\n        || g.oBackingStorePixelRatio\n        || g.backingStorePixelRatio\n        || 1,\n      r = dpr / bspr\n\n    el.style.outline = '1px solid #ccc'\n    el.style.position = 'absolute'\n\n    if (dpr !== bspr) {\n      el.width = w * r; el.height = h * r\n      g.scale(r, r)\n      el.style.width = px(w); el.style.height = px(h)\n    } else {\n      el.width = w; el.height = h\n    }\n\n    return { el, g, w, h, r }\n  },\n  byteToHex = (b: number): S => {\n    const hex = b.toString(16)\n    return (hex.length === 1) ? `0${hex}` : hex\n  },\n  hexToColor = (hex: S): Color => {\n    const c = parseInt(hex.substring(1), 16)\n    return new Color((c >> 16) & 255, (c >> 8) & 255, c & 255, 255)\n  },\n  hexmap = (() => {\n    const m = new Map<U, S>()\n    for (let i = 0; i < 256; i++) m.set(i, byteToHex(i))\n    return m\n  })(),\n  newHitmap = (init: U, gx: G, ratio: F): Hitmap => {\n    let mru = init\n    const\n      dict = new Map<number, number>(),\n      put = (index: number): S => {\n        const c = mru++\n        if (mru >= 16581375) mru = 0\n        dict.set(c, index)\n\n        const r = (c >> 16) & 255, g = (c >> 8) & 255, b = c & 255\n        return `#${hexmap.get(r)}${hexmap.get(g)}${hexmap.get(b)}`\n      },\n      test = (x: number, y: number): number | undefined => {\n        // TODO add radius param and hit-test a larger chunk to improve eraser usability.\n        const img = gx.getImageData(x * ratio, y * ratio, 1, 1).data\n\n        if (img[3] === 255) return dict.get((img[0] << 16) + (img[1] << 8) + img[2])\n\n        return undefined\n      },\n      clear = () => {\n        dict.clear()\n        mru = init\n      }\n\n    return { put, test, clear }\n  },\n  titleCase = (s: S) => s.charAt(0).toUpperCase() + s.slice(1),\n  inks = (() => {\n    const inks: Array<{ name: S, color: S }> = []\n    for (const k in spectrum) inks.push({ name: titleCase(k), color: spectrum[k] })\n    return inks\n  })()\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      shapeKeysB = box<S[]>([]),\n      shapesB = box<Shape[]>([]),\n      shapeB = box(ShapeT.Curve),\n      colorB = box('black'),\n      lineWidthB = box(3),\n      clearB = box<B>(),\n      availableTipSizes: [S, U][] = [['Fine', 3], ['Medium', 5], ['Bold', 7]],\n      layersRef = React.createRef<HTMLDivElement>(),\n      initPenStyle = (g: G) => {\n        g.lineJoin = 'round'\n        g.lineCap = 'round'\n      },\n      overlaps = (p1: P, p2: P) => (p1 === p2 || (p1.x === p2.x && p1.y === p2.y)),\n      dot = (g: G, p: P) => {\n        const lw = lineWidthB(), hlw = Math.floor(lw / 2)\n        g.fillRect(p.x - hlw, p.y - hlw, lw, lw)\n      },\n      line = (g: G, p1: P, p2: P) => {\n        if (overlaps(p1, p2)) {\n          dot(g, p1)\n          return\n        }\n        g.beginPath()\n        g.moveTo(p1.x, p1.y)\n        g.lineTo(p2.x, p2.y)\n        g.stroke()\n      },\n      strokeRect = (g: G, p1: P, p2: P) => {\n        g.strokeRect(p1.x, p1.y, p2.x - p1.x, p2.y - p1.y)\n      },\n      fillRect = (g: G, p1: P, p2: P) => {\n        g.fillRect(p1.x, p1.y, p2.x - p1.x, p2.y - p1.y)\n      },\n      pline = (g: G, pts: P[]) => {\n        switch (pts.length) {\n          case 1:\n            dot(g, pts[0])\n            return\n          case 2:\n            line(g, pts[0], pts[1])\n            return\n          default:\n            {\n              g.beginPath()\n              let p = pts[0]\n              g.moveTo(p.x, p.y)\n              for (let i = 1, n = pts.length; i < n; i++) {\n                p = pts[i]\n                g.lineTo(p.x, p.y)\n              }\n              g.stroke()\n            }\n        }\n      },\n      init = () => {\n        const layersEl = layersRef.current\n\n        if (!layersEl) {\n          window.setTimeout(init, 500)\n          return\n        }\n        const\n          { width, height } = state,\n          fgC = newCanvas(width, height, true), // foreground\n          bgC = newCanvas(width, height, true), // background\n          htC = newCanvas(width, height, true), // hit-testing; off-screen\n          fgEl = fgC.el,\n          fg = fgC.g,\n          bg = bgC.g,\n          ht = htC.g\n\n\n        fgEl.style.cursor = 'crosshair'\n        layersEl.appendChild(bgC.el)\n        layersEl.appendChild(fgEl)\n\n        initPenStyle(fg)\n        initPenStyle(bg)\n\n        let\n          pts: P[] = []\n        const\n          hitmap = newHitmap(0, ht, htC.r),\n          clear = (g: G) => g.clearRect(0, 0, width, height),\n          setAttr = (page: ChangeSet, k: S, v: any) => {\n            // TODO actual username\n            page.set(`${name} data ${k}`, v)\n          },\n          syncAttr = (k: S, v: any) => {\n            const page = wave.fork()\n            setAttr(page, k, v)\n            page.push()\n          },\n          clearAttrs = (ks: S[]) => {\n            const page = wave.fork()\n            for (const k of ks) setAttr(page, k, null)\n            page.push()\n          },\n          track2 = (p: P) => {\n            if (pts.length > 1) {\n              pts[1] = p\n            } else {\n              pts.push(p)\n            }\n          },\n          move = (x: U, y: U) => {\n            const p = new P(x, y)\n            switch (shapeB()) {\n              case ShapeT.Curve:\n                {\n                  pts.push(p)\n                  const\n                    n = pts.length,\n                    p0 = pts[n - 1]\n                  line(fg, p0, pts.length === 1 ? p0 : pts[n - 2])\n                }\n                break\n              case ShapeT.Line:\n                {\n                  track2(p)\n                  if (pts.length < 2) return\n                  clear(fg)\n                  line(fg, pts[0], pts[1])\n                }\n                break\n              case ShapeT.Rect:\n                {\n                  track2(p)\n                  if (pts.length < 2) return\n                  clear(fg)\n                  strokeRect(fg, pts[0], pts[1])\n                }\n                break\n              case ShapeT.SolidRect:\n                {\n                  track2(p)\n                  if (pts.length < 2) return\n                  clear(fg)\n                  fillRect(fg, pts[0], pts[1])\n                }\n                break\n              default: // eraser \n                {\n                  const i = hitmap.test(x, y)\n                  if (i !== undefined) {\n                    const shapeKeys = shapeKeysB()\n                    syncAttr(shapeKeys[i], null)\n                  }\n                }\n            }\n          },\n          marshalShape = (t: ShapeT, c: S, l: U): Shape | undefined => {\n            switch (t) {\n              case ShapeT.Curve:\n                return { t: ShapeT.Curve, p: marshalPoints(simplify(pts, 2, true)), c, l }\n              case ShapeT.Line:\n                if (pts.length === 2) return { t: ShapeT.Line, p: marshalPoints(pts), c, l }\n                return\n              case ShapeT.Rect:\n                if (pts.length === 2) return { t: ShapeT.Rect, p: marshalPoints(pts), c, l }\n                return\n              case ShapeT.SolidRect:\n                if (pts.length === 2) return { t: ShapeT.SolidRect, p: marshalPoints(pts), c }\n                return\n            }\n          },\n          done = () => {\n            if (!pts.length) return\n            const shape = marshalShape(shapeB(), colorB(), lineWidthB())\n            if (shape) {\n              draw(shape, 0)\n              // TODO won't work if local time is messed up; use additional key (shape count?)\n              syncAttr(new Date().toISOString(), JSON.stringify(shape))\n            }\n            pts = []\n            clear(fg)\n          },\n          draw = (shape: Shape, i: U) => {\n            switch (shape.t) {\n              case ShapeT.Curve:\n              case ShapeT.Line:\n                {\n                  const ps = unmarshalPoints(shape.p)\n                  bg.strokeStyle = shape.c\n                  bg.lineWidth = shape.l\n                  pline(bg, ps)\n                  ht.strokeStyle = hitmap.put(i)\n                  ht.lineWidth = shape.l\n                  pline(ht, ps)\n                }\n                break\n              case ShapeT.Rect:\n                {\n                  const ps = unmarshalPoints(shape.p), [p1, p2] = ps\n                  bg.strokeStyle = shape.c\n                  bg.lineWidth = shape.l\n                  strokeRect(bg, p1, p2)\n                  ht.strokeStyle = hitmap.put(i)\n                  ht.lineWidth = shape.l\n                  strokeRect(ht, p1, p2)\n                }\n                break\n              case ShapeT.SolidRect:\n                {\n                  const ps = unmarshalPoints(shape.p), [p1, p2] = ps\n                  bg.fillStyle = shape.c\n                  fillRect(bg, p1, p2)\n                  ht.fillStyle = hitmap.put(i)\n                  fillRect(ht, p1, p2)\n                }\n                break\n            }\n          },\n          redraw = (shapes: Shape[]) => {\n            clear(bg)\n            clear(ht)\n            shapes.forEach(draw)\n          },\n          onMouseMove = (e: MouseEvent) => {\n            const r = fgEl.getBoundingClientRect()\n            move(e.clientX - r.left, e.clientY - r.top)\n          },\n          onMouseUp = () => {\n            fgEl.removeEventListener('mousemove', onMouseMove)\n            fgEl.removeEventListener('mouseup', onMouseUp)\n            fgEl.removeEventListener('mouseout', onMouseUp)\n            done()\n          }\n\n        fgEl.addEventListener('mousedown', e => {\n          onMouseMove(e)\n          fgEl.addEventListener('mousemove', onMouseMove)\n          fgEl.addEventListener('mouseup', onMouseUp)\n          fgEl.addEventListener('mouseout', onMouseUp)\n        })\n\n        to(shapesB, redraw)\n\n        to(colorB, c => {\n          fg.strokeStyle = c\n          fg.fillStyle = c\n        })\n\n        to(lineWidthB, lw => {\n          fg.lineWidth = lw\n        })\n\n        on(clearB, () => clearAttrs(shapeKeysB()))\n      },\n      commands: ICommandBarItemProps[] = [\n        {\n          key: 'tool',\n          iconProps: { iconName: 'Edit' },\n          subMenuProps: {\n            items: [\n              {\n                key: 'pen',\n                text: 'Pen',\n                iconProps: { iconName: 'Edit' },\n                onClick: () => { shapeB(ShapeT.Curve) },\n              },\n              {\n                key: 'line',\n                text: 'Line',\n                iconProps: { iconName: 'Line' },\n                onClick: () => { shapeB(ShapeT.Line) },\n              },\n              {\n                key: 'rect',\n                text: 'Rectangle',\n                iconProps: { iconName: 'RectangleShape' },\n                onClick: () => { shapeB(ShapeT.Rect) },\n              },\n              {\n                key: 'solid_rect',\n                text: 'Solid Rectangle',\n                iconProps: { iconName: 'RectangleShapeSolid' },\n                onClick: () => { shapeB(ShapeT.SolidRect) },\n              },\n            ],\n          },\n        },\n        {\n          key: 'color',\n          iconProps: { iconName: 'Color' },\n          subMenuProps: {\n            items: inks.map(({ name: text, color }) => ({\n              key: color,\n              text,\n              iconProps: { iconName: 'CircleFill', style: { color } },\n              onClick: () => { colorB(color) },\n            })),\n          },\n        },\n        {\n          key: 'lineWidth',\n          iconProps: { iconName: 'LineThickness' },\n          subMenuProps: {\n            items: availableTipSizes.map(([name, lineWidth]) => ({\n              key: name,\n              text: name,\n              iconProps: { iconName: 'Edit' },\n              onClick: () => { lineWidthB(lineWidth) },\n            }))\n          },\n        },\n        {\n          key: 'erase',\n          iconProps: { iconName: 'EraseTool' },\n          onClick: () => { shapeB(ShapeT.None) },\n        },\n        {\n          key: 'clear',\n          iconProps: { iconName: 'Clear' },\n          onClick: () => { clearB(true) },\n        },\n      ],\n      unpack = (d: any): Dict<Shape> => {\n        if (!d) return {}\n        const shapes: Dict<Shape> = {}\n        for (const k in d) shapes[k] = JSON.parse(d[k])\n        return shapes\n      },\n      render = () => {\n        const\n          shapeDict = unpack(state.data),\n          shapeKeys = Object.keys(shapeDict).sort()\n\n        shapeKeysB(shapeKeys)\n        shapesB(shapeKeys.map(k => shapeDict[k]))\n\n        return (\n          <div data-test={name} className={css.card}>\n            <div className='wave-s12 wave-w6'>{state.title}</div>\n            <div>\n              <CommandBar\n                items={commands}\n                ariaLabel=\"Use left and right arrow keys to navigate between commands\"\n              />\n            </div>\n            <div ref={layersRef} className={css.layers} />\n          </div>\n        )\n      }\n    return { init, render, changed }\n  })\n\ncards.register('canvas', View)\n\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { TextField } from '@fluentui/react'\nimport { Box, box, Dict, Model, on, Rec, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, grid } from './layout'\nimport { border, clas, cssVar, padding } from './theme'\nimport { bond, config, wave } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n      overflow: 'auto',\n    },\n    history: {\n      flexGrow: 1,\n      overflow: 'auto',\n    },\n    message: {\n      padding: padding(6, 0)\n    },\n    header: {\n      marginBottom: 2,\n    },\n    user: {\n      marginRight: 5,\n    },\n    date: {\n      color: cssVar('$text7')\n    },\n    body: {\n      paddingLeft: 10,\n      borderLeft: border(1, cssVar('$text3')),\n    }\n  })\n\n/**\n * WARNING: Experimental and subject to change.\n * Do not use in production sites!\n *\n * Create a card that displays a chat room.\n * :icon \"OfficeChat\"\n */\ninterface State {\n  /**\n   * The title for this card.\n   * :t \"textbox\"\n   * :value \"Untitled Chat\"\n   */\n  title: S\n  /**\n   * The data for this card.\n   * :t \"record\"\n   * :value {}\n   */\n  data: Rec\n  /**\n   * The maximum number of messages contained in this card. Defaults to 50 messages.\n   * :t \"spinbox\"\n   * :value 50\n   * :min 10\n   * :max 10000\n   * :step 10\n   **/\n  capacity?: U\n}\n\ntype ChatMessage = {\n  /** Username of the sender. */\n  u: S\n  /** The message contents. */\n  m: S\n}\n\ntype HTMLTextBox = HTMLInputElement | HTMLTextAreaElement\n\nconst\n  ChatInputField = ({ inputB }: { inputB: Box<S> }) => {\n    const\n      [value, setValue] = React.useState(''),\n      onChange = React.useCallback(\n        (_event: React.FormEvent<HTMLTextBox>, newValue?: string) => {\n          setValue(newValue || '')\n        },\n        [],\n      ),\n      onKeyUp = ({ key, target }: React.KeyboardEvent<HTMLTextBox>, v?: S) => {\n        if (key == 'Enter') {\n          let input = v ?? (target as HTMLTextBox).value\n          if (!input) return\n          input = input.trim()\n          setValue('') // clear input field\n          if (input.length) inputB(input)\n        }\n      }\n    return (\n      <TextField\n        label='Send a message'\n        multiline autoAdjustHeight\n        onKeyUp={onKeyUp}\n        onChange={onChange}\n        value={value} />\n    )\n  },\n  unpack = (d: any): Dict<ChatMessage> => {\n    if (!d) return {}\n    const shapes: Dict<ChatMessage> = {}\n    for (const k in d) shapes[k] = JSON.parse(d[k])\n    return shapes\n  }\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    let _keys: S[] = []\n    const\n      messagesRef = React.createRef<HTMLDivElement>(),\n      inputB = box('', () => false),\n      scroll = () => {\n        const ref = messagesRef.current\n        if (ref) ref.scrollTop = ref.scrollHeight\n      },\n      render = () => {\n        const\n          messages = unpack(state.data),\n          keys = Object.keys(messages).sort(),\n          history = keys.map(time => {\n            const { u: user, m: message } = messages[time]\n            return (\n              <div key={`${user}|${time}|${message}`} className={css.message}>\n                <div className={clas('wave-s12', css.header)}>\n                  <span className={clas('wave-w6', css.user)}>{user}</span>\n                  <span className={clas('wave-s10', css.date)}>{(new Date(time)).toLocaleString()}</span>\n                </div>\n                <div className={css.body}>{message}</div>\n              </div>\n            )\n          })\n        _keys = keys\n        return (\n          <div data-test={name} className={css.card}>\n            <div className='wave-s12 wave-w6'>{state.title}</div>\n            <div ref={messagesRef} className={css.history}>{history}</div>\n            <div><ChatInputField inputB={inputB} /></div>\n          </div>\n        )\n      }\n\n    on(inputB, input => {\n      const\n        page = wave.fork(),\n        cap = state.capacity ?? 50,\n        n = _keys.length\n\n      // TODO actual username\n\n      if (n >= cap) {\n        for (let i = 0; i < n - cap + 1; i++) page.set(`${name} data ${_keys[i]}`, null)\n      }\n      const cm: ChatMessage = { u: config.username ?? '?', m: input }\n      page.set(`${name} data ${(new Date()).toISOString()}`, JSON.stringify(cm))\n      page.push()\n    })\n\n    return { render, init: scroll, update: scroll, changed }\n  })\n\ncards.register('chat', View)\n","//\n// THIS FILE IS GENERATED; DO NOT EDIT\n//\n\n// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { CardDef } from './editing'\n\nexport const cardDefs: CardDef[] = [\n  {\n    \"view\": \"canvas\",\n    \"icon\": \"EditCreate\",\n    \"attrs\": [\n      {\n        \"name\": \"box\",\n        \"optional\": false,\n        \"t\": \"box\",\n        \"value\": \"{\\\"zone\\\":\\\"Body\\\"}\"\n      },\n      {\n        \"name\": \"title\",\n        \"optional\": false,\n        \"t\": \"textbox\",\n        \"value\": \"Untitled Canvas\"\n      },\n      {\n        \"name\": \"width\",\n        \"optional\": false,\n        \"t\": \"spinbox\",\n        \"value\": 400,\n        \"min\": 400,\n        \"max\": 2048,\n        \"step\": 50\n      },\n      {\n        \"name\": \"height\",\n        \"optional\": false,\n        \"t\": \"spinbox\",\n        \"value\": 300,\n        \"min\": 300,\n        \"max\": 1536,\n        \"step\": 50\n      },\n      {\n        \"name\": \"data\",\n        \"optional\": false,\n        \"t\": \"record\",\n        \"value\": {}\n      }\n    ]\n  },\n  {\n    \"view\": \"chat\",\n    \"icon\": \"OfficeChat\",\n    \"attrs\": [\n      {\n        \"name\": \"box\",\n        \"optional\": false,\n        \"t\": \"box\",\n        \"value\": \"{\\\"zone\\\":\\\"Body\\\"}\"\n      },\n      {\n        \"name\": \"title\",\n        \"optional\": false,\n        \"t\": \"textbox\",\n        \"value\": \"Untitled Chat\"\n      },\n      {\n        \"name\": \"data\",\n        \"optional\": false,\n        \"t\": \"record\",\n        \"value\": {}\n      },\n      {\n        \"name\": \"capacity\",\n        \"optional\": true,\n        \"t\": \"spinbox\",\n        \"value\": 50,\n        \"min\": 10,\n        \"max\": 10000,\n        \"step\": 10\n      }\n    ]\n  },\n  {\n    \"view\": \"footer\",\n    \"icon\": \"Footer\",\n    \"attrs\": [\n      {\n        \"name\": \"box\",\n        \"optional\": false,\n        \"t\": \"box\",\n        \"value\": \"{\\\"zone\\\":\\\"Body\\\"}\"\n      },\n      {\n        \"name\": \"caption\",\n        \"optional\": false,\n        \"t\": \"textbox\",\n        \"value\": \"(c) Your Company, Inc.\"\n      }\n    ]\n  },\n  {\n    \"view\": \"frame\",\n    \"icon\": \"PageAdd\",\n    \"attrs\": [\n      {\n        \"name\": \"box\",\n        \"optional\": false,\n        \"t\": \"box\",\n        \"value\": \"{\\\"zone\\\":\\\"Body\\\"}\"\n      },\n      {\n        \"name\": \"title\",\n        \"optional\": false,\n        \"t\": \"textbox\",\n        \"value\": \"Untitled Frame\"\n      },\n      {\n        \"name\": \"path\",\n        \"optional\": true,\n        \"t\": \"textbox\",\n        \"value\": \"\"\n      },\n      {\n        \"name\": \"content\",\n        \"optional\": true,\n        \"t\": \"textarea\",\n        \"value\": \"\"\n      }\n    ]\n  },\n  {\n    \"view\": \"header\",\n    \"icon\": \"Header\",\n    \"attrs\": [\n      {\n        \"name\": \"box\",\n        \"optional\": false,\n        \"t\": \"box\",\n        \"value\": \"{\\\"zone\\\":\\\"Body\\\"}\"\n      },\n      {\n        \"name\": \"title\",\n        \"optional\": false,\n        \"t\": \"textbox\",\n        \"value\": \"Untitled Page\"\n      },\n      {\n        \"name\": \"subtitle\",\n        \"optional\": false,\n        \"t\": \"textbox\",\n        \"value\": \"Powered by H2O Wave.\"\n      },\n      {\n        \"name\": \"icon\",\n        \"optional\": true,\n        \"t\": \"textbox\",\n        \"value\": \"AppIconDefault\"\n      },\n      {\n        \"name\": \"icon_color\",\n        \"optional\": true,\n        \"t\": \"textbox\",\n        \"value\": \"yellow\"\n      }\n    ]\n  },\n  {\n    \"view\": \"markdown\",\n    \"icon\": \"InsertTextBox\",\n    \"attrs\": [\n      {\n        \"name\": \"box\",\n        \"optional\": false,\n        \"t\": \"box\",\n        \"value\": \"{\\\"zone\\\":\\\"Body\\\"}\"\n      },\n      {\n        \"name\": \"title\",\n        \"optional\": false,\n        \"t\": \"textbox\",\n        \"value\": \"Untitled Content\"\n      },\n      {\n        \"name\": \"content\",\n        \"optional\": false,\n        \"t\": \"textarea\",\n        \"value\": \"Hello, World!\"\n      }\n    ]\n  },\n  {\n    \"view\": \"markup\",\n    \"icon\": \"FileHTML\",\n    \"attrs\": [\n      {\n        \"name\": \"box\",\n        \"optional\": false,\n        \"t\": \"box\",\n        \"value\": \"{\\\"zone\\\":\\\"Body\\\"}\"\n      },\n      {\n        \"name\": \"title\",\n        \"optional\": false,\n        \"t\": \"textbox\",\n        \"value\": \"Untitled Content\"\n      },\n      {\n        \"name\": \"content\",\n        \"optional\": false,\n        \"t\": \"textarea\",\n        \"value\": \"<div/>\"\n      }\n    ]\n  }\n]","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Model, Rec, S, U, unpack } from 'h2o-wave'\nimport MarkdownIt from 'markdown-it'\nimport Renderer from 'markdown-it/lib/renderer'\nimport Token from 'markdown-it/lib/token'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, grid, substitute } from './layout'\nimport { border, clas, cssVar, padding, pc } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n    },\n    body: {\n      flexGrow: 1,\n    },\n    markdown: {\n      $nest: {\n        a: {\n          color: cssVar('$themePrimary'),\n          $nest: {\n            '&:hover': {\n              textDecoration: 'none',\n            },\n          },\n        },\n        table: {\n          width: pc(100),\n          borderCollapse: 'collapse',\n        },\n        tr: {\n          borderBottom: border(1, cssVar('$text5')),\n        },\n        th: {\n          padding: padding(11, 6),\n          textAlign: 'left',\n        },\n        td: {\n          padding: padding(11, 6),\n        },\n        img: {\n          maxWidth: '100%',\n          maxHeight: '100%',\n        },\n      },\n    },\n  })\n\nexport const\n  markdown = MarkdownIt({ html: true, linkify: true, typographer: true, }),\n  Markdown = ({ source }: { source: S }) => <div className={clas(css.markdown, 'wave-markdown')} dangerouslySetInnerHTML={{ __html: markdown.render(source) }} />\n\nconst defaultRenderer = markdown.renderer.rules.text\nmarkdown.renderer.rules.text = (tokens: Token[], idx: U, options: MarkdownIt.Options, env: any, self: Renderer) => {\n  const\n    linkOpenToken = tokens[idx + 1],\n    hrefAttr = linkOpenToken?.attrGet('href')\n\n  // Onclick has to be inlined otherwise a global function would be needed. Custom event is handled at App.tsx. Return false prevents navigation behavior.\n  if (hrefAttr?.startsWith('?')) linkOpenToken.attrPush(['onclick', `window.dispatchEvent(new CustomEvent(\"md-link-click\", {detail:\"${hrefAttr.substring(1)}\" }));return false`])\n  return defaultRenderer!(tokens, idx, options, env, self)\n}\n\n/**\n * Create a card that renders Markdown content.\n *\n * Github-flavored markdown is supported.\n * HTML markup is allowed in markdown content.\n * URLs, if found, are displayed as hyperlinks.\n * Copyright, reserved, trademark, quotes, etc. are replaced with language-neutral symbols.\n * :icon \"InsertTextBox\"\n */\ninterface State {\n  /**\n   * The title for this card.\n   * :t \"textbox\"\n   * :value \"Untitled Content\"\n   **/\n  title: S\n  /**\n   * The markdown content. Supports Github Flavored Markdown (GFM): https://guides.github.com/features/mastering-markdown/\n   * :t \"textarea\"\n   * :value \"Hello, World!\"\n   **/\n  content: S\n  /**\n   * Additional data for the card.\n   **/\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const\n          data = unpack<Rec>(state.data),\n          title = substitute(state.title, data)\n        return (\n          <div data-test={name} className={css.card}>\n            {title && <div className='wave-s12 wave-w6'>{title}</div>}\n            <div className={css.body}>\n              <Markdown source={substitute(state.content, data)} />\n            </div>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('markdown', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { Markdown } from './markdown'\n\nconst\n  css = stylesheet({\n    container: {\n      display: 'flex',\n      alignItems: 'flex-start',\n      alignContent: 'flex-start'\n    },\n    element: {\n      flexGrow: 1\n    },\n    icon: {\n      color: '#323130',\n      fontWeight: 400,\n      fontSize: '14px',\n      userSelect: 'none',\n      textAlign: 'left',\n      marginLeft: '0.5em',\n      cursor: 'pointer'\n    }\n  })\n\nexport const\n  XToolTip = ({ children, content, showIcon, expand }: {\n    children: React.ReactChild,\n    content?: S,\n    showIcon?: B,\n    expand?: B\n  }) => {\n    if (!content) return <>{children}</>\n\n    const\n      tooltipProps: Fluent.ITooltipProps = {\n        onRenderContent: () => (<div><Markdown source={content} /></div>)\n      }\n    return (\n      <div className={css.container} data-test='tooltip'>\n        {\n          showIcon === undefined || showIcon\n            ? (\n              <>\n                <div className={expand === undefined || expand ? css.element : ''}>{children}</div>\n                <Fluent.TooltipHost tooltipProps={tooltipProps}>\n                  <Fluent.FontIcon className={css.icon} iconName='Info' />\n                </Fluent.TooltipHost>\n              </>\n            )\n            : <Fluent.TooltipHost tooltipProps={tooltipProps}>{children}</Fluent.TooltipHost>\n        }\n      </div>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Dict, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { Component } from './form'\nimport { formItemWidth } from './theme'\nimport { XToolTip } from './tooltip'\nimport { wave } from './ui'\n\n/**\n * Create a button.\n *\n * Buttons are best used to enable a user to commit a change or complete steps in a task.\n * They are typically found inside forms, dialogs, panels or pages.\n * An example of their usage is confirming the deletion of a file in a confirmation dialog.\n *\n * When considering their place in a layout, contemplate the order in which a user will flow through the UI.\n * As an example, in a form, the individual will need to read and interact with the form fields before submitting\n * the form. Therefore, as a general rule, the button should be placed at the bottom of the UI container\n * which holds the related UI elements.\n *\n * Buttons may be placed within a \"buttons\" component which will lay out the buttons horizontally, or used\n * individually and they will be stacked vertically.\n *\n * While buttons can technically be used to navigate a user to another part of the experience, this is not\n * recommended unless that navigation is part of an action or their flow.\n */\nexport interface Button {\n  /** An identifying name for this component. If the name is prefixed with a '#', the button sets the location hash to the name when clicked. */\n  name: Id\n  /** The text displayed on the button. */\n  label?: S\n  /** The caption displayed below the label. Setting a caption renders a compound button. */\n  caption?: S\n  /** A value for this button. If a value is set, it is used for the button's submitted instead of a boolean True. */\n  value?: S\n  /** True if the button should be rendered as the primary button in the set. */\n  primary?: B\n  /** True if the button should be disabled. */\n  disabled?: B\n  /** True if the button should be rendered as link text and not a standard button. */\n  link?: B\n  /** An optional icon to display next to the button label (not applicable for links). */\n  icon?: S\n  /** The width of the button, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\n/** Create a set of buttons laid out horizontally. */\nexport interface Buttons {\n  /** The button in this set. */\n  items: Component[]\n  /** Specifies how to lay out buttons horizontally. */\n  justify?: 'start' | 'end' | 'center' | 'between' | 'around'\n  /** An identifying name for this component. */\n  name?: S\n  /** The width of the buttons, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\n\nconst\n  css = stylesheet({\n    buttons: {\n      boxSizing: 'border-box',\n      overflowX: 'auto'\n    },\n  }),\n  justifications: Dict<Fluent.Alignment> = {\n    start: 'start',\n    end: 'end',\n    center: 'center',\n    between: 'space-between',\n    around: 'space-around',\n  }\n\nconst\n  XButton = ({ model: { name, visible = true, link, label, disabled, icon, caption, value, primary, width } }: { model: Button }) => {\n    const\n      onClick = () => {\n        if (name.startsWith('#')) {\n          window.location.hash = name.substr(1)\n          return\n        }\n        wave.args[name] = value === undefined || value\n        wave.push()\n      },\n      // HACK: Our visibility logic in XComponents doesn't count with nested components, e.g. Butttons > Button.\n      styles: Fluent.IButtonStyles = {\n        root: {\n          display: visible ? 'inherit' : 'none',\n          width: formItemWidth(width),\n          minWidth: width ? 'initial' : undefined\n        }\n      }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[name] = false }, [])\n\n    if (link) {\n      return <Fluent.Link data-test={name} disabled={disabled} onClick={onClick} styles={styles}>{label}</Fluent.Link>\n    }\n    const btnProps: Fluent.IButtonProps = { text: label, disabled, onClick, styles, iconProps: { iconName: icon } }\n    if (!label && icon) return <Fluent.IconButton {...btnProps} data-test={name} title={caption} />\n\n    return caption?.length\n      ? primary\n        ? <Fluent.CompoundButton {...btnProps} data-test={name} primary secondaryText={caption} />\n        : <Fluent.CompoundButton {...btnProps} data-test={name} secondaryText={caption} />\n      : primary\n        ? <Fluent.PrimaryButton {...btnProps} data-test={name} />\n        : <Fluent.DefaultButton {...btnProps} data-test={name} />\n  }\nexport const\n  XButtons = ({ model }: { model: Buttons }) => {\n    const\n      { name, items, justify, width } = model,\n      children = (items.map(c => c.button).filter(Boolean) as Button[]).map(b => (\n        <XToolTip key={b.name} content={b.tooltip} showIcon={false} expand={false}>\n          <XButton model={b} />\n        </XToolTip>\n      ))\n    return (\n      <div data-test={name} className={css.buttons} style={{ width }}>\n        <Fluent.Stack horizontal horizontalAlign={justifications[justify || '']} tokens={{ childrenGap: 10 }}>{children}</Fluent.Stack>\n      </div>\n    )\n  },\n  XStandAloneButton = ({ model: m }: { model: Button }) => (\n    <div className={css.buttons}>\n      <XButton key={m.name} model={m} />\n    </div>\n  )","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { wave } from './ui'\n\n/**\n * Create a checkbox.\n *\n * A checkbox allows users to switch between two mutually exclusive options (checked or unchecked, on or off) through\n * a single click or tap. It can also be used to indicate a subordinate setting or preference when paired with another\n * component.\n *\n * A checkbox is used to select or deselect action items. It can be used for a single item or for a list of multiple\n * items that a user can choose from. The component has two selection states: unselected and selected.\n *\n * For a binary choice, the main difference between a checkbox and a toggle switch is that the checkbox is for status\n * and the toggle switch is for action.\n *\n * Use multiple checkboxes for multi-select scenarios in which a user chooses one or more items from a group of\n * choices that are not mutually exclusive.\n */\nexport interface Checkbox {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the checkbox. */\n  label?: S\n  /** True if selected, False if unselected. */\n  value?: B\n  /** True if the selection is indeterminate (neither selected nor unselected). */\n  indeterminate?: B\n  /** True if the checkbox is disabled. */\n  disabled?: B\n  /** True if the form should be submitted when the checkbox value changes. */\n  trigger?: B\n  /** The width of the checkbox, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nexport const\n  XCheckbox = ({ model: m }: { model: Checkbox }) => {\n    const onChange = (_e?: React.FormEvent<HTMLElement>, checked?: B) => {\n      wave.args[m.name] = checked === null ? null : !!checked\n      if (m.trigger) wave.push()\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[m.name] = !!m.value }, [])\n\n    return (\n      <Fluent.Checkbox\n        data-test={m.name}\n        inputProps={{ 'data-test': m.name } as React.ButtonHTMLAttributes<HTMLButtonElement>}\n        label={m.label}\n        defaultIndeterminate={m.indeterminate}\n        defaultChecked={m.value}\n        onChange={onChange}\n        disabled={m.disabled}\n      />\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { Choice } from './choice_group'\nimport { clas, margin } from './theme'\nimport { wave } from './ui'\n\n/**\n * Create a set of checkboxes.\n * Use this for multi-select scenarios in which a user chooses one or more items from a group of\n * choices that are not mutually exclusive.\n */\nexport interface Checklist {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed above the component. */\n  label?: S\n  /** The names of the selected choices. */\n  values?: S[]\n  /** The choices to be presented. */\n  choices?: Choice[]\n  /** True if the form should be submitted when the checklist value changes. */\n  trigger?: B\n  /** True if checklist should be rendered horizontally. */\n  inline?: B\n  /** The width of the checklist, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nconst\n  css = stylesheet({\n    toolbar: {\n      margin: margin(5, 0)\n    },\n    items: {\n      $nest: {\n        '> *': {\n          margin: '10px 0',\n        }\n      },\n    },\n    inline: {\n      display: 'flex',\n      flexWrap: 'wrap',\n      $nest: {\n        '.checklist-item': {\n          marginRight: 15\n        }\n      }\n    }\n  })\n\nexport const\n  XChecklist = ({ model: m }: { model: Checklist }) => {\n    const\n      defaultSelection = React.useMemo(() => new Set<S>(m.values), [m.values]),\n      getMappedChoices = React.useCallback(() => m.choices?.map(c => ({ c, selected: defaultSelection.has(c.name) })) || [], [defaultSelection, m.choices]),\n      [choices, setChoices] = React.useState(getMappedChoices()),\n      capture = (choices: { c: Choice, selected: B }[]) => {\n        wave.args[m.name] = choices.filter(({ selected }) => selected).map(({ c }) => c.name)\n        if (m.trigger) wave.push()\n      },\n      select = (value: B) => {\n        const _choices = choices.map(({ c, selected }) => ({ c, selected: c.disabled ? selected : value }))\n        setChoices(_choices)\n        capture(_choices)\n      },\n      selectAll = () => select(true),\n      deselectAll = () => select(false),\n      onChange = (idx: U) => (_e?: React.FormEvent<HTMLElement>, checked = false) => {\n        const _choices = [...choices]\n        _choices[idx].selected = checked\n        setChoices(_choices)\n        capture(_choices)\n      },\n      items = choices.map(({ c, selected }, i) => (\n        <Fluent.Checkbox\n          key={i}\n          data-test={`checkbox-${i + 1}`}\n          className='checklist-item'\n          label={c.label || c.name}\n          checked={selected}\n          onChange={onChange(i)}\n          disabled={!!c.disabled}\n          styles={{ root: { marginBottom: 4 } }}\n        />\n      ))\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[m.name] = m.values || [] }, [])\n    React.useEffect(() => { setChoices(getMappedChoices()) }, [getMappedChoices, m.choices])\n    return (\n      <div data-test={m.name}>\n        <Fluent.Label>{m.label}</Fluent.Label>\n        <div className={css.toolbar}>\n          <Fluent.Text variant='small'>\n            <Fluent.Link onClick={selectAll}>Select All</Fluent.Link> | <Fluent.Link onClick={deselectAll}>Deselect All</Fluent.Link>\n          </Fluent.Text>\n        </div>\n        <div className={clas(css.items, m.inline ? css.inline : '')}>{items}</div>\n      </div>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { wave } from './ui'\n\n/**\n *  Create a choice for a checklist, choice group or dropdown.\n */\nexport interface Choice {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** True if the checkbox is disabled. */\n  disabled?: B\n}\n\n/**\n * Create a choice group.\n * The choice group component, also known as radio buttons, let users select one option from two or more choices.\n * Each option is represented by one choice group button; a user can select only one choice group in a button group.\n *\n * Choice groups emphasize all options equally, and that may draw more attention to the options than necessary.\n * Consider using other components, unless the options deserve extra attention from the user.\n * For example, if the default option is recommended for most users in most situations, use a dropdown instead.\n *\n * If there are only two mutually exclusive options, combine them into a single Checkbox or Toggle switch.\n * For example, use a checkbox for \"I agree\" instead of choice group buttons for \"I agree\" and \"I don't agree.\"\n*/\nexport interface ChoiceGroup {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** The name of the selected choice. */\n  value?: S\n  /** The choices to be presented. */\n  choices?: Choice[]\n  /** True if this field is required. */\n  required?: B\n  /** True if the form should be submitted when the selection changes. */\n  trigger?: B\n  /** The width of the choice group, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nexport const\n  XChoiceGroup = ({ model: m }: { model: ChoiceGroup }) => {\n    const\n      options = (m.choices || []).map(({ name, label, disabled }): Fluent.IChoiceGroupOption => ({ key: name, text: label || name, disabled })),\n      onChange = (_e?: React.FormEvent<HTMLElement>, option?: Fluent.IChoiceGroupOption) => {\n        if (option) wave.args[m.name] = option.key\n        if (m.trigger) wave.push()\n      }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[m.name] = m.value || null }, [])\n\n    return (\n      <Fluent.ChoiceGroup\n        data-test={m.name}\n        label={m.label}\n        required={m.required}\n        defaultSelectedKey={m.value}\n        options={options}\n        onChange={onChange}\n      />\n    )\n\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { formItemWidth } from './theme'\nimport { wave } from './ui'\n\n/**\n * Create a color picker.\n *\n * A date picker allows a user to pick a color value.\n * If the 'choices' parameter is set, a swatch picker is displayed instead of the standard color picker.\n */\nexport interface ColorPicker {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** The selected color (CSS-compatible string). */\n  value?: S\n  /** A list of colors (CSS-compatible strings) to limit color choices to. */\n  choices?: S[]\n  /** The width of the color picker, e.g. '100px'. Defaults to '300px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** True if the form should be submitted when the color picker value changes. */\n  trigger?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nconst\n  toColorCells = (cs: S[]) => cs.map((c): Fluent.IColorCellProps => ({ id: c, label: c, color: c }))\n\nexport const\n  XColorPicker = ({ model }: { model: ColorPicker }) => {\n    const\n      { width, value, name, trigger, label, choices } = model,\n      defaultValue = value || null,\n      onColorChanged = (_id?: S, color = defaultValue) => {\n        wave.args[name] = color\n\n        if (trigger) wave.push()\n      },\n      onChange = (_e: React.SyntheticEvent<HTMLElement>, { str }: Fluent.IColor) => {\n        wave.args[name] = str || defaultValue\n        if (trigger) wave.push()\n      },\n      normalizedWidth = formItemWidth(width),\n      minMaxWidth = !normalizedWidth?.includes('%') ? `calc(${normalizedWidth} - 35px)` : 'initial'\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[name] = defaultValue }, [])\n\n    return (\n      <div data-test={name}>\n        <Fluent.Label>{label}</Fluent.Label>\n        {\n          choices?.length\n            ? <Fluent.SwatchColorPicker\n              columnCount={10}\n              selectedId={defaultValue || choices[0]}\n              colorCells={toColorCells(choices)}\n              onColorChanged={onColorChanged}\n            />\n            : <Fluent.ColorPicker\n              styles={{ root: { width: normalizedWidth, maxWidth: normalizedWidth }, colorRectangle: { minWidth: minMaxWidth, maxWidth: minMaxWidth } }}\n              color={defaultValue || '#000'}\n              onChange={onChange}\n            />\n        }\n      </div>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { wave } from './ui'\n\n/**\n * Create a combobox.\n *\n * A combobox is a list in which the selected item is always visible, and the others are visible on demand by\n * clicking a drop-down button or by typing in the input.\n * They are used to simplify the design and make a choice within the UI.\n *\n * When closed, only the selected item is visible.\n * When users click the drop-down button, all the options become visible.\n * To change the value, users open the list and click another value or use the arrow keys (up and down)\n * to select a new value.\n * When collapsed the user can select a new value by typing.\n */\nexport interface Combobox {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** A string that provides a brief hint to the user as to what kind of information is expected in the field. */\n  placeholder?: S\n  /** The name of the selected choice. */\n  value?: S\n  /** The choices to be presented. */\n  choices?: S[]\n  /** Text to be displayed as an error below the text box. */\n  error?: S\n  /** True if this field is disabled. */\n  disabled?: B\n  /** The width of the combobox, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\n\nexport const\n  XCombobox = ({ model: m }: { model: Combobox }) => {\n    const\n      [text, setText] = React.useState(m.value),\n      options = (m.choices || []).map((text, i): Fluent.IComboBoxOption => ({ key: `${i}`, text })),\n      onChange = (_e: React.FormEvent<Fluent.IComboBox>, option?: Fluent.IComboBoxOption, _index?: number, value?: string) => {\n        const v = option?.text || value || ''\n        wave.args[m.name] = v\n        setText(v)\n      }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[m.name] = m.value || null }, [])\n\n    return (\n      <Fluent.ComboBox\n        data-test={m.name}\n        label={m.label}\n        placeholder={m.placeholder}\n        options={options}\n        disabled={m.disabled}\n        autoComplete=\"on\"\n        allowFreeform={true}\n        errorMessage={m.error}\n        text={text}\n        onChange={onChange}\n      />\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { cssVar } from './theme'\nimport { wave } from './ui'\n\n/**\n * Create a date picker.\n *\n * A date picker allows a user to pick a date value.\n */\nexport interface DatePicker {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** A string that provides a brief hint to the user as to what kind of information is expected in the field. */\n  placeholder?: S\n  /** The date value in YYYY-MM-DD format. */\n  value?: S\n  /** True if this field is disabled. */\n  disabled?: B\n  /** True if the form should be submitted when the datepicker value changes. */\n  trigger?: B\n  /** The width of the date picker, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nconst\n  pad2 = (n: U) => { const s = `${n}`; return s.length === 1 ? `0${s}` : s },\n  formatDate = (d: Date): S => `${d.getFullYear()}-${pad2(d.getMonth() + 1)}-${pad2(d.getDate())}`,\n  parseDate = (s: S | null): Date | undefined => {\n    if (!s) return undefined\n    const ss = s.split('-')\n    if (ss.length !== 3) return undefined\n    const ymd = ss.map(s => parseInt(s, 10)).filter(n => !isNaN(n))\n    if (ymd.length !== 3) return undefined\n    return new Date(ymd[0], ymd[1] - 1, ymd[2])\n  }\n\nexport const\n  XDatePicker = ({ model: m }: { model: DatePicker }) => {\n    const\n      defaultVal = m.value || null,\n      parsedVal = defaultVal ? parseDate(defaultVal) : null,\n      [value, setValue] = React.useState<Date | undefined>(parsedVal ? new Date(parsedVal) : undefined),\n      onSelectDate = (d: Date | null | undefined) => {\n        const val = (d === null || d === undefined) ? defaultVal : formatDate(d)\n        wave.args[m.name] = val\n        setValue(val ? new Date(val) : undefined)\n        if (m.trigger) wave.push()\n      }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[m.name] = defaultVal }, [])\n\n    return (\n      <Fluent.DatePicker\n        data-test={m.name}\n        styles={{\n          callout: {\n            selectors: {\n              '.ms-DatePicker-day:hover': {\n                background: cssVar('$themeLighterAlt')\n              },\n              '.ms-DatePicker-day--highlighted': {\n                background: `${cssVar('$themeLighterAlt')} !important`\n              }\n            }\n          }\n        }}\n        label={m.label}\n        value={value}\n        placeholder={m.placeholder}\n        disabled={m.disabled}\n        onSelectDate={onSelectDate}\n      />\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { Choice } from './choice_group'\nimport { wave } from './ui'\n\n/**\n * Create a dropdown.\n *\n * A dropdown is a list in which the selected item is always visible, and the others are visible on demand by clicking\n * a drop-down button. They are used to simplify the design and make a choice within the UI. When closed, only the\n * selected item is visible. When users click the drop-down button, all the options become visible.\n *\n * To change the value, users open the list and click another value or use the arrow keys (up and down) to\n * select a new value.\n *\n * Note: Use either the 'value' parameter or the 'values' parameter. Setting the 'values' parameter renders a\n * multi-select dropdown.\n */\nexport interface Dropdown {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** A string that provides a brief hint to the user as to what kind of information is expected in the field. */\n  placeholder?: S\n  /** The name of the selected choice. */\n  value?: S\n  /** The names of the selected choices. If this parameter is set, multiple selections will be allowed. */\n  values?: S[]\n  /** The choices to be presented. */\n  choices?: Choice[]\n  /** True if this is a required field. */\n  required?: B\n  /** True if this field is disabled. */\n  disabled?: B\n  /** True if the form should be submitted when the dropdown value changes. */\n  trigger?: B\n  /** The width of the dropdown, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nexport const\n  XDropdown = ({ model: m }: { model: Dropdown }) => {\n    const\n      isMultivalued = !!m.values,\n      selection = React.useMemo(() => isMultivalued ? new Set<S>(m.values) : null, [isMultivalued, m.values]),\n      [selectedOptions, setSelectedOptions] = React.useState(Array.from(selection || [])),\n      options = (m.choices || []).map(({ name, label, disabled }): Fluent.IDropdownOption => ({ key: name, text: label || name, disabled })),\n      onChange = (_e?: React.FormEvent<HTMLElement>, option?: Fluent.IDropdownOption) => {\n        if (option) {\n          const name = option.key as S\n          if (isMultivalued && selection !== null) {\n            if (option.selected) {\n              selection.add(name)\n            } else {\n              selection.delete(name)\n            }\n            const selectedOpts = Array.from(selection)\n            wave.args[m.name] = selectedOpts\n            setSelectedOptions(selectedOpts)\n          } else {\n            wave.args[m.name] = name\n          }\n        }\n        if (m.trigger) wave.push()\n      },\n      selectAll = () => {\n        if (!selection) return\n\n        selection.clear()\n        options.forEach(o => { if (!o.disabled) selection.add(o.key as S) })\n\n        const selectionArr = Array.from(selection)\n        setSelectedOptions(selectionArr)\n        wave.args[m.name] = selectionArr\n\n        onChange()\n      },\n      deselectAll = () => {\n        if (!selection) return\n\n        selection.clear()\n        setSelectedOptions([])\n        wave.args[m.name] = []\n\n        onChange()\n      }\n\n    React.useEffect(() => {\n      wave.args[m.name] = isMultivalued\n        ? (m.values || [])\n        : (m.value || null)\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n\n    return (\n      <>\n        <Fluent.Dropdown\n          data-test={m.name}\n          label={m.label}\n          placeholder={m.placeholder}\n          options={options}\n          required={m.required}\n          disabled={m.disabled}\n          multiSelect={isMultivalued || undefined}\n          defaultSelectedKey={!isMultivalued ? m.value : undefined}\n          selectedKeys={isMultivalued ? selectedOptions : undefined}\n          onChange={onChange}\n        />\n        {\n          isMultivalued &&\n          <div>\n            <Fluent.Text variant='small'>\n              <Fluent.Link onClick={selectAll}>Select All</Fluent.Link> | <Fluent.Link onClick={deselectAll}>Deselect All</Fluent.Link>\n            </Fluent.Text>\n          </div>\n        }\n      </>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { Component, XComponents } from './form'\nimport { wave } from './ui'\n\n/**\n * Creates a new expander.\n *\n * Expanders can be used to show or hide a group of related components.\n */\nexport interface Expander {\n  /** An identifying name for this component. */\n  name: Id\n  /** The text displayed on the expander. */\n  label?: S\n  /** True if expanded, False if collapsed. */\n  expanded?: B\n  /** List of components to be hideable by the expander. */\n  items?: Component[]\n  /** The width of the expander, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\nconst\n  css = stylesheet({\n    expanderOpen: {\n      $nest: {\n        '>div:last-child': {\n          display: 'block',\n        },\n      },\n    },\n    expanderClosed: {\n      $nest: {\n        '>div:last-child': {\n          display: 'none',\n        },\n      },\n    },\n  })\n\nexport const XExpander = ({ model: m }: { model: Expander }) => {\n  const\n    [isOpen, setIsOpen] = React.useState(m.expanded),\n    onClick = React.useCallback(() => {\n      wave.args[m.name] = !isOpen\n      setIsOpen(!isOpen)\n    }, [isOpen, m.name])\n\n  React.useEffect(() => {\n    if (m.expanded !== undefined) {\n      wave.args[m.name] = !!m.expanded\n      setIsOpen(m.expanded)\n    }\n  }, [m])\n\n  return (\n    <div data-test={m.name} className={isOpen ? css.expanderOpen : css.expanderClosed}>\n      <Fluent.Separator alignContent=\"start\" styles={{ content: { paddingLeft: 0 } }}>\n        <Fluent.ActionButton\n          title={isOpen ? 'Shrink' : 'Expand'}\n          iconProps={{ iconName: isOpen ? 'ChevronDownMed' : 'ChevronRightMed' }}\n          onClick={onClick}\n          styles={{ root: { paddingLeft: 0 }, icon: { marginLeft: 0 } }}>{m.label}</Fluent.ActionButton>\n      </Fluent.Separator>\n      <XComponents items={m.items || []} />\n    </div>\n  )\n}","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, F, Id, S, U, xid } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { centerMixin, clas, dashed, padding } from './theme'\nimport { wave } from './ui'\n\n/**\n * Create a file upload component.\n * A file upload component allows a user to browse, select and upload one or more files.\n */\nexport interface FileUpload {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed in the bottom button. Defaults to \"Upload\". */\n  label?: S\n  /** True if the component should allow multiple files to be uploaded. */\n  multiple?: B\n  /** List of allowed file extensions, e.g. `pdf`, `docx`, etc. */\n  file_extensions?: S[]\n  /** Maximum allowed size (Mb) per file. Defaults to no limit. */\n  max_file_size?: F\n  /** Maximum allowed size (Mb) for all files combined. Defaults to no limit. */\n  max_size?: F\n  /** The height of the file upload, e.g. '400px', '50%', etc. */\n  height?: S\n  /** The width of the file upload, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nconst\n  css = stylesheet({\n    uploadInput: {\n      opacity: 0\n    },\n    upload: {\n      ...centerMixin(),\n      flexDirection: 'column',\n      boxSizing: 'border-box',\n    },\n    uploadDragging: {\n      border: dashed(2, 'var(--text)'),\n    },\n    uploadLabel: {\n      ...centerMixin(),\n      padding: padding(7, 10),\n      fontSize: 14,\n      fontWeight: 600,\n      borderRadius: 2,\n      background: 'var(--text)',\n      color: 'var(--page)',\n      minWidth: 80,\n      $nest: {\n        '&:hover': {\n          cursor: 'pointer'\n        }\n      }\n    },\n    uploadMessageBar: {\n      margin: '20px 0'\n    },\n    uploadRemove: {\n      fontSize: 20,\n      position: 'absolute',\n      top: -15,\n      right: 0,\n      cursor: 'pointer'\n    },\n  })\nconst convertMegabytesToBytes = (bytes: F) => bytes * 1024 * 1024\nexport const\n  XFileUpload = ({ model }: { model: FileUpload }) => {\n    const\n      [isDragging, setIsDragging] = React.useState(false),\n      [files, setFiles] = React.useState<File[]>([]),\n      [percentComplete, setPercentComplete] = React.useState(0.0),\n      [error, setError] = React.useState(''),\n      [successMsg, setSuccessMsg] = React.useState(''),\n      maxFileSizeBytes = model.max_file_size ? convertMegabytesToBytes(model.max_file_size) : 0,\n      maxSizeBytes = model.max_size ? convertMegabytesToBytes(model.max_size) : 0,\n      fileExtensions = model.file_extensions\n        ? model.file_extensions.map(e => e.startsWith('.') ? e : `.${e}`)\n        : null,\n      upload = async () => {\n        const formData = new FormData()\n        files.forEach((f: File) => formData.append('files', f))\n\n        try {\n          const makeRequest = new Promise<XMLHttpRequest>((resolve, reject) => {\n            const xhr = new XMLHttpRequest()\n            xhr.open(\"POST\", \"/_f\")\n            xhr.upload.onprogress = e => setPercentComplete(e.loaded / e.total)\n            xhr.send(formData)\n            xhr.onreadystatechange = () => {\n              if (xhr.readyState !== XMLHttpRequest.DONE) return\n              if (xhr.status >= 200 && xhr.status < 300) resolve(xhr)\n              else reject(xhr)\n            }\n          })\n          const { responseText } = await makeRequest\n          const { files } = JSON.parse(responseText)\n          wave.args[model.name] = files\n          wave.push()\n          setSuccessMsg(`Successfully uploaded files: ${files.map(({ name }: File) => name).join(',')}.`)\n        }\n        catch ({ responseText }) { setError(responseText || 'There was an error when uploading file.') }\n        finally { setFiles([]) }\n      },\n      isFileTypeAllowed = (fileName: string) => {\n        if (!fileExtensions) return true\n        for (const allowedExtension of fileExtensions) {\n          if (fileName.toLowerCase().endsWith(allowedExtension.toLowerCase())) return true\n        }\n        return false\n      },\n      validateFiles = (fileArr: File[]) => {\n        if (!model.multiple && fileArr.length > 1) {\n          return 'Cannot upload multiple files. Input is not set to multiple mode.'\n        }\n\n        const notAllowedFiles = fileArr.filter(({ name }) => !isFileTypeAllowed(name))\n        if (notAllowedFiles.length) {\n          return `Not allowed extension for files: ${notAllowedFiles.map(({ name }) => name).join(', ')}.\n          Allowed file extensions: ${fileExtensions?.join(', ')}.`\n        }\n\n        if (maxFileSizeBytes) {\n          const maxSizePerFileExceededFiles = fileArr.filter(({ size }) => size > maxFileSizeBytes)\n          if (maxSizePerFileExceededFiles.length) {\n            return `Max file size exceeded for files: ${maxSizePerFileExceededFiles.map(({ name }) => name).join(', ')}.\n            Allowed size per file: ${model.max_file_size}Mb.`\n          }\n        }\n\n        if (maxSizeBytes) {\n          const totalSize = fileArr.reduce((total, { size }) => total + size, 0)\n          if (totalSize > maxSizeBytes) {\n            return `Total max file size exceeded. Allowed size: ${model.max_size}Mb.`\n          }\n        }\n      },\n      onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const files = e.target.files\n        if (!files?.length) return\n        const fileArr = Array.from(files)\n\n        const errMsg = validateFiles(fileArr)\n        if (errMsg) {\n          setError(errMsg)\n          return\n        }\n        setFiles(fileArr)\n      },\n      onIsDragging = (e: React.DragEvent<HTMLFormElement>) => {\n        e.preventDefault()\n        e.stopPropagation()\n        setIsDragging(true)\n      },\n      onIsNotDragging = (e: React.DragEvent<HTMLFormElement>) => {\n        e.preventDefault()\n        e.stopPropagation()\n        setIsDragging(false)\n      },\n      onDrop = (e: React.DragEvent<HTMLFormElement>) => {\n        onIsNotDragging(e)\n        const files = e.dataTransfer.files\n        if (!files.length || error || successMsg) return\n        const fileArr = Array.from(files)\n\n        const errMsg = validateFiles(fileArr)\n        if (errMsg) {\n          setError(errMsg)\n          return\n        }\n\n        setFiles(fileArr)\n      },\n      // Workaround - This event prevents onDrop from firing.\n      // https://stackoverflow.com/questions/50230048/react-ondrop-is-not-firing/50230145.\n      onDragOver = (e: React.DragEvent<HTMLFormElement>) => {\n        e.preventDefault()\n        e.stopPropagation()\n      },\n      onDismissError = () => setError(''),\n      onDismissSuccess = () => {\n        setSuccessMsg('')\n        setPercentComplete(0)\n      },\n      removeFile = (index: U) => () => {\n        files.splice(index, 1)\n        setFiles([...files])\n      },\n      getUploadBodyComponent = () => {\n        if (error) return (\n          <>\n            <Fluent.Text variant='xLarge'>An error occured</Fluent.Text>\n            <Fluent.MessageBar\n              className={css.uploadMessageBar}\n              messageBarType={Fluent.MessageBarType.error}\n              isMultiline\n              onDismiss={onDismissError}>\n              {error}\n            </Fluent.MessageBar>\n          </>\n        )\n        else if (successMsg) return (\n          <>\n            <Fluent.Text variant='xLarge'>Upload successful</Fluent.Text>\n            <Fluent.MessageBar\n              className={css.uploadMessageBar}\n              messageBarType={Fluent.MessageBarType.success}\n              isMultiline\n              onDismiss={onDismissSuccess}>\n              {successMsg}\n            </Fluent.MessageBar>\n          </>\n        )\n        else if (isDragging) return (\n          <Fluent.Text styles={{ root: { pointerEvents: 'none' } }}>Drop files anywhere within the box.</Fluent.Text>\n        )\n        else if (percentComplete) return (\n          <Fluent.ProgressIndicator\n            styles={{ root: { width: '80%' } }}\n            data-test='progress' // TODO: Does not work.\n            description={`Uploading: ${(percentComplete * 100).toFixed(2)}%`}\n            percentComplete={percentComplete}\n          />\n        )\n        else if (files.length) return (\n          <>\n            <Fluent.Text variant='xLarge'>{model.multiple ? 'Chosen Files' : 'Chosen File'}</Fluent.Text>\n            <Fluent.Stack\n              horizontal\n              verticalAlign='center'\n              styles={{ root: { maxWidth: '100%', overflowX: 'auto', padding: '30px 0' } }}\n              tokens={{ childrenGap: 15 }}>\n              {\n                files.map(({ name }, i) => (\n                  <Fluent.StackItem key={xid()} styles={{ root: { textAlign: 'center', position: 'relative' } }}>\n                    <Fluent.Icon className={css.uploadRemove} iconName='RemoveFilter' onClick={removeFile(i)} />\n                    <Fluent.Icon iconName='OpenFile' styles={{ root: { fontSize: 35 } }} />\n                    <br />\n                    <Fluent.Text nowrap styles={{ root: { display: 'block', margin: '15px 0' } }}>{name}</Fluent.Text>\n                  </Fluent.StackItem>\n                ))\n              }\n            </Fluent.Stack>\n          </>\n        )\n        else return (\n          <>\n            <Fluent.Icon iconName='CloudUpload' styles={{ root: { fontSize: 50 } }} />\n            <input\n              id='file'\n              data-test={model.name}\n              className={css.uploadInput}\n              onChange={onChange}\n              type='file'\n              accept={fileExtensions?.join(',') || undefined}\n              multiple={model.multiple} />\n            <label htmlFor=\"file\" className={css.uploadLabel}>Browse...</label>\n            <Fluent.Text styles={{ root: { marginTop: 15 } }}>Or drag and drop {model.multiple ? 'files' : 'a file'} here.</Fluent.Text>\n          </>\n        )\n      }\n\n    const uploadClasses = isDragging && !error && !successMsg ? clas(css.upload, css.uploadDragging) : css.upload\n    return (\n      <>\n        <form\n          className={uploadClasses}\n          style={{ height: model.height || 300 }}\n          onDragStart={onIsDragging}\n          onDragEnter={onIsDragging}\n          onDragEnd={onIsNotDragging}\n          onDragLeave={onIsNotDragging}\n          onDrop={onDrop}\n          onDragOver={onDragOver}\n        >\n          {getUploadBodyComponent()}\n        </form>\n        <Fluent.PrimaryButton\n          disabled={!!percentComplete || !files.length}\n          text={model.label || 'Upload'}\n          onClick={upload} />\n      </>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, Model, S, xid } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, grid } from './layout'\nimport { formItemWidth } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n    },\n    body: {\n      flexGrow: 1,\n      position: 'relative',\n      $nest: {\n        'iframe': {\n          // WORKAROUND: Iframe \"height:100%\" implementation differs from Chrome/FF despite container being\n          // correctly expanded via \"flex-grow:1\". Need to position it absolutely instead.\n          position: 'absolute',\n          top: 0, left: 0, right: 0, bottom: 0\n        }\n      }\n    },\n  })\n\n/**\n * Create a new inline frame (an `iframe`).\n */\nexport interface Frame {\n  /** The path or URL of the web page, e.g. `/foo.html` or `http://example.com/foo.html` */\n  path?: S\n  /** The HTML content of the page. A string containing `<html>...</html>`. */\n  content?: S\n  /** The width of the frame, e.g. `200px`, `50%`, etc. Defaults to '100%'. */\n  width?: S\n  /** The height of the frame, e.g. `200px`, `50%`, etc. Defaults to '150px'. */\n  height?: S\n  /** An identifying name for this component. */\n  name?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\n/**\n * Render a card containing a HTML page inside an inline frame (an `iframe`).\n *\n * Either a path or content can be provided as arguments.\n * :icon \"PageAdd\"\n */\ninterface State {\n  /**\n   * The title for this card.\n   * :t \"textbox\"\n   * :value \"Untitled Frame\"\n   **/\n  title: S\n  /**\n   * The path or URL of the web page, e.g. `/foo.html` or `http://example.com/foo.html`.\n   * :t \"textbox\"\n   * :value \"\"\n   **/\n  path?: S\n  /**\n   * The HTML content of the page. A string containing `<html>...</html>`.\n   * :t \"textarea\"\n   * :value \"\"\n   */\n  content?: S\n}\n\nconst\n  // replace ' src=\"/' -> ' src=\"http://foo.bar.baz:8080/'\n  fixrefs = (s: S): S => s.replace(/(\\s+src\\s*=\\s*[\"'])\\//g, `$1${window.location.protocol}//${window.location.host}/`),\n  inline = (s: S): S => URL.createObjectURL(new Blob([fixrefs(s)], { type: 'text/html' })),\n  InlineFrame = ({ path, content }: { path?: S, content?: S }) => (\n    <iframe title={xid()} src={path ? path : content ? inline(content) : inline('Nothing to render.')} frameBorder=\"0\" width=\"100%\" height=\"100%\" />\n  )\n\n// HACK: Applying width/height styles directly on iframe don't work in Chrome/FF; so wrap in div instead.\nexport const XFrame = ({ model: { name, path, content, width = '100%', height = '150px' } }: { model: Frame }) => (\n  <div data-test={name} style={{ width: formItemWidth(width), height }}>\n    <InlineFrame path={path} content={content} />\n  </div>\n)\n\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const render = () => (\n      <div data-test={name} className={css.card}>\n        <div className='wave-s12 wave-w6'>{state.title}</div>\n        <div className={css.body}>\n          <InlineFrame path={state.path} content={state.content} />\n        </div>\n      </div>\n    )\n    return { render, changed }\n  })\n\ncards.register('frame', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, Model, Rec, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format, grid } from './layout'\nimport { formItemWidth } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n    },\n    img: {\n      flexGrow: 1,\n      objectFit: 'contain',\n      maxHeight: 'calc(100% - 20px)'\n    }\n  })\n\n/** Create a card that displays a base64-encoded image. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The image MIME subtype. One of `apng`, `bmp`, `gif`, `x-icon`, `jpeg`, `png`, `webp`. */\n  type?: S\n  /** Image data, base64-encoded. */\n  image?: S\n  /** Data for this card. */\n  data?: Rec\n  /** The path or URL or data URL of the image, e.g. `/foo.png` or `http://example.com/foo.png` or `data:image/png;base64,???`. */\n  path?: S\n}\n\n\n/** Create an image. */\nexport interface Image {\n  /** The image title, typically displayed as a tooltip. */\n  title: S\n  /** The image MIME subtype. One of `apng`, `bmp`, `gif`, `x-icon`, `jpeg`, `png`, `webp`. Required only if `image` is set. */\n  type?: S\n  /** Image data, base64-encoded. */\n  image?: S\n  /** The path or URL or data URL of the image, e.g. `/foo.png` or `http://example.com/foo.png` or `data:image/png;base64,???`. */\n  path?: S\n  /** The width of the image, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\nexport const\n  XImage = ({ model: { title, type, image, path, width } }: { model: Image }) => {\n    const\n      src = path\n        ? path\n        : (image && type)\n          ? `data:image/${type};base64,${image}`\n          : ''\n    return <img className={css.img} alt={title} src={src} width={formItemWidth(width)} />\n  },\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const render = () => {\n      const { title, type, image, data, path } = state\n      return (\n        <div data-test={name} className={css.card}>\n          <Format data={data} format={title} className='wave-s12 wave-w6' />\n          <XImage model={{ title, type, image, path }} />\n        </div >\n      )\n    }\n    return { render, changed }\n  })\n\ncards.register('image', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, S } from 'h2o-wave'\nimport React from 'react'\n\n/**\n * Create a label.\n *\n * Labels give a name or title to a component or group of components.\n * Labels should be in close proximity to the component or group they are paired with.\n * Some components, such as textboxes, dropdowns, or toggles, already have labels\n * incorporated, but other components may optionally add a Label if it helps inform\n * the user of the components purpose.\n*/\nexport interface Label {\n  /**  The text displayed on the label.*/\n  label: S\n  /** True if the field is required. */\n  required?: B\n  /** True if the label should be disabled. */\n  disabled?: B\n  /** The width of the label , e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n  /** An identifying name for this component. */\n  name?: S\n}\n\nexport const\n  XLabel = ({ model }: { model: Label }) => {\n    const { label, required = false, disabled = false, name } = model\n    return <Fluent.Label data-test={name} required={required} disabled={disabled} >{label}</Fluent.Label>\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, S } from 'h2o-wave'\nimport React from 'react'\n\n/**\n * Create a hyperlink.\n *\n * Hyperlinks can be internal or external.\n * Internal hyperlinks have paths that begin with a `/` and point to URLs within the Wave UI.\n * All other kinds of paths are treated as external hyperlinks.\n */\nexport interface Link {\n  /** The text to be displayed. If blank, the `path` is used as the label. */\n  label?: S\n  /** The path or URL to link to. */\n  path?: S\n  /** True if the link should be disabled. */\n  disabled?: B\n  /** True if the link should prompt the user to save the linked URL instead of navigating to it. Works only if `button` is false. */\n  download?: B\n  /** True if the link should be rendered as a button. */\n  button?: B\n  /** The width of the link, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** Where to display the link. Setting this to an empty string or `'_blank'` opens the link in a new tab or window. */\n  target?: S\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n  /** An identifying name for this component. */\n  name?: S\n}\n\nexport const\n  XLink = ({ model: { name, label, disabled, path, download, target, button } }: { model: Link }) => {\n    const\n      _label = label || path,\n      _target = target === '' ? '_blank' : target,\n      onBtnClick = React.useCallback(() => window.open(path, _target), [_target, path]),\n      onLinkClick = React.useCallback((ev: React.MouseEvent<HTMLAnchorElement>) => {\n        // HACK: Perform download in a new tab because FF drops WS connection - https://bugzilla.mozilla.org/show_bug.cgi?id=858538.\n        if (download && path) {\n          ev.preventDefault()\n          window.open(path, '_blank')\n        }\n      }, [download, path])\n\n    return button\n      ? <Fluent.DefaultButton data-test={name} text={_label} disabled={disabled} onClick={onBtnClick} />\n      : <Fluent.Link onClick={onLinkClick} data-test={name} href={path} disabled={disabled} target={_target}>{_label}</Fluent.Link>\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, grid } from './layout'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n    },\n    body: {\n      flexGrow: 1,\n    },\n  })\n\n/** Render HTML content. */\nexport interface Markup {\n  /** The HTML content. */\n  content: S\n  /** An identifying name for this component. */\n  name?: S\n  /** The width of the markup, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\n/**\n * Render HTML content.\n * :icon \"FileHTML\"\n **/\ninterface State {\n  /**\n   * The title for this card.\n   * :t \"textbox\"\n   * :value \"Untitled Content\"\n   **/\n  title: S\n  /**\n   * The HTML content.\n   * :t \"textarea\"\n   * :value \"<div/>\"\n   **/\n  content: S\n}\n\nexport const\n  XMarkup = ({ model: { content, name } }: { model: Markup }) => (\n    <div data-test={name} dangerouslySetInnerHTML={{ __html: content }} />\n  ),\n  MarkupCard = ({ name, title, content }: { name: S, title: S, content: S }) => (\n    <div data-test={name} className={css.card}>\n      {title && <div className='wave-s12 wave-w6'>{title}</div>}\n      <div className={css.body}>\n        <XMarkup model={{ content }} />\n      </div>\n    </div>\n  ),\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const render = () => <MarkupCard name={name} title={state.title} content={state.content} />\n    return { render, changed }\n  })\n\ncards.register('markup', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { Markdown } from './markdown'\n\n/**\n * Create a message bar.\n *\n * A message bar is an area at the top of a primary view that displays relevant status information.\n * You can use a message bar to tell the user about a situation that does not require their immediate attention and\n * therefore does not need to block other activities.\n */\nexport interface MessageBar {\n  /** The icon and color of the message bar. */\n  type?: 'info' | 'error' | 'warning' | 'success' | 'danger' | 'blocked'\n  /** The text displayed on the message bar. */\n  text?: S\n  /** An identifying name for this component. */\n  name?: S\n  /** The width of the message bar, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\nconst\n  css = stylesheet({\n    messageBar: {\n      $nest: {\n        // Adjust spacing to align with Fluent Messagebar icon.\n        '.wave-markdown > *:first-child': { marginTop: 0 },\n        '.wave-markdown > *:only-child': { marginBottom: 0 },\n      }\n    }\n  }),\n  toMessageBarType = (t?: S): Fluent.MessageBarType => {\n    switch (t) {\n      case 'error': return Fluent.MessageBarType.error\n      case 'warning': return Fluent.MessageBarType.warning\n      case 'success': return Fluent.MessageBarType.success\n      case 'danger': return Fluent.MessageBarType.severeWarning\n      case 'blocked': return Fluent.MessageBarType.blocked\n      default: return Fluent.MessageBarType.info\n    }\n  }\n\nexport const\n  XMessageBar = ({ model: m }: { model: MessageBar }) => (\n    m.text?.length\n      ? (\n        <Fluent.MessageBar data-test={m.name} messageBarType={toMessageBarType(m.type)} className={css.messageBar}>\n          <Markdown source={m.text} />\n        </Fluent.MessageBar>\n      )\n      : <div />\n  )","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Chart, registerInteraction } from '@antv/g2'\nimport { AdjustOption, AnnotationPosition, ArcOption, AxisOption, ChartCfg, CoordinateActions, CoordinateOption, DataMarkerOption, DataRegionOption, GeometryOption, LineOption, RegionOption, ScaleOption, TextOption } from '@antv/g2/lib/interface'\nimport { B, Dict, F, Model, parseI, parseU, Rec, S, unpack, V } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { Fmt, parseFormat } from './intl'\nimport { cards, grid } from './layout'\nimport { cssVarValue, formItemWidth } from './theme'\nimport { bond, wave } from './ui'\n\nlet\n  cat10 = [\n    '$gray',\n    '$blue',\n    '$green',\n    '$amber',\n    '$tangerine',\n    '$purple',\n    '$cyan',\n    '$mint',\n    '$pink',\n    '$brown',\n  ]\n\n\ntype AnnotationOption = ArcOption | LineOption | TextOption | RegionOption | DataMarkerOption | DataRegionOption\n\nenum SpaceT { CC, DD, TT, CD, DC, TC, CT, TD, DT }\n\n/**\n * Create a specification for a layer of graphical marks such as bars, lines, points for a plot.\n * A plot can contain multiple such layers of marks.\n*/\ninterface Mark {\n  /** Coordinate system. `rect` is synonymous to `cartesian`. `theta` is transposed `polar`. */\n  coord?: 'rect' | 'cartesian' | 'polar' | 'theta' | 'helix';\n  /** Graphical geometry. */\n  type?: 'interval' | 'line' | 'path' | 'point' | 'area' | 'polygon' | 'schema' | 'edge' | 'heatmap';\n  /** X field or value. */\n  x?: V;\n  /** X base field or value. */\n  x0?: V;\n  /** X bin lower bound field or value. For histograms. */\n  x1?: V;\n  /** X bin upper bound field or value. For histograms. */\n  x2?: V;\n  /** X axis scale minimum. */\n  x_min?: F;\n  /** X axis scale maximum. */\n  x_max?: F;\n  /** Whether to nice X axis scale ticks. */\n  x_nice?: B;\n  /** X axis scale type. */\n  x_scale?: 'linear' | 'cat' | 'category' | 'identity' | 'log' | 'pow' | 'power' | 'time' | 'time-category' | 'quantize' | 'quantile';\n  /** X axis title. */\n  x_title?: S;\n  /** Y field or value. */\n  y?: V;\n  /** Y base field or value. */\n  y0?: V;\n  /** Y bin lower bound field or value. For histograms. */\n  y1?: V;\n  /** Y bin upper bound field or value. For histograms. */\n  y2?: V;\n  /** Y axis scale minimum. */\n  y_min?: F;\n  /** Y axis scale maximum. */\n  y_max?: F;\n  /** Whether to nice Y axis scale ticks. */\n  y_nice?: B;\n  /** Y axis scale type. */\n  y_scale?: 'linear' | 'cat' | 'category' | 'identity' | 'log' | 'pow' | 'power' | 'time' | 'time-category' | 'quantize' | 'quantile';\n  /** Y axis title. */\n  y_title?: S;\n  /** Mark color field or value. */\n  color?: S;\n  /** Mark color range for multi-series plots. A string containing space-separated colors, e.g. `'#fee8c8 #fdbb84 #e34a33'` */\n  color_range?: S;\n  /** The unique values in the data (labels or categories or classes) to map colors to, e.g. `['high', 'medium', 'low']`. If this is not provided, the unique values are automatically inferred from the `color` attribute. */\n  color_domain?: S[];\n  /** Mark shape field or value for `point` mark types. Possible values are 'circle', 'square', 'bowtie', 'diamond', 'hexagon', 'triangle', 'triangle-down', 'cross', 'tick', 'plus', 'hyphen', 'line'. */\n  shape?: S;\n  /** Mark shape range for multi-series plots using `point` mark types. A string containing space-separated shapes, e.g. `'circle square diamond'` */\n  shape_range?: S;\n  /** Mark size field or value. */\n  size?: V;\n  /** Mark size range. A string containing space-separated integers, e.g. `'4 30'` */\n  size_range?: S;\n  /** Field to stack marks by, or 'auto' to infer. */\n  stack?: S;\n  /** Field to dodge marks by, or 'auto' to infer. */\n  dodge?: S;\n  /** Curve type for `line` and `area` mark types. */\n  curve?: 'none' | 'smooth' | 'step-before' | 'step' | 'step-after';\n  /** Mark fill color. */\n  fill_color?: S;\n  /** Mark fill opacity. */\n  fill_opacity?: F;\n  /** Mark stroke color. */\n  stroke_color?: S;\n  /** Mark stroke opacity. */\n  stroke_opacity?: F;\n  /** Mark stroke size. */\n  stroke_size?: F;\n  /** Mark stroke dash style. A string containing space-separated integers that specify distances to alternately draw a line and a gap (in coordinate space units). If the number of elements in the array is odd, the elements of the array get copied and concatenated. For example, [5, 15, 25] will become [5, 15, 25, 5, 15, 25]. */\n  stroke_dash?: S;\n  /** Label field or value. */\n  label?: S;\n  /** Distance between label and mark. */\n  label_offset?: F;\n  /** Horizontal distance between label and mark. */\n  label_offset_x?: F;\n  /** Vertical distance between label and mark. */\n  label_offset_y?: F;\n  /** Label rotation angle, in degrees, or 'none' to disable automatic rotation. The default behavior is 'auto' for automatic rotation. */\n  label_rotation?: S;\n  /** Label position relative to the mark. */\n  label_position?: 'top' | 'bottom' | 'middle' | 'left' | 'right';\n  /** Strategy to use if labels overlap. */\n  label_overlap?: 'hide' | 'overlap' | 'constrain';\n  /** Label fill color. */\n  label_fill_color?: S;\n  /** Label fill opacity. */\n  label_fill_opacity?: F;\n  /** Label stroke color. */\n  label_stroke_color?: S;\n  /** Label stroke opacity. */\n  label_stroke_opacity?: F;\n  /** Label stroke size (line width or pen thickness). */\n  label_stroke_size?: F;\n  /** Label font size. */\n  label_font_size?: F;\n  /** Label font weight. */\n  label_font_weight?: S;\n  /** Label line height. */\n  label_line_height?: F;\n  /** Label text alignment. */\n  label_align?: 'left' | 'right' | 'center' | 'start' | 'end';\n  /** Reference line stroke color. */\n  ref_stroke_color?: S;\n  /** Reference line stroke opacity. */\n  ref_stroke_opacity?: F;\n  /** Reference line stroke size (line width or pen thickness). */\n  ref_stroke_size?: F;\n  /** Reference line stroke dash style. A string containing space-separated integers that specify distances to alternately draw a line and a gap (in coordinate space units). If the number of elements in the array is odd, the elements of the array get copied and concatenated. For example, [5, 15, 25] will become [5, 15, 25, 5, 15, 25]. */\n  ref_stroke_dash?: S;\n}\n\n/** Extended mark attributes. Not exposed to API. */\ninterface MarkExt extends Mark {\n  /** Field. */\n  x_field?: S;\n  /** Format string. */\n  x_format?: Fmt;\n  /** Field. */\n  x0_field?: S;\n  /** Format string. */\n  x0_format?: Fmt;\n  /** Field. */\n  x1_field?: S;\n  /** Format string. */\n  x1_format?: Fmt;\n  /** Field. */\n  x2_field?: S;\n  /** Format string. */\n  x2_format?: Fmt;\n  /** Field. */\n  y_field?: S;\n  /** Format string. */\n  y_format?: Fmt;\n  /** Field. */\n  y0_field?: S;\n  /** Format string. */\n  y0_format?: Fmt;\n  /** Field. */\n  y1_field?: S;\n  /** Format string. */\n  y1_format?: Fmt;\n  /** Field. */\n  y2_field?: S;\n  /** Format string. */\n  y2_format?: Fmt;\n  /** Field. */\n  color_field?: S;\n  /** Format string. */\n  color_format?: Fmt;\n  /** Field. */\n  shape_field?: S;\n  /** Format string. */\n  shape_format?: Fmt;\n  /** Format string. */\n  size_format?: Fmt;\n  /** Field. */\n  size_field?: S;\n  /** Field. */\n  dodge_field?: S;\n  /** Field. */\n  label_field?: S;\n  /** Format string. */\n  label_format?: Fmt;\n}\n\n/** Create a plot. A plot is composed of one or more graphical mark layers. */\nexport interface Plot {\n  /** The graphical mark layers contained in this plot. */\n  marks: Mark[];\n}\n\nregisterInteraction('drag-move', {\n  start: [{ trigger: 'plot:mousedown', action: 'scale-translate:start' }],\n  processing: [{ trigger: 'plot:mousemove', action: 'scale-translate:translate', throttle: { wait: 100, leading: true, trailing: false } }],\n  end: [{ trigger: 'plot:mouseup', action: 'scale-translate:end' }],\n})\n\n// TODO not in use\nexport const\n  spaceTypeOf = (ds: any[], marks: Mark[]): SpaceT => spaceTypes[scaleTypeOf(ds, marks, 'x') + scaleTypeOf(ds, marks, 'y')],\n  crosshairFor = (t: SpaceT): 'x' | 'y' | 'xy' => {\n    switch (t) {\n      case SpaceT.CC:\n      case SpaceT.DD:\n      case SpaceT.TT:\n        return 'xy'\n      case SpaceT.DC:\n      case SpaceT.TC:\n      case SpaceT.TD:\n        return 'x'\n      case SpaceT.CD:\n      case SpaceT.CT:\n      case SpaceT.DT:\n        return 'y'\n    }\n  }\n\nconst\n  isF = (x: any): x is number => typeof x === 'number',\n  isB = (x: any): x is boolean => typeof x === 'boolean',\n  isS = (x: any): x is string => typeof x === 'string',\n  split = (s: S) => s.trim().split(/\\s+/g),\n  parseInts = (s: S) => split(s).map(s => parseInt(s, 10)),\n  convertToDates = (ds: any[], f: S) => {\n    for (const d of ds) {\n      if (d) {\n        const s = d[f]\n        if (s && isS(s)) d[f] = new Date(s) // must be ISO string\n      }\n    }\n  },\n  convertToPairs = (ds: any[], f0: S, f1: S, f: S) => {\n    for (const d of ds) if (d) d[f] = [d[f0], d[f1]]\n  },\n  xyVariants = ' 0 1 2'.split(' '),\n  xyExtra = split('min max nice scale title'),\n  makeXYProps = (p: S) => xyVariants.map(s => p + s),\n  makeXYExtraProps = (p: S) => xyExtra.map(s => `${p}_${s}`),\n  makeFormattables = (xs: S[]) => xs.map(f => ([f, f + '_field', f + '_format'])),\n  xProps = makeFormattables(makeXYProps('x')),\n  yProps = makeFormattables(makeXYProps('y')),\n  xExtraProps = makeXYExtraProps('x'),\n  yExtraProps = makeXYExtraProps('y'),\n  otherProps = makeFormattables(split('color shape size dodge label')),\n  formattables = [...xProps, ...yProps, ...otherProps],\n  scaleTypeOf = (ds: any[], marks: Mark[], attr: S): 'c' | 'd' | 't' => {\n    const f = attr + '_field', s = attr + '_scale'\n    for (const mark of marks) {\n      const m = mark as any, field = m[f], scale = m[s]\n      if (scale === 'time') return 't'\n      if (isS(field)) {\n        for (const d of ds) {\n          const v = d[field]\n          if (isF(v)) return 'c'\n          if (isS(v)) return 'd'\n        }\n      }\n    }\n    return 'c'\n  },\n  spaceTypes: Dict<SpaceT> = {\n    cc: SpaceT.CC, dd: SpaceT.DD, tt: SpaceT.TT,\n    dc: SpaceT.DC, cd: SpaceT.CD,\n    tc: SpaceT.TC, ct: SpaceT.CT,\n    td: SpaceT.TD, dt: SpaceT.DT,\n  },\n  dummyDatum: any = {},\n  makeFormatFunc = (field: S, render: HandlebarsTemplateDelegate<any>) => (datum: any, value?: any) => {\n    const x = datum ? datum[field] : value\n    if (x != null) {\n      dummyDatum[field] = x\n      return render(dummyDatum)\n    }\n    return ''\n  },\n  transposeMark = (mark: Mark) => { // WARNING: Can modify marks in-place!\n    const m: any = mark\n    for (let k = 0; k < xProps.length; k++) {\n      const x = xProps[k], y = yProps[k]\n      for (let i = 0; i < x.length; i++) {\n        const tmp = m[x[i]]\n        m[x[i]] = m[y[i]]\n        m[y[i]] = tmp\n      }\n    }\n    for (let i = 0; i < xExtraProps.length; i++) {\n      const x = xExtraProps[i], y = yExtraProps[i]\n      const tmp = m[x]\n      m[x] = m[y]\n      m[y] = tmp\n    }\n  },\n  refactorMark = (mark: Mark): MarkExt => {\n    // if any fields are passed in as format expressions, separate them out into _field and _format\n    const m = mark as any\n    for (const [plainAttr, fieldAttr, formatAttr] of formattables) {\n      const expr = m[plainAttr]\n      if (isS(expr)) {\n        const fmts = parseFormat(expr)\n        if (fmts) {\n          const [field, fmt] = fmts\n          m[plainAttr] = undefined\n          m[fieldAttr] = field\n          if (fmt) m[formatAttr] = makeFormatFunc(field, fmt)\n        }\n      }\n    }\n    return mark\n  },\n  refactorData = (ds: any[], marks: MarkExt[]): any[] => {\n    for (const m of marks) {\n      if (m.x_scale === 'time') {\n        for (const { x_field, x0_field } of marks) {\n          if (isS(x_field)) convertToDates(ds, x_field)\n          if (isS(x0_field)) convertToDates(ds, x0_field)\n        }\n        if (isS(m.x)) m.x = new Date(m.x)\n        if (isS(m.x0)) m.x0 = new Date(m.x0)\n        break\n      }\n    }\n    for (const m of marks) {\n      if (m.y_scale === 'time') {\n        for (const { y_field, y0_field } of marks) {\n          if (isS(y_field)) convertToDates(ds, y_field)\n          if (isS(y0_field)) convertToDates(ds, y0_field)\n        }\n        if (isS(m.y)) m.y = new Date(m.y)\n        if (isS(m.y0)) m.y0 = new Date(m.y0)\n        break\n      }\n    }\n    for (const { x_field, x0_field } of marks) {\n      if (isS(x_field) && isS(x0_field)) {\n        convertToPairs(ds, x0_field, x_field, x_field)\n      }\n    }\n    for (const { y_field, y0_field } of marks) {\n      if (isS(y_field) && isS(y0_field)) {\n        convertToPairs(ds, y0_field, y_field, y_field)\n      }\n    }\n    for (const mark of marks) {\n      const { type, x1_field, x2_field, y_field } = mark\n      if (type === 'interval' && isS(x1_field) && isS(x2_field) && isS(y_field)) { // histogram on x\n        mark.x_field = x1_field + ' - ' + x2_field\n        convertToPairs(ds, x1_field, x2_field, mark.x_field)\n      }\n    }\n    for (const mark of marks) {\n      const { type, y1_field, y2_field, x_field } = mark\n      if (type === 'interval' && isS(y1_field) && isS(y2_field) && isS(x_field)) { // histogram on y\n        mark.y_field = y1_field + ' - ' + y2_field\n        convertToPairs(ds, y1_field, y2_field, mark.y_field)\n      }\n    }\n    return ds\n  },\n  makeNote = ({\n    x, x0, y, y0, label,\n    fill_color, fill_opacity, stroke_color, stroke_opacity, stroke_size, stroke_dash,\n    ref_stroke_color, ref_stroke_opacity, ref_stroke_dash, ref_stroke_size,\n    label_fill_color, label_fill_opacity, label_stroke_color, label_stroke_opacity, label_stroke_size,\n    label_font_size, label_font_weight, label_line_height, label_align,\n  }: Mark): AnnotationOption[] => {\n\n    // XXX pass 'start'/'end' if axis is categorical\n\n    const\n      labelStyle = makeTextStyle(\n        label_fill_color, label_fill_opacity, label_stroke_color, label_stroke_opacity, label_stroke_size,\n        label_font_size, label_font_weight, label_line_height, label_align,\n      ),\n      shapeStyle = makeShapeStyle(fill_color, fill_opacity, stroke_color, stroke_opacity, stroke_size, stroke_dash),\n      lineStyle = makeShapeStyle(undefined, undefined, ref_stroke_color, ref_stroke_opacity, ref_stroke_size, ref_stroke_dash)\n\n    if (x != null && y != null) {\n      if (x0 != null && y0 != null) {\n        const region: DataRegionOption = {\n          type: 'region',\n          start: [x0, y0] as AnnotationPosition,\n          end: [x, y] as AnnotationPosition,\n          text: isS(label) ? { content: label, style: labelStyle } : undefined,\n          style: shapeStyle,\n        }\n        return [region]\n      } else {\n        const marker: DataMarkerOption = {\n          type: 'dataMarker',\n          position: [x, y] as AnnotationPosition,\n          text: isS(label) ? { content: label, style: labelStyle } : null,\n          point: { style: shapeStyle },\n          line: { style: lineStyle }\n        }\n        return [marker]\n      }\n    } else if (x != null) {\n      if (x0 != null) {\n        const region: DataRegionOption = {\n          type: 'region',\n          start: [x0, 'min'] as AnnotationPosition,\n          end: [x, 'max'] as AnnotationPosition,\n          text: isS(label) ? { content: label, style: labelStyle } : null,\n          style: shapeStyle,\n        }\n        return [region]\n      } else {\n        const line: LineOption = {\n          type: 'line',\n          start: [x, 'min'] as AnnotationPosition,\n          end: [x, 'max'] as AnnotationPosition,\n          text: isS(label) ? { content: label, style: labelStyle, position: 'start' } : undefined,\n          style: lineStyle,\n        }\n        return [line]\n      }\n    } else { // y != null\n      if (y0 != null) {\n        const region: DataRegionOption = {\n          type: 'region',\n          start: ['min', y0] as AnnotationPosition,\n          end: ['max', y] as AnnotationPosition,\n          text: isS(label) ? { content: label, style: labelStyle } : null,\n          style: shapeStyle,\n        }\n        return [region]\n\n      } else {\n        const line: LineOption = {\n          type: 'line',\n          start: ['min', y] as AnnotationPosition,\n          end: ['max', y] as AnnotationPosition,\n          text: isS(label) ? { content: label, style: labelStyle, position: 'start' } : undefined,\n          style: lineStyle,\n        }\n        return [line]\n      }\n    }\n  },\n  makeGeom = ({\n    type, x_field, y_field,\n    color_field, color_range, color_domain, color,\n    shape_field, shape_range, shape,\n    size_field, size_range, size,\n    stack,\n    dodge, dodge_field,\n    curve,\n    fill_color, fill_opacity, stroke_color, stroke_opacity, stroke_dash, stroke_size,\n    label_field, label_format, label_offset, label_offset_x, label_offset_y, label_rotation, label_position, label_overlap,\n    label_fill_color, label_fill_opacity, label_stroke_color, label_stroke_opacity, label_stroke_size,\n    label_font_size, label_font_weight, label_line_height, label_align,\n  }: MarkExt): GeometryOption => {\n    const o: GeometryOption = {}\n    if (isS(type)) o.type = type\n\n    const adjust: AdjustOption[] = []\n    // TODO set marginRatio=1 polar coords\n    if (isS(dodge_field)) {\n      adjust.push({ type: 'dodge', marginRatio: 0, dodgeBy: dodge_field })\n    } else if (dodge === 'auto') {\n      adjust.push({ type: 'dodge', marginRatio: 0 })\n    }\n    if (stack === 'auto') adjust.push({ type: 'stack' })\n    if (adjust.length) o.adjust = adjust\n    if (isS(x_field) && isS(y_field)) o.position = { fields: [x_field, y_field] }\n    if (isS(color_field)) {\n      const colors = isS(color_range) ? split(color_range).map(cssVarValue) : cat10\n      o.color = { fields: [color_field], values: colors }\n      if (color_domain && color_domain.length == colors.length) {\n        const domain_colors = color_domain.reduce((acc, value, i) => {\n          acc[value] = colors[i]\n          return acc\n        }, {} as Dict<S>)\n        o.color.callback = (x: S) => domain_colors[x]\n      }\n    } else {\n      o.color = isS(color) ? cssVarValue(color) : getComputedStyle(document.documentElement).getPropertyValue('--gray').trim()\n    }\n    if (isS(shape_field)) {\n      if (isS(shape_range)) {\n        o.shape = { fields: [shape_field], values: split(shape_range) }\n      } else {\n        o.shape = { fields: [shape_field] }\n      }\n    } else if (isS(shape)) {\n      o.shape = shape\n    }\n    if (isS(size_field)) {\n      if (isS(size_range)) {\n        o.size = { fields: [size_field], values: parseInts(size_range) }\n      } else {\n        o.size = { fields: [size_field] }\n      }\n    } else if (isF(size)) {\n      o.size = size\n    }\n    if (isS(label_field)) {\n      const styles = makeTextStyle(\n        label_fill_color, label_fill_opacity, label_stroke_color, label_stroke_opacity, label_stroke_size,\n        label_font_size, label_font_weight, label_line_height, label_align,\n      )\n      const c: Dict<any> = {}\n      if (styles) c.style = styles\n      switch (label_overlap) {\n        case 'hide': c.layout = { type: 'overlap' }; break\n        case 'overlap': c.layout = { type: 'fixedOverlap' }; break\n        case 'constrain': c.layout = { type: 'limitInShape' }; break\n      }\n      if (isF(label_offset)) c.offset = label_offset\n      if (isF(label_offset_x)) c.offsetX = label_offset_x\n      if (isF(label_offset_y)) c.offsetY = label_offset_y\n      if (isS(label_rotation)) {\n        const i_label_rotation = parseI(label_rotation)\n        if (isNaN(i_label_rotation)) {\n          c.autoRotate = label_rotation === 'none' ? false : true\n        } else {\n          c.rotate = i_label_rotation * Math.PI / 180\n        }\n      }\n      switch (label_position) {\n        case 'top': case 'bottom': case 'middle': case 'left': case 'right': c.position = label_position as any\n      }\n\n      if (label_format) {\n        o.label = {\n          fields: [label_field],\n          callback: (label) => ({ content: label_format(null, label) })\n        }\n      } else {\n        o.label = { fields: [label_field] }\n      }\n\n      if (Object.keys(c).length) o.label.cfg = c\n    }\n    if (isS(curve)) {\n      switch (curve) {\n        case 'smooth': o.shape = 'smooth'; break\n        case 'step-before': o.shape = 'vh'; break\n        case 'step': o.shape = 'hvh'; break\n        case 'step-after': o.shape = 'hv'; break\n      }\n    }\n    const style = makeShapeStyle(fill_color, fill_opacity, stroke_color, stroke_opacity, stroke_size, stroke_dash)\n    if (style) o.style = style\n\n    return o\n  },\n  makeShapeStyle = (fill_color?: S, fill_opacity?: F, stroke_color?: S, stroke_opacity?: F, stroke_size?: F, stroke_dash?: S): Dict<any> | undefined => {\n    const s: Dict<any> = {}\n    if (isS(fill_color)) s.fill = cssVarValue(fill_color)\n    if (isF(fill_opacity)) s.fillOpacity = fill_opacity\n    if (isS(stroke_color)) s.stroke = cssVarValue(stroke_color)\n    if (isF(stroke_opacity)) s.strokeOpacity = stroke_opacity\n    if (isF(stroke_size)) s.lineWidth = stroke_size\n    if (isS(stroke_dash)) s.lineDash = parseInts(stroke_dash)\n    return Object.keys(s).length ? s : undefined\n  },\n  makeTextStyle = (fill_color?: S, fill_opacity?: F, stroke_color?: S, stroke_opacity?: F, stroke_size?: F, font_size?: F, font_weight?: S, line_height?: F, align?: S): Dict<any> | undefined => {\n    const s: Dict<any> = {}\n    if (isS(fill_color)) s.fill = cssVarValue(fill_color)\n    if (isF(fill_opacity)) s.fillOpacity = fill_opacity\n    if (isS(stroke_color)) s.stroke = cssVarValue(stroke_color)\n    if (isF(stroke_opacity)) s.strokeOpacity = stroke_opacity\n    if (isF(stroke_size)) s.lineWidth = stroke_size\n    if (isF(font_size)) s.fontSize = font_size\n    if (isS(font_weight)) {\n      const u_font_weight = parseU(font_weight)\n      s.fontWeight = isNaN(u_font_weight) ? font_weight : u_font_weight\n    }\n    if (isF(line_height)) s.lineHeight = line_height\n    if (isS(align)) s.textAlign = align\n    return Object.keys(s).length ? s : undefined\n  },\n  makeScales = (marks: MarkExt[]): [Record<S, ScaleOption>, Record<S, AxisOption>] => {\n    const\n      scales: Record<S, ScaleOption> = {},\n      axes: Record<S, AxisOption> = {}\n\n    for (const m of marks) {\n      if (m.x_field) {\n        const [x_scale, x_axis] = makeScale(m.x_scale, m.x_format, m.x_title, m.x_min, m.x_max, m.x_nice)\n        scales[m.x_field] = x_scale\n        if (x_axis) axes[m.x_field] = x_axis\n        break\n      }\n    }\n\n    for (const m of marks) {\n      if (m.y_field) {\n        const [y_scale, y_axis] = makeScale(m.y_scale, m.y_format, m.y_title, m.y_min, m.y_max, m.y_nice)\n        scales[m.y_field] = y_scale\n        if (y_axis) axes[m.y_field] = y_axis\n        break\n      }\n    }\n\n    return [scales, axes]\n  },\n  fixScaleType = (t: S): S => {\n    switch (t) {\n      case 'time-category': return 'timeCat'\n      case 'power': return 'pow'\n    }\n    return t\n  },\n  makeScale = (typ: S | undefined, format: Fmt | undefined, title: S | undefined, min: S | F | undefined, max: S | F | undefined, nice: B | undefined): [ScaleOption, AxisOption | null] => {\n    const\n      scale: ScaleOption = {},\n      axis: AxisOption = { label: { autoHide: false } } // Bug in G2? `autoHide` should be set to false by default (it is not).\n    if (isS(typ)) scale.type = fixScaleType(typ) as any\n    if (format) scale.formatter = (v: any) => format(undefined, v)\n    if (isS(title)) {\n      scale.alias = title\n      // HACK ALERT!\n      // The scale alias is not rendered by G2 unless the axis title is non-empty.\n      axis.title = {}\n    }\n    if (isF(min)) scale.min = min\n    if (isF(max)) scale.max = max\n    scale.nice = isB(nice) ? nice : true\n    return [scale, axis]\n  },\n  getCoordType = (marks: Mark[]): S | undefined => {\n    for (const { coord } of marks) if (isS(coord)) return coord\n    return undefined\n  },\n  makeCoord = (space: SpaceT, marks: Mark[]): CoordinateOption | undefined => {\n\n    // HACK ALERT!\n    // Flip all x* and y* properties if the x-variable is continuous.\n    // This is because the underlying lib expects x-variables to be always discrete.\n    // So if the coord space is continuous-discrete, flip x/y and set a transpose transform on the coords.\n\n    const\n      type = getCoordType(marks) as any,\n      transpose = space === SpaceT.CD,\n      actions: CoordinateActions[] | undefined = transpose ? [['transpose']] : undefined\n\n    if (transpose) for (const mark of marks) transposeMark(mark)\n\n    return (\n      type\n        ? actions ? { type, actions } : { type }\n        : actions ? { actions } : undefined\n    )\n  },\n  makeMarks = (marks: Mark[]): [GeometryOption[], AnnotationOption[]] => {\n    const\n      geometries: GeometryOption[] = [],\n      annotations: AnnotationOption[] = []\n\n    for (const m of marks) {\n      const { x, y } = m\n      if (x != null || y != null) {\n        annotations.push(...makeNote(m))\n      } else {\n        geometries.push(makeGeom(m))\n      }\n    }\n\n    return [geometries, annotations]\n  },\n  makeChart = (el: HTMLElement, space: SpaceT, marks: Mark[]): ChartCfg => {\n    // WARNING: makeCoord() must be called before other functions.\n    const\n      coordinate = makeCoord(space, marks), // WARNING: this call may transpose x/y in-place.\n      [scales, axes] = makeScales(marks),\n      [geometries, annotations] = makeMarks(marks)\n\n    return {\n      container: el,\n      autoFit: true,\n      options: {\n        animate: false,\n        coordinate,\n        scales,\n        axes,\n        geometries,\n        annotations,\n        interactions: [\n          { type: 'drag-move' }, // custom\n        ],\n        tooltip: {\n          showCrosshairs: true,\n          crosshairs: { type: 'xy' }\n          // XXX pass container element\n        }\n      }\n    }\n  }\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n    },\n    body: {\n      flexGrow: 1,\n      display: 'flex',\n    },\n    plot: {\n      $nest: {\n        'canvas': {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0\n        }\n      }\n    }\n  })\n\n/** Create a visualization for display inside a form. */\nexport interface Visualization {\n  /** The plot to be rendered in this visualization. */\n  plot: Plot\n  /** Data for this visualization. */\n  data: Rec\n  /** The width of the visualization. Defaults to '100%'. */\n  width?: S\n  /** The hight of the visualization. Defaults to '300px'. */\n  height?: S\n  /** An identifying name for this component. */\n  name?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** The events to capture on this visualization. */\n  events?: S[]\n}\n\nexport const\n  XVisualization = ({ model }: { model: Visualization }) => {\n    const\n      container = React.useRef<HTMLDivElement>(null),\n      currentChart = React.useRef<Chart | null>(null),\n      currentPlot = React.useRef<Plot | null>(null),\n      checkDimensionsPostInit = (w: F, h: F) => { // Safari fix\n        const el = container.current\n        if (!el) return\n        if (el.clientHeight !== h || el.clientWidth !== w) {\n          currentChart.current?.destroy()\n          init()\n        }\n      },\n      init = () => {\n        // Map CSS var colors to their hex values.\n        cat10 = cat10.map(cssVarValue)\n        const el = container.current\n        if (!el) return\n        // If card does not have specified height, it uses content. Since the wrapper is empty, it takes very little space - set to 300px by default.\n        if (el.clientHeight < 30) el.style.height = '300px'\n        const\n          raw_data = unpack<any[]>(model.data),\n          raw_plot = unpack<Plot>(model.plot),\n          marks = raw_plot.marks.map(refactorMark),\n          plot: Plot = { marks },\n          space = spaceTypeOf(raw_data, marks),\n          data = refactorData(raw_data, plot.marks),\n          chart = plot.marks ? new Chart(makeChart(el, space, plot.marks)) : null\n        currentPlot.current = plot\n        if (chart) {\n          currentChart.current = chart\n          chart.data(data)\n          if (model.events) {\n            for (const event of model.events) {\n              switch (event) {\n                case 'select_marks': {\n                  chart.interaction('element-single-selected')\n                  chart.on('element:statechange', (ev: any) => {\n                    const e = ev.gEvent.originalEvent\n                    if (e.stateStatus && e.state === 'selected') {\n                      if (model.name) wave.emit(model.name, event, [e.element?.data])\n                    }\n                  })\n                }\n              }\n            }\n          }\n          chart.render()\n          // React fires mount lifecycle hook before Safari finishes Layout phase so we need recheck if original card dimensions are the\n          // same as after Layout phase. If not, rerender the plot again.\n          setTimeout(() => checkDimensionsPostInit(el.clientWidth, el.clientHeight), 300)\n        }\n      }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(init, [])\n    React.useEffect(() => {\n      const el = container.current\n      if (!el || !currentChart.current || !currentPlot.current) return\n      const\n        raw_data = unpack<any[]>(model.data),\n        data = refactorData(raw_data, currentPlot.current.marks)\n      currentChart.current.changeData(data)\n\n    }, [currentChart, currentPlot, model])\n\n    const\n      { width = 'auto', height = 'auto', name } = model,\n      style: React.CSSProperties = (width === 'auto' && height === 'auto')\n        ? { flexGrow: 1 }\n        : { width: formItemWidth(width), height }\n    return <div data-test={name} style={style} className={css.plot} ref={container} />\n  }\n\n/** Create a card displaying a plot. */\ninterface State {\n  /** The title for this card. */\n  title: S\n  /** Data for this card. */\n  data: Rec\n  /** The plot to be displayed in this card. */\n  plot: Plot\n  /** The events to capture on this card. */\n  events?: S[]\n}\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const { title = 'Untitled', plot, data, events } = state\n        return (\n          <div className={css.card}>\n            <div className='wave-s12 wave-w6'>{title}</div>\n            <div className={css.body}>\n              <XVisualization model={{ name, plot, data, events }} />\n            </div>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('plot', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { Choice } from './choice_group'\nimport { wave } from './ui'\n\n/**\n * Create a picker.\n * Pickers are used to select one or more choices, such as tags or files, from a list.\n * Use a picker to allow the user to quickly search for or manage a few tags or files.\n*/\nexport interface Picker {\n  /** An identifying name for this component. */\n  name: Id\n  /** The choices to be presented. */\n  choices: Choice[]\n  /** Text to be displayed above the component. */\n  label?: S\n  /** The names of the selected choices. */\n  values?: S[]\n  /** Maximum number of selectable choices. Defaults to no limit. */\n  max_choices?: U\n  /** True if the picker is a required field. */\n  required?: B\n  /** Controls whether the picker should be disabled or not. */\n  disabled?: B\n  /** The width of the picker, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** True if the form should be submitted when the picker value changes. */\n  trigger?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nconst pickerSuggestionsProps: Fluent.IBasePickerSuggestionsProps = {\n  suggestionsHeaderText: 'Suggestions',\n  noResultsFoundText: 'No results found',\n}\n\nexport const XPicker = ({ model: m }: { model: Picker }) => {\n  const\n    tags: Fluent.ITag[] = React.useMemo(() => m.choices.map(({ name, label }) => ({ key: name, name: label || name })), [m.choices]),\n    [selectedTags, setSelectedTags] = React.useState<Fluent.ITag[]>(tags.filter(({ key }) => m.values?.includes(key as S))),\n    filterSuggestedTags = (filterText: S, selectedTags?: Fluent.ITag[]) => {\n      if (!filterText) return []\n      const isAlreadySelected = (t: Fluent.ITag) => selectedTags && selectedTags.includes(t)\n      const isStringMatch = (name: S) => name.toLowerCase().includes(filterText.toLowerCase())\n      return tags.filter(t => isStringMatch(t.name) && !isAlreadySelected(t))\n    },\n    onChange = (items?: Fluent.ITag[]) => {\n      setSelectedTags(items || [])\n      wave.args[m.name] = items ? items.map(({ key }) => key) : null\n      if (m.trigger) wave.push()\n    },\n    onEmptyResolveSuggestions = () => tags\n\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  React.useEffect(() => { wave.args[m.name] = m.values || null }, [])\n\n  return (\n    <>\n      {m.label && <Fluent.Label required={m.required}>{m.label}</Fluent.Label>}\n      <Fluent.TagPicker\n        inputProps={{ 'data-test': m.name } as Fluent.IInputProps}\n        removeButtonAriaLabel=\"Remove\"\n        onResolveSuggestions={filterSuggestedTags}\n        onChange={onChange}\n        pickerSuggestionsProps={pickerSuggestionsProps}\n        itemLimit={m.max_choices}\n        selectedItems={selectedTags}\n        disabled={m.disabled}\n        onEmptyResolveSuggestions={onEmptyResolveSuggestions}\n      />\n    </>\n  )\n}","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, F, S } from 'h2o-wave'\nimport React from 'react'\n\n/**\n * Create a progress bar.\n *\n * Progress bars are used to show the completion status of an operation lasting more than 2 seconds.\n * If the state of progress cannot be determined, do not set a value.\n * Progress bars feature a bar showing total units to completion, and total units finished.\n * The label appears above the bar, and the caption appears below.\n * The label should tell someone exactly what the operation is doing.\n *\n * Examples of formatting include:\n * [Object] is being [operation name], or\n * [Object] is being [operation name] to [destination name] or\n * [Object] is being [operation name] from [source name] to [destination name]\n *\n * Status text is generally in units elapsed and total units.\n * Real-world examples include copying files to a storage location, saving edits to a file, and more.\n * Use units that are informative and relevant to give the best idea to users of how long the operation will take to complete.\n * Avoid time units as they are rarely accurate enough to be trustworthy.\n * Also, combine steps of a complex operation into one total bar to avoid rewinding the bar.\n * Instead change the label to reflect the change if necessary. Bars moving backwards reduce confidence in the service.\n*/\nexport interface Progress {\n  /** The text displayed above the bar. */\n  label: S\n  /** The text displayed below the bar. */\n  caption?: S\n  /** The progress, between 0.0 and 1.0, or -1 (default) if indeterminate. */\n  value?: F\n  /** The width of the separator, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n  /** An identifying name for this component. */\n  name?: S\n}\n\nexport const\n  XProgress = ({ model }: { model: Progress }) => {\n    const\n      { label, caption = 'Please wait...', value, name } = model\n    return (\n      <div data-test={name}>\n        <Fluent.ProgressIndicator label={label} description={caption} percentComplete={value} />\n      </div>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, F, Id, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { wave } from './ui'\n\n/**\n * Create a range slider.\n *\n * A range slider is an element used to select a value range. It provides a visual indication of adjustable content, as well as the\n * current setting in the total range of content. It is displayed as a horizontal track with options on either side.\n * Knobs or levers are dragged to one end or the other to make the choice, indicating the current max and min value.\n *\n*/\nexport interface RangeSlider {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** The minimum value of the slider. Defaults to 0. */\n  min?: F\n  /** The maximum value of the slider. Defaults to 100. */\n  max?: F\n  /** The difference between two adjacent values of the slider. */\n  step?: F\n  /** The lower bound of the selected range. */\n  min_value?: F\n  /** The upper bound of the selected range. Default value is `max`. */\n  max_value?: F\n  /** True if this field is disabled. */\n  disabled?: B\n  /** The width of the range slider, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the form should be submitted when the slider value changes. */\n  trigger?: B\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nexport const XRangeSlider = ({ model }: { model: RangeSlider }) => {\n  const\n    { min = 0, max = 100, step = 1, min_value, max_value = max, disabled, trigger, name, label } = model,\n    onChange = React.useCallback((_val: U, val_range?: [U, U]) => { if (val_range) wave.args[name] = val_range }, [name]),\n    onChanged = React.useCallback(() => { if (trigger) wave.push() }, [trigger])\n\n  React.useEffect(() => {\n    wave.args[name] = [\n      typeof min_value == 'number' && min_value > min && min_value <= max ? min_value : min,\n      typeof max_value == 'number' && max_value > min && max_value <= max ? max_value : max,\n    ]\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  return (\n    <div data-test={name}>\n      <Fluent.Slider\n        ranged\n        max={max}\n        min={min}\n        step={step}\n        label={label}\n        defaultLowerValue={min_value}\n        defaultValue={max_value}\n        disabled={disabled}\n        onChange={onChange}\n        onChanged={onChanged}\n      />\n    </div>\n  )\n}","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\n\nconst\n  css = stylesheet({\n    separator: {\n      boxSizing: 'border-box',\n    },\n  })\n\n/**\n * Create a separator.\n *\n * A separator visually separates content into groups.\n */\nexport interface Separator {\n  /** The text displayed on the separator. */\n  label?: S\n  /** An identifying name for this component. */\n  name?: S\n  /** The width of the separator , e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\nexport const\n  XSeparator = ({ model: m }: { model: Separator }) => (\n    <div data-test={m.name} className={css.separator}>\n      <Fluent.Separator>{m.label}</Fluent.Separator>\n    </div>\n  )","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, F, Id, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { wave } from './ui'\n\n/**\n * Create a slider.\n *\n * A slider is an element used to set a value. It provides a visual indication of adjustable content, as well as the\n * current setting in the total range of content. It is displayed as a horizontal track with options on either side.\n * A knob or lever is dragged to one end or the other to make the choice, indicating the current value.\n * Marks on the slider bar can show values and users can choose where they want to drag the knob or lever to\n * set the value.\n *\n * A slider is a good choice when you know that users think of the value as a relative quantity, not a numeric value.\n * For example, users think about setting their audio volume to low or medium  not about setting the\n * value to two or five.\n *\n * The default value of the slider will be zero or be constrained to the min and max values. The min will be returned\n * if the value is set under the min and the max will be returned if set higher than the max value.\n*/\nexport interface Slider {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** The minimum value of the slider. */\n  min?: F\n  /** The maximum value of the slider. */\n  max?: F\n  /** The difference between two adjacent values of the slider. */\n  step?: F\n  /** The current value of the slider. */\n  value?: F\n  /** True if this field is disabled. */\n  disabled?: B\n  /** True if the form should be submitted when the slider value changes. */\n  trigger?: B\n  /** The width of the slider, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nexport const\n  XSlider = ({ model: m }: { model: Slider }) => {\n    const\n      { min = 0, max = 100, step = 1, value = 0 } = m,\n      defaultValue = (value < min) ? min : ((value > max) ? max : value),\n      onChange = (v: U) => wave.args[m.name] = v,\n      onChanged = React.useCallback((_e: MouseEvent | KeyboardEvent | TouchEvent, _value: U) => { if (m.trigger) wave.push() }, [m.trigger])\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[m.name] = defaultValue }, [])\n\n    return (\n      <Fluent.Slider\n        data-test={m.name}\n        buttonProps={{ 'data-test': m.name } as React.HTMLAttributes<HTMLButtonElement>}\n        label={m.label}\n        min={min}\n        max={max}\n        step={step}\n        defaultValue={defaultValue}\n        showValue\n        originFromZero={min < 0 && max >= 0}\n        onChange={onChange}\n        onChanged={onChanged}\n        disabled={m.disabled}\n      />\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, F, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { debounce, wave } from './ui'\n\n/**\n * Create a spinbox.\n *\n * A spinbox allows the user to incrementally adjust a value in small steps.\n * It is mainly used for numeric values, but other values are supported too.\n */\nexport interface Spinbox {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** The minimum value of the spinbox. Defaults to \"0\". */\n  min?: F\n  /** The maximum value of the spinbox. Defaults to \"100\". */\n  max?: F\n  /** The difference between two adjacent values of the spinbox. Defaults to \"1\". */\n  step?: F\n  /** The current value of the spinbox. Defaults to \"0\". */\n  value?: F\n  /** True if this field is disabled. */\n  disabled?: B\n  /** The width of the spinbox, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** True if the form should be submitted when the spinbox value changes. */\n  trigger?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\nconst\n  DEBOUNCE_TIMEOUT = 500,\n  precisionRound = (value: F, precision: F) => {\n    const exp = Math.pow(10, precision)\n    return Math.round(value * exp) / exp\n  },\n  // Source: https://github.com/microsoft/fluentui/blob/ecb0e9b12665a05353f64f1b69981584c3addbc0/packages/utilities/src/math.ts#L91.\n  calculatePrecision = (value: F) => {\n    /**\n     * Group 1:\n     * [1-9]([0]+$) matches trailing zeros\n     * Group 2:\n     * \\.([0-9]*) matches all digits after a decimal point.\n     */\n    const groups = /[1-9]([0]+$)|\\.([0-9]*)/.exec(String(value))\n    if (!groups) return 0\n    return -groups[1]?.length || groups[2]?.length || 0\n  }\nexport const\n  XSpinbox = ({ model: { name, trigger, label, disabled, min = 0, max = 100, step = 1, value = 0 } }: { model: Spinbox }) => {\n    const\n      [val, setVal] = React.useState<{ val?: S }>(), // Use primitive wrapper to always force a React update.\n      precision = Math.max(calculatePrecision(step), 0),\n      parseValue = (v: F) => {\n        const x = precisionRound(v, precision)\n        return (!isNaN(x) && isFinite(x)) ? x : value\n      },\n      onIncrement = (v: S) => {\n        const newValue = Math.min(parseValue(Number(v) + step), max)\n        wave.args[name] = newValue\n        if (trigger) wave.push()\n        return String(newValue)\n      },\n      onDecrement = (v: S) => {\n        const newValue = Math.max(parseValue(Number(v) - step), min)\n        wave.args[name] = newValue\n        if (trigger) wave.push()\n        return String(newValue)\n      },\n      handleOnChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        const\n          value = parseValue(Number(e.target.value)),\n          newValue = value > max\n            ? max\n            : value < min\n              ? min\n              : value\n        wave.args[name] = newValue\n        if (trigger) wave.push()\n        setVal({ val: String(newValue) })\n      },\n      debouncedHandleOnchange = debounce(DEBOUNCE_TIMEOUT, handleOnChange),\n      onChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n        e.persist()\n        trigger ? debouncedHandleOnchange(e) : handleOnChange(e)\n      }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[name] = (value < min) ? min : ((value > max) ? max : value) }, [])\n\n    return (\n      <Fluent.SpinButton\n        inputProps={{ 'data-test': name } as React.InputHTMLAttributes<HTMLInputElement>}\n        label={label}\n        onChange={onChange}\n        min={min}\n        max={max}\n        step={step}\n        defaultValue={String(value)}\n        value={val?.val}\n        onIncrement={onIncrement}\n        onDecrement={onDecrement}\n        disabled={disabled}\n      />\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { FontIcon } from '@fluentui/react'\nimport { B, Dict, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { clas, cssVar, padding } from './theme'\n\n/** Create a set of stats laid out horizontally. */\nexport interface Stats {\n  /** The individual stats to be displayed. */\n  items: Stat[]\n  /** Specifies how to lay out the individual stats. Defaults to 'start'. */\n  justify?: 'start' | 'end' | 'center' | 'between' | 'around'\n  /** Whether to display the stats with a contrasting background. */\n  inset?: B\n  /** The width of the stats, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\n/** Create a stat (a label-value pair) for displaying a metric. */\nexport interface Stat {\n  /** The label for the metric. */\n  label: S\n  /** The value of the metric. */\n  value?: S\n  /** The caption displayed below the primary value. */\n  caption?: S\n  /** An optional icon, displayed next to the label. */\n  icon?: S\n  /** The color of the icon. */\n  icon_color?: S\n}\n\nconst\n  css = stylesheet({\n    stats: {\n      display: 'flex',\n      alignItems: 'flex-start',\n      overflowX: 'auto'\n    },\n    inset: {\n      background: cssVar('$page'),\n      padding: padding(10, 15),\n    },\n    stat: {\n      display: 'flex',\n      alignItems: 'center'\n    },\n    lhs: {\n      width: 45,\n      marginRight: '0.5em',\n    },\n    icon: {\n      fontSize: 45,\n    },\n    statCaption: {\n      color: cssVar('$text5')\n    }\n  }),\n  justifications: Dict<S> = {\n    start: 'flex-start',\n    end: 'flex-end',\n    center: 'center',\n    between: 'space-between',\n    around: 'space-around',\n  },\n  statMargin = '2em'\n\n\nexport const\n  XStats = ({ model: m }: { model: Stats }) => {\n    const\n      statStyle: React.CSSProperties = m.justify\n        ? m.justify === 'start'\n          ? { marginRight: statMargin }\n          : m.justify === 'end'\n            ? { marginLeft: statMargin }\n            : {}\n        : { marginRight: statMargin },\n      justification = justifications[m.justify ?? ''],\n      stats = m.items.map(({ label, value, caption, icon, icon_color }, i) => (\n        <div key={`${i}:${label}`} className={css.stat} style={statStyle}>\n          {icon && (\n            <div className={css.lhs} style={icon_color ? { color: cssVar(icon_color) } : undefined}>\n              <FontIcon className={css.icon} iconName={icon} />\n            </div>\n          )}\n          <div>\n            <div className='wave-s12 wave-w5'>{label}</div>\n            {value && <div className='wave-s24 wave-w3'>{value}</div>}\n            {caption && <div className={clas(css.statCaption, 'wave-s13')}>{caption}</div>}\n          </div>\n        </div>\n      ))\n\n    return (\n      <div className={clas(css.stats, m.inset ? css.inset : '')} style={{ justifyContent: justification }}>{stats}</div>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { rem } from './theme'\n\n/**\n * Create a step for a stepper.\n */\ninterface Step {\n  /** Text displayed below icon. */\n  label: S\n  /** Icon to be displayed. */\n  icon?: S\n  /** Indicates whether this step has already been completed. */\n  done?: B\n}\n\n/**\n  Create a component that displays a sequence of steps in a process.\n  The steps keep users informed about where they are in the process and how much is left to complete.\n*/\nexport interface Stepper {\n  /** An identifying name for this component. */\n  name: Id\n  /** The sequence of steps to be displayed. */\n  items: Step[]\n  /** The width of the stepper, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nconst\n  css = stylesheet({\n    stepNumber: {\n      background: 'var(--text)',\n      color: 'var(--card)',\n      alignItems: 'center',\n      borderRadius: '50%',\n      display: 'inline-flex',\n      justifyContent: 'center',\n      fontSize: rem(0.8),\n      height: 24,\n      minWidth: 24,\n      width: 24,\n    },\n    disabled: {\n      opacity: 0.5\n    }\n  }),\n  iconStyles: Fluent.IIconStyles = { root: { fontSize: 24 } }\n\nexport const\n  XStepper = ({ model: m }: { model: Stepper }) => {\n    const\n      steps = m.items,\n      disabledStyles = (stepIdx: U) => stepIdx > 0 && !steps[stepIdx - 1].done ? css.disabled : '',\n      createStep = (step: Step, i: U) => (\n        <React.Fragment key={i}>\n          <Fluent.Stack horizontal horizontalAlign='space-between' verticalAlign='center' grow={1}>\n            <Fluent.Stack\n              className={!step.done ? disabledStyles(i) : ''}\n              horizontalAlign='center'\n              styles={{ root: { paddingRight: 10, paddingLeft: 10 } }}\n            >\n              {\n                step.done\n                  ? <Fluent.Icon styles={iconStyles} iconName='CompletedSolid' />\n                  : step.icon\n                    ? <Fluent.Icon styles={iconStyles} iconName={step.icon} />\n                    : <span className={css.stepNumber}>{i + 1}</span>\n              }\n              <Fluent.Text block nowrap styles={{ root: { padding: 10 } }}>{step.label}</Fluent.Text>\n            </Fluent.Stack>\n          </Fluent.Stack>\n          {(steps.length - 1) !== i && <Fluent.Separator styles={{ root: { width: '100%' } }} />}\n        </React.Fragment>\n      )\n\n    return (\n      <Fluent.Stack data-test={m.name} horizontal horizontalAlign='space-between' verticalAlign='center'>\n        {steps.map(createStep)}\n      </Fluent.Stack>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { S } from 'h2o-wave'\nimport React from 'react'\n\n/**\n * Create a cell type that renders a column's cells as icons instead of plain text.\n * If set on a column, the cell value is interpreted as the name of the icon to be displayed.\n*/\nexport interface IconTableCellType {\n  /** Icon color. */\n  color?: S\n  /** An identifying name for this component. */\n  name?: S\n}\n\nexport const XIconTableCellType = ({ model: m, icon }: { model: IconTableCellType, icon: S }) => (\n  <Fluent.Icon data-test={m.name} iconName={icon} styles={{ root: { fontSize: '1.2rem', color: m.color || 'inherit' } }} />\n)\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/* eslint-disable @typescript-eslint/no-non-null-asserted-optional-chain */\nimport * as d3 from 'd3'\nimport { F, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { debounce } from '../ui'\n\n\ninterface Props {\n  thickness: U\n  color: S\n  value: F\n}\n\nconst css = stylesheet({\n  container: {\n    // Height 100% is not working in Safari. Without this, container has 0 height and d3 cannot compute properly.\n    position: 'absolute',\n    top: 0, left: 0, right: 0, bottom: 0\n  }\n})\n\nexport const ProgressArc = ({ thickness, color, value }: Props) => {\n  const\n    ref = React.useRef<HTMLDivElement>(null),\n    [content, setContent] = React.useState<JSX.Element | null>(null),\n    renderViz = React.useCallback(() => {\n      if (!ref.current) return\n\n      const { width, height } = ref.current.getBoundingClientRect()\n      if (!height) {\n        // Safari has weird event loop meaning this React code can run before Layout phase is finished (flex items not positioned yet).\n        setTimeout(renderViz, 300)\n        return\n      }\n\n      const\n        diameter = Math.min(width, height),\n        outerRadius = diameter / 2,\n        innerRadius = diameter / 2 - thickness,\n        slot = d3.arc()({\n          outerRadius,\n          innerRadius,\n          startAngle: 0,\n          endAngle: 2 * Math.PI,\n        }),\n        bar = d3.arc()({\n          outerRadius,\n          innerRadius,\n          startAngle: 0,\n          endAngle: 2 * Math.PI * value,\n        })\n\n      setContent(\n        <svg viewBox={`0 0 ${width} ${height}`} style={{ position: 'absolute', top: 0, left: 0, right: 0, bottom: 0 }}>\n          <g transform={diameter === height ? `translate(${(width - (2 * outerRadius)) / 2}, 0)` : `translate(0, ${(height - (2 * outerRadius)) / 2})`}>\n            <path d={slot as S} fill={color} fillOpacity={0.15} transform={`translate(${outerRadius},${outerRadius})`} />\n            <path d={bar as S} fill={color} transform={`translate(${outerRadius},${outerRadius})`} />\n          </g>\n        </svg>\n      )\n    }, [color, thickness, value]),\n    onResize = debounce(1000, renderViz)\n\n  React.useEffect(() => {\n    window.addEventListener('resize', onResize)\n    return () => window.removeEventListener('resize', onResize)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n  React.useLayoutEffect(renderViz, [value, color, thickness, renderViz])\n\n  return <div ref={ref} className={css.container}>{content}</div>\n}","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { F, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { ProgressArc } from './parts/progress_arc'\nimport { clas, cssVar } from './theme'\n\nconst\n  css = stylesheet({\n    container: {\n      position: 'relative',\n      width: 50,\n      height: 50\n    },\n    percentContainer: {\n      position: 'absolute',\n      top: 0, left: 0, bottom: 0, right: 0\n    },\n    percent: {\n      opacity: 0.5,\n    },\n  })\n\n/**\n * Create a cell type that renders a column's cells as progress bars instead of plain text.\n * If set on a column, the cell value must be between 0.0 and 1.0.\n*/\nexport interface ProgressTableCellType {\n  /** Color of the progress arc. */\n  color?: S\n  /** An identifying name for this component. */\n  name?: S\n}\n\nexport const XProgressTableCellType = ({ model: m, progress }: { model: ProgressTableCellType, progress: F }) => (\n  <div data-test={m.name} className={css.container}>\n    <ProgressArc thickness={2} color={cssVar(m.color || '$red')} value={progress} />\n    <Fluent.Stack horizontalAlign='center' verticalAlign='center' className={clas(css.percentContainer, 'wave-s12')}>\n      <div className={css.percent}>{`${Math.round(progress * 100)}%`}</div>\n    </Fluent.Stack>\n  </div >\n)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Dict, Id, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { IconTableCellType, XIconTableCellType } from \"./icon_table_cell_type\"\nimport { ProgressTableCellType, XProgressTableCellType } from \"./progress_table_cell_type\"\nimport { cssVar, rem } from './theme'\nimport { wave } from './ui'\n\n/** Defines cell content to be rendered instead of a simple text. */\ninterface TableCellType {\n  /** Renders a progress arc with a percentage value in the middle. */\n  progress?: ProgressTableCellType\n  /** Renders an icon. */\n  icon?: IconTableCellType\n}\n\n/** Create a table column. */\ninterface TableColumn {\n  /** An identifying name for this column. */\n  name: Id\n  /** The text displayed on the column header. */\n  label: S\n  /** The minimum width of this column, e.g. '50px'. Only `px` units are supported at this time. */\n  min_width?: S\n  /** The maximum width of this column, e.g. '100px'. Only `px` units are supported at this time. */\n  max_width?: S\n  /** Indicates whether the column is sortable. */\n  sortable?: B\n  /** Indicates whether the contents of this column can be searched through. Enables a search box for the table if true. */\n  searchable?: B\n  /** Indicates whether the contents of this column are displayed as filters in a dropdown. */\n  filterable?: B\n  /** Indicates whether each cell in this column should be displayed as a clickable link. Applies to exactly one text column in the table. */\n  link?: B\n  /** Defines the data type of this column. Defaults to `string`. */\n  data_type?: 'string' | 'number' | 'time'\n  /** Defines how to render each cell in this column. Defaults to plain text. */\n  cell_type?: TableCellType\n}\n\n/** Create a table row. */\ninterface TableRow {\n  /** An identifying name for this row. */\n  name: Id\n  /** The cells in this row (displayed left to right). */\n  cells: S[]\n}\n\n\n/**\n * Create an interactive table.\n *\n * This table differs from a markdown table in that it supports clicking or selecting rows. If you simply want to\n * display a non-interactive table of information, use a markdown table.\n *\n * If `multiple` is set to False (default), each row in the table is clickable. When a row is clicked, the form is\n * submitted automatically, and `q.args.table_name` is set to `[row_name]`, where `table_name` is the `name` of\n * the table, and `row_name` is the `name` of the row that was clicked on.\n *\n * If `multiple` is set to True, each row in the table is selectable. A row can be selected by clicking on it.\n * Multiple rows can be selected either by shift+clicking or using marquee selection. When the form is submitted,\n * `q.args.table_name` is set to `[row1_name, row2_name, ...]` where `table_name` is the `name` of the table,\n * and `row1_name`, `row2_name` are the `name` of the rows that were selected. Note that if `multiple` is\n * set to True, the form is not submitted automatically, and one or more buttons are required in the form to trigger\n * submission.\n */\nexport interface Table {\n  /** An identifying name for this component. */\n  name: Id\n  /** The columns in this table. */\n  columns: TableColumn[]\n  /** The rows in this table. */\n  rows: TableRow[]\n  /** True to allow multiple rows to be selected. */\n  multiple?: B\n  /** True to allow group by feature. */\n  groupable?: B\n  /** Indicates whether the contents of this table can be downloaded and saved as a CSV file. Defaults to False. */\n  downloadable?: B\n  /** Indicates whether a Reset button should be displayed to reset search / filter / group-by values to their defaults. Defaults to False. */\n  resettable?: B\n  /** The height of the table, e.g. '400px', '50%', etc. */\n  height?: S\n  /** The width of the table, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** The names of the selected rows. If this parameter is set, multiple selections will be allowed (`multiple` is assumed to be `True`). */\n  values?: S[]\n  /** Controls visibility of table rows when `multiple` is set to `True`. Defaults to 'on-hover'. */\n  checkbox_visibility?: 'always' | 'on-hover' | 'hidden'\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\ntype QColumn = Fluent.IColumn & {\n  dataType?: S\n  cellType?: TableCellType\n  isSortable?: B\n}\n\ntype DataTable = {\n  model: Table\n  onFilterChange: (filterKey: S, filterVal: S) => (e?: React.FormEvent<HTMLInputElement | HTMLElement>, checked?: B) => void\n  sort: (col: QColumn) => void,\n  reset: () => void\n  filteredItems: any[]\n  selectedFilters: Dict<S[]> | null\n  items: any[]\n  selection: Fluent.Selection\n  isMultiple: B\n  isSearchable: B\n  groups?: Fluent.IGroup[]\n}\n\nconst\n  css = stylesheet({\n    // HACK: Put sorting icon on right (same as filter).\n    sortableHeader: {\n      $nest: {\n        '.ms-DetailsHeader-cellName': {\n          position: 'relative',\n          paddingRight: 15\n        }\n      }\n    },\n    sortingIcon: {\n      marginLeft: 10,\n      fontSize: rem(1.1),\n      position: 'absolute',\n      top: -2,\n      right: -5\n    },\n    // HACK: incorrect width recalculated after changing to \"group by mode\" - collapse icon in header\n    // causes horizontal overflow for whole table.\n    hideCellGroupCollapse: {\n      $nest: {\n        'div[class*=\"cellIsGroupExpander\"]': {\n          display: 'none'\n        }\n      }\n    }\n  }),\n  checkboxVisibilityMap = {\n    'always': Fluent.CheckboxVisibility.always,\n    'on-hover': Fluent.CheckboxVisibility.onHover,\n    'hidden': Fluent.CheckboxVisibility.hidden,\n  },\n  groupByF = function <T extends Dict<any>>(arr: T[], key: S): Dict<any> {\n    return arr.reduce((rv, x: T) => {\n      (rv[x[key]] = rv[x[key]] || []).push(x)\n      return rv\n    }, {} as Dict<any>)\n  },\n  sortingF = (column: QColumn, sortAsc: B) => (rowA: any, rowB: any) => {\n    let a = rowA[column.key], b = rowB[column.key]\n\n    switch (column.dataType) {\n      case 'number':\n        a = +a\n        b = +b\n        return sortAsc ? a - b : b - a\n      case 'time':\n        a = Date.parse(a)\n        b = Date.parse(b)\n        break\n      default:\n        a = a.toLowerCase()\n        b = b.toLowerCase()\n        break\n    }\n\n    return sortAsc\n      ? b > a ? -1 : 1\n      : b > a ? 1 : -1\n  },\n  formatNum = (num: U) => num.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\"),\n  toCSV = (data: unknown[][]): S => data.map(row => {\n    const line = JSON.stringify(row)\n    return line.substr(1, line.length - 2)\n  }).join('\\n'),\n  DataTable = ({ model: m, onFilterChange, items, filteredItems, selection, selectedFilters, isMultiple, isSearchable, groups, sort, reset }: DataTable) => {\n    const\n      [colContextMenuList, setColContextMenuList] = React.useState<Fluent.IContextualMenuProps | null>(null),\n      selectedFiltersRef = React.useRef(selectedFilters),\n      onColumnClick = (e: React.MouseEvent<HTMLElement>, column: QColumn) => {\n        const isMenuClicked = (e.target as HTMLElement).getAttribute('data-icon-name') === 'ChevronDown'\n\n        if (isMenuClicked) onColumnContextMenu(column, e)\n        else if (column.isSortable) {\n          sort(column)\n          setColumns(columns.map(col => column.key === col.key ? column : col))\n        }\n      },\n      [columns, setColumns] = React.useState(m.columns.map((c): QColumn => {\n        const\n          minWidth = c.min_width\n            ? c.min_width.endsWith('px')\n              ? +c.min_width.substring(0, c.min_width.length - 2)\n              : +c.min_width\n            : 150,\n          maxWidth = c.max_width\n            ? c.max_width.endsWith('px')\n              ? +c.max_width.substring(0, c.max_width.length - 2)\n              : +c.max_width\n            : undefined\n        return {\n          key: c.name,\n          name: c.label,\n          fieldName: c.name,\n          minWidth,\n          maxWidth,\n          headerClassName: c.sortable ? css.sortableHeader : undefined,\n          iconClassName: c.sortable ? css.sortingIcon : undefined,\n          iconName: c.sortable ? 'SortDown' : undefined,\n          onColumnClick,\n          columnActionsMode: c.filterable ? Fluent.ColumnActionsMode.hasDropdown : Fluent.ColumnActionsMode.clickable,\n          cellType: c.cell_type,\n          dataType: c.data_type,\n          isSortable: c.sortable,\n          isResizable: true,\n        }\n      })),\n      primaryColumnKey = m.columns.find(c => c.link)?.name || (m.columns[0].link === false ? undefined : m.columns[0].name),\n      onRenderMenuList = React.useCallback((listProps?: Fluent.IContextualMenuListProps) => {\n        if (!listProps) return null\n\n        return (\n          <div style={{ padding: 10 }}>\n            <Fluent.Text variant='mediumPlus' styles={{ root: { paddingTop: 10, paddingBottom: 10, fontWeight: 'bold' } }} block>Show only</Fluent.Text>\n            {\n              listProps.items.map(({ key, name, data }) => (\n                <Fluent.Checkbox\n                  key={key}\n                  label={name}\n                  defaultChecked={!!name && !!selectedFiltersRef.current && selectedFiltersRef.current[data]?.includes(name)}\n                  onChange={onFilterChange(data || '', name || '')}\n                  styles={{ root: { marginBottom: 5 } }}\n                />\n              )\n              )\n            }\n          </div>\n        )\n      }, [onFilterChange]),\n      onColumnContextMenu = React.useCallback((col: Fluent.IColumn, e: React.MouseEvent<HTMLElement>) => {\n        setColContextMenuList({\n          items: Array.from(new Set(items.map(i => i[col.fieldName || col.key]))).map(option => ({ key: option, name: option, data: col.fieldName || col.key })),\n          target: e.target as HTMLElement,\n          directionalHint: Fluent.DirectionalHint.bottomLeftEdge,\n          gapSpace: 10,\n          isBeakVisible: true,\n          onRenderMenuList,\n          onDismiss: () => setColContextMenuList(null),\n        })\n      }, [items, onRenderMenuList]),\n      onRenderDetailsHeader = React.useCallback((props?: Fluent.IDetailsHeaderProps) => {\n        if (!props) return <span />\n\n        return (\n          <Fluent.Sticky stickyPosition={Fluent.StickyPositionType.Header} isScrollSynced>\n            <Fluent.DetailsHeader {...props} onColumnContextMenu={onColumnContextMenu} className={groups ? css.hideCellGroupCollapse : ''} />\n          </Fluent.Sticky>\n        )\n      }, [groups, onColumnContextMenu]),\n      onRenderDetailsFooter = (props?: Fluent.IDetailsFooterProps) => {\n        const isFilterable = m.columns.some(c => c.filterable)\n        if (!props || (!m.downloadable && !m.resettable && !isSearchable && !isFilterable)) return null\n\n        const\n          footerItems: Fluent.ICommandBarItemProps[] = [],\n          buttonStyles = { root: { background: cssVar('$card') } }\n        if (m.downloadable) footerItems.push({ key: 'download', text: 'Download data', iconProps: { iconName: 'Download' }, onClick: download, buttonStyles })\n        if (m.resettable) footerItems.push({ key: 'reset', text: 'Reset table', iconProps: { iconName: 'Refresh' }, onClick: reset, buttonStyles })\n\n        return (\n          <Fluent.Sticky stickyPosition={Fluent.StickyPositionType.Footer} isScrollSynced>\n            <Fluent.Stack horizontal horizontalAlign={isFilterable ? 'space-between' : 'end'} verticalAlign='center'>\n              {\n                isFilterable && (\n                  <Fluent.Text variant='smallPlus' block styles={{ root: { whiteSpace: 'nowrap' } }}>Rows:\n                    <b style={{ paddingLeft: 5 }}>{formatNum(filteredItems.length)} of {formatNum(items.length)}</b>\n                  </Fluent.Text>\n                )\n              }\n              <div style={{ width: '80%' }}>\n                <Fluent.CommandBar items={footerItems} styles={{ root: { background: cssVar('$card') }, primarySet: { justifyContent: 'flex-end' } }} />\n              </div>\n            </Fluent.Stack>\n          </Fluent.Sticky>\n        )\n      },\n      onRenderRow = (props?: Fluent.IDetailsRowProps) => props\n        ? <Fluent.DetailsRow {...props} styles={{ cell: { alignSelf: 'center' }, checkCell: { display: 'flex', alignItems: 'center' }, root: { width: '100%' } }} />\n        : null,\n      onItemInvoked = (item: Fluent.IObjectWithKey & Dict<any>) => {\n        wave.args[m.name] = [item.key as S]\n        wave.push()\n      },\n      download = () => {\n        // TODO: Prompt a dialog for name, encoding, etc.\n        const\n          data = toCSV([m.columns.map(({ label, name }) => label || name), ...m.rows.map(({ cells }) => cells)]),\n          a = document.createElement('a'),\n          blob = new Blob([data], { type: \"octet/stream\" }),\n          url = window.URL.createObjectURL(blob)\n\n        a.href = url\n        a.download = 'exported_data.csv'\n        a.click()\n\n        window.URL.revokeObjectURL(url)\n      },\n      onRenderItemColumn = (item?: Fluent.IObjectWithKey & Dict<any>, _index?: number, col?: QColumn) => {\n        if (!item || !col) return <span />\n\n        let v = item[col.fieldName as S]\n        if (col.cellType?.progress) return <XProgressTableCellType model={col.cellType.progress} progress={item[col.key]} />\n        if (col.cellType?.icon) return <XIconTableCellType model={col.cellType.icon} icon={item[col.key]} />\n        if (col.dataType === 'time') v = new Date(v).toLocaleString()\n        if (col.key === primaryColumnKey && !isMultiple) {\n          const onClick = () => {\n            wave.args[m.name] = [item.key as S]\n            wave.push()\n          }\n          return <Fluent.Link onClick={onClick}>{v}</Fluent.Link>\n        }\n\n        return v\n      }\n\n    // HACK: React stale closures - https://reactjs.org/docs/hooks-faq.html#why-am-i-seeing-stale-props-or-state-inside-my-function\n    // TODO: Find a reasonable way of doing this.\n    React.useEffect(() => { { selectedFiltersRef.current = selectedFilters } }, [selectedFilters])\n\n    return (\n      <>\n        <Fluent.DetailsList\n          items={filteredItems}\n          columns={columns}\n          constrainMode={Fluent.ConstrainMode.unconstrained}\n          layoutMode={Fluent.DetailsListLayoutMode.fixedColumns}\n          groups={groups}\n          selection={selection}\n          selectionMode={isMultiple ? Fluent.SelectionMode.multiple : Fluent.SelectionMode.none}\n          selectionPreservedOnEmptyClick\n          onItemInvoked={isMultiple ? undefined : onItemInvoked}\n          onRenderRow={onRenderRow}\n          onRenderItemColumn={onRenderItemColumn}\n          onRenderDetailsHeader={onRenderDetailsHeader}\n          onRenderDetailsFooter={onRenderDetailsFooter}\n          checkboxVisibility={checkboxVisibilityMap[m.checkbox_visibility || 'on-hover']}\n        />\n        {colContextMenuList && <Fluent.ContextualMenu {...colContextMenuList} />}\n      </>\n    )\n  }\n\n\nexport const\n  XTable = ({ model: m }: { model: Table }) => {\n    const\n      items = React.useMemo(() => m.rows.map(r => {\n        const item: Fluent.IObjectWithKey & Dict<any> = { key: r.name }\n        for (let i = 0, n = r.cells.length; i < n; i++) {\n          const col = m.columns[i]\n          item[col.name] = r.cells[i]\n        }\n        return item\n      }), [m.rows, m.columns]),\n      isMultiple = Boolean(m.values?.length || m.multiple),\n      [filteredItems, setFilteredItems] = React.useState(items),\n      searchableKeys = React.useMemo(() => m.columns.filter(({ searchable }) => searchable).map(({ name }) => name), [m.columns]),\n      [searchStr, setSearchStr] = React.useState(''),\n      [selectedFilters, setSelectedFilters] = React.useState<Dict<S[]> | null>(null),\n      [groups, setGroups] = React.useState<Fluent.IGroup[] | undefined>(),\n      [groupByKey, setGroupByKey] = React.useState('*'),\n      groupByOptions: Fluent.IDropdownOption[] = React.useMemo(() =>\n        m.groupable ? [{ key: '*', text: '(No Grouping)' }, ...m.columns.map(col => ({ key: col.name, text: col.label }))] : [], [m.columns, m.groupable]\n      ),\n      filter = React.useCallback((selectedFilters: Dict<S[]> | null) => {\n        // If we have filters, check if any of the data-item's props (filter's keys) equals to any of its filter values.\n        setFilteredItems(\n          selectedFilters\n            ? items.filter(i => Object.keys(selectedFilters)\n              .every(filterKey => !selectedFilters[filterKey].length || selectedFilters[filterKey]\n                .some(filterVal => i[filterKey] === filterVal)\n              )\n            )\n            : items\n        )\n      }, [items]),\n      makeGroups = React.useCallback((groupByKey: S, filteredItems: (Fluent.IObjectWithKey & Dict<any>)[]) => {\n        let prevSum = 0\n        const\n          groupedBy = groupByF(filteredItems, groupByKey),\n          groupedByKeys = Object.keys(groupedBy),\n          groups: Fluent.IGroup[] = groupedByKeys.map((key, i) => {\n            if (i !== 0) {\n              const prevKey = groupedByKeys[i - 1]\n              prevSum += groupedBy[prevKey].length\n            }\n\n            let name = key\n            if (isNaN(Number(key)) && !isNaN(Date.parse(key))) name = new Date(key).toLocaleString()\n\n            return { key, name, startIndex: prevSum, count: groupedBy[key].length, isCollapsed: true }\n          })\n\n        groups.sort(({ name: name1 }, { name: name2 }) => {\n          const numName1 = Number(name1), numName2 = Number(name2)\n          if (!isNaN(numName1) && !isNaN(numName2)) return numName1 - numName2\n\n          const dateName1 = Date.parse(name1), dateName2 = Date.parse(name2)\n          if (!isNaN(dateName1) && !isNaN(dateName2)) return dateName1 - dateName2\n\n          return name2 < name1 ? 1 : -1\n        })\n\n        return { groupedBy, groups }\n      }, []),\n      initGroups = React.useCallback(() => {\n        setGroupByKey(groupByKey => {\n          setFilteredItems(filteredItems => {\n            const { groupedBy, groups } = makeGroups(groupByKey, filteredItems)\n            setGroups(groups)\n            return Object.values(groupedBy).flatMap(arr => arr)\n          })\n          return groupByKey\n        })\n      }, [makeGroups]),\n      search = React.useCallback(() => {\n        setSearchStr(searchString => {\n          const _searchStr = searchString.toLowerCase()\n          if (!_searchStr || !searchableKeys.length) return searchString || ''\n\n          setFilteredItems(filteredItems => filteredItems.filter(i => searchableKeys.some(key => (i[key] as S).toLowerCase().includes(_searchStr))))\n          return searchString || ''\n        })\n      }, [searchableKeys]),\n      onSearchChange = React.useCallback((_e: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, searchStr = '') => {\n        setSearchStr(searchStr)\n\n        if (!searchStr && !selectedFilters) {\n          setFilteredItems(items)\n          setGroups(groups => {\n            if (groups) initGroups()\n            return groups\n          })\n          return\n        }\n\n        filter(selectedFilters)\n        search()\n        setGroups(groups => {\n          if (groups) initGroups()\n          return groups\n        })\n      }, [selectedFilters, filter, search, initGroups, items]),\n      onGroupByChange = (_e: React.FormEvent<HTMLDivElement>, option?: Fluent.IDropdownOption) => {\n        if (!option) return\n        reset()\n        if (option.key === '*') return\n\n        setGroupByKey(option.key as S)\n        initGroups()\n      },\n      onFilterChange = React.useCallback((filterKey: S, filterVal: S) => (_e?: React.FormEvent<HTMLInputElement | HTMLElement>, checked?: B) => {\n        setSelectedFilters(selectedFilters => {\n          const filters = selectedFilters || {}\n\n          if (checked) {\n            if (filters[filterKey]) filters[filterKey].push(filterVal)\n            else filters[filterKey] = [filterVal]\n          }\n          else filters[filterKey] = filters[filterKey].filter(f => f !== filterVal)\n          const newFilters = Object.values(filters).every(v => !v.length) ? null : { ...filters }\n\n          filter(newFilters)\n          search()\n          setGroups(groups => {\n            if (groups) initGroups()\n            return groups\n          })\n          return newFilters\n        })\n\n      }, [filter, initGroups, search]),\n      // TODO: Make filter options in dropdowns dynamic.\n      reset = React.useCallback(() => {\n        setSelectedFilters(null)\n        setSearchStr('')\n\n        setGroups(undefined)\n        setGroupByKey('*')\n\n        filter(null)\n        search()\n      }, [filter, search]),\n      selection = React.useMemo(() => new Fluent.Selection({ onSelectionChanged: () => { wave.args[m.name] = selection.getSelection().map(item => item.key as S) } }), [m.name]),\n      computeHeight = () => {\n        if (m.height) return m.height\n        if (items.length > 10) return 500\n\n        const\n          topToolbarHeight = searchableKeys.length || m.groupable ? 60 : 0,\n          headerHeight = 60,\n          rowHeight = m.columns.some(c => c.cell_type)\n            ? m.columns.some(c => c.cell_type?.progress) ? 68 : 50\n            : 43,\n          footerHeight = m.downloadable || m.resettable || searchableKeys.length ? 44 : 0\n\n        return topToolbarHeight + headerHeight + (items.length * rowHeight) + footerHeight\n      },\n      sort = React.useCallback((column: QColumn) => {\n        const sortAsc = column.iconName === 'SortDown'\n        column.iconName = sortAsc ? 'SortUp' : 'SortDown'\n\n        setGroups(groups => {\n          if (groups) {\n            setFilteredItems(filteredItems => groups?.reduce((acc, group) =>\n              [...acc, ...filteredItems.slice(group.startIndex, acc.length + group.count).sort(sortingF(column, sortAsc))],\n              [] as any[]) || [])\n          }\n          else setFilteredItems(filteredItems => [...filteredItems].sort(sortingF(column, sortAsc)))\n          return groups\n        })\n      }, [])\n\n    React.useEffect(() => {\n      wave.args[m.name] = []\n      if (isMultiple && m.values) {\n        m.values.forEach(v => selection.setKeySelected(v, true, false))\n        wave.args[m.name] = m.values\n      }\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n    React.useEffect(() => setFilteredItems(items), [items])\n\n    const dataTableProps: DataTable = React.useMemo(() => ({\n      model: m,\n      onFilterChange,\n      items,\n      filteredItems,\n      selectedFilters,\n      groups,\n      selection,\n      sort,\n      isMultiple,\n      reset,\n      isSearchable: !!searchableKeys.length\n    }), [filteredItems, groups, isMultiple, items, m, onFilterChange, reset, searchableKeys.length, selectedFilters, selection, sort])\n\n    return (\n      <div data-test={m.name} style={{ position: 'relative', height: computeHeight() }}>\n        <Fluent.Stack horizontal horizontalAlign='space-between' >\n          {m.groupable && <Fluent.Dropdown data-test='groupby' label='Group by' selectedKey={groupByKey} onChange={onGroupByChange} options={groupByOptions} styles={{ root: { width: 300 } }} />}\n          {!!searchableKeys.length && <Fluent.TextField data-test='search' label='Search' onChange={onSearchChange} value={searchStr} styles={{ root: { width: '50%' } }} />}\n        </Fluent.Stack>\n        <Fluent.ScrollablePane scrollbarVisibility={Fluent.ScrollbarVisibility.auto} styles={{ root: { top: m.groupable || searchableKeys.length ? 80 : 0 } }}>\n          {\n            isMultiple\n              ? <Fluent.MarqueeSelection selection={selection}><DataTable {...dataTableProps} /></Fluent.MarqueeSelection>\n              : <DataTable {...dataTableProps} />\n          }\n        </Fluent.ScrollablePane>\n      </div>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { wave } from './ui'\n\n/**\n * Create a tab.\n */\nexport interface Tab {\n  /** An identifying name for this component. */\n  name: Id\n  /** The text displayed on the tab. */\n  label?: S\n  /** The icon displayed on the tab. */\n  icon?: S\n}\n\n/**\n * Create a tab bar.\n */\nexport interface Tabs {\n  /** An identifying name for this component. */\n  name: Id\n  /** The name of the tab to select. */\n  value?: S\n  /** The tabs in this tab bar. */\n  items?: Tab[]\n  /** The width of the tabs, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** True if tabs should be rendered as links instead of buttons. */\n  link?: B\n}\n\nconst\n  css = stylesheet({\n    pivot: {\n      // Actual height of the Fluent pivot is 44.\n      // When used standalone in a flex layout, scrollbars show up when attempting to fit to content height.\n      // Explicitly set a height to work around.\n      minHeight: 46,\n      overflowX: 'auto',\n      overflowY: 'hidden'\n    }\n  })\n\nexport const\n  XTabs = ({ model: m }: { model: Tabs }) => {\n    const\n      onLinkClick = (item?: Fluent.PivotItem) => {\n        const name = item?.props.itemKey\n        if (!name) return\n        if (name.startsWith('#')) {\n          window.location.hash = name.substr(1)\n          return\n        }\n        if (m.name) {\n          if (name !== wave.args[m.name]) {\n            wave.args[m.name] = name\n            wave.push()\n          }\n        } else {\n          wave.args[name] = true\n          wave.push()\n        }\n      },\n      tabs = m.items?.map(t => <Fluent.PivotItem key={t.name} itemIcon={t.icon} itemKey={t.name} headerText={t.label} />)\n    return (\n      <div className={css.pivot}>\n        <Fluent.Pivot\n          data-test={m.name}\n          selectedKey={m.value ?? null}\n          linkFormat={m.link ? Fluent.PivotLinkFormat.links : Fluent.PivotLinkFormat.tabs}\n          onLinkClick={onLinkClick}>{tabs}</Fluent.Pivot>\n      </div>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, Model, Rec, S, unpack } from 'h2o-wave'\nimport Handlebars from 'handlebars'\nimport React from 'react'\nimport { cards, substitute } from './layout'\nimport { MarkupCard, XMarkup } from './markup'\nimport { bond } from './ui'\n\n/** Render dynamic content using an HTML template.*/\nexport interface Template {\n  /** The Handlebars template. https://handlebarsjs.com/guide/ */\n  content: S\n  /** Data for the Handlebars template */\n  data?: Rec\n  /** An identifying name for this component. */\n  name?: S\n  /** The width of the template, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\n/** Render dynamic content using an HTML template.*/\ninterface State {\n  /** The title for this card.*/\n  title: S\n  /** The Handlebars template. https://handlebarsjs.com/guide/ */\n  content: S\n  /** Data for the Handlebars template. */\n  data?: Rec\n}\n\nexport const\n  XTemplate = ({ model: m }: { model: Template }) => {\n    const\n      template = Handlebars.compile(m.content || ''),\n      data = unpack<Rec>(m.data)\n    return <div data-test={m.name}><XMarkup model={{ content: template(data || {}) }} /></div>\n  },\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      template = Handlebars.compile(state.content || ''),\n      render = () => {\n        const data = unpack<Rec>(state.data)\n        return <MarkupCard name={name} title={substitute(state.title, data)} content={template(data || {})} />\n      }\n    return { render, changed }\n  })\n\ncards.register('template', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Dict, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { CardMenu } from './card_menu'\nimport { Markdown } from './markdown'\nimport { margin } from './theme'\nimport { Command } from './toolbar'\n\n/** Create text content. */\nexport interface Text {\n  /** The text content. */\n  content: S\n  /** The font size of the text content. */\n  size?: 'xl' | 'l' | 'm' | 's' | 'xs'\n  /** The width of the text , e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** Tooltip message. */\n  tooltip?: S\n  /** An identifying name for this component. */\n  name?: S\n}\n\n/** Create extra-large sized text content. */\nexport interface TextXl {\n  /** The text content. */\n  content: S\n  /** The width of the text , e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** Tooltip message. */\n  tooltip?: S\n  /** Contextual menu commands for this component. */\n  commands?: Command[]\n  /** An identifying name for this component. */\n  name?: S\n}\n\n/** Create large sized text content. */\nexport interface TextL {\n  /** The text content. */\n  content: S\n  /** The width of the text , e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** Tooltip message. */\n  tooltip?: S\n  /** Contextual menu commands for this component. */\n  commands?: Command[]\n  /** An identifying name for this component. */\n  name?: S\n}\n\n/** Create medium sized text content. */\nexport interface TextM {\n  /** The text content. */\n  content: S\n  /** The width of the text , e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** Tooltip message. */\n  tooltip?: S\n  /** An identifying name for this component. */\n  name?: S\n}\n\n/** Create small sized text content. */\nexport interface TextS {\n  /** The text content. */\n  content: S\n  /** The width of the text , e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** Tooltip message. */\n  tooltip?: S\n  /** An identifying name for this component. */\n  name?: S\n}\n\n/** Create extra-small sized text content. */\nexport interface TextXs {\n  /** The text content. */\n  content: S\n  /** The width of the text , e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** Tooltip message. */\n  tooltip?: S\n  /** An identifying name for this component. */\n  name?: S\n}\n\nconst\n  css = stylesheet({\n    text: {\n      position: 'relative',\n      $nest: {\n        p: {\n          // Override default 1em margin inside markdown paragraphs.\n          margin: margin(0, 0, 10, 0),\n        }\n      },\n    },\n  }),\n  textVariants: Dict<keyof Fluent.IFontStyles> = {\n    xl: 'xLarge',\n    l: 'large',\n    m: 'medium',\n    s: 'small',\n    xs: 'xSmall',\n  },\n  toTextVariant = (s: S) => textVariants[s] || 'mediumPlus'\n\nexport const\n  XText = ({ content, name, size, commands }: { content: S, name?: S, size?: S, commands?: Command[] }) => {\n    const menuName = name ? `${name}-menu` : name\n    return (\n      <div className={css.text}>\n        <Fluent.Text data-test={name} variant={toTextVariant(size || 'm')} block>\n          <Markdown source={content} />\n        </Fluent.Text>\n        {!!commands?.length && <CardMenu name={menuName} commands={commands} />}\n      </div>\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { debounce, wave } from './ui'\n\n/**\n * Create a text box.\n *\n * The text box component enables a user to type text into an app.\n * It's typically used to capture a single line of text, but can be configured to capture multiple lines of text.\n * The text displays on the screen in a simple, uniform format.\n*/\nexport interface Textbox {\n  /** An identifying name for this component. */\n  name: Id\n  /** The text displayed above the field. */\n  label?: S\n  /** A string that provides a brief hint to the user as to what kind of information is expected in the field. It should be a word or short phrase that demonstrates the expected type of data, rather than an explanatory message. */\n  placeholder?: S\n  /** Text to be displayed inside the text box. */\n  value?: S\n  /** The masking string that defines the mask's behavior. A backslash will escape any character. Special format characters are: '9': [0-9] 'a': [a-zA-Z] '*': [a-zA-Z0-9].*/\n  mask?: S\n  /** Icon displayed in the far right end of the text field. */\n  icon?: S\n  /** Text to be displayed before the text box contents. */\n  prefix?: S\n  /** Text to be displayed after the text box contents. */\n  suffix?: S\n  /** Text to be displayed as an error below the text box. */\n  error?: S\n  /** True if the text box is a required field. */\n  required?: B\n  /** True if the text box is disabled. */\n  disabled?: B\n  /** True if the text box is a read-only field. */\n  readonly?: B\n  /** True if the text box should allow multi-line text entry. */\n  multiline?: B\n  /** True if the text box should hide text content. */\n  password?: B\n  /** True if the form should be submitted when the text value changes. */\n  trigger?: B\n  /** The height of the text box, e.g. '100px'. Applicable only if `multiline` is true. */\n  height?: S\n  /** The width of the text box, e.g. '100px'. Defaults to '100%'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nconst DEBOUNCE_TIMEOUT = 500\nexport const\n  XTextbox = ({ model: m }: { model: Textbox }) => {\n    const onChange = ({ target }: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, v?: S) => {\n      v = v || (target as HTMLInputElement).value\n\n      wave.args[m.name] = v ?? (m.value || '')\n      if (m.trigger) wave.push()\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[m.name] = m.value || '' }, [])\n\n    return m.mask\n      ? (\n        <Fluent.MaskedTextField\n          data-test={m.name}\n          label={m.label}\n          defaultValue={m.value}\n          mask={m.mask}\n          errorMessage={m.error}\n          required={m.required}\n          disabled={m.disabled}\n          readOnly={m.readonly}\n          onChange={m.trigger ? debounce(DEBOUNCE_TIMEOUT, onChange) : onChange}\n        />\n      )\n      : (\n        <Fluent.TextField\n          data-test={m.name}\n          styles={m.multiline && m.height ? { fieldGroup: { height: m.height } } : undefined}\n          label={m.label}\n          placeholder={m.placeholder}\n          iconProps={{ iconName: m.icon }}\n          prefix={m.prefix}\n          suffix={m.suffix}\n          defaultValue={m.value}\n          errorMessage={m.error}\n          required={m.required}\n          disabled={m.disabled}\n          readOnly={m.readonly}\n          multiline={m.multiline}\n          type={m.password ? 'password' : undefined}\n          onChange={m.trigger ? debounce(DEBOUNCE_TIMEOUT, onChange) : onChange}\n        />\n      )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { wave } from './ui'\n\n/**\n * Create a toggle.\n * Toggles represent a physical switch that allows users to turn things on or off.\n * Use toggles to present users with two mutually exclusive options (like on/off), where choosing an option results\n * in an immediate action.\n *\n * Use a toggle for binary operations that take effect right after the user flips the Toggle.\n * For example, use a Toggle to turn services or hardware components on or off.\n * In other words, if a physical switch would work for the action, a Toggle is probably the best component to use.\n */\nexport interface Toggle {\n  /** An identifying name for this component. */\n  name: Id\n  /** Text to be displayed alongside the component. */\n  label?: S\n  /** True if selected, False if unselected. */\n  value?: B\n  /** True if the checkbox is disabled. */\n  disabled?: B\n  /** True if the form should be submitted when the toggle value changes. */\n  trigger?: B\n  /** The width of the toggle, e.g. '100px'. */\n  width?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n  /** An optional tooltip message displayed when a user clicks the help icon to the right of the component. */\n  tooltip?: S\n}\n\nexport const\n  XToggle = ({ model: m }: { model: Toggle }) => {\n    const onChange = React.useCallback((_e?: React.FormEvent<HTMLElement>, checked?: B) => {\n      wave.args[m.name] = !!checked\n      if (m.trigger) wave.push()\n    }, [m.name, m.trigger])\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    React.useEffect(() => { wave.args[m.name] = !!m.value }, [])\n\n    return (\n      <Fluent.Toggle\n        data-test={m.name}\n        label={m.label}\n        defaultChecked={m.value}\n        onChange={onChange}\n        disabled={m.disabled}\n        onText=\"On\"\n        offText=\"Off\"\n        inlineLabel\n      />\n    )\n  }","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, Model, Rec, S, unpack, xid } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport vegaEmbed from 'vega-embed'\nimport { cards, grid } from './layout'\nimport { formItemWidth } from './theme'\nimport { bond, debounce } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n    },\n    body: {\n      flexGrow: 1,\n      display: 'flex',\n    },\n    plot: {\n      $nest: {\n        'canvas': {\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0\n        }\n      }\n    }\n  })\n\n/** Create a Vega-lite plot for display inside a form. */\nexport interface VegaVisualization {\n  /** The Vega-lite specification. */\n  specification: S\n  /** Data for the plot, if any. */\n  data?: Rec\n  /** The width of the visualization. Defaults to '100%'. */\n  width?: S\n  /** The height of the visualization. Defaults to '300px'. */\n  height?: S\n  /** An identifying name for this component. */\n  name?: S\n  /** True if the component should be visible. Defaults to true. */\n  visible?: B\n}\n\nexport const\n  XVegaVisualization = ({ model: state }: { model: VegaVisualization }) => {\n    const\n      ref = React.useRef<HTMLDivElement>(null),\n      init = React.useCallback(() => {\n        const el = ref.current\n        if (!el) return\n\n        const spec = JSON.parse(state.specification)\n        // HACK: Vega calculates dimensions with extra 10px for some reason, increase container for 10px as well.\n        if (!isNaN(spec.height)) el.style.height = `${spec.height + 10}px`\n        // If card does not have specified height, it uses content. Since the wrapper is empty, it takes very little space - set to 300px by default.\n        else if (el.clientHeight < 30) el.style.height = '300px'\n\n        const\n          data = unpack<any[]>(state.data),\n          width = el.clientWidth - 10, // HACK: Vega calculates dimensions with extra 10px for some reason.\n          height = el.clientHeight - 10 // HACK: Vega calculates dimensions with extra 10px for some reason.\n\n        if (data) spec.data = { values: data }\n        vegaEmbed(el, spec, {\n          mode: 'vega-lite',\n          defaultStyle: false,\n          renderer: 'canvas',\n          actions: false,\n          config: {\n            autosize: {\n              type: 'fit',\n              resize: true\n            },\n            view: {\n              discreteWidth: width,\n              discreteHeight: height,\n              continuousWidth: width,\n              continuousHeight: height,\n            }\n          }\n        }).catch(console.error)\n      }, [state.data, state.specification]),\n      onResize = debounce(1000, init),\n      { name, width = 'auto', height = 'auto' } = state,\n      style: React.CSSProperties = (width === 'auto' && height === 'auto')\n        ? { flexGrow: 1 }\n        : { width: formItemWidth(width), height }\n\n    React.useEffect(init, [init, state])\n    React.useEffect(() => {\n      init()\n      window.addEventListener('resize', onResize)\n      return () => window.removeEventListener('resize', onResize)\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [])\n\n    return <div data-test={name} className={css.plot} style={{ ...style, position: 'relative' }} ref={ref} />\n  }\n\n/** Create a card containing a Vega-lite plot. */\ninterface State {\n  /** The title of this card. */\n  title: S\n  /** The Vega-lite specification. */\n  specification: S\n  /** Data for the plot, if any. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const { specification, data, title } = state\n        return (\n          <div data-test={name} className={css.card}>\n            <div className='wave-s12 wave-w6'>{title}</div>\n            <div className={css.body}>\n              <XVegaVisualization key={xid()} model={{ specification, data }} />\n            </div>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('vega', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Model, Packed, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { Button, Buttons, XButtons, XStandAloneButton } from './button'\nimport { Checkbox, XCheckbox } from './checkbox'\nimport { Checklist, XChecklist } from './checklist'\nimport { ChoiceGroup, XChoiceGroup } from './choice_group'\nimport { ColorPicker, XColorPicker } from './color_picker'\nimport { Combobox, XCombobox } from './combobox'\nimport { DatePicker, XDatePicker } from './date_picker'\nimport { Dropdown, XDropdown } from './dropdown'\nimport { Expander, XExpander } from './expander'\nimport { FileUpload, XFileUpload } from './file_upload'\nimport { Frame, XFrame } from './frame'\nimport { Image, XImage } from './image'\nimport { Label, XLabel } from './label'\nimport { cards } from './layout'\nimport { Link, XLink } from './link'\nimport { Markup, XMarkup } from './markup'\nimport { MessageBar, XMessageBar } from './message_bar'\nimport { Picker, XPicker } from './picker'\nimport { Visualization, XVisualization } from './plot'\nimport { Progress, XProgress } from './progress'\nimport { bond } from './ui'\nimport { RangeSlider, XRangeSlider } from './range_slider'\nimport { Separator, XSeparator } from './separator'\nimport { Slider, XSlider } from './slider'\nimport { Spinbox, XSpinbox } from './spinbox'\nimport { Stats, XStats } from './stats'\nimport { Stepper, XStepper } from './stepper'\nimport { Table, XTable } from './table'\nimport { Tabs, XTabs } from './tabs'\nimport { Template, XTemplate } from './template'\nimport { Text, TextL, TextM, TextS, TextXl, TextXs, XText } from './text'\nimport { Textbox, XTextbox } from './textbox'\nimport { clas, cssVar, padding } from './theme'\nimport { Toggle, XToggle } from './toggle'\nimport { XToolTip } from './tooltip'\nimport { VegaVisualization, XVegaVisualization } from './vega'\nimport { Persona, XPersona } from \"./persona\"\n\n/** Create a component. */\nexport interface Component {\n  /** Text block. */\n  text?: Text\n  /** Extra-large sized text block. */\n  text_xl?: TextXl\n  /** Large sized text block. */\n  text_l?: TextL\n  /** Medium sized text block. */\n  text_m?: TextM\n  /** Small sized text block. */\n  text_s?: TextS\n  /** Extra-small sized text block. */\n  text_xs?: TextXs\n  /** Label. */\n  label?: Label\n  /** Separator. */\n  separator?: Separator\n  /** Progress bar. */\n  progress?: Progress\n  /** Message bar. */\n  message_bar?: MessageBar\n  /** Textbox. */\n  textbox?: Textbox\n  /** Checkbox. */\n  checkbox?: Checkbox\n  /** Toggle. */\n  toggle?: Toggle\n  /** Choice group. */\n  choice_group?: ChoiceGroup\n  /** Checklist. */\n  checklist?: Checklist\n  /** Dropdown. */\n  dropdown?: Dropdown\n  /** Combobox. */\n  combobox?: Combobox\n  /** Slider. */\n  slider?: Slider\n  /** Spinbox. */\n  spinbox?: Spinbox\n  /** Date picker. */\n  date_picker?: DatePicker\n  /** Color picker. */\n  color_picker?: ColorPicker\n  /** Button. */\n  button?: Button\n  /** Button set. */\n  buttons?: Buttons\n  /** File upload. */\n  file_upload?: FileUpload\n  /** Table. */\n  table?: Table;\n  /** Link. */\n  link?: Link\n  /** Tabs. */\n  tabs?: Tabs;\n  /** Expander. */\n  expander?: Expander\n  /** Frame. */\n  frame?: Frame\n  /** Markup */\n  markup?: Markup\n  /** Template */\n  template?: Template\n  /** Picker.*/\n  picker?: Picker\n  /** Range Slider. */\n  range_slider?: RangeSlider\n  /** Stepper. */\n  stepper?: Stepper\n  /** Visualization. */\n  visualization?: Visualization\n  /** Vega-lite Visualization. */\n  vega_visualization?: VegaVisualization\n  /** Stats */\n  stats?: Stats\n  /** Inline components */\n  inline?: Inline\n  /** Image */\n  image?: Image\n  /** Persona. */\n  persona?: Persona\n}\n\n/** Create an inline (horizontal) list of components. */\ninterface Inline {\n  /** The components laid out inline. */\n  items: Component[]\n  /** Specifies how to lay out the individual components. Defaults to 'start'. */\n  justify?: 'start' | 'end'\n  /** Whether to display the components inset from the parent form, with a contrasting background. */\n  inset?: B\n}\n\n/** Create a form. */\ninterface State {\n  /** The components in this form. */\n  items: Packed<Component[]>\n  /** The title for this card. */\n  title?: S\n}\n\nconst\n  defaults: Partial<State> = { items: [] },\n  css = stylesheet({\n    card: {\n      padding: 15,\n    },\n    vertical: {\n      display: 'flex',\n      flexDirection: 'column',\n      flexGrow: 1,\n      $nest: {\n        '> [data-visible=\"true\"] ~ div': {\n          marginTop: 10\n        },\n      }\n    },\n    horizontal: {\n      display: 'flex',\n      alignItems: 'center',\n      $nest: {\n        '> [data-visible=\"true\"] ~ div': {\n          marginLeft: 25\n        }\n      }\n    },\n    inset: {\n      background: cssVar('$page'),\n      padding: padding(10, 15)\n    },\n    horizontalRight: {\n      justifyContent: 'flex-end',\n    },\n  })\n\nexport enum XComponentAlignment { Top, Left, Right }\n\nexport const\n  XComponents = ({ items, alignment, inset }: { items: Component[], alignment?: XComponentAlignment, inset?: B }) => {\n    const\n      components = items.map((m: any, i) => {\n        const\n          // All form items are wrapped by their component name (first and only prop of \"m\").\n          [componentKey] = Object.keys(m),\n          { name, visible = true, width = 'auto' } = m[componentKey],\n          visibleStyles: React.CSSProperties = visible ? {} : { display: 'none' }\n\n        return (\n          // Recreate only if name or position within form items changed, update otherwise.\n          <div key={name || `${componentKey}-${i}`} data-visible={visible} style={{ ...visibleStyles, width }}>\n            <XComponent model={m} />\n          </div>\n        )\n      }),\n      className = alignment === XComponentAlignment.Left\n        ? clas(css.horizontal, inset ? css.inset : '')\n        : alignment === XComponentAlignment.Right\n          ? clas(css.horizontal, css.horizontalRight, inset ? css.inset : '')\n          : css.vertical\n    return <div className={className}>{components}</div>\n  },\n  XInline = ({ model: m }: { model: Inline }) => (\n    <XComponents\n      items={m.items}\n      alignment={m.justify === 'end' ? XComponentAlignment.Right : XComponentAlignment.Left}\n      inset={m.inset}\n    />\n  )\n\n\nconst\n  XComponent = ({ model: m }: { model: Component }) => {\n    if (m.text) return <XToolTip content={m.text.tooltip} expand={false}><XText name={m.text.name} content={m.text.content} size={m.text.size} /></XToolTip>\n    if (m.text_xl) return <XToolTip content={m.text_xl.tooltip} expand={false}><XText name={m.text_xl.name} content={m.text_xl.content} size='xl' commands={m.text_xl.commands} /></XToolTip>\n    if (m.text_l) return <XToolTip content={m.text_l.tooltip} expand={false}><XText name={m.text_l.name} content={m.text_l.content} size='l' commands={m.text_l.commands} /></XToolTip>\n    if (m.text_m) return <XToolTip content={m.text_m.tooltip} expand={false}><XText name={m.text_m.name} content={m.text_m.content} /></XToolTip>\n    if (m.text_s) return <XToolTip content={m.text_s.tooltip} expand={false}><XText name={m.text_s.name} content={m.text_s.content} size='s' /></XToolTip>\n    if (m.text_xs) return <XToolTip content={m.text_xs.tooltip} expand={false}><XText name={m.text_xs.name} content={m.text_xs.content} size='xs' /></XToolTip>\n    if (m.label) return <XToolTip content={m.label.tooltip} expand={false}><XLabel model={m.label} /></XToolTip>\n    if (m.link) return <XToolTip content={m.link.tooltip} expand={false}><XLink model={m.link} /></XToolTip>\n    if (m.separator) return <XSeparator model={m.separator} />\n    if (m.progress) return <XToolTip content={m.progress.tooltip}><XProgress model={m.progress} /></XToolTip>\n    if (m.message_bar) return <XMessageBar model={m.message_bar} />\n    if (m.textbox) return <XToolTip content={m.textbox.tooltip}><XTextbox model={m.textbox} /></XToolTip>\n    if (m.checkbox) return <XToolTip content={m.checkbox.tooltip} expand={false}><XCheckbox model={m.checkbox} /></XToolTip>\n    if (m.toggle) return <XToolTip content={m.toggle.tooltip} expand={false}><XToggle model={m.toggle} /></XToolTip>\n    if (m.choice_group) return <XToolTip content={m.choice_group.tooltip}><XChoiceGroup model={m.choice_group} /></XToolTip>\n    if (m.dropdown) return <XToolTip content={m.dropdown.tooltip}><XDropdown model={m.dropdown} /></XToolTip>\n    if (m.checklist) return <XToolTip content={m.checklist.tooltip}><XChecklist model={m.checklist} /></XToolTip>\n    if (m.combobox) return <XToolTip content={m.combobox.tooltip}><XCombobox model={m.combobox} /></XToolTip>\n    if (m.slider) return <XToolTip content={m.slider.tooltip}><XSlider model={m.slider} /></XToolTip>\n    if (m.spinbox) return <XToolTip content={m.spinbox.tooltip} expand={false}><XSpinbox model={m.spinbox} /></XToolTip>\n    if (m.date_picker) return <XToolTip content={m.date_picker.tooltip}><XDatePicker model={m.date_picker} /></XToolTip>\n    if (m.color_picker) return <XToolTip content={m.color_picker.tooltip}><XColorPicker model={m.color_picker} /></XToolTip>\n    if (m.file_upload) return <XToolTip content={m.file_upload.tooltip}><XFileUpload model={m.file_upload} /></XToolTip>\n    if (m.table) return <XToolTip content={m.table.tooltip}><XTable model={m.table} /></XToolTip>\n    if (m.buttons) return <XButtons model={m.buttons} />\n    if (m.tabs) return <XTabs model={m.tabs} />\n    if (m.button) return <XToolTip content={m.button.tooltip} showIcon={false} expand={false}><XStandAloneButton model={m.button} /></XToolTip>\n    if (m.expander) return <XExpander model={{ ...m.expander }} /> //HACK: Force new props reference on every update.\n    if (m.frame) return <XFrame model={m.frame} />\n    if (m.markup) return <XMarkup model={m.markup} />\n    if (m.template) return <XTemplate model={m.template} />\n    if (m.picker) return <XToolTip content={m.picker.tooltip}><XPicker model={m.picker} /></XToolTip>\n    if (m.range_slider) return <XToolTip content={m.range_slider.tooltip}><XRangeSlider model={m.range_slider} /></XToolTip>\n    if (m.stepper) return <XToolTip content={m.stepper.tooltip}><XStepper model={m.stepper} /></XToolTip>\n    if (m.visualization) return <XVisualization model={m.visualization} />\n    if (m.vega_visualization) return <XVegaVisualization model={m.vega_visualization} />\n    if (m.stats) return <XStats model={m.stats} />\n    if (m.inline) return <XInline model={m.inline} />\n    if (m.image) return <XImage model={m.image} />\n    if (m.persona) return <XPersona model={m.persona} />\n    return <Fluent.MessageBar messageBarType={Fluent.MessageBarType.severeWarning}>This component could not be rendered.</Fluent.MessageBar>\n  }\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const\n          s = { ...defaults, ...state },\n          title = s.title,\n          items = unpack<Component[]>(s.items) // XXX ugly\n\n        return (\n          <div data-test={name} className={css.card}>\n            {title && <div className='wave-s12 wave-w6'>{title}</div>}\n            <XComponents items={items} />\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('form', View)","import * as Fluent from '@fluentui/react'\nimport { Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { cssVar } from './theme'\nimport { wave } from './ui'\n\n\n/** \n  * Create an individual's persona or avatar, a visual representation of a person across products. \n  * Can be used to display an individual's avatar (or a composition of the persons initials on a background color), their name or identification, and online status.\n*/\nexport interface Persona {\n  /** Primary text, displayed next to the persona coin. */\n  title: S\n  /** Secondary text, displayed under the title. */\n  subtitle?: S\n  /** Tertiary text, displayed under the subtitle. Only visible for sizes >= 'm'. */\n  caption?: S\n  /** The size of the persona coin. Defaults to 'm'. */\n  size?: 'xl' | 'l' | 'm' | 's' | 'xs'\n  /** Image, URL or base64-encoded (`data:image/png;base64,???`). */\n  image?: S\n  /** Initials, if `image` is not specified. */\n  initials?: S\n  /** Initials background color (CSS-compatible string). */\n  initials_color?: S\n  /** An identifying name for this component. */\n  name?: Id\n}\n\nconst fluentSizes: { [K in 'xs' | 's' | 'm' | 'l' | 'xl']: Fluent.PersonaSize } = {\n  'xs': Fluent.PersonaSize.size48,\n  's': Fluent.PersonaSize.size56,\n  'm': Fluent.PersonaSize.size72,\n  'l': Fluent.PersonaSize.size100,\n  'xl': Fluent.PersonaSize.size120,\n}\n\nexport const XPersona = ({ model }: { model: Persona }) => {\n  const onClick = () => {\n    if (model.name) {\n      if (model.name.startsWith('#')) {\n        window.location.hash = model.name.substr(1)\n        return\n      }\n      wave.args[model.name] = true\n      wave.push()\n    }\n  }\n\n  return (\n    <div data-test={model.name} onClick={onClick}>\n      <Fluent.Persona\n        styles={{ root: { cursor: model.name ? 'pointer' : 'initial' } }}\n        text={model.title}\n        secondaryText={model.subtitle}\n        tertiaryText={model.caption}\n        imageUrl={model.image}\n        imageInitials={model.initials}\n        initialsColor={cssVar(model.initials_color)}\n        size={model.size ? fluentSizes[model.size] : Fluent.PersonaSize.size72}\n      />\n    </div>\n  )\n}\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { B, Box, box, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { Component, XComponents } from './form'\nimport { bond, wave } from './ui'\n\nexport const dialogB: Box<Dialog | null> = box(null)\n\n/**\n * A dialog box (Dialog) is a temporary pop-up that takes focus from the page or app\n * and requires people to interact with it. Its primarily used for confirming actions,\n * such as deleting a file, or asking people to make a choice.\n */\nexport interface Dialog {\n  /** The dialog's title. */\n  title: S\n  /** The components displayed in this dialog. */\n  items: Component[]\n  /** The width of the dialog, e.g. '400px', defaults to '600px'. */\n  width?: S\n  /** True if the dialog should have a closing 'X' button at the top right corner. */\n  closable?: B\n  /** True to disable all actions and commands behind the dialog. Blocking dialogs should be used very sparingly, only when it is critical that the user makes a choice or provides information before they can proceed. Blocking dialogs are generally used for irreversible or potentially destructive tasks. Defaults to false. */\n  blocking?: B\n  /** Dialog with large header banner, mutually exclusive with `closable` prop. Defaults to false. */\n  primary?: B\n  /** An identifying name for this component. */\n  name?: Id\n  /** The events to capture on this dialog. */\n  events?: S[]\n}\n\nexport default bond(() => {\n  const\n    onDismiss = () => {\n      const { closable, name, events } = dialogB() || {}\n      if (closable && name) {\n        events?.forEach(e => {\n          if (e === 'dismissed') wave.emit(name, e, true)\n        })\n      }\n      dialogB(null)\n    },\n    render = () => {\n      const\n        { title, width = '600px', items = [], closable, primary, blocking } = dialogB() || {},\n        dialogContentProps: Fluent.IDialogContentProps = {\n          title,\n          onDismiss,\n          type: closable\n            ? Fluent.DialogType.close\n            : primary\n              ? Fluent.DialogType.largeHeader\n              : Fluent.DialogType.normal\n        }\n\n      return (\n        <Fluent.Dialog hidden={!dialogB()} dialogContentProps={dialogContentProps} modalProps={{ isBlocking: blocking }} minWidth={width} maxWidth={width}>\n          <XComponents items={items} />\n        </Fluent.Dialog>\n      )\n    }\n  return { render, dialogB }\n})","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nexport const showNotification = async (notificationText: string) => {\n  // TODO: Decide on fallback when user's browser does not support Notification API.\n  if (!('Notification' in window)) return\n  else if (Notification.permission === 'granted') new Notification(notificationText)\n  else if (Notification.permission !== 'denied') {\n    if (await Notification.requestPermission() === 'granted') new Notification(notificationText)\n  }\n}","import { B, Dict, S } from 'h2o-wave'\n\n/**\n * Create a reference to an external Javascript file to be included on a page.\n */\nexport interface Script {\n  /** The URI of an external script. */\n  path: S\n  /** Whether to fetch and load this script in parallel to parsing and evaluated as soon as it is available. */\n  asynchronous?: B\n  /** The CORS setting for this script. See https://developer.mozilla.org/en-US/docs/Web/HTML/Attributes/crossorigin */\n  cross_origin?: S\n  /** Indicates which referrer to send when fetching the script. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/script */\n  referrer_policy?: S\n  /** The cryptographic hash to verify the script's integrity. See https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity */\n  integrity?: S\n}\n\n/**\n * Create a block of inline Javascript to be executed immediately on a page.\n */\nexport interface InlineScript {\n  /** The Javascript source code to be executed. */\n  content: S\n  /** The names of modules required on the page's `window` global before running this script. */\n  requires?: S[]\n  /** The HTML elements required to be present on the page before running this script. Each 'target' can either be the ID of the element (`foo`) or a CSS selector (`#foo`, `.foo`, `table > td.foo`, etc.). */\n  targets?: S[]\n}\n\nlet executableScriptElement: HTMLScriptElement | null = null\n\nconst\n  installedScripts: Dict<B> = {},\n  installScript = (content: S) => {\n    if (executableScriptElement) {\n      executableScriptElement.remove()\n    }\n    const e = executableScriptElement = document.createElement('script')\n    e.type = 'text/javascript'\n    // HTML5 specifies that a <script> tag inserted with innerHTML should not execute.\n    // See https://developer.mozilla.org/en-US/docs/Web/API/Element/innerHTML#security_considerations\n    // See https://www.w3.org/TR/2008/WD-html5-20080610/dom.html#innerhtml0\n    e.appendChild(document.createTextNode(content))\n    document.body.appendChild(e)\n  },\n  hasModule = (p: S) => {\n    let d = window as any\n    for (const k of p.split('.')) {\n      d = d[k]\n      if (!d) return false\n    }\n    return true\n  },\n  hasModules = (paths: S[]) => !paths.some(p => !hasModule(p)),\n  hasTarget = (selector: S) => document.getElementById(selector) || document.querySelector(selector),\n  hasTargets = (selectors: S[]) => !selectors.some(id => !hasTarget(id))\n\nexport const\n  installScripts = (scripts: Script[]) => {\n    scripts.forEach(({ path, asynchronous, cross_origin, referrer_policy, integrity }) => {\n      if (installedScripts[path]) return // load exactly once\n      const e = document.createElement('script')\n      e.type = 'text/javascript'\n      e.src = path\n      if (asynchronous) e.async = true\n      if (cross_origin) e.crossOrigin = cross_origin\n      if (referrer_policy) e.referrerPolicy = referrer_policy\n      if (integrity) e.integrity = integrity\n      document.body.appendChild(e)\n      e.addEventListener('load', () => {\n        installedScripts[path] = true\n      })\n    })\n  },\n  executeScript = ({ content, requires, targets }: InlineScript) => {\n    const\n      resolved = () => {\n        if (requires && requires.length) {\n          if (!hasModules(requires)) return false\n        }\n        if (targets && targets.length) {\n          if (!hasTargets(targets)) return false\n        }\n        return true\n      }\n\n    if (resolved()) {\n      installScript(content)\n      return\n    }\n\n    let tries = 0\n    const\n      t = setInterval(() => {\n        if (resolved()) {\n          clearInterval(t)\n          installScript(content)\n        } else {\n          tries++\n          if (tries > 100) {\n            clearInterval(t)\n            console.error('Failed to execute inline script: one or more of the requirements were not found.')\n          }\n        }\n      }, 10)\n  }\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { Box, box, Id, S } from 'h2o-wave'\nimport React from 'react'\nimport { Component, XComponents } from './form'\nimport { bond, wave } from './ui'\n\nexport const sidePanelB: Box<SidePanel | null> = box(null)\n\n/**\n * A dialog box (Dialog) is a temporary pop-up that takes focus from the page or app\n * and requires people to interact with it. Its primarily used for confirming actions,\n * such as deleting a file, or asking people to make a choice.\n */\nexport interface SidePanel {\n  /** The side panel's title. */\n  title: S\n  /** The components displayed in this side panel. */\n  items: Component[]\n  /** The width of the dialog, e.g. '400px'. Defaults to '600px'. */\n  width?: S\n  /** An identifying name for this component. */\n  name?: Id\n  /** The events to capture on this side panel. */\n  events?: S[]\n}\n\nexport default bond(() => {\n  const\n    onDismiss = () => {\n      const\n        { name, events } = sidePanelB() || {},\n        ev = events?.find(e => e === 'dismissed')\n\n      if (ev && name) wave.emit(name, ev, true)\n      sidePanelB(null)\n    },\n    render = () => {\n      const { title, width = '600px', items = [] } = sidePanelB() || {}\n      return (\n        <Fluent.Panel isOpen={!!sidePanelB()} headerText={title} type={Fluent.PanelType.custom} customWidth={width} onDismiss={onDismiss}>\n          <XComponents items={items} />\n        </Fluent.Panel >\n      )\n    }\n  return { render, sidePanelB }\n})","import { on, Rec, S } from 'h2o-wave'\nimport { argsB } from './ui'\n\n/**\n * Configure user interaction tracking (analytics) for a page.\n */\nexport interface Tracker {\n  /** The tracking provider. Supported providers are `ga` (Google Analytics) and `gtag` (Google Global Site Tags or gtag.js) */\n  type: 'ga' | 'gtag'\n  /** The tracking ID or measurement ID. */\n  id: S\n}\n\nlet\n  tracker: Tracker | null = null\n\nconst\n  sanitize = (args: Rec): Rec => {\n    const r: Rec = {}\n\n    for (const k in args) {\n      const v = args[k]\n      // Don't send actual values; only that certain elements were possibly interacted with.\n      if (v) r[k] = k === '#' ? v : true\n    }\n\n    return r\n  },\n  sendEvent = (args: Rec) => {\n    if (!tracker) return\n    switch (tracker.type) {\n      case 'ga':\n      case 'gtag':\n        {\n          const w = window as any\n          if (w.gtag) w.gtag('event', 'sync', sanitize(args))\n        }\n    }\n  }\n\nexport const\n  setupTracker = (t: Tracker) => {\n    if (tracker) return  // Setup only once for the lifetime of the page\n\n    switch (t.type) {\n      case 'ga':\n      case 'gtag':\n        {\n          const s = document.createElement('script')\n          s.type = 'text/javascript'\n          s.async = true\n          s.src = `https://www.googletagmanager.com/gtag/js?id=${t.id}`\n          document.body.appendChild(s)\n          s.addEventListener('load', () => {\n            const w = window as any\n            w.dataLayer = w.dataLayer || []\n            // eslint-disable-next-line prefer-rest-params\n            function gtag() { w.dataLayer.push(arguments) }\n            w.gtag = gtag\n            w.gtag('js', new Date())\n            w.gtag('config', t.id)\n          })\n        }\n        tracker = t\n    }\n  }\n\non(argsB, (args) => window.setTimeout((() => sendEvent(args)), 0))\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { box, disconnect, Id, Model, on, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { Dialog, dialogB } from './dialog'\nimport { cards } from './layout'\nimport { showNotification } from './notification'\nimport { executeScript, InlineScript, installScripts, Script } from './script'\nimport { SidePanel, sidePanelB } from './side_panel'\nimport { themeB } from './theme'\nimport { setupTracker, Tracker } from './tracking'\nimport { bond } from './ui'\n\n\nexport type FlexBox = Partial<{ zone: S, order: U, size: S, width: S, height: S }>\n\n\n/**\n * Create an inline CSS to be injected into a page.\n */\ninterface InlineStylesheet {\n  /** The CSS to be applied to this page. */\n  content: S\n  /** A valid media query to set conditions for when the style should be applied. More info at https://developer.mozilla.org/en-US/docs/Web/HTML/Element/style#attr-media. */\n  media?: S\n}\n\n/**\n * Create a reference to an external CSS file to be included on a page.\n */\ninterface Stylesheet {\n  /** The URI of an external stylesheet. */\n  path: S\n  /** A valid media query to set conditions for when the stylesheet should be loaded. More info at https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-media. */\n  media?: S\n  /** The CORS setting. See https://developer.mozilla.org/en-US/docs/Web/HTML/Element/link#attr-crossorigin */\n  cross_origin?: S\n}\n/**\n * Represents the layout structure for a page.\n */\nexport interface Layout {\n  /**\n   * The minimum viewport width at which to use this layout.\n   * Values must be pixel widths (e.g. '0px', '576px', '768px') or a named preset.\n   * The named presets are:\n   * 'xs': '0px' for extra small devices (portrait phones),\n   * 's': '576px' for small devices (landscape phones),\n   * 'm': '768px' for medium devices (tablets),\n   * 'l': '992px' for large devices (desktops),\n   * 'xl': '1200px' for extra large devices (large desktops).\n   *\n   * A breakpoint value of 'xs' (or '0') matches all viewport widths, unless other breakpoints are set.\n  */\n  breakpoint: S\n  /** The zones in this layout. Each zones can in turn contain sub-zones. */\n  zones: Zone[]\n  /** The width of the layout. Defaults to `100%`. */\n  width?: S\n  /** The minimum width of the layout. */\n  min_width?: S\n  /** The maximum width of the layout. */\n  max_width?: S\n  /** The height of the layout. Defaults to `auto`. */\n  height?: S\n  /** The minimum height of the layout. */\n  min_height?: S\n  /** The maximum height of the layout. */\n  max_height?: S\n  /** An identifying name for this zone. */\n  name?: Id\n}\n\n/**\n * Represents an zone within a page layout.\n */\nexport interface Zone {\n  /** An identifying name for this zone. */\n  name: Id\n  /** The size of this zone. */\n  size?: S\n  /** Layout direction. */\n  direction?: 'row' | 'column'\n  /** Layout strategy for main axis. */\n  justify?: 'start' | 'end' | 'center' | 'between' | 'around'\n  /** Layout strategy for cross axis. */\n  align?: 'start' | 'end' | 'center' | 'stretch'\n  /** Wrapping strategy. */\n  wrap?: 'start' | 'end' | 'center' | 'between' | 'around' | 'stretch'\n  /** The sub-zones contained inside this zone. */\n  zones?: Zone[]\n}\n\n/**\n * Represents page-global state.\n *\n * This card is invisible.\n * It is used to control attributes of the active page.\n*/\ninterface State {\n  /** The title of the page. */\n  title?: S\n  /** Refresh rate in seconds. A value of 0 turns off live-updates. Values != 0 are currently ignored (reserved for future use). */\n  refresh?: U\n  /** Display a desktop notification. */\n  notification?: S\n  /** Redirect the page to a new URL. */\n  redirect?: S\n  /** \n   * Shortcut icon path. Preferably a `.png` file (`.ico` files may not work in mobile browsers). \n   * Not supported in Safari.\n  */\n  icon?: S\n  /** The layouts supported by this page. */\n  layouts?: Layout[]\n  /** Display a dialog on the page. */\n  dialog?: Dialog\n  /** Display a side panel on the page. */\n  side_panel?: SidePanel\n  /** Specify the name of the theme (color scheme) to use on this page. One of 'light' or 'neon'. */\n  theme?: S\n  /** Configure a tracker for the page (for web analytics). */\n  tracker?: Tracker\n  /** External Javascript files to load into the page. */\n  scripts?: Script[]\n  /** Javascript code to execute on this page. */\n  script?: InlineScript\n  /** CSS stylesheet to be applied to this page. */\n  stylesheet?: InlineStylesheet\n  /** External CSS files to load into the page. */\n  stylesheets?: Stylesheet[]\n}\n\nconst\n  windowTitleB = box(''),\n  windowIconB = box('')\n\non(windowTitleB, t => window.document.title = t)\non(windowIconB, icon => {\n  const\n    iconLink = document.querySelector(\"link[rel*='icon']\") as HTMLLinkElement,\n    touchIconLink = document.querySelector(\"link[rel*='apple-touch-icon']\") as HTMLLinkElement\n  if (iconLink) iconLink.href = icon\n  // Not working as of Feb 2021 since Safari does not support dynamic favicon changes.\n  if (touchIconLink) touchIconLink.href = icon\n})\n\nexport const\n  layoutsB = box<Layout[]>([]),\n  preload = ({ state }: Model<State>) => {\n    const {\n      title,\n      icon,\n      refresh,\n      notification,\n      redirect,\n      layouts,\n      dialog,\n      side_panel,\n      theme,\n      tracker,\n      scripts,\n      script,\n      stylesheet,\n      stylesheets\n    } = state\n\n    if (redirect) {\n      try {\n        const\n          { location } = window,\n          url = new URL(`${location.origin}${location.pathname}${redirect}`)\n        if (redirect === url.hash) {\n          location.hash = redirect\n        } else {\n          location.replace(redirect)\n        }\n      } catch (e) {\n        console.error(`Could not redirect: ${redirect} is an invalid URL`, e)\n      }\n      delete state.redirect\n    }\n\n    dialogB(dialog ? { ...dialog } : null)\n    sidePanelB(side_panel ? { ...side_panel } : null)\n\n    if (title) windowTitleB(title)\n    if (icon) windowIconB(icon)\n    if (typeof refresh === 'number' && refresh === 0) disconnect()\n    if (theme) themeB(theme)\n    if (notification) showNotification(notification)\n    if (tracker) setupTracker(tracker)\n    if (layouts) layoutsB(layouts)\n    if (scripts) installScripts(scripts)\n    if (script) {\n      delete state.script\n      executeScript(script)\n    }\n    if (stylesheet) {\n      const styleEl = document.createElement('style')\n      const { content, media } = stylesheet\n      styleEl.innerText = content\n      if (media) styleEl.media = media\n      document.head.appendChild(styleEl)\n      delete state.stylesheet\n    }\n    if (stylesheets) {\n      stylesheets.forEach(({ path, media, cross_origin }) => {\n        const linkEl = document.createElement('link')\n        linkEl.rel = 'stylesheet'\n        linkEl.href = path\n        linkEl.as = 'style'\n        if (media) linkEl.media = media\n        if (cross_origin) linkEl.crossOrigin = cross_origin\n        document.head.appendChild(linkEl)\n      })\n      delete state.stylesheets\n    }\n  }\n\nexport const View = bond(() => ({ render: () => <></> }))\n\ncards.register('meta', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { DialogType, IDropdownOption } from '@fluentui/react'\nimport { B, Box, box, Card, Dict, Model, Page, parseU, S, U, WaveEventType, xid } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cardDefs } from './defs'\nimport { defaultLayoutDef, editorActionB, EditorActionT, LayoutDef, layoutDefs, noAction, pickCard } from './editing'\nimport { cards } from './layout'\nimport { FlexBox, Layout, layoutsB, Zone } from './meta'\nimport { border, cssVar } from './theme'\nimport { bond, contentB, wave } from './ui'\n\n/**\n * WARNING: Experimental and subject to change.\n * Do not use in production sites!\n *\n * Create a card that enables WYSIWYG editing on a page.\n * Adding this card to a page makes the page editable by end-users.\n */\ninterface State {\n  /** The editing mode. Defaults to `public`.*/\n  mode: 'public' | 'private'\n}\n\nconst\n  css = stylesheet({\n    fab: {\n      position: 'fixed',\n      right: 20,\n      bottom: 20,\n      width: 56,\n      height: 56,\n      color: cssVar('$card'),\n      background: cssVar('$text'),\n      borderRadius: '50%',\n      fontSize: 20,\n      cursor: 'pointer',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      boxShadow: `0px 3px 5px ${cssVar('$text0')}`,\n      $nest: {\n        '&:hover': {\n          boxShadow: `0px 12px 20px ${cssVar('$text2')}`,\n        }\n      },\n    },\n    panelActions: {\n      marginTop: 10,\n    },\n    cards: {\n      display: 'flex',\n      flexWrap: 'wrap',\n      justifyContent: 'flex-start',\n      alignItems: 'flex-start',\n      alignContent: 'flex-start',\n    },\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n      justifyContent: 'center',\n      cursor: 'pointer',\n      margin: 3,\n      padding: 3,\n      border: border(1, cssVar('$text3')),\n      $nest: {\n        '&:hover': {\n          backgroundColor: cssVar('$text0'),\n        }\n      }\n    },\n    cardIcon: {\n      width: 50,\n      height: 50,\n      fontSize: 22,\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      color: cssVar('$text7'),\n    },\n    cardCaption: {\n      marginTop: 5,\n      fontSize: 11,\n      width: 82,\n      whiteSpace: 'nowrap',\n      overflow: 'hidden',\n      textOverflow: 'ellipsis',\n      textAlign: 'center',\n    }\n  }),\n  labelize = (s: S) => s.split('_').map(s => s.charAt(0).toUpperCase() + s.slice(1)).join(' '),\n  toDict = <T extends unknown>(xs: T[], k: (x: T) => S): Dict<T> => {\n    const d: Dict<T> = {}\n    for (const x of xs) d[k(x)] = x\n    return d\n  },\n  cardDefLookup = toDict(cardDefs, d => d.view),\n  parsePx = (s: S) => parseU(s.replace(/px$/, '')),\n  collectZones = (zoneNames: S[], zones: Zone[]) => {\n    for (const zone of zones) {\n      if (zone.zones) {\n        collectZones(zoneNames, zone.zones)\n      } else {\n        zoneNames.push(zone.name)\n      }\n    }\n  },\n  getActiveLayout = (): Layout => {\n    const layouts = layoutsB()\n    return layouts && layouts.length ? layouts[0] : defaultLayoutDef.layout\n  },\n  identifyLayoutDef = (layout: Layout): LayoutDef => {\n    return layoutDefs.find(ld => ld.layout.name === layout.name) ?? defaultLayoutDef\n  },\n  separatorStyle: Partial<Fluent.ISeparatorStyles> = {\n    root: {\n      marginTop: 15,\n    },\n  },\n  Divider = ({ children }: { children: React.ReactNode }) => <Fluent.Separator styles={separatorStyle}>{children}</Fluent.Separator>,\n  spinBoxStyle: Partial<Fluent.ISpinButtonStyles> = {\n    root: {\n      marginTop: 5,\n      marginBottom: 5,\n    },\n    labelWrapper: {\n      width: 90,\n    },\n  },\n  SpinBox = bond(({ label, defaultValue, min, max, step, onChange }: { label: S, defaultValue: U, min: U, max: U, step: U, onChange: (v: U) => void }) => {\n    const\n      parseValue = (s: string): U => {\n        const u = parseU(s)\n        return isNaN(u) ? 0 : u\n      },\n      onBlur = (e: React.FocusEvent<HTMLInputElement>) => {\n        onChange(parseValue(e.target.value))\n      },\n      onIncrement = (s: S) => {\n        const v = Math.min(max, parseValue(s) + step)\n        onChange(v)\n        return String(v)\n      },\n      onDecrement = (s: S) => {\n        const v = Math.max(min, parseValue(s) - step)\n        onChange(v)\n        return String(v)\n      },\n      render = () => {\n        return (\n          <Fluent.SpinButton\n            label={label}\n            min={min}\n            max={max}\n            step={step}\n            defaultValue={'' + defaultValue}\n            onBlur={onBlur}\n            onIncrement={onIncrement}\n            onDecrement={onDecrement}\n            styles={spinBoxStyle}\n          />\n        )\n      }\n    return { render }\n  }),\n  AttrPanelView = bond(({ view, card }: { view: S, card?: Card }) => {\n    const\n      { attrs } = cardDefLookup[view],\n      isNew = card ? false : true,\n      original: Dict<any> = {},\n      changes: Dict<any> = {},\n      zones: S[] = [],\n      layout = getActiveLayout()\n\n    collectZones(zones, layout.zones)\n\n    for (const { name, value } of attrs) original[name] = changes[name] = value\n\n    if (card) {\n      const { state } = card\n      for (const k in state) {\n        original[k] = changes[k] = state[k]\n      }\n    }\n\n    let cardName = card ? card.name : `${view}${(new Date()).toISOString()}`\n\n    const\n      onDismiss = () => { editorActionB(noAction) },\n      save = () => {\n        const page = wave.fork()\n        if (isNew) {\n          const card: Dict<any> = { ...{ view }, ...original, ...changes }\n          page.put(cardName, card)\n        } else {\n          for (const k in changes) {\n            const v = changes[k]\n            if (v !== original[k]) page.set(`${cardName} ${k}`, v)\n          }\n        }\n        page.push()\n        editorActionB(noAction)\n      },\n      goBack = () => { editorActionB(pickCard) },\n      abort = () => { editorActionB(noAction) },\n      onChangeCardName = ({ target }: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, v?: string) => {\n        cardName = v || (target as HTMLInputElement).value\n      },\n      renderFooter = () => (\n        <Fluent.Stack horizontal tokens={{ childrenGap: 10 }}>\n          <Fluent.PrimaryButton onClick={save}>{isNew ? 'Add card' : 'Save changes'}</Fluent.PrimaryButton>\n          <Fluent.DefaultButton onClick={isNew ? goBack : abort}>Back</Fluent.DefaultButton>\n        </Fluent.Stack>\n      ),\n      render = () => {\n        const\n          fields = attrs.map(attr => {\n            const { name } = attr\n            switch (attr.t) {\n              case 'textbox':\n                {\n                  const onChange = ({ target }: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, v?: string) => {\n                    changes[name] = v || (target as HTMLInputElement).value\n                  }\n                  return (\n                    <Fluent.TextField\n                      key={name}\n                      label={labelize(name)}\n                      defaultValue={changes[name]}\n                      onChange={onChange} />\n                  )\n                }\n              case 'textarea':\n                {\n                  const onChange = ({ target }: React.FormEvent<HTMLInputElement | HTMLTextAreaElement>, v?: string) => {\n                    changes[name] = v || (target as HTMLInputElement).value\n                  }\n                  return (\n                    <Fluent.TextField\n                      key={name}\n                      label={labelize(name)}\n                      defaultValue={changes[name]}\n                      multiline={true}\n                      onChange={onChange}\n                      styles={{ field: { minHeight: 300 } }} />\n                  )\n                }\n              case 'spinbox':\n                {\n                  const\n                    { min, max, step, value } = attr,\n                    defaultValue = (value < min) ? min : ((value > max) ? max : value),\n                    onChange = (v: U) => {\n                      changes[name] = v\n                    }\n\n                  changes[name] = defaultValue\n\n                  return (\n                    <SpinBox\n                      key={name}\n                      label={labelize(name) + ':'}\n                      min={min} max={max} step={step}\n                      defaultValue={changes[name]}\n                      onChange={onChange}\n                    />\n                  )\n                }\n              case 'record':\n                // TODO\n                return (\n                  <div key={name} />\n                )\n              case 'box':\n                {\n                  const\n                    zoneOptions: IDropdownOption[] = zones.map(key => ({ key, text: key })),\n                    changeBox = (f: (b: Dict<any>) => void) => {\n                      const b = JSON.parse(changes[name])\n                      f(b)\n                      changes[name] = JSON.stringify(b)\n                    },\n                    setBox = (k: keyof FlexBox, v: S | U) => changeBox(b => b[k] = v),\n                    unsetBox = (k: keyof FlexBox) => changeBox(b => { delete b[k] }),\n                    onZoneChange = (_e?: React.FormEvent<HTMLElement>, option?: Fluent.IDropdownOption) => {\n                      if (option) setBox('zone', option.key)\n                    },\n                    onOrderChange = (v: U) => {\n                      if (v) { setBox('order', v) } else { unsetBox('order') }\n                    },\n                    onSizeChange = (v: U) => {\n                      if (v) { setBox('size', `${v}`) } else { unsetBox('size') }\n                    },\n                    onWidthChange = (v: U) => {\n                      if (v) { setBox('width', `${v}px`) } else { unsetBox('width') }\n                    },\n                    onHeightChange = (v: U) => {\n                      if (v) { setBox('height', `${v}px`) } else { unsetBox('height') }\n                    },\n                    { zone: zone0, order: order0, size: size0, width: width0, height: height0 } = JSON.parse(changes[name]) as FlexBox\n                  return (\n                    <div key={name}>\n                      <Divider>Box</Divider>\n                      <Fluent.Dropdown label='Zone' options={zoneOptions} defaultSelectedKey={zone0} onChange={onZoneChange} />\n                      <SpinBox\n                        defaultValue={order0 ?? 0}\n                        label='Order:'\n                        min={0} max={25} step={1}\n                        onChange={onOrderChange}\n                      />\n                      <SpinBox\n                        defaultValue={size0 ? parseU(size0) : 0}\n                        label='Size:'\n                        min={0} max={25} step={1}\n                        onChange={onSizeChange}\n                      />\n                      <SpinBox\n                        defaultValue={width0 ? parsePx(width0) : 0}\n                        label='Width (px):'\n                        min={0} max={10000} step={10}\n                        onChange={onWidthChange}\n                      />\n                      <SpinBox\n                        defaultValue={height0 ? parsePx(height0) : 0}\n                        label='Height (px):'\n                        min={0} max={10000} step={10}\n                        onChange={onHeightChange}\n                      />\n                      <Divider>Properties</Divider>\n                    </div>\n                  )\n                }\n            }\n          })\n        return (\n          <Fluent.Panel\n            headerText={isNew ? 'Add card' : 'Edit card'}\n            isOpen={true}\n            isLightDismiss={true}\n            onDismiss={onDismiss}\n            onRenderFooterContent={renderFooter}\n            isFooterAtBottom={true}\n          >\n            <Divider>{labelize(view)} Card</Divider>\n            {isNew ? <Fluent.TextField label='Card Name' defaultValue={cardName} onChange={onChangeCardName} /> : null}\n            <div>{fields}</div>\n          </Fluent.Panel>\n        )\n      }\n    return { render }\n  }),\n  ConfirmDialog = bond(({ title, text, acceptCaption, cancelCaption, onAccept }: { title: S, text: S, acceptCaption: S, cancelCaption: S, onAccept: () => void }) => {\n    const\n      hiddenB = box(false),\n      cancel = () => { hiddenB(true) },\n      accept = () => {\n        onAccept()\n        hiddenB(true)\n      },\n      render = () => (\n        <Fluent.Dialog\n          hidden={hiddenB()}\n          onDismiss={cancel}\n          dialogContentProps={{ type: DialogType.normal, title, subText: text }}\n          modalProps={{ styles: { main: { maxWidth: 450 } } }}\n        >\n          <Fluent.DialogFooter>\n            <Fluent.DefaultButton onClick={cancel} text={cancelCaption} />\n            <Fluent.PrimaryButton onClick={accept} text={acceptCaption} />\n          </Fluent.DialogFooter>\n        </Fluent.Dialog>\n      )\n    return { render, hiddenB }\n  }),\n  PageSetupView = bond(({ pageSetupB }: { pageSetupB: Box<PageSetup> }) => {\n    const\n      pageSetup = pageSetupB(),\n      layoutOptions: Fluent.IDropdownOption[] = layoutDefs.map(({ name: key }) => ({ key, text: key })),\n      onLayoutChange = (_ev?: React.FormEvent<HTMLElement | HTMLInputElement>, option?: Fluent.IDropdownOption) => {\n        if (!option) return\n        const def = layoutDefs.find(d => d.name === option.key)\n        if (def) {\n          pageSetup.layoutDef = def\n          pageSetupB({ ...pageSetup })\n        }\n      },\n      onWidthChange = (width: U) => {\n        pageSetup.width = width\n        pageSetupB({ ...pageSetup })\n      },\n      render = () => (\n        <>\n          <Fluent.Dropdown\n            label='Page Layout'\n            options={layoutOptions}\n            defaultSelectedKey={pageSetup.layoutDef.name}\n            onChange={onLayoutChange} />\n          <SpinBox\n            defaultValue={pageSetup.width}\n            label='Page Width:'\n            min={0} max={4000} step={50}\n            onChange={onWidthChange}\n          />\n        </>\n      )\n\n    return { render }\n  })\n\ntype PageSetup = {\n  layoutDef: LayoutDef\n  width: U\n}\n\nexport const\n  LayoutPicker = bond(({ visibleB }: { visibleB: Box<B> }) => {\n    const\n      pageSetupB = box<PageSetup>({\n        layoutDef: defaultLayoutDef,\n        width: 0,\n      }),\n      accept = () => {\n        const\n          { layoutDef, width } = pageSetupB(),\n          layout: Layout = { ...layoutDef.layout },\n          page = wave.fork()\n\n        if (width) layout.width = `${width}px`\n\n        page.put('__editor__', { view: 'editor', box: '', mode: 'public' })\n        page.put('__meta__', { view: 'meta', box: '', layouts: [layout] })\n        page.push()\n      },\n      cancel = () => { visibleB(false) },\n      render = () => {\n        return (\n          <Fluent.Dialog\n            hidden={!visibleB()}\n            onDismiss={cancel}\n            dialogContentProps={{\n              type: Fluent.DialogType.largeHeader,\n              title: 'Edit this page?',\n              subText: \"Don't worry, you can always change these settings later.\",\n            }}\n            modalProps={{ isBlocking: false, styles: { main: { maxWidth: 450 } } }}\n          >\n            <PageSetupView pageSetupB={pageSetupB} />\n            <Fluent.DialogFooter>\n              <Fluent.DefaultButton onClick={cancel} text=\"Back to safety\" />\n              <Fluent.PrimaryButton onClick={accept} text=\"Start Editing\" />\n            </Fluent.DialogFooter>\n          </Fluent.Dialog >\n        )\n      }\n    return { render, visibleB }\n  }),\n  getActivePage = (): Page | null => {\n    const e = contentB()\n    if (e && e.t === WaveEventType.Page) return e.page\n    return null\n  },\n  View = bond(({ name, changed }: Model<State>) => {\n    const\n      addCard = () => { editorActionB(pickCard) },\n      onDismiss = () => { editorActionB(noAction) },\n      render = () => {\n        let content: JSX.Element | null = null\n        const\n          action = editorActionB()\n\n        switch (action.t) {\n          case EditorActionT.Add:\n            {\n              content = <AttrPanelView view={action.view} />\n            }\n            break\n          case EditorActionT.Edit:\n            {\n              const page = getActivePage()\n              if (page) {\n                const\n                  { name } = action,\n                  card = page.get(name)\n                if (card) content = <AttrPanelView view={card.state.view} card={card} />\n              }\n            }\n            break\n          case EditorActionT.Delete:\n            {\n              const\n                { name } = action,\n                onAccept = () => {\n                  const page = wave.fork()\n                  page.del(name)\n                  page.push()\n                }\n              content = <ConfirmDialog\n                key={xid()}\n                title='Delete Card?'\n                text='This card will be permanently deleted.'\n                acceptCaption='Delete Card'\n                cancelCaption=\"Don't delete\"\n                onAccept={onAccept}\n              />\n            }\n            break\n          case EditorActionT.Pick:\n            {\n              const\n                layout = getActiveLayout(),\n                pageSetupB = box<PageSetup>({\n                  layoutDef: identifyLayoutDef(layout),\n                  width: layout.width ? parsePx(layout.width) : 0,\n                }),\n                choices = cardDefs.map(({ view, icon }) => {\n                  const onClick = () => { editorActionB({ t: EditorActionT.Add, view }) }\n                  return (\n                    <div key={view} className={css.card} onClick={onClick}>\n                      <div className={css.cardIcon} >\n                        <Fluent.FontIcon iconName={icon} />\n                      </div>\n                      <div className={css.cardCaption}>{labelize(view)}</div>\n                    </div>\n                  )\n                }),\n                save = () => {\n                  const\n                    page = wave.fork(),\n                    { layoutDef, width } = pageSetupB(),\n                    layout = { ...layoutDef.layout }\n                  if (width) layout.width = `${width}px`\n                  page.set('__meta__ layouts', [layout])\n                  page.push()\n                },\n                renderFooter = () => (\n                  <Fluent.Stack horizontal tokens={{ childrenGap: 10 }}>\n                    <Fluent.PrimaryButton onClick={save}>Apply changes</Fluent.PrimaryButton>\n                  </Fluent.Stack>\n                )\n              content = (\n                <Fluent.Panel\n                  headerText='Edit this page'\n                  isLightDismiss={true}\n                  onDismiss={onDismiss}\n                  isOpen={true}\n                  onRenderFooterContent={renderFooter}\n                  isFooterAtBottom={true}\n                >\n                  <Divider>Add Content</Divider>\n                  <div className={css.cards}>{choices}</div>\n                  <Divider>Page Setup</Divider>\n                  <PageSetupView key={xid()} pageSetupB={pageSetupB} />\n                </Fluent.Panel>\n              )\n            }\n            break\n        }\n        return (\n          <>\n            <div data-test={name} className={css.fab} onClick={addCard} >\n              <Fluent.FontIcon iconName='WindowEdit' />\n            </div>\n            {content}\n          </>\n        )\n      }\n    return { render, changed, editorActionB }\n  })\n\ncards.register('editor', View)\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Data, Dict, Model, Rec, S } from 'h2o-wave'\nimport React from 'react'\nimport { cards, Repeat } from './layout'\nimport { bond } from './ui'\n\n/**\n * EXPERIMENTAL. DO NOT USE.\n * Create a card containing other cards laid out using a one-dimensional model with flexible alignemnt and wrapping capabilities.\n **/\ninterface State {\n  /** The child card type. */\n  item_view: S\n  /** The child card properties. */\n  item_props: Rec\n  /** Data for this card. */\n  data: Data\n  /** Layout direction. */\n  direction?: 'horizontal' | 'vertical'\n  /** Layout strategy for main axis. */\n  justify?: 'start' | 'end' | 'center' | 'between' | 'around'\n  /** Layout strategy for cross axis. */\n  align?: 'start' | 'end' | 'center' | 'baseline' | 'stretch'\n  /** Wrapping strategy. */\n  wrap?: 'start' | 'end' | 'center' | 'between' | 'around' | 'stretch'\n}\n\nconst\n  directions: Dict<S> = {\n    horizontal: 'row',\n    vertical: 'column',\n  },\n  justifications: Dict<S> = {\n    start: 'flex-start',\n    end: 'flex-end',\n    center: 'center',\n    between: 'space-between',\n    around: 'space-around',\n  },\n  alignments: Dict<S> = {\n    start: 'flex-start',\n    end: 'flex-end',\n    center: 'center',\n    baseline: 'baseline',\n    stretch: 'stretch',\n  },\n  wrappings: Dict<S> = {\n    start: 'flex-start',\n    end: 'flex-end',\n    center: 'center',\n    between: 'space-between',\n    around: 'space-around',\n    stretch: 'stretch',\n  },\n  toFlexStyle = (state: State): React.CSSProperties => {\n    const\n      css: React.CSSProperties = { display: 'flex' },\n      direction = directions[state.direction || ''],\n      justify = justifications[state.justify || ''],\n      align = alignments[state.align || ''],\n      wrap = wrappings[state.wrap || '']\n\n    if (direction) css.flexDirection = direction as any\n    if (justify) css.justifyContent = justify\n    if (align) css.alignItems = align\n    if (wrap) {\n      css.flexWrap = 'wrap'\n      css.alignContent = wrap\n    }\n    return css\n  }\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        // FIXME theme.merge()\n        return (\n          <div data-test={name} style={toFlexStyle(state)} >\n            <Repeat view={state.item_view} props={state.item_props} data={state.data} />\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('flex', View)\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { CardEffect, cards } from './layout'\nimport { Markdown } from './markdown'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      alignItems: 'center',\n    },\n  })\n\n\n/**\n * Render a page footer displaying a caption.\n * Footer cards are typically displayed at the bottom of a page.\n * :icon \"Footer\"\n */\ninterface State {\n  /**\n   * The caption. Supports markdown.\n   * :t \"textbox\"\n   * :value \"(c) Your Company, Inc.\"\n   **/\n  caption: S\n}\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const\n          { caption } = state\n\n        return (\n          <div data-test={name} className={css.card}>\n            <div className='wave-s13'><Markdown source={caption} /></div>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('footer', View, { effect: CardEffect.Transparent })\n\n\n\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as d3 from 'd3'\nimport { Data, Dict, F, Model, Rec, Recs, S, U, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, grid } from './layout'\nimport { bond } from './ui'\n\n\n/** Create a card for displaying vector graphics. */\ninterface State {\n  /**\n   * The position and dimension of the SVG viewport, in user space.\n   * A space-separated list of four numbers: min-x, min-y, width and height.\n   * For example, '0 0 400 300'.\n   * See: https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/viewBox\n   */\n  view_box: S\n  /** Background layer for rendering static SVG elements. Must be packed to conserve memory. */\n  stage?: Recs\n  /** Foreground layer for rendering dynamic SVG elements. */\n  scene?: Data\n  /**\n   * The displayed width of the rectangular viewport.\n   * (Not the width of its coordinate system.)\n   */\n  width?: S\n  /**\n   * The displayed height of the rectangular viewport.\n   * (Not the height of its coordinate system.)\n   */\n  height?: S\n}\n\nconst\n  toAttributes = (d: any): [S, any] => {\n    const\n      t = d['_t'] || 'u',  // default to '<use/>'\n      a: any = {}\n    delete d['_t']\n\n    for (const k in d) a[k.replace(/_./g, x => x.substr(1).toUpperCase())] = d[k] // xml_attr to xmlAttr\n    return [t, a]\n  },\n  extract = (d: any, extra: S[]): any[] => {\n    const e: any[] = []\n    for (const k of extra) e.push(d[k])\n    for (const k of extra) delete d[k]\n    return e\n  },\n  nums = (s: S): F[] => s.split(/\\s/g).map(x => +x),\n  zip = <T1, T2, T3>(a: T1[], b: T2[], f: (a: T1, b: T2) => T3): T3[] => {\n    const\n      n = a.length,\n      c: T3[] = new Array(n)\n    for (let i = 0; i < n; i++) c[i] = f(a[i], b[i])\n    return c\n  },\n  zip3 = <T1, T2, T3, T4>(a: T1[], b: T2[], c: T3[], f: (a: T1, b: T2, c: T3) => T4): T4[] => {\n    const\n      n = a.length,\n      d: T4[] = new Array(n)\n    for (let i = 0; i < n; i++) d[i] = f(a[i], b[i], c[i])\n    return d\n  },\n  curves: Dict<d3.CurveFactory> = {\n    basis: d3.curveBasis,\n    'basis-closed': d3.curveBasisClosed,\n    'basis-open': d3.curveBasisOpen,\n    cardinal: d3.curveCardinal,\n    'cardinal-closed': d3.curveCardinalClosed,\n    'cardinal-open': d3.curveCardinalOpen,\n    smooth: d3.curveCatmullRom,\n    'smooth-closed': d3.curveCatmullRomClosed,\n    'smooth-open': d3.curveCatmullRomOpen,\n    linear: d3.curveLinear,\n    'linear-closed': d3.curveLinearClosed,\n    'monotone-x': d3.curveMonotoneX,\n    'monotone-y': d3.curveMonotoneY,\n    natural: d3.curveNatural,\n    step: d3.curveStep,\n    'step-after': d3.curveStepAfter,\n    'step-before': d3.curveStepBefore,\n  },\n  ret0 = () => 0,\n  get0 = (d: any) => d[0],\n  get1 = (d: any) => d[1],\n  get2 = (d: any) => d[2]\n\nconst\n  css = stylesheet({\n    card: {\n      position: 'absolute',\n      left: grid.gap, top: grid.gap, right: grid.gap, bottom: grid.gap,\n    },\n  })\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    type El = { d: S, o: S }\n\n    const\n      renderEl = (o: Rec, i: U) => {\n        const\n          [t, a] = toAttributes(o)\n        switch (t) {\n          case 'a': {\n            const\n              [r1, r2, a1, a2] = extract(a, ['r1', 'r2', 'a1', 'a2']),\n              d = d3.arc()({\n                innerRadius: r1,\n                outerRadius: r2,\n                startAngle: a1 * Math.PI / 180.0,\n                endAngle: a2 * Math.PI / 180.0,\n              })\n            return <path key={i} {...a} d={d} />\n          }\n          case 'c': return <circle key={i} {...a} />\n          case 'e': return <ellipse key={i} {...a} />\n          case 'i': return <image key={i} {...a} />\n          case 'l': return <line key={i} {...a} />\n          case 'p': return <path key={i} {...a} />\n          case 'pg': return <polygon key={i} {...a} />\n          case 'pl': return <polyline key={i} {...a} />\n          case 'r': return <rect key={i} {...a} />\n          case 's': {\n            const\n              [x, y, x0, y0, curve, radial] = extract(a, ['x', 'y', 'x0', 'y0', 'curve', 'radial']),\n              c = curves[curve] || d3.curveLinear,\n              d = radial\n                ? y0 === ''\n                  ? d3.radialArea().angle(get0).outerRadius(get1).innerRadius(ret0).curve(c)(zip(nums(x), nums(y), (x, y) => [x, y]) as any)\n                  : y0\n                    ? d3.radialArea().angle(get0).outerRadius(get2).innerRadius(get1).curve(c)(zip3(nums(x), nums(y0), nums(y), (x, y0, y) => [x, y0, y]) as any)\n                    : x0 === ''\n                      ? d3.radialArea().endAngle(get0).startAngle(ret0).radius(get1).curve(c)(zip(nums(x), nums(y), (x, y) => [x, y]) as any)\n                      : x0\n                        ? d3.radialArea().endAngle(get1).startAngle(get0).radius(get2).curve(c)(zip3(nums(x0), nums(x), nums(y), (x0, x, y) => [x0, x, y]) as any)\n                        : d3.radialLine().curve(c)(zip(nums(x), nums(y), (x, y) => [x, y]))\n                : y0 === ''\n                  ? d3.area().x(get0).y1(get1).y0(ret0).curve(c)(zip(nums(x), nums(y), (x, y) => [x, y]) as any)\n                  : y0\n                    ? d3.area().x(get0).y1(get2).y0(get1).curve(c)(zip3(nums(x), nums(y0), nums(y), (x, y0, y) => [x, y0, y]) as any)\n                    : x0 === ''\n                      ? d3.area().x1(get0).x0(ret0).y(get1).curve(c)(zip(nums(x), nums(y), (x, y) => [x, y]) as any)\n                      : x0\n                        ? d3.area().x1(get1).x0(get0).y(get2).curve(c)(zip3(nums(x0), nums(x), nums(y), (x0, x, y) => [x0, x, y]) as any)\n                        : d3.line().curve(c)(zip(nums(x), nums(y), (x, y) => [x, y]))\n            return <path key={i} {...a} d={d} />\n          }\n          case 't': {\n            const [text] = extract(a, ['text'])\n            return <text key={i} {...a} >{text}</text>\n          }\n          default: return <use key={i} {...a} />\n        }\n      },\n      render = () => {\n        const\n          { view_box, width, height, stage, scene } = state,\n          stageEls = stage ? unpack<Recs>(stage).map(renderEl) : [],\n          sceneEls = scene ? unpack<El[]>(scene).map(({ d, o }, i) => renderEl({\n            ...(d ? JSON.parse(d) : {}),\n            ...(o ? JSON.parse(o) : {}),\n          }, i)) : []\n        return (\n          <div data-test={name} className={css.card}>\n            <svg viewBox={view_box} width={width} height={height}>\n              <g>{stageEls}</g>\n              <g>{sceneEls}</g>\n            </svg>\n          </div>\n        )\n\n      }\n    return { render, changed }\n  })\n\ncards.register('graphics', View)\n\n\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, box, Data, Model, Rec, S, unpack, xid } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, CardView, Format } from './layout'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    body: {\n      flexGrow: 1,\n      overflow: 'auto',\n      $nest: {\n        '>*': {\n          borderBottom: '1px solid var(--text1)',\n          padding: '5px 0',\n        },\n      },\n    },\n    table: {\n      width: '100%',\n    }\n  })\n\n/** EXPERIMENTAL. DO NOT USE. */\ninterface State {\n  /** EXPERIMENTAL. DO NOT USE. */\n  title: S\n  /** EXPERIMENTAL. DO NOT USE. */\n  cells: Data\n  /** EXPERIMENTAL. DO NOT USE. */\n  data: Data\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const\n      render = () => {\n        let cells = unpack<any[]>(s.cells)\n\n        if (!Array.isArray(cells)) cells = [{ title: 'Data' }]\n\n        const\n          ths = cells.map((cell, i) => (<th key={i}>{cell.title}</th>)),\n          columns = cells.map(({ view, props, value }) => ({ view, props: unpack<Rec>(props), value })),\n          trs = unpack<Rec[]>(s.data).map((data, i) => {\n            const tds = columns.map(({ view, props, value }, j) => {\n              if (value != null) {\n                return <td><Format data={data} format={value} /></td>\n              } else {\n                const card: Model<any> = {\n                  name: xid(),\n                  state: { ...props, view, data },\n                  changed: box<B>(),\n                }\n                return <td><CardView key={j} card={card} /></td>\n              }\n            })\n            return (<tr key={i}>{tds}</tr>)\n          })\n\n        return (\n          <div data-test={name} className={css.card}>\n            <div className='wave-s12 wave-w6'>{s.title || 'Untitled'}</div>\n            <div className={css.body}>\n              <table className={css.table}>\n                <thead>\n                  <tr>{ths}</tr>\n                </thead>\n                <tbody>\n                  {trs}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('grid', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { INavLink, INavLinkGroup, Nav } from '@fluentui/react'\nimport { B, Id, Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { CardEffect, cards } from './layout'\nimport { bond, wave } from './ui'\n\n/** Create a navigation item. */\nexport interface NavItem {\n  /** The name of this item. Prefix the name with a '#' to trigger hash-change navigation. */\n  name: Id\n  /** The label to display. */\n  label: S\n  /** An optional icon to display next to the label. */\n  icon?: S\n  /** True if this item should be disabled. */\n  disabled?: B\n}\n\n/** Create a group of navigation items. */\nexport interface NavGroup {\n  /** The label to display for this group. */\n  label: S\n  /** The navigation items contained in this group. */\n  items: NavItem[]\n  /** Indicates whether nav groups should be rendered as collapsed initially */\n  collapsed?: B\n}\n\n/** Create a card containing a navigation pane. */\nexport interface State {\n  /** The navigation groups contained in this pane. */\n  items: NavGroup[]\n  /** The name of the active (highlighted) navigation item. */\n  value?: S\n}\n\nexport const\n  XNav = ({ items, value, hideNav }: State & { hideNav?: () => void }) => {\n    const groups = items.map((g): INavLinkGroup => ({\n      name: g.label,\n      collapseByDefault: g.collapsed,\n      links: g.items.map(({ name, label, icon, disabled }): INavLink => ({\n        key: name,\n        name: label,\n        icon,\n        disabled,\n        url: '',\n        onClick: () => {\n          if (hideNav) hideNav()\n          if (name.startsWith('#')) {\n            window.location.hash = name.substr(1)\n            return\n          }\n          wave.args[name] = true\n          wave.push()\n        }\n      }))\n    }))\n    return <Nav groups={groups} selectedKey={value} />\n  },\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const render = () => <div data-test={name}><XNav {...state} /></div>\n    return { render, changed }\n  })\n\ncards.register('nav', View, { effect: CardEffect.Flat })\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { FontIcon, Panel, PanelType } from '@fluentui/react'\nimport { B, Box, box, Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { CardEffect, cards } from './layout'\nimport { NavGroup, XNav } from './nav'\nimport { bond } from './ui'\nimport { clas, cssVar, padding } from './theme'\n\nconst\n  iconSize = 24,\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      alignItems: 'center',\n      padding: padding(8, 15),\n    },\n    lhs: {\n      width: iconSize + 15,\n      height: iconSize + 15,\n      display: 'flex',\n      alignItems: 'center',\n      cursor: 'default',\n    },\n    burger: {\n      $nest: {\n        '&:hover': {\n          color: cssVar('page'),\n          cursor: 'pointer',\n        },\n      },\n    },\n    icon: {\n      fontSize: iconSize,\n      height: iconSize,\n      width: iconSize,\n    },\n    rhs: {\n      flexGrow: 1\n    },\n    subtitle: {\n      position: 'relative',\n      top: -5, // nudge up slightly to account for padding\n    },\n  })\n\n\n/**\n * Render a page header displaying a title, subtitle and an optional navigation menu.\n * Header cards are typically used for top-level navigation.\n * :icon \"Header\"\n */\ninterface State {\n  /**\n   * The title.\n   * :t \"textbox\"\n   * :value \"Untitled Page\"\n   **/\n  title: S\n  /**\n   * The subtitle, displayed below the title.\n   * :t \"textbox\"\n   * :value \"Powered by H2O Wave.\"\n   **/\n  subtitle: S\n  /**\n   * The icon, displayed to the left.\n   * :t \"textbox\"\n   * :value \"AppIconDefault\"\n   **/\n  icon?: S\n  /**\n   * The icon's color.\n   * :t \"textbox\"\n   * :value \"yellow\"\n   **/\n  icon_color?: S\n  /**\n   * The navigation menu to display when the header's icon is clicked.\n   **/\n  nav?: NavGroup[]\n}\n\nconst\n  Navigation = bond(({ items, isOpenB }: { items: NavGroup[], isOpenB: Box<B> }) => {\n    const\n      hideNav = () => isOpenB(false),\n      render = () => (\n        <Panel\n          isLightDismiss\n          type={PanelType.smallFixedNear}\n          isOpen={isOpenB()}\n          onDismiss={hideNav}\n          hasCloseButton={false}\n        >\n          <XNav items={items} hideNav={hideNav} />\n        </Panel>\n      )\n    return { render, isOpenB }\n  })\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      navB = box(false),\n      showNav = () => navB(true),\n      render = () => {\n        const\n          { title, subtitle, icon, icon_color, nav } = state,\n          burger = nav\n            ? (\n              <div className={clas(css.lhs, css.burger)} onClick={showNav}>\n                <FontIcon className={css.icon} iconName='GlobalNavButton' />\n              </div>\n            ) : (\n              <div className={css.lhs}>\n                <FontIcon className={css.icon} iconName={icon ?? 'WebComponents'} style={{ color: cssVar(icon_color) }} />\n              </div>\n            )\n\n        return (\n          <div data-test={name} className={css.card}>\n            {burger}\n            <div className={css.rhs}>\n              <div className='wave-s24 wave-w3'>{title}</div>\n              <div className={clas(css.subtitle, 'wave-s12')}>{subtitle}</div>\n            </div>\n            {nav && <Navigation items={nav} isOpenB={navB} />}\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('header', View, { effect: CardEffect.Raised })\n\n\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { F, S, U } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\n\nconst css = stylesheet({\n  body: {\n    position: 'relative',\n  },\n  rail: {\n    position: 'absolute',\n    width: '100%',\n    opacity: 0.15,\n  },\n  bar: {\n    position: 'absolute',\n  }\n})\n\ninterface Props {\n  thickness: U\n  color: S\n  value: F\n}\n\nexport const ProgressBar = ({ thickness, color, value }: Props) => {\n  return (\n    <div className={css.body} style={{ height: thickness }}>\n      <div className={css.rail} style={{ height: thickness, backgroundColor: color }} />\n      <div className={css.bar} style={{ width: `${Math.round(value * 100)}%`, height: thickness, backgroundColor: color }} />\n    </div>\n  )\n}\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { F, Model, Rec, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format, grid } from './layout'\nimport { ProgressBar } from './parts/progress_bar'\nimport { clas, cssVar } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'space-between',\n      padding: grid.gap,\n    },\n    values: {\n      display: 'flex',\n      justifyContent: 'space-between',\n    },\n    aux_value: {\n      color: 'var(--text7)',\n    },\n    caption: {\n      color: 'var(--text5)',\n    },\n    captions: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      color: 'var(--text7)',\n    },\n  })\n\n/** Create a large captioned card displaying a primary value, an auxiliary value and a progress bar, with captions for each value. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The card's caption. */\n  caption: S\n  /** The primary value displayed. */\n  value: S\n  /** The auxiliary value, typically a target value. */\n  aux_value: S\n  /** The caption displayed below the primary value. */\n  value_caption: S\n  /** The caption displayed below the auxiliary value. */\n  aux_value_caption: S\n  /** The value of the progress bar, between 0 and 1. */\n  progress: F\n  /** The color of the progress bar. */\n  plot_color?: S\n  /** Data for this card. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const render = () => {\n      const data = unpack<Rec>(s.data)\n      return (\n        <div data-test={name} className={css.card}>\n          <Format data={data} format={s.title} className='wave-s12 wave-w6' />\n          <Format data={data} format={s.caption} className={clas(css.caption, 'wave-s13')} />\n          <div>\n            <div className={clas(css.values, 'wave-s18 wave-w3')}>\n              <div><Format data={data} format={s.value} /></div>\n              <Format data={data} format={s.aux_value} className={css.aux_value} />\n            </div>\n            <ProgressBar thickness={2} color={cssVar(s.plot_color)} value={s.progress} />\n            <div className={clas(css.captions, 'wave-s12')}>\n              <div><Format data={data} format={s.value_caption} /></div>\n              <div><Format data={data} format={s.aux_value_caption} /></div>\n            </div>\n          </div>\n        </div>\n      )\n    }\n    return { render, changed }\n  })\n\ncards.register('large_bar_stat', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Model, Rec, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format } from './layout'\nimport { clas } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: 15,\n    },\n    values: {\n      display: 'flex',\n      alignItems: 'baseline',\n    },\n    aux_value: {\n      marginLeft: 5,\n      color: 'var(--text6)',\n    },\n    caption: {\n      color: 'var(--text5)',\n    }\n  })\n\n/** Create a stat card displaying a primary value, an auxiliary value and a caption. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The primary value displayed. */\n  value: S\n  /** The auxiliary value displayed next to the primary value. */\n  aux_value: S\n  /** The caption displayed below the primary value. */\n  caption: S\n  /** Data for this card. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const render = () => (\n      <div data-test={name} className={css.card}>\n        <Format data={s.data} format={s.title} className='wave-s12 wave-w6' />\n        <div className={css.values}>\n          <Format data={s.data} defaultValue={s.value} format={s.value} className='wave-s40 wave-w2' />\n          <Format data={s.data} format={s.aux_value} className={css.aux_value} />\n        </div>\n        <Format data={s.data} format={s.caption} className={clas(css.caption, 'wave-s13')} />\n      </div>\n    )\n\n    return { render, changed }\n  })\n\ncards.register('large_stat', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Data, Model, Rec, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Repeat } from './layout'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    body: {\n      flexGrow: 1,\n      overflow: 'auto',\n      $nest: {\n        '>*': {\n          borderBottom: '1px solid var(--text1)',\n          padding: '5px 0',\n        },\n      },\n    }\n  })\n\n/**\n * EXPERIMENTAL. DO NOT USE.\n * Create a card containing other cards laid out in the form of a list (vertically, top-to-bottom).\n **/\ninterface State {\n  /** The title for this card. */\n  title: S\n  /** The child card type. */\n  item_view: S\n  /** The child card properties. */\n  item_props: Rec\n  /** Data for this card. */\n  data: Data\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const\n      render = () => {\n        return (\n          <div data-test={name} className={css.card}>\n            <div className='wave-s12 wave-w6'>{s.title}</div>\n            <div className={css.body}>\n              <Repeat view={s.item_view} props={s.item_props} data={s.data} />\n            </div>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('list', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Model, Rec, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format } from './layout'\nimport { clas, cssVar } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    item: {\n      display: 'flex',\n      justifyContent: 'space-between',\n    },\n    left: {\n      flexDirection: 'column',\n    },\n    right: {\n      flexDirection: 'column',\n    },\n    caption: {\n      color: cssVar('text5'),\n    },\n    aux_value: {\n      color: cssVar('text5'),\n    },\n  })\n\n/** EXPERIMENTAL. DO NOT USE. */\ninterface State {\n  /** EXPERIMENTAL. DO NOT USE. */\n  title: S\n  /** EXPERIMENTAL. DO NOT USE. */\n  caption: S\n  /** EXPERIMENTAL. DO NOT USE. */\n  value: S\n  /** EXPERIMENTAL. DO NOT USE. */\n  aux_value: S\n  /** EXPERIMENTAL. DO NOT USE. */\n  data: Rec\n}\n\nconst defaults: Partial<State> = {\n  title: 'Untitled',\n}\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const\n          s = { ...defaults, ...state },\n          data = unpack<Rec>(s.data)\n\n        return (\n          <div data-test={name} className={css.item}>\n            <div className={css.left}>\n              <Format data={data} format={s.title} className='wave-s12 wave-w6' />\n              <Format data={data} format={s.caption} className={clas(css.caption, 'wave-s13')} />\n            </div>\n            <div className={css.right}>\n              <Format data={data} format={s.value} className='wave-s12' />\n              <Format data={data} format={s.aux_value} className={clas(css.aux_value, 'wave-s13')} />\n            </div>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('list_item1', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { cards } from './layout'\nimport { bond } from './ui'\n\nexport const\n  View = bond(({ name, state, changed }: Model<Record<S, unknown>>) => {\n    const\n      render = () => (\n        <div data-test={name}>\n          <pre>{JSON.stringify(state, null, 2)}</pre>\n        </div>\n      )\n    return { render, changed }\n  })\n\ncards.register('', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Model, Rec, S, U, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, grid } from './layout'\nimport { bond, wave } from './ui'\n\nconst\n  pixelSize = 20,\n  canvasSize = pixelSize * 16,\n  palette = '#ffffff #bfbfbf #808080 #404040 #000000 #6699ff #3366cc #003399 #99cc33 #00cc00 #669900 #ffcc00 #ff9900 #ff6600 #cc0000'.split(/\\s+/g)\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n    },\n    canvas: {\n      display: 'flex', flexWrap: 'wrap',\n      width: canvasSize, height: canvasSize,\n    },\n    swatches: {\n      paddingTop: 10,\n      marginTop: 15,\n      borderTop: '1px solid #ccc',\n    },\n    pixel: {\n      display: 'inline-block',\n      width: pixelSize, height: pixelSize,\n    }\n  }),\n  defaultColorAt = (i: U): S => {\n    const\n      row = Math.floor(i / 16),\n      col = i % 16,\n      odd = col % 2 === 1\n    return row % 2 === 0\n      ? odd ? '#fff' : '#ddd'\n      : odd ? '#ddd' : '#fff'\n\n  }\n\n/**\n * WARNING: Experimental and subject to change.\n * Do not use in production sites!\n *\n * Create a card displaying a collaborative Pixel art tool.\n */\ninterface State {\n  /** The title for this card.*/\n  title: S\n  /** The data for this card.*/\n  data: Rec\n}\n\n/** A pixel. */\ninterface Pixel {\n  /** The pixel's color. */\n  color: S\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    let brush = '#000'\n    const\n      paint = (i: U) => {\n        const page = wave.fork()\n        page.set(`${name} data ${i}`, brush === 'none' ? null : [brush])\n        page.push()\n      },\n      render = () => {\n        const\n          data = unpack<(Pixel | null)[]>(s.data),\n          swatches = palette.map((c, i) => (\n            <div\n              key={i}\n              className={css.pixel}\n              style={{ backgroundColor: c }}\n              onClick={() => brush = c}\n            />\n          )),\n          pixels = data.map((p, i) => {\n            const color = p ? p.color : defaultColorAt(i)\n            return (\n              <div\n                key={i}\n                className={css.pixel}\n                style={{ backgroundColor: color }}\n                onClick={() => paint(i)}\n              />\n            )\n          })\n        return (\n          <div data-test={name} className={css.card}>\n            <div className='wave-s12 wave-w6'>{s.title}</div>\n            <div className={css.canvas}>{pixels}</div>\n            <div className={css.swatches}>\n              <div className={css.pixel}>\n                <svg onClick={() => brush = 'none'} viewBox=\"0 0 433.25 433.25\" width={pixelSize} height={pixelSize}>\n                  <path d=\"M418.4,192.331c19.8-19.8,19.8-51.9,0-71.7l-0.1-0.1l-78.6-78.3c-19.8-19.8-51.9-19.7-71.8,0l-169.5,169.6l-54.2,54.1 c-19.8,19.7-19.8,51.8-0.1,71.6l48.3,48.3H10c-5.5,0-10,4.5-10,10s4.5,10,10,10h297.4c5.5,0,10-4.5,10-10s-4.5-10-10-10H225 l23.9-23.7L418.4,192.331z M196.7,385.831h-76.1l-62.3-62.4c-12-12-11.9-31.4,0-43.4l47.1-47l122.2,122L196.7,385.831z M119.6,218.931l162.5-162.5c12-12,31.5-12,43.5,0l78.6,78.4c12,12,12,31.4,0,43.5l-162.4,162.8L119.6,218.931z\" />\n                </svg>\n              </div>\n              {swatches}\n            </div>\n          </div>)\n\n      }\n    return { render, changed }\n  })\n\ncards.register('pixel_art', View)\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Data, Model, Rec, S } from 'h2o-wave'\nimport React from 'react'\nimport { cards, Repeat } from './layout'\nimport { bond } from './ui'\n\n/**\n * EXPERIMENTAL. DO NOT USE.\n * Create a card containing other cards.\n **/\ninterface State {\n  /** EXPERIMENTAL. DO NOT USE. */\n  item_view: S\n  /** The child card properties. */\n  item_props: Rec\n  /** Data for this card. */\n  data: Data\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const\n      render = () => (\n        <div data-test={name}>\n          <Repeat view={s.item_view} props={s.item_props} data={s.data} />\n        </div>\n      )\n    return { render, changed }\n  })\n\ncards.register('repeat', View)\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Model, Packed, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { Component, XComponentAlignment, XComponents } from './form'\nimport { CardEffect, cards } from './layout'\nimport { Markdown } from './markdown'\nimport { clas } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      paddingTop: 5,\n    },\n    rhs: {\n      flexGrow: 1,\n      marginLeft: 15\n    },\n    subtitle: {\n      $nest: {\n        '>div>p': { margin: 0 },\n      },\n    },\n  })\n\n\n/**\n * Render a card displaying a title, a subtitle, and optional components.\n * Section cards are typically used to demarcate different sections on a page. \n */\ninterface State {\n  /** The title. */\n  title: S\n  /** The subtitle, displayed below the title. Supports Markdown. */\n  subtitle: S\n  /** The components to display in this card */\n  items?: Packed<Component[]>\n}\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const\n          { title, subtitle, items } = state,\n          components = unpack<Component[]>(items), // XXX ugly\n          form = items && (\n            <div className={css.rhs}>\n              <XComponents items={components} alignment={XComponentAlignment.Right} />\n            </div>\n          )\n\n        return (\n          <div data-test={name} className={css.card}>\n            <div>\n              <div className='wave-s14 wave-w6'>{title}</div>\n              <div className={clas(css.subtitle, 'wave-s12')}><Markdown source={subtitle} /></div>\n            </div>\n            {form}\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('section', View, { effect: CardEffect.Transparent })\n\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/* eslint-disable @typescript-eslint/no-non-null-asserted-optional-chain */\nimport * as d3 from 'd3'\nimport { F, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { debounce } from '../ui'\n\ninterface Props {\n  data: any[]\n  zeroValue?: F\n  value: S\n  color: S\n  curve: 'linear' | 'smooth' | 'step' | 'step-after' | 'step-before'\n}\n\nconst curves: Record<S, d3.CurveFactory> = {\n  linear: d3.curveLinear,\n  smooth: d3.curveCatmullRom,\n  step: d3.curveStep,\n  'step-after': d3.curveStepAfter,\n  'step-before': d3.curveStepBefore,\n}\n\nconst css = stylesheet({\n  container: {\n    width: '100%',\n    height: '100%',\n    position: 'relative',\n    flexGrow: 1,\n    minHeight: 32,\n  }\n})\n\nexport const MicroArea = ({ value, color, data, zeroValue, curve }: Props) => {\n  const\n    ref = React.useRef<HTMLDivElement>(null),\n    [minY, maxY] = React.useMemo(() => {\n      let [minY, maxY] = d3.extent<any, any>(data, d => d[value])\n\n      if (zeroValue != null) {\n        minY = Math.min(zeroValue, minY)\n        maxY = Math.max(zeroValue, maxY)\n      }\n      return [minY, maxY]\n    }, [data, value, zeroValue]),\n    [content, setContent] = React.useState<JSX.Element | null>(null),\n    renderViz = React.useCallback(() => {\n      if (!ref.current) return\n\n      const { width, height } = ref.current.getBoundingClientRect()\n      if (!height) {\n        // Safari has weird event loop meaning this React code can run before Layout phase is finished (flex items not positioned yet).\n        setTimeout(renderViz, 300)\n        return\n      }\n      const\n        scaleX = d3.scaleLinear().domain([0, data.length - 1]).range([0, width]),\n        scaleY = d3.scaleLinear().domain([minY, maxY]).range([height, 2]),\n        fcurve = curves[curve] || d3.curveLinear,\n\n        ln = d3.line<any>()\n          // .curve(d3.curveBasis) // XXX add support for this\n          .defined(d => d && d[value] != null)\n          .x((_, i) => scaleX(i))\n          .y(d => scaleY(d[value]))\n          .curve(fcurve),\n        ar = d3.area<any>()\n          // .curve(d3.curveBasis) // XXX add support for this\n          .defined(d => d && d[value] != null)\n          .x((_, i) => scaleX(i))\n          .y0(_ => scaleY(zeroValue == null ? minY : zeroValue))\n          .y1(d => scaleY(d[value]))\n          .curve(fcurve)\n\n      setContent(\n        <svg viewBox={`0 0 ${width} ${height}`} style={{ position: 'absolute', top: 0, left: 0, right: 0, bottom: 0 }}>\n          <path d={ar(data) as S} fill={color} fillOpacity='0.1' strokeLinejoin='round' strokeLinecap='round'></path>\n          <path d={ln(data) as S} fill='none' stroke={color} strokeWidth='1.5' strokeLinejoin='round' strokeLinecap='round'></path>\n        </svg>\n      )\n    }, [color, curve, data, maxY, minY, value, zeroValue]),\n    onResize = debounce(1000, renderViz)\n\n  React.useEffect(() => {\n    window.addEventListener('resize', onResize)\n    return () => window.removeEventListener('resize', onResize)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n  React.useLayoutEffect(renderViz, [value, color, data, zeroValue, curve, minY, maxY, renderViz])\n\n  return <div ref={ref} className={css.container}>{content}</div>\n}","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/* eslint-disable @typescript-eslint/no-non-null-asserted-optional-chain */\nimport * as d3 from 'd3'\nimport { F, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { debounce } from '../ui'\n\ninterface Props {\n  data: any[]\n  zeroValue?: F\n  category?: S\n  value: S\n  color: S\n}\n\nconst css = stylesheet({\n  container: {\n    width: '100%',\n    height: '100%',\n    position: 'relative',\n    flexGrow: 1,\n    minHeight: 32,\n  }\n})\n\nexport const MicroBars = ({ value, category = 'x', color, data, zeroValue }: Props) => {\n  const\n    ref = React.useRef<HTMLDivElement | null>(null),\n    [content, setContent] = React.useState<JSX.Element | null>(null),\n    [minY, maxY] = React.useMemo(() => {\n      let [minY, maxY] = d3.extent<any, any>(data, d => d[value])\n\n      if (zeroValue != null) {\n        minY = Math.min(zeroValue, minY)\n        maxY = Math.max(zeroValue, maxY)\n      }\n      return [minY, maxY]\n    }, [data, value, zeroValue]),\n    renderViz = React.useCallback(() => {\n      if (!ref.current) return\n\n      const { width, height } = ref.current.getBoundingClientRect()\n      if (!height) {\n        // Safari has weird event loop meaning this React code can run before Layout phase is finished (flex items not positioned yet).\n        setTimeout(renderViz, 300)\n        return\n      }\n\n      const\n        scaleX = d3.scaleBand().domain(data.map(d => d[category])).range([0, width]).paddingInner(0.1),\n        scaleY = d3.scaleLinear().domain([minY, maxY]).range([height, 0]),\n        rects = data.map((d, i) => {\n          const x = scaleX(d[category]), y = scaleY(d[value])\n          return <rect key={i} fill={color} x={x} y={y} width={2} height={height - y} />\n        })\n      setContent(<svg viewBox={`0 0 ${width} ${height}`} style={{ position: 'absolute', top: 0, left: 0, right: 0, bottom: 0 }}>{rects}</svg>)\n    }, [category, color, data, maxY, minY, value]),\n    onResize = debounce(1000, renderViz)\n\n  React.useEffect(() => {\n    window.addEventListener('resize', onResize)\n    return () => window.removeEventListener('resize', onResize)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n  React.useLayoutEffect(renderViz, [value, category, color, data, zeroValue, minY, maxY, renderViz])\n\n  return <div ref={ref} className={css.container}>{content}</div>\n}","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Data, F, Model, Rec, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format, grid } from './layout'\nimport { MicroArea } from './parts/microarea'\nimport { MicroBars } from './parts/microbars'\nimport { cssVar, padding } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    text: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      padding: padding(8, grid.gap),\n    },\n  })\n\n/** Create a small stat card displaying a primary value and a series plot. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The primary value displayed. */\n  value: S\n  /** The plot's data. */\n  plot_data: Data\n  /** The data field to use for y-axis values. */\n  plot_value: S\n  /** The base value to use for each y-axis mark. Set this to `0` if you want to pin the x-axis at `y=0`. If not provided, the minimum value from the data is used. */\n  plot_zero_value?: F\n  /** The data field to use for x-axis values (ignored if `plot_type` is `area`; must be provided if `plot_type` is `interval`). Defaults to 'x'. */\n  plot_category?: S\n  /** The type of plot. Defaults to `area`. */\n  plot_type?: 'area' | 'interval'\n  /** The plot's curve style. Defaults to `linear`. */\n  plot_curve?: 'linear' | 'smooth' | 'step' | 'step-after' | 'step-before'\n  /** The plot's color. */\n  plot_color?: S\n  /** Data for this card. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const render = () => {\n      const\n        data = unpack<Rec>(s.data),\n        plot = s.plot_type === 'interval'\n          ? (\n            <MicroBars\n              data={unpack<any[]>(s.plot_data)}\n              category={s.plot_category}\n              value={s.plot_value}\n              color={cssVar(s.plot_color)}\n              zeroValue={s.plot_zero_value}\n            />\n          ) : (\n            <MicroArea\n              data={unpack<any[]>(s.plot_data)}\n              value={s.plot_value}\n              color={cssVar(s.plot_color)}\n              zeroValue={s.plot_zero_value}\n              curve={s.plot_curve || 'linear'}\n            />\n          )\n      return (\n        <div data-test={name} className={css.card}>\n          <div className={css.text}>\n            <Format data={data} format={s.title || 'Untitled'} className='wave-s12 wave-w6' />\n            <Format data={data} format={s.value} className='wave-s12' />\n          </div>\n          {plot}\n        </div>\n      )\n    }\n    return { render, changed }\n  })\n\ncards.register('small_series_stat', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Model, Rec, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format, grid } from './layout'\nimport { clas } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n    },\n    value: {\n      lineHeight: '28px', // Override to fit inside 1 unit height in grid layout.\n    }\n  })\n\n/** Create a stat card displaying a single value. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The primary value displayed. */\n  value: S\n  /** Data for this card. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const render = () => {\n      const data = unpack<Rec>(s.data)\n      return (\n        <div data-test={name} className={css.card}>\n          <Format data={data} format={s.title} className='wave-s12 wave-w6' />\n          <Format data={data} format={s.value} className={clas(css.value, 'wave-s24 wave-w3')} />\n        </div>\n      )\n    }\n    return { render, changed }\n  })\n\ncards.register('small_stat', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { FontIcon } from '@fluentui/react'\nimport { Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards } from './layout'\nimport { clas, cssVar } from './theme'\nimport { bond, jump } from './ui'\n\n\n/**\n * Render a card displaying a list of stats.\n */\ninterface State {\n  /** The title. */\n  title: S\n  /** The individual stats to be displayed. */\n  items: StatListItem[]\n  // TODO optional data for buffer-based rendering.\n  /** An optional name for this item. */\n  name?: S\n  /** The subtitle, displayed below the title. */\n  subtitle?: S\n}\n\n/** Create a stat item (a label-value pair) for stat_list_card. */\nexport interface StatListItem {\n  /** The label for the metric. */\n  label: S\n  /** An optional name for this item (required only if this item is clickable). */\n  name?: S\n  /** The caption for the metric, displayed below the label. */\n  caption?: S\n  /** The primary value of the metric. */\n  value?: S\n  /** The font color of the primary value. */\n  value_color?: S\n  /** The auxiliary value, displayed below the primary value. */\n  aux_value?: S\n  /** An optional icon, displayed next to the label. */\n  icon?: S\n  /** The color of the icon. */\n  icon_color?: S\n}\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: 15,\n    },\n    items: {\n      overflow: 'auto',\n      flexGrow: 1,\n      marginTop: '1em',\n    },\n    item: {\n      display: 'flex',\n      justifyContent: 'space-between',\n      borderBottom: '1px solid #ddd',\n      padding: '0.5em 0',\n      $nest: {\n        '&:last-child': {\n          borderBottom: 'none'\n        }\n      }\n    },\n    icon: {\n      padding: '0.2em 0.5em 0em 0.1em',\n    },\n    lhs: {\n      flexGrow: 1,\n    },\n    rhs: {\n      textAlign: 'right'\n    },\n    caption: {\n      opacity: 0.7,\n    },\n    auxValue: {\n      opacity: 0.7,\n    },\n    clickable: {\n      cursor: 'pointer',\n      $nest: {\n        '&:hover': {\n          backgroundColor: '#fafafa',\n        }\n      },\n    },\n  })\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const\n          { name: listName, title, subtitle, items } = state,\n          list = items.map(({ name: itemName, label, caption, value, value_color, aux_value, icon, icon_color }, i) => {\n            const\n              onClick = itemName ? () => jump(listName, itemName) : undefined\n            return (\n              <div key={itemName ?? `${i}:${label}`} className={onClick ? clas(css.item, css.clickable) : css.item} onClick={onClick}>\n                {icon && <div className={css.icon} style={icon_color ? { color: cssVar(icon_color) } : undefined}><FontIcon iconName={icon} /></div>}\n                <div className={css.lhs}>\n                  <div className='wave-s12 wave-w6'>{label}</div>\n                  {caption && <div className={clas(css.caption, 'wave-s12')}>{caption}</div>}\n                </div>\n                <div className={css.rhs}>\n                  {value && (\n                    <div className='wave-s13 wave-w6' style={value_color ? { color: cssVar(value_color) } : undefined}>{value}</div>\n                  )}\n                  {aux_value && <div className={clas(css.auxValue, 'wave-s12')}>{aux_value}</div>}\n                </div>\n              </div>\n            )\n          })\n\n        return (\n          <div data-test={name} className={css.card}>\n            <div className='wave-s12 wave-w6'>{title}</div>\n            {subtitle && <div className='wave-s12'>{subtitle}</div>}\n            <div className={css.items}>\n              {list}\n            </div>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('stat_list', View)\n\n\n\n\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { FontIcon } from '@fluentui/react'\nimport { Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards } from './layout'\nimport { clas, cssVar } from './theme'\nimport { bond, jump } from './ui'\n\n/**\n * Render a card displaying a table of stats.\n */\ninterface State {\n  /** The title. */\n  title: S\n  /** The names of this table's columns. */\n  columns: S[]\n  /** The rows displayed in this table. */\n  items: StatTableItem[]\n  // TODO optional data for buffer-based rendering.\n  /** An optional name for this item. */\n  name?: S\n  /** The subtitle, displayed below the title. */\n  subtitle?: S\n}\n\n/** Create a stat item (a label and a set of values) for stat_table_card. */\nexport interface StatTableItem {\n  /** The label for the row. */\n  label: S\n  /** The values displayed in the row. */\n  values: S[]\n  /** An optional name for this row (required only if this row is clickable). */\n  name?: S\n  /** The caption for the metric, displayed below the label. */\n  caption?: S\n  /** An optional icon, displayed next to the label. */\n  icon?: S\n  /** The color of the icon. */\n  icon_color?: S\n}\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: 15,\n      // HACK: for some reason, the overflow on 'items' does not take effect without this line.\n      overflow: 'auto',\n    },\n    items: {\n      flexGrow: 1,\n      overflow: 'auto',\n      marginTop: '1em',\n    },\n    table: {\n      borderSpacing: 0,\n      width: '100%',\n      $nest: {\n        tbody: {\n          $nest: {\n            th: {\n              borderTop: '1px solid #ddd',\n              textAlign: 'left',\n              padding: '0.5em 1em 0.5em 0',\n            },\n            td: {\n              borderTop: '1px solid #ddd',\n              padding: '0.5em 0 0.5em 1em',\n            },\n          },\n        },\n        td: {\n          textAlign: 'right',\n          verticalAlign: 'top',\n        }\n      }\n    },\n    thead: {\n      opacity: 0.4,\n      $nest: {\n        th: {\n          textAlign: 'right',\n          width: '1%',\n          whiteSpace: 'nowrap',\n          padding: '0.5em 0 0.5em 1em',\n        },\n        'th:first-child': {\n          textAlign: 'left',\n          width: '100%',\n          padding: '0.5em 1em 0.5em 0',\n        }\n      },\n    },\n    header: {\n      display: 'flex',\n    },\n    caption: {\n      opacity: 0.7,\n    },\n    icon: {\n      padding: '0.2em 0.5em 0em 0.1em',\n    },\n    clickable: {\n      cursor: 'pointer',\n      $nest: {\n        '&:hover': {\n          backgroundColor: '#fafafa',\n        }\n      },\n    },\n  })\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const\n          { name: tableName, title, columns, subtitle, items } = state,\n          header = columns.map((label, i) => (\n            <th key={`${i}:${label}`}>{label}</th>\n          )),\n          rows = items.map(({ name: rowName, label, values, caption, icon, icon_color }, i) => {\n            const\n              onClick = rowName ? () => jump(tableName, rowName) : undefined,\n              cells = values.map((value, j) => (<td key={`${j}:${value}`}>{value}</td>))\n\n            return (\n              <tr key={rowName ?? `${i}:${label}`} className={onClick ? css.clickable : undefined} onClick={onClick}>\n                <th key='label'>\n                  <div className={css.header}>\n                    {icon && <div className={css.icon} style={icon_color ? { color: cssVar(icon_color) } : undefined}>\n                      <FontIcon iconName={icon} />\n                    </div>}\n                    <div>\n                      <div className='wave-w6'>{label}</div>\n                      {caption && <div className={clas(css.caption, 'wave-s12 wave-w4')}>{caption}</div>}\n                    </div>\n                  </div>\n                </th>\n                {cells}\n              </tr>\n            )\n          })\n\n        return (\n          <div data-test={name} className={css.card}>\n            <div className='wave-s12 wave-w6'>{title}</div>\n            {subtitle && <div className='wave-s12'>{subtitle}</div>}\n            <div className={css.items}>\n              <table className={clas(css.table, 'wave-s13')}>\n                <thead className={clas(css.thead, 'wave-w6')}>\n                  <tr>\n                    {header}\n                  </tr>\n                </thead>\n                <tbody>\n                  {rows}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('stat_table', View)\n\n\n\n\n\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Pivot, PivotItem, PivotLinkFormat } from '@fluentui/react'\nimport { B, Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { CardEffect, cards } from './layout'\nimport { Tab } from './tabs'\nimport { bond, wave } from './ui'\n\n/** Create a card containing tabs for navigation. */\ninterface State {\n  /** The tabs to display in this card */\n  items: Tab[]\n  /** The name of the tab to select. */\n  value?: S\n  /** True if tabs should be rendered as links instead of buttons. */\n  link?: B\n  /** An optional name for the card. If provided, the selected tab can be accessed using the name of the card. */\n  name?: S\n}\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      minHeight: 46 // HACK: Prevent overflow - https://github.com/h2oai/wave/issues/904.\n    },\n  })\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      onLinkClick = (item?: PivotItem) => {\n        const name = item?.props.itemKey\n        if (!name) return\n        if (name.startsWith('#')) {\n          window.location.hash = name.substr(1)\n          return\n        }\n        if (state.name) {\n          wave.args[state.name] = name\n        } else {\n          wave.args[name] = true\n        }\n        wave.push()\n      },\n      render = () => {\n        const\n          linkFormat = state.link ? PivotLinkFormat.links : PivotLinkFormat.tabs,\n          items = state.items.map(({ name, label, icon }) => (\n            <PivotItem key={name} itemKey={name} headerText={label} itemIcon={icon} />\n          ))\n        return (\n          <div data-test={name} className={css.card}>\n            <Pivot linkFormat={linkFormat} onLinkClick={onLinkClick} defaultSelectedKey={state.value}>{items}</Pivot>\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('tab', View, { effect: CardEffect.Transparent })\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { F, Model, Rec, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format, grid } from './layout'\nimport { ProgressArc } from './parts/progress_arc'\nimport { clas, cssVar } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      padding: grid.gap,\n      position: 'relative',\n    },\n    body: {\n      position: 'relative',\n      display: 'flex',\n      flexGrow: 1,\n    },\n    value_overlay: {\n      position: 'absolute',\n      top: 0, right: 0, bottom: 0, left: 0,\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      alignItems: 'center',\n    },\n    aux_value: {\n      color: 'var(--text7)',\n    },\n  })\n\n/** Create a tall stat card displaying a primary value, an auxiliary value and a progress gauge. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The primary value displayed. */\n  value: S\n  /** The auxiliary value displayed next to the primary value. */\n  aux_value: S\n  /** The value of the progress gauge, between 0 and 1. */\n  progress: F\n  /** The color of the progress gauge. */\n  plot_color?: S\n  /** Data for this card. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const render = () => {\n      const data = unpack<Rec>(s.data)\n      return (\n        <div data-test={name} className={css.card}>\n          <Format data={data} format={s.title} className='wave-s12 wave-w6' />\n          <div className={css.body}>\n            <ProgressArc thickness={2} color={cssVar(s.plot_color)} value={s.progress} />\n            <div className={css.value_overlay}>\n              <Format data={data} format={s.value} className='wave-s24 wave-w3' />\n              <Format data={data} format={s.aux_value} className={clas(css.aux_value, 'wave-s12')} />\n            </div>\n          </div>\n        </div>\n      )\n    }\n    return { render, changed }\n  })\n\ncards.register('tall_gauge_stat', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Data, F, Model, Rec, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format, grid } from './layout'\nimport { MicroArea } from './parts/microarea'\nimport { MicroBars } from './parts/microbars'\nimport { clas, cssVar } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    text: {\n      padding: grid.gap,\n    },\n    aux_value: {\n      color: 'var(--text7)',\n    },\n  })\n\n/** Create a tall stat card displaying a primary value, an auxiliary value and a series plot. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The primary value displayed. */\n  value: S\n  /** The auxiliary value displayed below the primary value. */\n  aux_value: S\n  /** The plot's data. */\n  plot_data: Data\n  /** The data field to use for y-axis values. */\n  plot_value: S\n  /** The base value to use for each y-axis mark. Set this to `0` if you want to pin the x-axis at `y=0`. If not provided, the minimum value from the data is used. */\n  plot_zero_value?: F\n  /** The data field to use for x-axis values (ignored if `plot_type` is `area`; must be provided if `plot_type` is `interval`). Defaults to 'x'. */\n  plot_category?: S\n  /** The type of plot. Defaults to `area`. */\n  plot_type?: 'area' | 'interval'\n  /** The plot's curve style. Defaults to `linear`. */\n  plot_curve?: 'linear' | 'smooth' | 'step' | 'step-after' | 'step-before'\n  /** The plot's color. */\n  plot_color?: S\n  /** Data for this card. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const render = () => {\n      const\n        data = unpack<Rec>(s.data),\n        plot = s.plot_type === 'interval'\n          ? (\n            <MicroBars\n              data={unpack<any[]>(s.plot_data)}\n              category={s.plot_category}\n              value={s.plot_value}\n              color={cssVar(s.plot_color)}\n              zeroValue={s.plot_zero_value}\n            />\n          ) : (\n            <MicroArea\n              data={unpack<any[]>(s.plot_data)}\n              value={s.plot_value}\n              color={cssVar(s.plot_color)}\n              zeroValue={s.plot_zero_value}\n              curve={s.plot_curve || 'linear'}\n            />\n          )\n\n      return (\n        <div data-test={name} className={css.card}>\n          <div className={css.text}>\n            <Format data={data} format={s.title || 'Untitled'} className='wave-s12 wave-w6' />\n            <Format data={data} format={s.value} className='wave-s24 wave-w3' />\n            <Format data={data} format={s.aux_value} className={clas(css.aux_value, 'wave-s12')} />\n          </div>\n          {plot}\n        </div>\n      )\n    }\n    return { render, changed }\n  })\n\ncards.register('tall_series_stat', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { CommandBar, IButtonProps, ICommandBarItemProps } from '@fluentui/react'\nimport { Id, Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { CardEffect, cards } from './layout'\nimport { bond, wave } from './ui'\n\n/**\n * Create a command.\n *\n * Commands are typically displayed as context menu items or toolbar button.\n */\nexport interface Command {\n  /** An identifying name for this component. If the name is prefixed with a '#', the command sets the location hash to the name when executed. */\n  name: Id\n  /** The text displayed for this command. */\n  label?: S\n  /** The caption for this command (typically a tooltip). */\n  caption?: S\n  /** The icon to be displayed for this command. */\n  icon?: S\n  /** Sub-commands, if any */\n  items?: Command[]\n  /** Data associated with this command, if any. */\n  value?: S\n  /** DEPRECATED. Use `value` instead. Data associated with this command, if any. */\n  data?: S\n}\n\n\n/** Create a card containing a toolbar. */\ninterface State {\n  /** Items to render. */\n  items: Command[]\n  /** Items to render on the right side (or left, in RTL). */\n  secondary_items?: Command[]\n  /** Items to render in an overflow menu. */\n  overflow_items?: Command[]\n}\n\nconst\n  overflowProps: IButtonProps = { ariaLabel: 'More' },\n  toCommands = (commands: Command[]) => commands.map(toCommand),\n  toCommand = ({ name, label, caption, icon, items, value }: Command): ICommandBarItemProps => {\n    wave.args[name] = false\n    const onClick = () => {\n      if (name[0] === '#') {\n        window.location.hash = name.substr(1)\n        return\n      }\n      wave.args[name] = value === undefined || value\n      wave.push()\n    }\n    return {\n      key: name,\n      text: label,\n      ariaLabel: caption || label,\n      title: caption,\n      iconOnly: !label,\n      iconProps: icon ? { iconName: icon } : undefined,\n      subMenuProps: items ? { items: toCommands(items) } : undefined,\n      onClick,\n    }\n  }\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n    }\n  })\n\nexport const\n  View = bond(({ name, state, changed }: Model<State>) => {\n    const\n      render = () => {\n        const\n          { items, overflow_items, secondary_items } = state,\n          commands = toCommands(items),\n          overflowCommands = overflow_items ? toCommands(overflow_items) : undefined,\n          farCommands = secondary_items ? toCommands(secondary_items) : undefined\n        return (\n          <div className={css.card}>\n            <CommandBar\n              data-test={name}\n              items={commands}\n              overflowItems={overflowCommands}\n              overflowButtonProps={overflowProps}\n              farItems={farCommands}\n              ariaLabel='Use left and right arrow keys to navigate between commands.'\n            />\n          </div>\n        )\n      }\n    return { render, changed }\n  })\n\ncards.register('toolbar', View, { effect: CardEffect.Transparent })\n\n\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { F, Model, Rec, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format, grid } from './layout'\nimport { ProgressBar } from './parts/progress_bar'\nimport { clas, cssVar } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      padding: grid.gap,\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    content: {\n      flexGrow: 1,\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'flex-end',\n    },\n    values: {\n      display: 'flex',\n      alignItems: 'baseline',\n    },\n    aux_value: {\n      marginLeft: 5,\n      color: cssVar('$text7'),\n    }\n  })\n\n/** Create a wide stat card displaying a primary value, an auxiliary value and a progress bar. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The primary value displayed. */\n  value: S\n  /** The auxiliary value displayed next to the primary value. */\n  aux_value: S\n  /** The value of the progress bar, between 0 and 1. */\n  progress: F\n  /** The color of the progress bar. */\n  plot_color?: S\n  /** Data for this card. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const render = () => {\n      const data = unpack<Rec>(s.data)\n      return (\n        <div data-test={name} className={css.card}>\n          <Format data={data} format={s.title} className='wave-s12 wave-w6' />\n          <div className={css.content}>\n            <div className={css.values}>\n              <Format data={data} format={s.value} className='wave-s18 wave-w3' />\n              <Format data={data} format={s.aux_value} className={clas(css.aux_value, 'wave-s13')} />\n            </div>\n            <ProgressBar thickness={2} color={cssVar(s.plot_color)} value={s.progress} />\n          </div>\n        </div>\n      )\n    }\n    return { render, changed }\n  })\n\ncards.register('wide_bar_stat', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { F, Model, Rec, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format, grid } from './layout'\nimport { ProgressArc } from './parts/progress_arc'\nimport { centerMixin, clas, cssVar, padding, pc } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      padding: padding(8, grid.gap),\n    },\n    lhs: {\n      position: 'relative',\n      width: pc(50)\n    },\n    rhs: {\n      width: pc(50),\n      marginLeft: grid.gap,\n    },\n    values: {\n      display: 'flex',\n      alignItems: 'baseline',\n    },\n    percentContainer: {\n      position: 'absolute',\n      top: 0, right: 0, bottom: 0, left: 0,\n      ...centerMixin(),\n    },\n    percent: {\n      opacity: 0.5,\n    },\n    title: {\n      overflow: 'visible'\n    },\n    value: {\n      lineHeight: 28, // Override to fit inside 1 unit height in grid layout.\n    },\n    aux_value: {\n      color: cssVar('$text7'),\n      marginLeft: 5,\n    }\n  })\n\n/** Create a wide stat card displaying a primary value, an auxiliary value and a progress gauge. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The primary value displayed. */\n  value: S\n  /** The auxiliary value displayed next to the primary value. */\n  aux_value: S\n  /** The value of the progress gauge, between 0 and 1. */\n  progress: F\n  /** The color of the progress gauge. */\n  plot_color?: S\n  /** Data for this card. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const render = () => {\n      const data = unpack<Rec>(s.data)\n      return (\n        <div data-test={name} className={css.card}>\n          <div className={css.lhs}>\n            <ProgressArc thickness={2} color={cssVar(s.plot_color)} value={s.progress} />\n            <div className={css.percentContainer}>\n              <div className={css.percent}>{`${Math.round(s.progress * 100)}%`}</div>\n            </div>\n          </div>\n          <div className={css.rhs}>\n            <Format data={data} format={s.title} className={clas(css.title, 'wave-s12 wave-w6')} />\n            <div className={css.values}>\n              <Format data={data} format={s.value} className='wave-s24 wave-w3' />\n              <Format data={data} format={s.aux_value} className={clas(css.aux_value, 'wave-s13')} />\n            </div>\n          </div>\n        </div >\n      )\n    }\n    return { render, changed }\n  })\n\ncards.register('wide_gauge_stat', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { Model, S } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, grid } from './layout'\nimport { clas, cssVar, pc } from './theme'\nimport { bond, wave } from './ui'\n\nconst\n  iconStyles: Fluent.IIconStyles = { root: { fontSize: 80 } },\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      padding: grid.gap\n    },\n    lhs: {\n      paddingRight: 20,\n      textAlign: 'center',\n      display: 'flex'\n    },\n    imgSpecified: {\n      $nest: {\n        '& > div': {\n          width: pc(50)\n        }\n      }\n    },\n    clickable: {\n      cursor: 'pointer'\n    },\n    title: {\n      paddingBottom: 17,\n    },\n    img: {\n      flexGrow: 1,\n      backgroundSize: 'cover',\n      backgroundRepeat: 'no-repeat',\n      backgroundPosition: 'center'\n    }\n  })\n/** Create a wide information card displaying a title, caption, and either an icon or image. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The card's caption, displayed below the title. */\n  caption: S\n  /** The card's icon. */\n  icon?: S\n  /** The cards image. */\n  image?: S\n  /** The card's category, displayed above the title. */\n  category?: S\n  /** An identifying name for this card. Makes the card clickable, similar to a button. */\n  name?: S\n  /** The card's background color. */\n  color?: S\n}\n\nexport const View = bond(({ name, state, changed }: Model<State>) => {\n  const\n    { title, caption, icon, image, category, name: stateName, color } = state,\n    onClick = () => {\n      if (!stateName) return\n      if (stateName.startsWith('#')) {\n        window.location.hash = stateName.substr(1)\n        return\n      }\n      wave.args[stateName] = stateName\n      wave.push()\n    },\n    render = () => (\n      <div\n        data-test={name}\n        onClick={onClick}\n        style={{ background: color ? cssVar(color) : 'inherit' }}\n        className={clas(css.card, stateName ? css.clickable : '', !icon && image ? css.imgSpecified : '')}\n      >\n        <div className={css.lhs}>\n          {\n            icon\n              ? <Fluent.Icon iconName={icon} styles={iconStyles} />\n              : image\n                ? <div className={css.img} style={{ backgroundImage: `url('${image}')` }}></div>\n                : <Fluent.Icon iconName='MiniExpand' styles={iconStyles} />\n          }\n        </div>\n        <div>\n          {category && <div className='wave-s12 wave-w5 wave-t5'>{category}</div>}\n          <div className={clas('wave-s20 wave-w5 wave-t9', css.title)}>{title}</div>\n          {caption && <div className='wave-s14 wave-w4 wave-t8'>{caption}</div>}\n        </div>\n      </div>\n    )\n\n  return { render, changed }\n})\n\ncards.register('wide_info', View)\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { Data, F, Model, Rec, S, unpack } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { cards, Format, grid } from './layout'\nimport { MicroArea } from './parts/microarea'\nimport { MicroBars } from './parts/microbars'\nimport { clas, cssVar, pc } from './theme'\nimport { bond } from './ui'\n\nconst\n  css = stylesheet({\n    card: {\n      display: 'flex',\n      padding: grid.gap,\n    },\n    plot: {\n      display: 'flex',\n      width: pc(50),\n    },\n    text: {\n      width: pc(50),\n      paddingLeft: grid.gap,\n    },\n    values: {\n      display: 'flex',\n      alignItems: 'baseline',\n    },\n    value: {\n      lineHeight: '28px', // Override to fit inside 1 unit height in grid layout.\n    },\n    aux_value: {\n      color: cssVar('$text7'),\n      marginLeft: 5,\n    }\n  })\n\n/** Create a wide stat card displaying a primary value, an auxiliary value and a series plot. */\ninterface State {\n  /** The card's title. */\n  title: S\n  /** The primary value displayed. */\n  value: S\n  /** The auxiliary value displayed below the primary value. */\n  aux_value: S\n  /** The plot's data. */\n  plot_data: Data\n  /** The data field to use for y-axis values. */\n  plot_value: S\n  /** The base value to use for each y-axis mark. Set this to `0` if you want to pin the x-axis at `y=0`. If not provided, the minimum value from the data is used. */\n  plot_zero_value?: F\n  /** The data field to use for x-axis values (ignored if `plot_type` is `area`; must be provided if `plot_type` is `interval`). Defaults to 'x'. */\n  plot_category?: S\n  /** The type of plot. Defaults to `area`. */\n  plot_type?: 'area' | 'interval'\n  /** The plot's curve style. Defaults to `linear`. */\n  plot_curve?: 'linear' | 'smooth' | 'step' | 'step-after' | 'step-before'\n  /** The plot's color. */\n  plot_color?: S\n  /** Data for this card. */\n  data?: Rec\n}\n\nexport const\n  View = bond(({ name, state: s, changed }: Model<State>) => {\n    const render = () => {\n      const\n        data = unpack<Rec>(s.data),\n        plot = s.plot_type === 'interval'\n          ? (\n            <MicroBars\n              data={unpack<any[]>(s.plot_data)}\n              category={s.plot_category}\n              value={s.plot_value}\n              color={cssVar(s.plot_color)}\n              zeroValue={s.plot_zero_value}\n            />\n          ) : (\n            <MicroArea\n              data={unpack<any[]>(s.plot_data)}\n              value={s.plot_value}\n              color={cssVar(s.plot_color)}\n              zeroValue={s.plot_zero_value}\n              curve={s.plot_curve || 'linear'}\n            />\n          )\n\n      return (\n        <div data-test={name} className={css.card}>\n          <div className={css.plot}>{plot}</div>\n          <div className={css.text}>\n            <Format data={data} format={s.title} className='wave-s12 wave-w6' />\n            <div className={css.values}>\n              <Format data={data} format={s.value} className={clas(css.value, 'wave-s24 wave-w3')} />\n              <Format data={data} format={s.aux_value} className={clas(css.aux_value, 'wave-s13')} />\n            </div>\n          </div>\n        </div>\n      )\n    }\n    return { render, changed }\n  })\n\ncards.register('wide_series_stat', View)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport { clas, margin, padding } from './theme'\n\nconst\n  css = stylesheet({\n    live: {\n      backgroundColor: '#ff2938',\n      color: '#fff',\n      fontSize: 11,\n      fontWeight: 700,\n      letterSpacing: 4,\n      textAlign: 'center',\n      margin: margin(5, 0, 10),\n      padding: padding(2, 0),\n      borderRadius: 2,\n    }\n  })\nexport const Logo = () => (\n  <div>\n    <svg width=\"35.964439mm\" height=\"9.0737419mm\" viewBox=\"0 0 35.964439 9.0737419\">\n      <g transform=\"matrix(0.54446153,0,0,0.54446153,-16.152559,-20.599374)\">\n        <path d=\"m 44.823532,48.430372 q 0,0.633406 -0.452432,1.085839 -0.429811,0.429811 -1.063217,0.429811 h -5.564924 l -5.632788,4.230247 q -0.384568,0.294081 -0.837,0.316703 -0.452433,0.04524 -0.859623,-0.203595 -0.339324,-0.203595 -0.542919,-0.54292 -0.203595,-0.339324 -0.203595,-0.769135 v -9.093899 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 v 6.062599 l 3.642084,-2.737218 q 0.407189,-0.294082 0.904865,-0.294082 h 4.54695 v -3.031299 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 0.633406,0 1.063217,0.452433 0.452432,0.429811 0.452432,1.063217 z\" />\n        <path d=\"m 61.789719,48.430372 q 0,0.633406 -0.452433,1.085839 -0.429811,0.429811 -1.063217,0.429811 -0.633406,0 -1.085839,-0.429811 -0.429811,-0.452433 -0.429811,-1.085839 v -6.062599 l -9.704683,7.261546 q -0.520298,0.384568 -1.153704,0.316703 -0.633405,-0.09049 -1.017973,-0.633406 -0.384568,-0.520298 -0.27146,-1.10846 0.09049,-0.610784 0.588163,-0.995352 l 12.14782,-9.071278 q 0.361946,-0.271459 0.791757,-0.294081 0.429811,-0.04524 0.791758,0.13573 0.384568,0.158351 0.610784,0.520298 0.248838,0.361946 0.248838,0.837 z\" />\n        <path d=\"m 78.507067,43.001179 q 0.384568,0.520297 0.27146,1.131082 -0.09049,0.588162 -0.588162,0.97273 l -12.147821,9.071278 q -0.384568,0.271459 -0.814379,0.294081 -0.407189,0.04524 -0.791757,-0.13573 -0.361946,-0.158351 -0.610784,-0.520298 -0.226217,-0.361946 -0.226217,-0.837 v -9.093899 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 v 6.062599 l 9.704683,-7.261546 q 0.520298,-0.384568 1.153704,-0.294081 0.633406,0.06786 1.017973,0.610784 z\" />\n        <path d=\"m 95.722092,52.977322 q 0,0.633406 -0.452433,1.063217 -0.429811,0.452433 -1.063217,0.452433 h -6.062599 q -0.633406,0 -1.085839,-0.452433 -0.429811,-0.429811 -0.429811,-1.063217 v -3.0313 h -4.546949 q -0.633406,0 -1.085839,-0.429811 -0.429811,-0.452433 -0.429811,-1.085839 v -4.546949 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 h 12.125198 q 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 0,0.633406 -0.452433,1.085838 -0.429811,0.429812 -1.063217,0.429812 H 83.596893 v 1.515649 h 4.54695 q 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 v 3.0313 h 4.546949 q 0.633406,0 1.063217,0.429811 0.452433,0.452433 0.452433,1.085839 z\" />\n      </g>\n    </svg>\n    <div className={clas('wave-pulse', css.live)}>LIVE</div>\n  </div>\n)","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { B, box, Card, Dict, Disposable, on, Page, parseU, S, U } from 'h2o-wave'\nimport { default as React } from 'react'\nimport { stylesheet } from 'typestyle'\nimport { CardMenu } from './card_menu'\nimport { CardEffect, CardView, getCardStyle, GridLayout } from './layout'\nimport { FlexBox, Layout, layoutsB, preload, Zone } from './meta'\nimport { clas, cssVar, margin } from './theme'\nimport { bond } from './ui'\n\n\ntype Breakpoint = {\n  layout: Layout\n  min: U\n  max: U\n  listener(e: MediaQueryListEvent): void\n  mq: MediaQueryList\n}\n\ntype Slot = {\n  order: U\n  zone?: S\n  grow?: U\n  width?: S\n  height?: S\n}\n\ntype CardSlot = {\n  card: Card\n  slot: Slot\n}\n\ntype Section = {\n  zone: Zone\n  sections?: Section[]\n  cardslots: CardSlot[]\n}\n\nconst\n  presetBreakpoints: Dict<S> = {\n    xs: '0px',\n    s: '576px',\n    m: '768px',\n    l: '992px',\n    xl: '1200px',\n  },\n  breakpointsB = box<Breakpoint[]>([]),\n  layoutB = box<{ layout: Layout, index: U } | null>(null),\n  resizedB = box(), // breakpoint changed?\n  parseBreakpoint = (spec: S): U => parseInt(presetBreakpoints[spec] ?? spec, 10),\n  badSlot: Slot = { order: 0 },\n  parseBox = ({ zone, order, size, width, height }: FlexBox): Slot => {\n    return { zone, order: order ? order : 0, grow: size ? parseU(size) : NaN, width, height }\n  },\n  parseBoxes = (index: U, spec: S): Slot => {\n    try {\n      if (spec[0] === '[') {\n        const specs: any[] = JSON.parse(spec)\n        spec = specs[index]\n        if (!spec) spec = specs[0]\n        if (!spec) return badSlot\n      }\n      return spec[0] === '{' ? parseBox(JSON.parse(spec)) : { zone: spec, order: 0 }\n    } catch {\n      return badSlot\n    }\n  },\n  // eslint-disable-next-line @typescript-eslint/ban-types\n  segregate = <T extends {}>(xs: T[], f: (x: T) => B): [T[], T[]] => {\n    const a: T[] = [], b: T[] = []\n    for (const x of xs) (f(x) ? a : b).push(x)\n    return [a, b]\n  }\n\non(layoutsB, layouts => {\n  const\n    bps = layouts.map((layout, index): Breakpoint => {\n      const\n        nextLayout = layouts[index + 1],\n        min = parseBreakpoint(layout.breakpoint),\n        max = nextLayout ? parseBreakpoint(nextLayout.breakpoint) - 1 : 0,\n        mq = window.matchMedia(\n          max\n            ? `(min-width:${min}px) and (max-width:${max}.98px)`\n            : `(min-width:${min}px)`\n        ),\n        listener = (mq: MediaQueryListEvent) => {\n          if (mq.matches) {\n            layoutB({ layout, index })\n            resizedB({})\n          }\n        },\n        bp: Breakpoint = { layout, min, max, mq, listener }\n\n      mq.addListener(listener)\n      if (mq.matches) layoutB({ layout, index })\n\n      return bp\n    })\n\n  for (const { mq, listener } of breakpointsB()) mq.removeListener(listener)\n  breakpointsB(bps)\n})\n\nconst\n  css = stylesheet({\n    flex: {\n      position: 'relative',\n      display: 'flex',\n    },\n    slot: {\n      boxSizing: 'border-box',\n      transition: 'box-shadow 0.3s cubic-bezier(.25,.8,.25,1)',\n      display: 'flex',\n      flexDirection: 'column',\n      margin: margin(7), // Approx 15px gutter between cards.\n      overflow: 'auto',\n      $nest: {\n        '>*': {\n          boxSizing: 'border-box',\n          flexGrow: 1, // Expand vertically\n        }\n      }\n    },\n    normal: {\n      backgroundColor: cssVar('$card'),\n      boxShadow: `0px 3px 5px ${cssVar('$text0')}`,\n      $nest: {\n        '&:hover': {\n          boxShadow: `0px 12px 20px ${cssVar('$text2')}`,\n        }\n      },\n    },\n    raised: {\n      color: cssVar('$card'),\n      backgroundColor: cssVar('$themePrimary'),\n      boxShadow: `0px 3px 7px ${cssVar('$text3')}`,\n      margin: 0,\n    },\n    flat: {\n      backgroundColor: cssVar('$card'),\n      boxShadow: `0px 3px 5px ${cssVar('$text0')}`,\n    },\n  }),\n  getCardEffectClass = (c: Card) => {\n    const { effect } = getCardStyle(c)\n    return clas(css.slot, effect === CardEffect.Normal\n      ? css.normal\n      : effect === CardEffect.Raised\n        ? css.raised\n        : effect == CardEffect.Flat\n          ? css.flat : '')\n  },\n  justifications: Dict<S> = {\n    start: 'flex-start',\n    end: 'flex-end',\n    center: 'center',\n    between: 'space-between',\n    around: 'space-around',\n  },\n  alignments: Dict<S> = {\n    start: 'flex-start',\n    end: 'flex-end',\n    center: 'center',\n    baseline: 'baseline',\n    stretch: 'stretch',\n  },\n  wrappings: Dict<S> = {\n    start: 'flex-start',\n    end: 'flex-end',\n    center: 'center',\n    between: 'space-between',\n    around: 'space-around',\n    stretch: 'stretch',\n  },\n  toSectionStyle = (zone: Zone, direction?: S): React.CSSProperties => {\n    const\n      style: React.CSSProperties = {\n        flexDirection: zone.direction === 'row' ? 'row' : 'column',\n        justifyContent: justifications[zone.justify ?? ''],\n        alignItems: alignments[zone.align ?? ''],\n        alignContent: wrappings[zone.wrap ?? ''],\n        flexWrap: zone.wrap ? 'wrap' : undefined,\n      }\n\n    if (zone.size) {\n      const grow = parseU(zone.size) // attempt strict-parse to uint\n      if (!isNaN(grow)) {// no units; treat as ratio\n        if (grow > 0) style.flexGrow = grow\n      } else { // has units; treat as size\n        if (direction === 'row') {\n          style.width = zone.size\n        } else {\n          style.height = zone.size\n          style.minHeight = zone.size // Needed for Safari.\n        }\n      }\n    } else { // no size\n      // expand to fit if horizontal\n      if (direction === 'row') {\n        style.flexGrow = 1\n      }\n    }\n\n    return style\n  },\n  toSlotStyle = ({ card: c, slot }: CardSlot): React.CSSProperties => {\n    const\n      { width, height, grow } = slot,\n      zIndex = c.name === '__unhandled_error__' ? 1 : undefined,\n      style: React.CSSProperties = { position: 'relative', zIndex }\n\n    if (grow || grow === 0 || width || height) {\n      if (grow) style.flexGrow = grow // grow only if non-zero (else default to shrink)\n      if (width) style.width = width\n      if (height) style.height = height\n    } else { // no size specified; occupy 1 part\n      style.flexGrow = 1\n    }\n    return style\n  },\n  toSection = (zone: Zone): Section => ({\n    zone,\n    sections: zone.zones?.map(toSection),\n    cardslots: []\n  }),\n  findSection = (section: Section, name: S): Section | null => {\n    const { zone, sections } = section\n    if (zone.name === name) return section\n    if (sections) {\n      for (const s of sections) {\n        const c = findSection(s, name)\n        if (c) return c\n      }\n    }\n    return null\n  },\n  sortCardsInSection = (section: Section) => {\n    const { sections } = section\n    if (sections) {\n      for (const s of sections) {\n        sortCardsInSection(s)\n      }\n    }\n    section.cardslots.sort((a, b) => a.slot.order - b.slot.order)\n  },\n  FlexSection = ({ section, hasEditor, direction }: { section: Section, hasEditor: B, direction?: S }) => {\n    const\n      { zone, cardslots, sections } = section,\n      children = sections\n        ? sections.map(section => <FlexSection key={section.zone.name} section={section} hasEditor={hasEditor} direction={zone.direction} />)\n        : cardslots.length ?\n          cardslots.map(cardslot => {\n            const { card: c } = cardslot\n            return (\n              <div key={c.id} className={getCardEffectClass(c)} style={toSlotStyle(cardslot)}>\n                <CardView card={c} />\n                <CardMenu name={c.name} commands={c.state.commands} changedB={c.changed} canEdit={hasEditor} />\n              </div>\n            )\n          })\n          : null\n\n    return (\n      <div data-test={zone.name} className={css.flex} style={toSectionStyle(zone, direction)}>\n        {children}\n      </div>\n    )\n  },\n  FlexLayout = ({ name, cards }: { name: S, cards: Card[] }) => {\n    const layoutIndex = layoutB()\n    if (!layoutIndex) return <></>\n    const\n      { layout, index } = layoutIndex,\n      section = toSection({ name: '__main__', zones: layout.zones }),\n      { width, min_width, max_width, height, min_height, max_height } = layout,\n      editor = cards.find(c => c.state.view === 'editor')\n\n    for (const card of cards) {\n      const\n        slot = parseBoxes(index, card.state.box),\n        target = findSection(section, slot.zone ?? '')\n      target?.cardslots.push({ card, slot })\n    }\n\n    sortCardsInSection(section)\n\n    const style: React.CSSProperties = {\n      width: width ?? '100%',\n      minWidth: min_width,\n      maxWidth: max_width,\n      height,\n      minHeight: min_height,\n      maxHeight: max_height,\n    }\n    if (height === '100%') {\n      style.display = 'flex'\n      style.flexDirection = 'column'\n    }\n    return (\n      <div data-test={name} style={style}>\n        <FlexSection section={section} hasEditor={editor ? true : false} />\n        {editor && <CardView card={editor} />}\n      </div>\n    )\n  }\nexport const\n  PageLayout = bond(({ page }: { page: Page }) => {\n    let\n      metaCard: Card | null = null,\n      onMetaCardChanged: Disposable | null = null\n\n    const\n      { changed } = page,\n      render = () => {\n        const\n          all = page.items(),\n          [metas, cards] = segregate(all, c => c.state.view === 'meta')\n\n        if (metas.length) {\n          onMetaCardChanged?.dispose()\n          metaCard = metas[0]\n          preload(metaCard as any) // causes layoutB to be set, if available.\n          onMetaCardChanged = on(metaCard.changed, () => preload(metaCard as any))\n        }\n        return layoutsB().length\n          ? <FlexLayout name={page.key} cards={cards} />\n          : <GridLayout name={page.key} cards={cards} />\n      }\n\n    return { render, changed, resizedB }\n  })\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport * as Fluent from '@fluentui/react'\nimport { box, WaveErrorCode, WaveEventType } from 'h2o-wave'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\nimport Dialog from './dialog'\nimport SidePanel from './side_panel'\nimport { LayoutPicker } from './editor'\nimport { Logo } from './logo'\nimport { PageLayout } from './page'\nimport { clas, cssVar, pc, themeB } from './theme'\nimport { bond, busyB, config, contentB, listen, wave } from './ui'\n\nconst\n  css = stylesheet({\n    app: {\n      position: 'absolute',\n      left: 0, top: 0, right: 0, bottom: 0,\n      backgroundColor: cssVar('$page'),\n      color: cssVar('$text'),\n      display: 'flex',\n      justifyContent: 'center',\n      overflow: 'auto'\n    },\n    centerFullHeight: {\n      height: pc(100),\n      display: 'flex',\n      justifyContent: 'center',\n      alignItems: 'center',\n      backgroundColor: cssVar('$page'),\n      color: cssVar('$text'),\n    },\n    freeOverlay: {\n      position: 'fixed',\n      left: 0, top: 0, right: 0, bottom: 0,\n      opacity: 0,\n      zIndex: -1,\n    },\n    busyOverlay: {\n      position: 'fixed',\n      left: 0, top: 0, right: 0, bottom: 0,\n      opacity: 0.8,\n      zIndex: 999,\n      transition: 'opacity 500ms 500ms',\n    },\n    notFoundOverlay: {\n      display: 'flex',\n      flexDirection: 'column',\n      alignItems: 'center',\n    },\n  })\n\nconst\n  BusyOverlay = bond(() => {\n    const\n      render = () => (\n        <div className={busyB() ? css.busyOverlay : css.freeOverlay}>\n          <Fluent.Spinner className={css.centerFullHeight} label='Loading...' size={Fluent.SpinnerSize.large} />\n        </div>\n      )\n    return { render, busyB }\n  }),\n  NotFoundOverlay = bond(() => {\n    const\n      pickingLayoutB = box(false),\n      onClick = () => {\n        pickingLayoutB(true)\n      },\n      render = () => (\n        <div className={css.notFoundOverlay}>\n          <Logo />\n          {config.editable && (\n            <>\n              <Fluent.DefaultButton onClick={onClick} >Edit this page...</Fluent.DefaultButton>\n              <LayoutPicker visibleB={pickingLayoutB} />\n            </>\n          )}\n        </div>\n      )\n\n    return { render }\n  }),\n  App = bond(() => {\n    const\n      onHashChanged = () => wave.push(),\n      onMdLinkClick = ({ detail }: any) => {\n        wave.args[detail] = true\n        wave.push()\n      },\n      init = () => {\n        listen()\n        window.addEventListener('hashchange', onHashChanged)\n        window.addEventListener('md-link-click', onMdLinkClick)\n      },\n      render = () => {\n        const e = contentB()\n        if (e) {\n          switch (e.t) {\n            case WaveEventType.Page:\n              {\n                const page = e.page\n                return (\n                  <Fluent.Fabric applyTheme>\n                    <div className={css.app}>\n                      <PageLayout key={page.key} page={page} />\n                      <BusyOverlay />\n                      <Dialog />\n                      <SidePanel />\n                    </div>\n                  </Fluent.Fabric>\n                )\n              }\n            case WaveEventType.Error:\n              {\n                // TODO better sadface\n                const message = e.code === WaveErrorCode.PageNotFound ? <NotFoundOverlay /> : 'Unknown Remote Error'\n                return <div className={clas(css.centerFullHeight, css.app)}>{message}</div>\n              }\n            case WaveEventType.Exception:\n              {\n                // TODO better sadface\n                const message = `Unhandled exception: ${e.error}`\n                return <div className={clas(css.centerFullHeight, css.app)}>{message}</div>\n              }\n            case WaveEventType.Disconnect:\n              {\n                // TODO better sadface\n                const message = `Disconnected. Reconnecting in ${e.retry}s`\n                return <div className={clas(css.centerFullHeight, css.app)}>{message}</div>\n              }\n          }\n        }\n        return <Fluent.Spinner className={css.centerFullHeight} size={Fluent.SpinnerSize.large} label='Loading ...' />\n      },\n      dispose = () => {\n        window.removeEventListener('hashchange', onHashChanged)\n        window.removeEventListener('md-link-click', onMdLinkClick)\n      }\n\n    return { init, render, dispose, contentB, themeB }\n  })\n\nexport default App\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { CompoundButton } from '@fluentui/react'\nimport React from 'react'\nimport { stylesheet } from 'typestyle'\n\nconst\n  css = stylesheet({\n    login: {\n      width: '100%',\n      minHeight: '100vh',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      flexDirection: 'column',\n    },\n  })\n\nconst\n  Login = () => {\n    const\n      queryString = window.location.search,\n      action = `/_auth/init${queryString}`\n    return (\n      <div className={css.login}>\n        <form action={action} method=\"POST\">\n          <CompoundButton type=\"default\" secondaryText=\"using OpenID Connect.\">\n            Log In\n          </CompoundButton>\n        </form>\n      </div>\n    )\n  }\n\nexport default Login\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport React from 'react'\nimport { BrowserRouter, Route, Switch } from 'react-router-dom'\nimport App from './app'\nimport Login from './login'\n\nconst\n  Router = () => {\n    const\n      routes = [\n        {\n          path: '/_auth/login',\n          exact: true,\n          render: () => <Login />,\n        },\n        {\n          path: '/',\n          exact: false,\n          render: () => <App />\n        },\n      ]\n    return (\n      <BrowserRouter>\n        <Switch>\n          {routes.map((r, i) => <Route key={i} path={r.path} exact={r.exact} render={r.render} />)}\n        </Switch>\n      </BrowserRouter>\n    )\n  }\n\nexport default Router\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.0/8 are considered localhost for IPv4.\n  window.location.hostname.match(\n    /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n  )\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    )\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister()\n      })\n      .catch(error => {\n        console.error(error.message)\n      })\n  }\n}\n","// Copyright 2020 H2O.ai, Inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport { initializeIcons, loadTheme } from '@fluentui/react'\nimport React from 'react'\nimport ReactDOM from 'react-dom'\nimport './cards'\nimport './index.scss'\nimport Router from './router'\nimport * as serviceWorker from './serviceWorker'\nimport { defaultTheme } from './theme'\n\nloadTheme({\n  defaultFontStyle: { fontFamily: 'Inter' },\n  palette: defaultTheme.fluentPalette,\n})\n\n// Initialize Fluent icons\ninitializeIcons()\n\nReactDOM.render(<Router />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}