var ti=Object.defineProperty,ai=Object.defineProperties;var ni=Object.getOwnPropertyDescriptors;var Bn=Object.getOwnPropertySymbols;var ri=Object.prototype.hasOwnProperty,li=Object.prototype.propertyIsEnumerable;var In=(e,a,n)=>a in e?ti(e,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[a]=n,W=(e,a)=>{for(var n in a||(a={}))ri.call(a,n)&&In(e,n,a[n]);if(Bn)for(var n of Bn(a))li.call(a,n)&&In(e,n,a[n]);return e},ie=(e,a)=>ai(e,ni(a));import{t as ii,d as N,g as Ve,T as Ct,B as rt,i as pt,c as oi,h as zn,l as Ir,r as Ye,s as z,I as $e,C as ka,a as si,H as Ca,b as ci,R as t,m as di,e as Za,F as at,S as Le,A as yn,L as Ae,f as vt,j as en,P as Fe,D as Xe,k as Xt,n as je,o as fe,p as mi,q as ze,u as ui,v as zr,w as pi,x as $a,y as Mr,z as fi,E as Na,G as Sa,J as bt,K as gi,M as Fr,N as Wr,O as hi,Q as vn,U as _a,V as yi,W as vi,X as Wt,Y as Oe,Z as tn,_ as Hr,$ as tt,a0 as Or,a1 as bi,a2 as Vr,a3 as jr,a4 as Xr,a5 as Ut,a6 as ga,a7 as Aa,a8 as Mn,a9 as xi,aa as Ei,ab as wi,ac as ki,ad as Ci,ae as $i,af as Ni,ag as Fn,ah as Si,ai as _i,aj as Ti,ak as Pi,al as Di,am as Ur,an as Gr,ao as Li,ap as Ai,aq as Ri,ar as Bi,as as bn,at as xn,au as Ii,av as Wn,aw as Ta,ax as qr,ay as Zt,az as zi,aA as At,aB as Qr,aC as Pa,aD as Mi,aE as Fi,aF as Wi,aG as Hi,aH as Oi,aI as Vi,aJ as Yr,aK as ji,aL as Xi,aM as Ui,aN as Gi,aO as qi,aP as Qi,aQ as Kr,aR as Jr,aS as Zr,aT as Yi,aU as Ki,aV as Ji,aW as el,aX as an,aY as Zi,aZ as eo,a_ as to,a$ as ao,b0 as no,b1 as ro,b2 as lo,b3 as io,b4 as oo}from"./vendor.2f0b4f78.js";function Vm(){import("data:text/javascript,")}const so=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerpolicy&&(i.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?i.credentials="include":l.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}};so();const me=e=>`${e}px`,ve=e=>`${e}%`,tl=e=>`${e}rem`,B=(...e)=>e.join(" "),be=(e,a)=>`${e}px solid ${a}`,co=(e,a)=>`${e}px dashed ${a}`,he=e=>`${e} !important`,xe=(...e)=>e.map(me).join(" "),ye=xe,Ke=()=>({display:"flex",alignItems:"center",justifyContent:"center"}),f=(e="$gray")=>e.startsWith("$")?`var(--${e.substr(1)}, var(--gray))`:e,ee=e=>e.startsWith("$")?(e=e.substring(1),getComputedStyle(document.body).getPropertyValue(`--${e}`).trim()):e,wt=e=>(e==null?void 0:e.includes("%"))?"100%":e,al=24,nn={amber:"#ffc107",azure:"#03a9f4",black:"#000",blue:"#2196f3",brown:"#795548",cyan:"#00bcd4",gray:"#9e9e9e",green:"#8bc34a",indigo:"#3f51b5",lime:"#cddc39",mint:"#4caf50",orange:"#ff9800",pink:"#e91e63",purple:"#9c27b0",red:"#f44336",tangerine:"#ff5722",teal:"#009688",violet:"#673ab7",white:"#fff",yellow:"#ffeb3b"},Ht=e=>{e.startsWith("$")&&(e=ee(e)),e.startsWith("#")&&(e=e.slice(1)),e.length===3&&(e=e.split("").map(i=>`${i}${i}`).join(""));const a=parseInt(e.substr(0,2),16),n=parseInt(e.substr(2,2),16),r=parseInt(e.substr(4,2),16);return(a*299+n*587+r*114)/1e3>=128?"black":"white"},ha={default:{palette:{card:"#ffffff",page:"#f5f5f5",text:"#323130"},fluentPalette:{black:"#000000",neutralDark:"#201f1e",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralQuaternary:"#d0d0d0",neutralQuaternaryAlt:"#e1dfdd",neutralSecondary:"#605e5c",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",themeDark:"#151515",themeDarkAlt:"#252525",themeDarker:"#0b0b0b",themeLight:"#595959",themeLighter:"#737373",themeLighterAlt:"#898989",themePrimary:"#000000",themeSecondary:"#2f2f2f",themeTertiary:"#373737",white:"#ffffff"}},neon:{palette:{card:"#0d0e0f",page:"#1b1d1f",text:"#ffffff"},fluentPalette:{black:"#f8f8f8",neutralDark:"#f4f4f4",neutralLight:"#2c2f32",neutralLighter:"#1f2123",neutralLighterAlt:"#16181a",neutralPrimary:"#fff",neutralPrimaryAlt:"#dadada",neutralQuaternary:"#3c4043",neutralQuaternaryAlt:"#35383b",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#5b5f63",themeDark:"#d7e464",themeDarkAlt:"#d0df4a",themeDarker:"#e1eb8a",themeLight:"#3d4211",themeLighter:"#202309",themeLighterAlt:"#080902",themePrimary:"#cddc39",themeSecondary:"#b3c132",themeTertiary:"#7a8422",white:"#0d0e0f"}},"h2o-dark":{palette:{card:"#121212",page:"#080808",text:"#ffffff"},fluentPalette:{black:"#f8f8f8",neutralDark:"#f4f4f4",neutralLight:"#343434",neutralLighter:"#252525",neutralLighterAlt:"#1c1c1c",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#dadada",neutralQuaternary:"#454545",neutralQuaternaryAlt:"#3d3d3d",neutralSecondary:"#d0d0d0",neutralTertiary:"#c8c8c8",neutralTertiaryAlt:"#656565",themeDark:"#c2991d",themeDarkAlt:"#e6b522",themeDarker:"#8f7015",themeLight:"#ffefbe",themeLighter:"#fff6dc",themeLighterAlt:"#fffdf6",themePrimary:"#fec925",themeSecondary:"#ffcf40",themeTertiary:"#ffde7d",white:"#121212"}},"one-dark-pro":{palette:{card:"#282C34",page:"#0E0C21",text:"#cacccf"},fluentPalette:{black:"#f9f9f9",neutralDark:"#f3f3f4",neutralLight:"#414651",neutralLighter:"#353a44",neutralLighterAlt:"#2f333c",neutralPrimary:"#cacccf",neutralPrimaryAlt:"#e7e8e9",neutralQuaternary:"#4e545f",neutralQuaternaryAlt:"#484d59",neutralSecondary:"#e1e2e4",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#dcdddf",neutralTertiaryAlt:"#686e7a",themeDark:"#d899ec",themeDarkAlt:"#d288e8",themeDarker:"#e2b3f1",themeLight:"#3d2545",themeLighter:"#211425",themeLighterAlt:"#080509",themePrimary:"#CD7BE5",themeSecondary:"#b46dca",themeTertiary:"#7b4a8a",white:"#282C34"}},monokai:{palette:{card:"#2B2A2D",page:"#232022",text:"#cdcccf"},fluentPalette:{black:"#f9f9f9",neutralDark:"#f3f3f4",neutralLight:"#49484c",neutralLighter:"#3c3b3f",neutralLighterAlt:"#343337",neutralPrimary:"#cdcccf",neutralPrimaryAlt:"#e8e8e9",neutralQuaternary:"#58565b",neutralQuaternaryAlt:"#515054",neutralSecondary:"#e3e3e4",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#dedddf",neutralTertiaryAlt:"#737177",themeDark:"#f787a5",themeDarkAlt:"#f67194",themeDarker:"#f9a6bc",themeLight:"#491d29",themeLighter:"#271016",themeLighterAlt:"#0a0405",themePrimary:"#F56188",themeSecondary:"#d75679",themeTertiary:"#933b52",white:"#2B2A2D"}},nord:{palette:{card:"#2E3441",page:"#3B4251",text:"#C8D1E3"},fluentPalette:{black:"#f8f9fc",neutralDark:"#f2f4f9",neutralLight:"#454c5b",neutralLighter:"#3a414f",neutralLighterAlt:"#343a48",neutralPrimary:"#C8D1E3",neutralPrimaryAlt:"#e5eaf2",neutralQuaternary:"#515969",neutralQuaternaryAlt:"#4c5363",neutralSecondary:"#dfe5ef",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#d9e0ec",neutralTertiaryAlt:"#6a7282",themeDark:"#a2cfdc",themeDarkAlt:"#92c7d6",themeDarker:"#b8dce5",themeLight:"#293a3f",themeLighter:"#161f21",themeLighterAlt:"#050808",themePrimary:"#87C0D0",themeSecondary:"#78aab8",themeTertiary:"#52747d",white:"#2E3441"}},"winter-is-coming":{palette:{card:"#0A2D44",page:"#031629",text:"#D4DEEC"},fluentPalette:{black:"#fafbfd",neutralDark:"#f5f8fb",neutralLight:"#1a4460",neutralLighter:"#123a54",neutralLighterAlt:"#0e344d",neutralPrimary:"#D4DEEC",neutralPrimaryAlt:"#ecf0f7",neutralQuaternary:"#24506d",neutralQuaternaryAlt:"#204a67",neutralSecondary:"#e7edf5",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#e3eaf3",neutralTertiaryAlt:"#3c6886",themeDark:"#63b5e2",themeDarkAlt:"#4aa9dd",themeDarker:"#89c8ea",themeLight:"#113041",themeLighter:"#091a23",themeLighterAlt:"#020609",themePrimary:"#38A0DA",themeSecondary:"#328dbf",themeTertiary:"#226082",white:"#0A2D44"}},fuchasia:{palette:{card:"#381E42",page:"#2C1834",text:"#C7CCD0"},fluentPalette:{black:"#f8f9f9",neutralDark:"#f2f3f4",neutralLight:"#51325e",neutralLighter:"#462852",neutralLighterAlt:"#3f234a",neutralPrimary:"#C7CCD0",neutralPrimaryAlt:"#e6e8ea",neutralQuaternary:"#5e3d6b",neutralQuaternaryAlt:"#583865",neutralSecondary:"#e0e3e5",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#dadee0",neutralTertiaryAlt:"#775584",themeDark:"#e692e0",themeDarkAlt:"#e180db",themeDarker:"#ecade8",themeLight:"#432340",themeLighter:"#231222",themeLighterAlt:"#090509",themePrimary:"#DE73D7",themeSecondary:"#c366bd",themeTertiary:"#854581",white:"#381E42"}},nature:{palette:{card:"#13413F",page:"#0C2521",text:"#CBCECE"},fluentPalette:{black:"#f9f9f9",neutralDark:"#f3f4f4",neutralLight:"#245b59",neutralLighter:"#1c4f4d",neutralLighterAlt:"#174846",neutralPrimary:"#CBCECE",neutralPrimaryAlt:"#e8e9e9",neutralQuaternary:"#2f6966",neutralQuaternaryAlt:"#2a6360",neutralSecondary:"#e3e4e4",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#dddfdf",neutralTertiaryAlt:"#46827f",themeDark:"#56cd95",themeDarkAlt:"#3ec385",themeDarker:"#7ddaaf",themeLight:"#0e3925",themeLighter:"#071e13",themeLighterAlt:"#020805",themePrimary:"#2dbd7a",themeSecondary:"#28a66b",themeTertiary:"#1b7149",white:"#13413F"}},solarized:{palette:{card:"#FDF6E3",page:"#EEE7D5",text:"#002b36"},fluentPalette:{black:"#083e4c",neutralDark:"#165362",neutralLight:"#e8e2d1",neutralLighter:"#f2ebd9",neutralLighterAlt:"#f6efdd",neutralPrimary:"#002b36",neutralPrimaryAlt:"#3f7e8e",neutralQuaternary:"#cec9b9",neutralQuaternaryAlt:"#d8d2c2",neutralSecondary:"#5a96a4",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#7baebb",neutralTertiaryAlt:"#c6c1b2",themeDark:"#1d4d74",themeDarkAlt:"#225b8a",themeDarker:"#153956",themeLight:"#aecae0",themeLighter:"#d2e2ef",themeLighterAlt:"#f3f8fb",themePrimary:"#266599",themeSecondary:"#3874a5",themeTertiary:"#6b9bc2",white:"#FDF6E3"}},oceanic:{palette:{card:"#263238",page:"#1E272C",text:"#ced5d9"},fluentPalette:{black:"#d0dade",neutralDark:"#c1cdd2",neutralLight:"#3e4d55",neutralLighter:"#334148",neutralLighterAlt:"#2d3a41",neutralPrimary:"#B0BEC5",neutralPrimaryAlt:"#9aa6ad",neutralQuaternary:"#4a5b63",neutralQuaternaryAlt:"#44555d",neutralSecondary:"#697176",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#34393b",neutralTertiaryAlt:"#63757e",themeDark:"#52bfb1",themeDarkAlt:"#3ab3a3",themeDarker:"#79d0c4",themeLight:"#0d332e",themeLighter:"#071b19",themeLighterAlt:"#020706",themePrimary:"#2bab9a",themeSecondary:"#269687",themeTertiary:"#1a675c",white:"#263238"}},ember:{palette:{card:"#F4F6F8",page:"#EBEEF2",text:"#1C1E24"},fluentPalette:{black:"#30333c",neutralDark:"#464954",neutralLight:"#dfe1e3",neutralLighter:"#e8eaed",neutralLighterAlt:"#eceef1",neutralPrimary:"#1C1E24",neutralPrimaryAlt:"#747884",neutralQuaternary:"#c6c8ca",neutralQuaternaryAlt:"#cfd1d3",neutralSecondary:"#8d919c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a7aab4",neutralTertiaryAlt:"#bec0c2",themeDark:"#972318",themeDarkAlt:"#b3291d",themeDarker:"#6f1a12",themeLight:"#eeb7b2",themeLighter:"#f6d8d5",themeLighterAlt:"#fdf5f4",themePrimary:"#c72e20",themeSecondary:"#ce4236",themeTertiary:"#dd776e",white:"#F4F6F8"}},lighting:{palette:{card:"#F4F6F9",page:"#FFFFFF",text:"#4f5959"},fluentPalette:{black:"#2c3232",neutralDark:"#3c4444",neutralLight:"#e1e3e5",neutralLighter:"#eaecef",neutralLighterAlt:"#eef0f3",neutralPrimary:"#4f5959",neutralPrimaryAlt:"#636d6d",neutralQuaternary:"#c8c9cc",neutralQuaternaryAlt:"#d1d3d6",neutralSecondary:"#919c9c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#c7cdcd",neutralTertiaryAlt:"#c0c2c4",themeDark:"#1f5495",themeDarkAlt:"#2564b1",themeDarker:"#173e6e",themeLight:"#b5ceed",themeLighter:"#d7e5f6",themeLighterAlt:"#f5f8fd",themePrimary:"#296fc4",themeSecondary:"#3e7ecb",themeTertiary:"#74a3dc",white:"#F4F6F9"}},kiwi:{palette:{text:"#000000",card:"#ffffff",page:"#f4fae8"},fluentPalette:{black:"#0b0b0b",neutralDark:"#151515",neutralLight:"#eaeaea",neutralLighter:"#f4f4f4",neutralLighterAlt:"#f8f8f8",neutralPrimary:"#000000",neutralPrimaryAlt:"#2f2f2f",neutralQuaternary:"#d0d0d0",neutralQuaternaryAlt:"#dadada",neutralSecondary:"#373737",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#595959",neutralTertiaryAlt:"#c8c8c8",themeDark:"#435918",themeDarkAlt:"#506a1d",themeDarker:"#324212",themeLight:"#c6d6a7",themeLighter:"#e0e9ce",themeLighterAlt:"#f7f9f2",themePrimary:"#597520",themeSecondary:"#698630",themeTertiary:"#93ac61",white:"#ffffff"}},benext:{palette:{text:"#555555",card:"#FFFFFF",page:"#E3E6EA"},fluentPalette:{neutralDark:"#404040",neutralLight:"#d1d4d7",neutralLighter:"#dadde1",neutralLighterAlt:"#dde0e4",neutralPrimary:"#555555",neutralPrimaryAlt:"#696969",neutralQuaternary:"#babcbf",neutralQuaternaryAlt:"#c3c5c9",neutralSecondary:"#989898",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#cccccc",neutralTertiaryAlt:"#b2b5b8",themeDark:"#823613",themeDarkAlt:"#9a4017",themeDarker:"#60280e",themeLight:"#e6beab",themeLighter:"#f2dbd1",themeLighterAlt:"#fcf6f3",themePrimary:"#ab481a",themeSecondary:"#b5582e",themeTertiary:"#cd8564",white:"#E3E6EA",black:"#2f2f2f"}}},mo=e=>{const a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return a?[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]:[0,0,0]},$t=ii(),nl=e=>{var o;const a=(o=ha[e])!=null?o:ha[En],{palette:n,fluentPalette:r}=a,l=Ve(n.card),i=(s,c)=>{document.body.style.setProperty(`--${s}`,c);const[d,m,u]=mo(c);let p=.05;for(let g=0;g<10;g++)document.body.style.setProperty(`--${s}${g}`,`rgba(${d},${m},${u},${p})`),p+=g===0?.05:.1};if(Object.keys(n).forEach(s=>document.body.style.setProperty(`--${s}`,n[s])),Object.keys(r).forEach(s=>document.body.style.setProperty(`--${s}`,r[s]||null)),n.text&&i("text",n.text),n.card&&i("card",n.card),r.themePrimary){i("primary",r.themePrimary);const s=Ve(r.themePrimary);if(s){const c=zn(s.h,s.s,s.v);Object.keys(nn).forEach(d=>{const{h:m,s:u,v:p}=Ve(ee(`$${d}`)),g=zn(m,u,p);document.body.style.setProperty(`--${d}`,`hsl(${g.h}, ${c.s}%, ${g.l}%)`)})}}setTimeout(()=>Ir({palette:r,defaultFontStyle:{fontFamily:"Inter"},isInverted:pt(l)}),0)},En="default",Da=N.box(En),rl=N.box([]),uo=ha[En],po={horizontal:"row",vertical:"column"},wn={start:"flex-start",end:"flex-end",center:"center",between:"space-between",around:"space-around"},ll={start:"flex-start",end:"flex-end",center:"center",baseline:"baseline",stretch:"stretch"},il={start:"flex-start",end:"flex-end",center:"center",between:"space-between",around:"space-around",stretch:"stretch"};N.on(rl,e=>{e.forEach(a=>{const{text:n,primary:r,card:l,page:i}=a,o=Ve(r),s=Ve(n),c=Ve(l);Ct.setSlot($t[rt[rt.primaryColor]],o,pt(o),!0,!0),Ct.setSlot($t[rt[rt.foregroundColor]],s,pt(s),!0,!0),Ct.setSlot($t[rt[rt.backgroundColor]],c,pt(c),!0,!0),Ct.insureSlots($t,pt(c));const{palette:d}=oi({palette:Ct.getThemeAsJson($t),isInverted:pt(c)});ha[a.name]={fluentPalette:d,palette:{text:n,card:l,page:i}}}),nl(Da())});N.on(Da,nl);var ft=(e=>(e[e.None=0]="None",e[e.Pick=1]="Pick",e[e.Add=2]="Add",e[e.Edit=3]="Edit",e[e.Delete=4]="Delete",e))(ft||{});const zt={t:0},ol={t:1},De=N.box(zt),fo=e=>{De({t:3,name:e})},go=e=>{De({t:4,name:e})},ya=[{name:"Sidebar on Left",layout:{name:"hsbf",breakpoint:"xs",min_height:"512px",zones:[{name:"Header"},{name:"Main",direction:"row",zones:[{name:"Sidebar",size:"256px"},{name:"Body"}]},{name:"Footer"}]}},{name:"Sidebar on Right",layout:{name:"hbsf",breakpoint:"xs",min_height:"512px",zones:[{name:"Header"},{name:"Main",direction:"row",zones:[{name:"Body"},{name:"Sidebar",size:"256px"}]},{name:"Footer"}]}},{name:"No Sidebar",layout:{name:"hbf",breakpoint:"xs",min_height:"512px",zones:[{name:"Header"},{name:"Body"},{name:"Footer"}]}},{name:"Body Only",layout:{name:"b",breakpoint:"xs",zones:[{name:"Body"}]}}],kn=ya[0];function ho(e,a){e=e.toLowerCase(),a=a.toLowerCase();const n=e.length,r=a.length;if(r>n)return!1;if(r===n)return a===e;e:for(let l=0,i=0;l<r;l++){const o=a.charCodeAt(l);for(;i<n;)if(e.charCodeAt(i++)===o)continue e;return!1}return!0}const Gt={list:{border:be(1,f("$neutralQuaternaryAlt")),".ms-ContextualMenu-link":{lineHeight:"unset"},".ms-ContextualMenu-submenuIcon":{lineHeight:"unset",display:"flex",alignItems:"center"}}};function j(e){return class extends Ye.exports.Component{constructor(a){super(a);const n=this,r=e(a),l=[];Object.keys(r).forEach(i=>{if(i==="render"||i==="dispose"||i==="init"||i==="update")return;const o=r[i];N.boxed(o)&&l.push(N.on(o,s=>n.setState({})))}),this.model=r,this.arrows=l,this.state={}}componentDidMount(){this.model.init&&this.model.init()}componentDidUpdate(){this.model.update&&this.model.update()}componentWillUnmount(){this.model.dispose&&this.model.dispose();for(const a of this.arrows)a.dispose()}render(){return this.model.render()}}}let Ot=null;const Mt={},yo=e=>{for(const a in e)delete e[a]};var Br;const qt=(Br=document.getElementsByTagName("body")[0].getAttribute("data-base-url"))!=null?Br:"/",vo=qt+"_s/",bo=qt+"_f/",xo=qt+"_auth/init",Eo=qt+"_auth/login",va=N.box(null),sl=N.box({}),ba=N.box(!1),xa={username:"",editable:!1},cl=(e,a)=>{if(a.startsWith("#")){window.location.hash=a.substr(1);return}e?y.args[e]=a:y.args[a]=!0,y.push()},kt=(e,a)=>{let n=null;return(...r)=>{n&&window.clearTimeout(n),n=window.setTimeout(()=>{a(...r),n=null},e)}},wo=(e,a)=>{let n=!1;return(...r)=>{n||(a(...r),n=!0,window.setTimeout(()=>{n=!1},e))}},ko=e=>{Ot=N.connect(e,a=>{switch(a.t){case N.WaveEventType.Page:case N.WaveEventType.Error:case N.WaveEventType.Exception:case N.WaveEventType.Disconnect:va(a);break;case N.WaveEventType.Reset:window.location.reload();break;case N.WaveEventType.Redirect:window.location.replace(a.url);break;case N.WaveEventType.Config:xa.username=a.username,xa.editable=a.editable;break;case N.WaveEventType.Data:ba(!1);break}})},Hn=()=>{if(!Ot)return;const e=window.location.hash;(e==null?void 0:e.length)>1&&(Mt["#"]=e.substr(1));const a=W({},Mt);yo(Mt),Ot.push(a),ba(!0),sl(a)},y={baseURL:qt,socketURL:vo,uploadURL:bo,initURL:xo,loginURL:Eo,args:Mt,debounce:kt,throttle:wo,push:Hn,fork:()=>{if(!Ot)throw new Error("not initialized");return Ot.fork()},emit:(e,a,n)=>{const r={},l={};r[a]=n,l[e]=r,Mt[""]=l,Hn()}};window.wave=y;const Ra=z({menu:{position:"absolute",top:0,right:0,$nest:{">div:first-child":{padding:24,fontSize:16,color:f("$text7")}}},icon:{userSelect:"none",marginRight:-6},target:{boxSizing:"border-box",cursor:"pointer",opacity:.5,$nest:{"&:hover":{opacity:1}}}}),dl="__edit__",ml="__delete__",ul=e=>{const a=()=>{var n,r;if(e.name===dl){e.value&&fo(e.value);return}if(e.name===ml){e.value&&go(e.value);return}if(e.name.startsWith("#")){window.location.hash=e.name.substr(1);return}y.args[e.name]=(r=(n=e.value)!=null?n:e.data)!=null?r:!0,y.push()};return{key:e.name,text:e.label||e.name||"Untitled",iconProps:e.icon?{iconName:e.icon}:void 0,title:e.caption||void 0,subMenuProps:e.items?{items:e.items.map(ul),styles:Gt}:void 0,onClick:a}},Cn=j(({commands:e,name:a,changedB:n,canEdit:r})=>{const l=Ye.exports.createRef(),i=N.box(!0),o=()=>i(!1),s=()=>i(!0);return{render:()=>{const d=e!=null?e:[];r&&d.push({name:dl,label:"Edit this card",icon:"Edit",value:a},{name:ml,label:"Delete this card",icon:"Delete",value:a});const m=i(),u=d.map(ul);return u.length?Ye.exports.createElement("div",{className:B(Ra.menu,"w-card-menu"),"data-test":a},Ye.exports.createElement("div",{className:Ra.target,ref:l,onClick:o},Ye.exports.createElement($e,{className:Ra.icon,iconName:"MoreVertical"})),Ye.exports.createElement(ka,{target:l,items:u,hidden:m,onItemClick:s,onDismiss:s,styles:Gt})):Ye.exports.createElement(Ye.exports.Fragment,null)},changedB:n,hiddenB:i}}),Co=ci(),Ba=si({locale:navigator.language,messages:{},onError:()=>{}},Co),$o=e=>e.replace(/(_\w)/g,a=>a[1].toUpperCase()),No=e=>{const a={};for(const n in e){const r=e[n];a[$o(n)]=r==="true"?!0:r==="false"?!1:/^\d+$/.test(r)?parseInt(r,10):r}return a},pl=e=>/^\w+$/.test(e);Ca.registerHelper("intl",(e,{hash:a})=>{a=No(a);const n=a.type;return n==="date"?Ba.formatDate(e,a):n==="time"?Ba.formatTime(e,a):n==="number"||typeof e=="number"?Ba.formatNumber(e,a):e});const fl=e=>typeof e=="string"&&e.length>1&&e.charAt(0)==="="&&e.charAt(1)!=="=",So=e=>{if(!fl(e))return null;if(e=e.substr(1),pl(e))return[e,void 0];const a=e.match(/\{\{\s*(\w+)\s+(\S+)/);if(a)return[a[2],gl(e)];const n=e.match(/\{\{\s*(\S+)/);return n?[n[1],void 0]:null},gl=e=>Ca.compile(e),_o=(e,a)=>{pl(e)&&(e="{{"+e+"}}");const n=gl(e);return n?n(a):e};var Je=(e=>(e.Transparent="transparent",e.Normal="normal",e.Raised="raised",e.Flat="flat",e))(Je||{});const To={effect:"normal"},Po=()=>{const e={};return{register:(r,l,i=To)=>e[r]={ctor:l,style:i},lookup:r=>e[r]||e[""]}},Y=Po(),Et=(e,a,n=null)=>e!=null?fl(e)?_o(e.substr(1),a):e:n!=null?n:null,te=({data:e,defaultValue:a,format:n,className:r,style:l})=>{const i=Et(n,e,a);return i==null?null:r||l?t.createElement("div",{className:r,style:l},i):t.createElement(t.Fragment,null,i)},Qt=({card:e})=>{const a=Y.lookup(e.state.view).ctor;return t.createElement(a,W({},e))},$n=({view:e,props:a,data:n})=>{const r=N.unpack(n).map((l,i)=>{const o={name:N.xid(),state:ie(W({},N.unpack(a)),{view:e,data:l}),changed:N.box()};return t.createElement(Qt,{key:i,card:o})});return t.createElement(t.Fragment,null,r)},rn={left:0,top:0,width:0,height:0},Do=(e,a,n,r,l)=>{let i=1;const o=e-2*l,s=a-2*l,c=e*n+l*(n+1),d=a*r+l*(r+1),m=c-2*l,u=d-2*l,p=(v,k,I,P)=>{const b={left:v*(e+l),top:k*(a+l)};return I>0?b.width=I*e+(I-1)*l:b.right=-(I+1)*(e+l),P>0?b.height=P*a+(P-1)*l:b.bottom=-(P+1)*(a+l),b},g=v=>{const k=v.trim().split(/\s+/g);switch(k.length){case 1:return["1","1",v,v];case 2:return["1","1",...k];case 3:return[...k,k[2]];case 4:return k;default:return k.slice(0,4)}},h=v=>{if(!v)return rn;const[k,I,P,b]=g(v).map(N.parseI);return isNaN(k)||isNaN(I)||isNaN(P)||isNaN(b)?rn:p(k-1,I-1,P,b)},w=()=>[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight];return{width:c,height:d,innerWidth:m,innerHeight:u,unitWidth:e,unitHeight:a,unitInnerWidth:o,unitInnerHeight:s,gap:l,place:h,scale:i,rescale:()=>{const[v,k]=w();return i=Math.min(v/c,k/d),i},inset:{position:"absolute",left:l,top:l,right:l,bottom:l,overflow:"auto"}}},se=Do(134,76,12,10,15),Ea=z({grid:{position:"relative",boxSizing:"border-box",width:se.innerWidth,margin:ye(se.gap)},slot:{boxSizing:"border-box",transition:"box-shadow 0.3s cubic-bezier(.25,.8,.25,1)",display:"flex",flexDirection:"column",margin:ye(7),overflow:"auto",$nest:{">*":{boxSizing:"border-box",flexGrow:1}}},normal:{backgroundColor:f("$card"),boxShadow:`0px 3px 5px ${f("$text0")}`,$nest:{"&:hover":{boxShadow:`0px 12px 20px ${f("$text2")}`}}},flat:{backgroundColor:f("$card"),boxShadow:`0px 3px 5px ${f("$text0")}`},raised:{margin:0,background:f("$themePrimary"),color:f("$card"),boxShadow:`0px 3px 7px ${f("$text3")}`,$nest:{".ms-Link":{color:f("$card")},".ms-Persona":{$nest:{"&-primaryText":{color:f("$card")},"&-secondaryText":{color:f("$card")},"&-tertiaryText":{color:f("$card")}}},".ms-Button":{$nest:{"&-menuIcon":{color:f("$card")}}},".ms-Nav":{$nest:{"&-chevronButton":{color:f("$card")},"&-link":{color:f("$card")},"&-link .ms-Icon":{color:f("$card")},".is-selected .ms-Nav-link":{background:f("$themeDark")},".is-selected .ms-Nav-link:after":{borderColor:f("$card")},"&-compositeLink:hover .ms-Nav-link":{background:f("$text1")},"&-compositeLink:hover.is-disabled .ms-Nav-link":{background:"transparent"}}},".w-menu":{color:he(f("$card")),$nest:{"& .ms-Button-icon":{color:he(f("$card"))}}},".w-tabs":{$nest:{".ms-Pivot-link":{backgroundColor:f("$themePrimary"),color:f("$card")},".ms-Pivot-link.is-selected":{backgroundColor:f("$card"),color:f("$text")}}},".w-tabs-link":{$nest:{".ms-Pivot-link":{color:f("$card")},".ms-Pivot-link:hover .ms-Pivot-linkContent":{color:f("$text")},".ms-Pivot-link.is-selected:before":{backgroundColor:f("$card")}}},".ms-Checkbox":{$nest:{"&-text":{color:he(f("$card"))},"&-checkbox":{borderColor:he(f("$card"))},"&-checkmark":{color:f("$themePrimary")},"&-label:hover .ms-Checkbox-checkmark":{color:f("$card")},"&.is-checked .ms-Checkbox-checkbox":{background:he(f("$card"))},"&.is-checked .ms-Checkbox-label:hover .ms-Checkbox-checkmark":{color:f("$themePrimary")}}},".ms-Toggle":{$nest:{"&-label":{color:f("$card")},"&-stateText":{color:f("$card")},"&-background":{borderColor:f("$card"),background:f("$themePrimary")},"&-thumb":{background:he(f("$card"))},"&.is-checked .ms-Toggle-background":{background:f("$card")},"&.is-checked .ms-Toggle-thumb":{background:he(f("$text"))}}},".ms-TextField-fieldGroup":{$nest:{i:{color:f("$text")}}},"& + div.w-card-menu i":{color:f("$card")},".ms-Label":{color:f("$card")}}},transparent:{backgroundColor:"transparent"},marginless:{margin:0}}),hl=e=>{const{effect:a,marginless:n}=Lo(e);return B(Ea.slot,Nn(a),n?Ea.marginless:"")},yl=e=>{switch(e){case"card":return"normal";case"transparent":return"transparent";case"primary":return"raised";default:return"raised"}},Nn=e=>Ea[e],Lo=e=>Y.lookup(e.state.view).style,Ao=({name:e,cards:a})=>{const n=!!a.find(l=>l.state.view==="editor"),r=a.map(l=>{const i=se.place(l.state.box),{left:o,top:s,right:c,bottom:d,width:m,height:u}=i,p=i===rn?l.state.view==="editor"?void 0:"none":void 0,g=l.name==="__unhandled_error__"?1:"initial";return t.createElement("div",{key:l.id,className:hl(l),style:{display:p,position:"absolute",left:o,top:s,right:c,bottom:d,width:m,height:u,zIndex:g,margin:0}},t.createElement(Qt,{card:l}),t.createElement(Cn,{name:l.name,commands:l.state.commands,changedB:l.changed,canEdit:n}))});return t.createElement("div",{"data-test":e,className:Ea.grid},r)},ln=z({card:{display:"flex",flexDirection:"column",padding:se.gap},body:{flexGrow:1},markdown:{$nest:{">*:only-child":{margin:0},a:{color:f("$themePrimary"),$nest:{"&:hover":{textDecoration:"none"}}},table:{width:ve(100),borderCollapse:"collapse"},tr:{borderBottom:be(1,f("$text5"))},th:{padding:xe(11,6),textAlign:"left"},td:{padding:xe(11,6)},img:{maxWidth:"100%",maxHeight:"100%"}}}}),Ro=di({html:!0,linkify:!0,typographer:!0}),Se=({source:e})=>{const a=n=>{const r=n.target.getAttribute("href");if(n.target instanceof HTMLAnchorElement&&(r==null?void 0:r.startsWith("?")))return window.dispatchEvent(new CustomEvent("md-link-click",{detail:r.substring(1)})),n.preventDefault(),n.stopPropagation(),!1};return t.createElement("div",{onClick:a,className:B(ln.markdown,"wave-markdown"),dangerouslySetInnerHTML:{__html:Ro.render(e)}})},Bo=j(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=Et(a.title,l);return t.createElement("div",{"data-test":e,className:ln.card},i&&t.createElement("div",{className:"wave-s12 wave-w6"},i),t.createElement("div",{className:ln.body},t.createElement(Se,{source:Et(a.content,l)})))},changed:n}));Y.register("markdown",Bo);const ea=z({container:{display:"flex",alignItems:"flex-start",alignContent:"flex-start"},expand:{flexGrow:1},icon:{color:f("$text"),fontWeight:400,fontSize:"14px",userSelect:"none",textAlign:"left",marginLeft:"0.5em",cursor:"pointer"},preventOverflow:{minWidth:0}}),oe=({children:e,content:a,showIcon:n=!0,expand:r=!0})=>{if(!a)return t.createElement(t.Fragment,null,e);const l={onRenderContent:()=>t.createElement("div",null,t.createElement(Se,{source:a}))};return t.createElement("div",{className:ea.container,"data-test":"tooltip"},n?t.createElement(t.Fragment,null,t.createElement("div",{className:B(ea.preventOverflow,r?ea.expand:"")},e),t.createElement(Za,{tooltipProps:l},t.createElement(at,{className:ea.icon,iconName:"Info"}))):t.createElement(Za,{tooltipProps:l},e))},vl=z({buttons:{boxSizing:"border-box",overflowX:"auto"}}),Io={start:"start",end:"end",center:"center",between:"space-between",around:"space-around"},bl=({model:{name:e,visible:a=!0,link:n,label:r,disabled:l,icon:i,caption:o,value:s,primary:c,width:d,path:m}})=>{const u=h=>{h.stopPropagation(),m?window.open(m,"_blank"):e.startsWith("#")?window.location.hash=e.substr(1):(y.args[e]=s===void 0||s,y.push())},p={root:{display:a?void 0:"none",width:wt(d),minWidth:d?"initial":void 0},icon:{fontSize:20,display:"flex",alignItems:"center"}};if(t.useEffect(()=>{y.args[e]=!1},[]),n)return t.createElement(Ae,{"data-test":e,disabled:l,onClick:u,styles:p},r);const g={text:r,disabled:l,onClick:u,styles:p,iconProps:{iconName:i}};return!r&&i?t.createElement(vt,ie(W({},g),{"data-test":e,title:o})):(o==null?void 0:o.length)?c?t.createElement(en,ie(W({},g),{"data-test":e,primary:!0,secondaryText:o})):t.createElement(en,ie(W({},g),{"data-test":e,secondaryText:o})):c?t.createElement(Fe,ie(W({},g),{"data-test":e})):t.createElement(Xe,ie(W({},g),{"data-test":e}))},zo=({model:e})=>{const{name:a,items:n,justify:r,width:l}=e,i=n.map(o=>o.button).filter(Boolean).map(o=>t.createElement(oe,{key:o.name,content:o.tooltip,showIcon:!1,expand:!1},t.createElement(bl,{model:o})));return t.createElement("div",{"data-test":a,className:vl.buttons,style:{width:l}},t.createElement(Le,{horizontal:!0,horizontalAlign:Io[r||""],tokens:{childrenGap:10}},i))},Mo=({model:e})=>t.createElement("div",{className:vl.buttons},t.createElement(bl,{key:e.name,model:e})),Fo=({model:e})=>t.createElement(Le,{horizontal:!0,verticalAlign:"center",styles:{root:{height:24}}},e.items.map(({mini_button:a})=>a?t.createElement(xl,{key:a.name,model:a}):null)),xl=({model:e})=>{const{name:a,label:n,icon:r}=e,l=()=>{if(a.startsWith("#")){window.location.hash=a.substr(1);return}y.args[a]=!0,y.push()};return t.createElement(yn,{"data-test":a,styles:{label:{color:f("$neutralTertiary")},labelHovered:{color:"inherit"},icon:{color:f("$neutralTertiary")},root:{padding:xe(0,1)}},text:n,iconProps:{iconName:r},onClick:l})},Wo=({model:e})=>{const a=(n,r)=>{y.args[e.name]=r===null?null:!!r,e.trigger&&y.push()};return t.useEffect(()=>{y.args[e.name]=!!e.value},[]),t.createElement(Xt,{"data-test":e.name,inputProps:{"data-test":e.name},styles:{checkmark:{display:"flex"}},label:e.label,defaultIndeterminate:e.indeterminate,defaultChecked:e.value,onChange:a,disabled:e.disabled})},Ia=z({toolbar:{margin:ye(5,0)},items:{$nest:{"> *":{margin:"10px 0"}}},inline:{display:"flex",flexWrap:"wrap",$nest:{".checklist-item":{marginRight:15}}}}),Ho=({model:e})=>{const a=t.useMemo(()=>new Set(e.values),[e.values]),n=t.useCallback(()=>{var u;return((u=e.choices)==null?void 0:u.map(p=>({c:p,selected:a.has(p.name)})))||[]},[a,e.choices]),[r,l]=t.useState(n()),i=u=>{y.args[e.name]=u.filter(({selected:p})=>p).map(({c:p})=>p.name),e.trigger&&y.push()},o=u=>{const p=r.map(({c:g,selected:h})=>({c:g,selected:g.disabled?h:u}));l(p),i(p)},s=()=>o(!0),c=()=>o(!1),d=u=>(p,g=!1)=>{const h=[...r];h[u].selected=g,l(h),i(h)},m=r.map(({c:u,selected:p},g)=>t.createElement(Xt,{key:g,"data-test":`checkbox-${g+1}`,className:"checklist-item",label:u.label||u.name,checked:p,onChange:d(g),disabled:!!u.disabled,styles:{root:{marginBottom:4},checkmark:{display:"flex"}}}));return t.useEffect(()=>{y.args[e.name]=e.values||[]},[]),t.useEffect(()=>{l(n())},[n,e.choices]),t.createElement("div",{"data-test":e.name},t.createElement(je,null,e.label),t.createElement("div",{className:Ia.toolbar},t.createElement(fe,{variant:"small"},t.createElement(Ae,{onClick:s},"Select All")," | ",t.createElement(Ae,{onClick:c},"Deselect All"))),t.createElement("div",{className:B(Ia.items,e.inline?Ia.inline:"")},m))},Oo=({model:e})=>{const a={choiceFieldWrapper:{marginRight:15}},n=(e.choices||[]).map(({name:l,label:i,disabled:o})=>({key:l,text:i||l,disabled:o,styles:a})),r=(l,i)=>{i&&(y.args[e.name]=i.key),e.trigger&&y.push()};return t.useEffect(()=>{y.args[e.name]=e.value||null},[]),t.createElement(mi,{styles:e.inline?{flexContainer:{display:"flex",flexWrap:"wrap"}}:void 0,"data-test":e.name,label:e.label,required:e.required,defaultSelectedKey:e.value,options:n,onChange:r})},Nt=z({multiContainer:{position:"relative",$nest:{"&:hover > button":{opacity:1}}},compactContainer:{position:"relative"},btnMultiline:{opacity:0,transition:"opacity .5s"},btn:{minWidth:"initial",position:"absolute",top:31,right:4,width:24,height:24},copiedBtn:{background:f("$green"),$nest:{"&:hover":{background:f("$green")}}}}),Vo=({model:e})=>{const{name:a,multiline:n,label:r,value:l}=e,i=t.useRef(null),o=t.useRef(),[s,c]=t.useState(!1),d=async()=>{var u;const m=i.current;if(!!m){try{document.queryCommandSupported("copy")&&(m.select(),document.execCommand("copy"),(u=window.getSelection())==null||u.removeAllRanges())}catch{await window.navigator.clipboard.writeText(l)}c(!0),o.current=window.setTimeout(()=>c(!1),2e3)}};return t.useEffect(()=>()=>window.clearTimeout(o.current),[]),t.createElement("div",{"data-test":a,className:n?Nt.multiContainer:Nt.compactContainer},t.createElement(ze,{componentRef:i,defaultValue:l,label:r,multiline:n,styles:{root:{width:ve(100)}},readOnly:!0}),t.createElement(Fe,{title:"Copy to clipboard",onClick:d,iconProps:{iconName:s?"CheckMark":"Copy"},className:B(Nt.btn,s?Nt.copiedBtn:"",n?Nt.btnMultiline:"")}))},ta=z({inlinePickerContainer:{display:"flex",alignItems:"center"},preview:{width:20,height:20,margin:ye(0,15),border:be(1,f("$text"))},rhs:{display:"flex",alignItems:"center"}}),jo=e=>e.map(a=>({id:a,label:a,color:a})),Xo=({model:e,onChange:a})=>{const[n,r]=t.useState(!1),l=e.value||"#000",[i,o]=t.useState(Ve(l)),[s,c]=t.useState(l),d=()=>r(!n),m=(p,g="")=>{if(c(g),!(g==null?void 0:g.match(/^#([0-9a-f]{3}){1,2}$/i)))return;const h=Ve(g);o(h),a(null,h)},u=(p,g)=>{o(g),c(g.str),a(null,g)};return t.createElement("div",{className:ta.inlinePickerContainer},e.label&&t.createElement(je,null,e.label),t.createElement("div",{className:ta.rhs},t.createElement("div",{className:ta.preview,style:{background:i==null?void 0:i.str},onClick:d}),n&&t.createElement(pi,{directionalHint:$a.rightBottomEdge,target:`.${ta.preview}`,onDismiss:d,gapSpace:10},t.createElement(zr,{alphaType:e.alpha?"alpha":"none",color:i,onChange:u})),t.createElement(ze,{value:s,onChange:m})))},Uo=({model:e})=>{const{width:a,value:n,name:r,trigger:l,label:i,choices:o,alpha:s,inline:c}=e,d=n||null,[m,u]=t.useState(d),p=(L,E,v=d)=>{y.args[r]=v,u(v),l&&y.push()},g=(L,{str:E})=>{y.args[r]=E||d,l&&y.push()},h=wt(a),w=(h==null?void 0:h.includes("%"))?"initial":`calc(${h} - 35px)`;return t.useEffect(()=>{y.args[r]=d},[]),t.createElement("div",{"data-test":r},c?t.createElement(Xo,{model:e,onChange:g}):t.createElement(t.Fragment,null,i&&t.createElement(je,null,i),(o==null?void 0:o.length)?t.createElement(ui,{columnCount:10,selectedId:m||o[0],colorCells:jo(o),onChange:p}):t.createElement(zr,{alphaType:s?"alpha":"none",color:d||"#000",onChange:g,styles:{root:{width:h,maxWidth:h},colorRectangle:{minWidth:w,maxWidth:w}}})))},Go=({model:e})=>e.values?t.createElement(Qo,{model:e}):t.createElement(qo,{model:e}),qo=({model:e})=>{var o;const[a,n]=El(e.choices),[r,l]=t.useState((o=e.value)!=null?o:null),i=(s,c,d,m)=>{const u=c&&String(c.key)||m||"";l(u),e.value=u,y.args[e.name]=u,e.trigger&&y.push()};return t.useEffect(()=>{y.args[e.name]=r},[e.name,r]),t.useEffect(()=>{l(e.value||null),e.value&&!(e.choices||[]).includes(e.value)&&n((s=[])=>[...s,{key:e.value,text:e.value}])},[e.value]),t.createElement(Mr,{"data-test":e.name,label:e.label,placeholder:e.placeholder,options:a,required:e.required,selectedKey:r,allowFreeform:!0,disabled:e.disabled,autoComplete:"on",errorMessage:e.error,onChange:i})},Qo=({model:e})=>{var s;const[a,n]=El(e.choices),[r,l]=t.useState((s=e.values)!=null?s:[]),i=c=>{l(d=>{const m=c.selected?[...d,String(c.key)]:d.filter(u=>u!==c.key);return y.args[e.name]=m,m})},o=(c,d,m,u)=>{if(!d&&u){const p={key:u,text:u};n((g=[])=>[...g,p]),i(ie(W({},p),{selected:!0}))}d&&i(d),e.trigger&&y.push()};return t.useEffect(()=>{var c,d;y.args[e.name]=((c=e.values)==null?void 0:c.length)?e.values:null,l(e.values||[]),((d=e.values)==null?void 0:d.length)&&n((m=[])=>[...m,...e.values.filter(u=>!m.some(p=>p.key===u)).map(u=>({key:u,text:u}))])},[e.values]),t.createElement(Mr,{"data-test":e.name,label:e.label,placeholder:e.placeholder,options:a,required:e.required,multiSelect:!0,selectedKey:r,allowFreeform:!0,disabled:e.disabled,autoComplete:"on",errorMessage:e.error,onChange:o})},El=(e=[])=>{const a=t.useMemo(()=>(e||[]).map(l=>({key:l,text:l})),[e]),[n,r]=t.useState(a);return t.useEffect(()=>{r(a)},[e,a]),[n,r]},On=e=>{const a=`${e}`;return a.length===1?`0${a}`:a},Yo=e=>`${e.getFullYear()}-${On(e.getMonth()+1)}-${On(e.getDate())}`,za=e=>{if(!e)return;const a=e.split("-");if(a.length!==3)return;const n=a.map(r=>parseInt(r,10)).filter(r=>!isNaN(r));if(n.length===3)return new Date(n[0],n[1]-1,n[2])},Ko=({model:e})=>{const a=e.value||null,n=a?za(a):null,[r,l]=t.useState(n?new Date(n):void 0),i=o=>{const s=o==null?a:Yo(o);y.args[e.name]=s,l(s?new Date(`${s}T00:00:00`):void 0),e.trigger&&y.push()};return t.useEffect(()=>{y.args[e.name]=a},[]),t.createElement(fi,{"data-test":e.name,styles:{icon:{bottom:2},readOnlyTextField:{paddingRight:he("32px")},statusMessage:{marginTop:0}},label:e.label,value:r,placeholder:e.placeholder,disabled:e.disabled,onSelectDate:i,minDate:za(e.min||null),maxDate:za(e.max||null)})},Vn=z({dialogCheckedRow:{background:f("$neutralLight")},dialogControls:{display:"flex",justifyContent:"space-between",marginTop:16}}),jn=({name:e,label:a,required:n,disabled:r,value:l,values:i,choices:o,trigger:s,placeholder:c})=>{const d=!!i,m=t.useMemo(()=>d?new Set(i):null,[d,i]),[u,p]=t.useState(Array.from(m||[])),g=(o||[]).map(({name:E,label:v,disabled:k})=>({key:E,text:v||E,disabled:k})),h=(E,v)=>{if(v){const k=v.key;if(d&&m!==null){v.selected?m.add(k):m.delete(k);const I=Array.from(m);y.args[e]=I,p(I)}else y.args[e]=k}s&&y.push()},w=()=>{if(!m)return;m.clear(),g.forEach(v=>{v.disabled||m.add(v.key)});const E=Array.from(m);p(E),y.args[e]=E,h()},L=()=>{!m||(m.clear(),p([]),y.args[e]=[],h())};return t.createElement(t.Fragment,null,t.createElement(Na,{"data-test":e,styles:{caretDownWrapper:{lineHeight:me(26)}},label:a,placeholder:c,options:g,required:n,disabled:r,multiSelect:d||void 0,defaultSelectedKey:d?void 0:l,selectedKeys:d?u:void 0,onChange:h}),d&&t.createElement("div",null,t.createElement(fe,{variant:"small"},t.createElement(Ae,{onClick:w},"Select All")," | ",t.createElement(Ae,{onClick:L},"Deselect All"))))},Xn=44,Un=40,Gn=({name:e,choices:a,values:n,value:r,disabled:l,required:i,trigger:o,placeholder:s,label:c})=>{const d=!!n,[m,u]=t.useState(!0),p=t.useMemo(()=>(n==null?void 0:n.length)?new Map(n.map(D=>[D,!0])):r?new Map([[r,!0]]):new Map,[r,n]),g=t.useMemo(()=>(a==null?void 0:a.map(({name:D,label:G},X)=>({name:D,text:G||D,idx:X,checked:p.has(D)})))||[],[p,a]),[h,w]=t.useState(g),[L,E]=t.useState(()=>{if(!(n==null?void 0:n.length)&&!r)return;const D=new Map(g.map(({name:G,text:X})=>[G,X]));if(n==null?void 0:n.length)return n.map(G=>D.get(G)||"").filter(Boolean).join(", ");if(r)return D.get(r)}),v=t.useCallback(()=>u(!m),[m]),k=t.useCallback(()=>{v(),w(g.map(D=>(D.checked=p.has(D.name),D)))},[p,g,v]),I=t.useCallback(D=>{const G=D?[D]:g.filter(({checked:X})=>X);y.args[e]=G.length===1?G[0].name:G.map(({name:X})=>X),o&&y.push(),E(G.length?G.map(({text:X})=>X).join(", "):""),p.clear(),G.forEach(({name:X})=>p.set(X,!0)),k()},[k,p,g,e,o]),P=(D=!0)=>()=>w(h.map(G=>(G.checked=D,G))),b=(D,G="")=>w(G?g.filter(({text:X})=>ho(X,G)):g),$=t.useCallback(D=>(G,X=!1)=>{g[D].checked=X,d?w(h.map(_=>(g[D].name===_.name&&(_.checked=X),_))):I(g[D])},[h,d,g,I]),S=t.useCallback(D=>D?t.createElement(Xt,{label:D.text,styles:{root:{minHeight:Xn,alignItems:"center"},label:{width:ve(100),padding:12,wordBreak:"break-word"},checkmark:{display:"flex"}},onChange:$(D.idx),className:D.checked?Vn.dialogCheckedRow:"",checked:D.checked}):null,[$]),R=t.useCallback(()=>({itemCount:Un,height:Xn*Un}),[]);return t.createElement(t.Fragment,null,t.createElement(ze,{"data-test":e,iconProps:{iconName:"ChevronDown"},readOnly:!0,onClick:v,label:c,disabled:l,required:i,styles:{field:{cursor:"pointer"},icon:{fontSize:12,color:f("$neutralSecondary")}},placeholder:s,value:L||""}),t.createElement(Sa,{hidden:m,dialogContentProps:{title:c,type:bt.close},onDismiss:k,minWidth:600,maxWidth:"90vw"},t.createElement(gi,{styles:{innerContent:{height:"65vh"},header:{height:0}}},t.createElement(je,null,"Search"),t.createElement(Fr,{"data-test":`${e}-search`,onChange:b,autoFocus:!0}),d&&t.createElement("div",{className:B("wave-s14",Vn.dialogControls)},t.createElement("span",{className:"wave-w5"},"Selected: ",g.filter(({checked:D})=>D).length),t.createElement("div",null,t.createElement(Ae,{onClick:P()},"Select All")," | ",t.createElement(Ae,{onClick:P(!1)},"Deselect All"))),t.createElement(Wr,{styles:{root:{marginTop:100,boxShadow:`0px 3px 7px ${f("$text3")}`}}},t.createElement(hi,{items:h,getPageSpecification:R,renderedWindowsAhead:3,onRenderCell:S}))),d&&t.createElement(vn,null,t.createElement(Xe,{text:"Cancel",onClick:k}),t.createElement(Fe,{text:"Select",onClick:()=>I()}))))},Jo=({model:e})=>{var a;return t.useEffect(()=>{y.args[e.name]=e.values?e.values||[]:e.value||null},[]),e.popup==="always"?t.createElement(Gn,W({},e)):e.popup==="never"?t.createElement(jn,W({},e)):(((a=e.choices)==null?void 0:a.length)||0)>100?t.createElement(Gn,W({},e)):t.createElement(jn,W({},e))},qn=z({expanderOpen:{$nest:{">div:last-child":{display:"block"}}},expanderClosed:{$nest:{">div:last-child":{display:"none"}}}}),Zo=({model:e})=>{const[a,n]=t.useState(e.expanded),r=t.useCallback(()=>{y.args[e.name]=!a,n(!a)},[a,e.name]);return t.useEffect(()=>{e.expanded!==void 0&&(y.args[e.name]=!!e.expanded,n(e.expanded))},[e]),t.createElement("div",{"data-test":e.name,className:a?qn.expanderOpen:qn.expanderClosed,"data-visible":a?"visible":"hidden"},t.createElement(_a,{alignContent:"start",styles:{content:{paddingLeft:0}}},t.createElement(yn,{title:a?"Shrink":"Expand",iconProps:{iconName:a?"ChevronDownMed":"ChevronRightMed"},onClick:r,styles:{root:{paddingLeft:0},icon:{marginLeft:0}}},e.label)),t.createElement(Ee,{items:e.items||[]}))},es=({model:e})=>{const{name:a,max:n,items:r,value:l}=e,i=()=>{if(a){if(a.startsWith("#")){window.location.hash=a.substr(1);return}y.args[a]=l===void 0||l,y.push()}},o=(s,{persona:c})=>{if(c){const{title:d,image:m,initials:u}=c;s.push({personaName:d,imageUrl:m,imageInitials:u})}return s};return t.createElement("div",{"data-test":a},t.createElement(yi,{styles:{addButton:{".ms-Persona-initials":{background:f("$themePrimary"),color:f("$card")}},descriptiveOverflowButton:{".ms-Persona-initials":{background:f("$neutralLighter")},".ms-Persona-initials>span":{color:f("$text")}}},personas:r.reduce(o,[]),maxDisplayablePersonas:n,showAddButton:!!a,addButtonProps:{onClick:i},overflowButtonProps:{},overflowButtonType:vi.descriptive}))},Pe=z({uploadInput:{opacity:0},upload:ie(W({},Ke()),{flexDirection:"column",boxSizing:"border-box"}),uploadDragging:{border:co(2,f("$themePrimary"))},uploadLabel:ie(W({},Ke()),{padding:xe(7,10),fontSize:14,fontWeight:600,borderRadius:2,background:f("$themePrimary"),color:f("$page"),minWidth:80,boxSizing:"border-box",height:32,$nest:{"&:hover":{cursor:"pointer"}}}),uploadLabelCompact:{position:"absolute",top:2,right:2,height:28},uploadMessageBar:{margin:"20px 0"},uploadRemove:{fontSize:20,position:"absolute",top:-15,right:0,cursor:"pointer"},compact:{position:"relative"}}),Qn=e=>e*1024*1024,ts=({model:e})=>{const{name:a,label:n,file_extensions:r,max_file_size:l,compact:i,height:o,max_size:s,multiple:c}=e,[d,m]=t.useState(!1),[u,p]=t.useState([]),[g,h]=t.useState(""),[w,L]=t.useState(0),[E,v]=t.useState(""),[k,I]=t.useState(""),P=l?Qn(l):0,b=s?Qn(s):0,$=r?r.map(K=>K.startsWith(".")?K:`.${K}`):null,S=t.useRef(),R=async(K=u)=>{const re=new FormData;K.forEach(U=>re.append("files",U));try{const{responseText:U}=await new Promise((ke,F)=>{const M=new XMLHttpRequest;S.current=()=>{F(),M.abort(),L(0)},M.open("POST",y.uploadURL),M.upload.onprogress=q=>L(q.loaded/q.total),M.send(re),M.onreadystatechange=()=>{M.readyState===XMLHttpRequest.DONE&&(M.status>=200&&M.status<300?ke(M):F(M))}}),{files:ne}=JSON.parse(U);y.args[a]=ne,i||y.push(),I(`Successfully uploaded files: ${g}.`)}catch(U){U&&v(U instanceof XMLHttpRequest?U.responseText:"There was an error when uploading file."),h("")}finally{p([])}},D=K=>!$||$.some(re=>K.toLowerCase().endsWith(re.toLowerCase())),G=K=>{if(!c&&K.length>1)return"Cannot upload multiple files. Input is not set to multiple mode.";const re=K.filter(({name:U})=>!D(U));if(re.length)return`Not allowed extension for files: ${re.map(({name:U})=>U).join(", ")}.
          Allowed file extensions: ${$==null?void 0:$.join(", ")}.`;if(P){const U=K.filter(({size:ne})=>ne>P);if(U.length)return`Max file size exceeded for files: ${U.map(({name:ne})=>ne).join(", ")}.
            Allowed size per file: ${l}Mb.`}if(b&&K.reduce((ne,{size:ke})=>ne+ke,0)>b)return`Total max file size exceeded. Allowed size: ${s}Mb.`},X=async K=>{const re=K.target.files;if(!(re==null?void 0:re.length))return;const U=Array.from(re),ne=G(U);ne?v(ne):(E&&v(""),p(U),h(U.map(({name:ke})=>ke).join(", ")),i&&(await R(U),L(0)))},_=K=>{K.preventDefault(),K.stopPropagation(),m(!0)},H=K=>{K.preventDefault(),K.stopPropagation(),m(!1)},x=K=>{H(K);const re=K.dataTransfer.files;if(!re.length||E||k)return;const U=Array.from(re),ne=G(U);if(ne){v(ne);return}else E&&v("");p(U)},C=K=>{K.preventDefault(),K.stopPropagation()},T=()=>v(""),O=()=>{I(""),L(0)},J=K=>()=>{u.splice(K,1),p([...u])},ae=()=>E?t.createElement(t.Fragment,null,t.createElement(fe,{variant:"xLarge"},"An error occured"),t.createElement(Wt,{className:Pe.uploadMessageBar,messageBarType:Oe.error,isMultiline:!0,onDismiss:T},E)):k?t.createElement(t.Fragment,null,t.createElement(fe,{variant:"xLarge"},"Upload successful"),t.createElement(Wt,{className:Pe.uploadMessageBar,messageBarType:Oe.success,isMultiline:!0,onDismiss:O},k)):d?t.createElement(fe,{styles:{root:{pointerEvents:"none"}}},"Drop files anywhere within the box."):w?t.createElement(t.Fragment,null,t.createElement(tn,{styles:{root:{width:"80%"}},"data-test":"progress",description:`Uploading: ${(w*100).toFixed(2)}%`,percentComplete:w}),t.createElement(Xe,{styles:{root:{marginTop:12}},text:"Cancel",onClick:S.current})):u.length?t.createElement(t.Fragment,null,t.createElement(fe,{variant:"xLarge"},c?"Chosen Files":"Chosen File"),t.createElement(Le,{horizontal:!0,verticalAlign:"center",styles:{root:{maxWidth:"100%",overflowX:"auto",padding:"30px 0"}},tokens:{childrenGap:15}},u.map(({name:K},re)=>t.createElement(Hr,{key:N.xid(),styles:{root:{textAlign:"center",position:"relative"}}},t.createElement($e,{className:Pe.uploadRemove,iconName:"RemoveFilter",onClick:J(re)}),t.createElement($e,{iconName:"OpenFile",styles:{root:{fontSize:35}}}),t.createElement("br",null),t.createElement(fe,{nowrap:!0,styles:{root:{display:"block",margin:"15px 0"}}},K))))):t.createElement(t.Fragment,null,t.createElement($e,{iconName:"Upload",styles:{root:{fontSize:50}}}),t.createElement("input",{id:a,"data-test":a,className:Pe.uploadInput,onChange:X,type:"file",accept:$==null?void 0:$.join(","),multiple:c}),t.createElement("label",{htmlFor:a,className:Pe.uploadLabel},"Browse..."),t.createElement(fe,{styles:{root:{marginTop:15}}},"Or drag and drop ",c?"files":"a file"," here."));return i?(()=>t.createElement(t.Fragment,null,w?t.createElement("div",{style:{display:"flex",alignItems:"center"}},t.createElement(tn,{label:n?t.createElement(je,null,n):void 0,description:`Uploading: ${(w*100).toFixed(2)}%`,percentComplete:w,styles:{root:{flex:1},itemName:{padding:0},itemProgress:{paddingTop:5,paddingBottom:5}}}),t.createElement(vt,{iconProps:{iconName:"cancel"},title:"Cancel",onClick:S.current,styles:{root:{padding:16,marginTop:11,marginLeft:6}}})):t.createElement(t.Fragment,null,n&&t.createElement(je,{style:{paddingTop:6}},n),t.createElement("div",{className:Pe.compact},t.createElement(ze,{"data-test":`textfield-${a}`,readOnly:!0,value:g,errorMessage:E}),t.createElement("input",{id:a,"data-test":a,type:"file",hidden:!0,onChange:X,accept:$==null?void 0:$.join(","),multiple:c}),t.createElement("label",{htmlFor:a,className:B(Pe.uploadLabel,Pe.uploadLabelCompact)},"Browse")))))():t.createElement(t.Fragment,null,t.createElement("form",{className:d&&!E&&!k?B(Pe.upload,Pe.uploadDragging):Pe.upload,style:{height:o||300},onDragStart:_,onDragEnter:_,onDragEnd:H,onDragLeave:H,onDrop:x,onDragOver:C},ae()),t.createElement(Fe,{disabled:!!w||!u.length,text:n||"Upload",onClick:()=>R()}))},Yn=z({card:{display:"flex",flexDirection:"column",padding:se.gap},body:{flexGrow:1,position:"relative",$nest:{iframe:{position:"absolute",top:0,left:0,right:0,bottom:0}}}}),as=e=>e.replace(/(\s+src\s*=\s*["'])\//g,`$1${window.location.protocol}//${window.location.host}/`),Kn=e=>URL.createObjectURL(new Blob([as(e)],{type:"text/html"})),wl=({path:e,content:a})=>t.createElement("iframe",{title:N.xid(),src:e||Kn(a||"Nothing to render."),frameBorder:"0",width:"100%",height:"100%"}),ns=({model:{name:e,path:a,content:n,width:r="100%",height:l="150px"}})=>t.createElement("div",{"data-test":e,style:{width:wt(r),height:l}},t.createElement(wl,{path:a,content:n})),rs=j(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,className:Yn.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",{className:Yn.body},t.createElement(wl,{path:a.path,content:a.content}))),changed:n}));Y.register("frame",rs);const kl=z({card:{display:"flex",flexDirection:"column",padding:se.gap},img:{flexGrow:1,objectFit:"contain",maxHeight:"calc(100% - 20px)"}}),Cl=({model:{title:e,type:a,image:n,path:r,width:l}})=>{const i=r||(n&&a?`data:image/${a};base64,${n}`:"");return t.createElement("img",{className:kl.img,alt:e,src:i,width:wt(l)})},ls=j(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,type:i,image:o,data:s,path:c}=a;return t.createElement("div",{"data-test":e,className:kl.card},t.createElement(te,{data:s,format:l,className:"wave-s12 wave-w6"}),t.createElement(Cl,{model:{title:l,type:i,image:o,path:c}}))},changed:n}));Y.register("image",ls);const is=({model:e})=>{const{label:a,required:n=!1,disabled:r=!1,name:l}=e;return t.createElement(je,{"data-test":l,required:n,disabled:r},a)},Ma=z({linkGroup:{margin:ye(-6,12,0,12),$nest:{a:{display:"block",marginTop:8},"a:first-of-type":{marginTop:0}}},linkGroupLabel:{marginBottom:10},inline:{display:"flex",$nest:{a:{marginRight:16},"a:last-child":{marginRight:0}}}}),os=({model:{label:e,items:a,inline:n}})=>t.createElement("div",{className:n?Ma.inline:Ma.linkGroup},e&&t.createElement("div",{className:B("wave-s20 wave-w6",Ma.linkGroupLabel)},e),a.filter(({link:r})=>r).map((r,l)=>t.createElement($l,{key:l,model:r.link}))),$l=({model:{name:e,label:a,disabled:n,path:r,download:l,target:i,button:o}})=>{const s=a||r,c=i===""?"_blank":i,d=t.useCallback(()=>window.open(r,c),[c,r]),m=t.useCallback(u=>{l&&r&&(u.preventDefault(),window.open(r,"_blank"))},[l,r]);return o?t.createElement(Xe,{"data-test":e,text:s,disabled:n,onClick:d}):t.createElement(Ae,{onClick:m,"data-test":e,href:r,disabled:n,target:c},s)},Jn=z({card:{display:"flex",flexDirection:"column",padding:se.gap},body:{flexGrow:1}}),Sn=({model:{content:e,name:a}})=>t.createElement("div",{"data-test":a,dangerouslySetInnerHTML:{__html:e}}),Nl=({name:e,title:a,content:n})=>t.createElement("div",{"data-test":e,className:Jn.card},a&&t.createElement("div",{className:"wave-s12 wave-w6"},a),t.createElement("div",{className:Jn.body},t.createElement(Sn,{model:{content:n}}))),ss=j(({name:e,state:a,changed:n})=>({render:()=>t.createElement(Nl,{name:e,title:a.title,content:a.content}),changed:n}));Y.register("markup",ss);const Sl=z({messageBar:{$nest:{".wave-markdown > *:first-child":{marginTop:0},".wave-markdown > *:only-child":{marginBottom:0},".wave-markdown p":{fontSize:14,lineHeight:me(20),letterSpacing:"-0.006em"},".ms-MessageBar-dismissal .ms-Button-icon":{fontSize:16}}}}),_l={info:{iconName:"InfoSolid",background:"#DBEEFD",color:"#165589"},error:{iconName:"StatusErrorFull",background:"#F1CBCB",color:"#5E0000"},warning:{iconName:"IncidentTriangle",background:"#FFF6DC",color:"#8F7015"},success:{iconName:"CompletedSolid",background:"#CAEACA",color:"#094609"},danger:{iconName:"IncidentTriangle",background:"#F1CBCB",color:"#5E0000"},blocked:{iconName:"Blocked2Solid",background:"#F1CBCB",color:"#5E0000"}},Tl=e=>{switch(e){case"error":return Oe.error;case"warning":return Oe.warning;case"success":return Oe.success;case"danger":return Oe.severeWarning;case"blocked":return Oe.blocked;default:return Oe.info}},cs=({type:e,text:a,buttons:n,name:r})=>{const{iconName:l,color:i,background:o}=_l[e||"info"],s=n==null?void 0:n.filter(({button:c})=>c);return(a==null?void 0:a.length)?t.createElement(Wt,{"data-test":r,styles:{root:{background:o,color:i,borderRadius:4,width:"auto",".ms-Link":{color:i,fontWeight:600},".ms-Link:hover":{textDecoration:"none"},padding:"8px 16px",minHeight:24},content:{alignItems:"center"},icon:{fontSize:24,color:i,display:"inline-flex"},iconContainer:{margin:0,marginRight:16,display:"flex",alignItems:"center"},text:{margin:0},innerText:{whiteSpace:he("initial")},actions:{margin:0}},messageBarType:Tl(e),className:Sl.messageBar,isMultiline:!1,actions:(s==null?void 0:s.length)?t.createElement(Ee,{items:s||[],alignment:"end"}):void 0,messageBarIconProps:{iconName:l}},t.createElement(Se,{source:a})):null},ds=({model:e})=>t.createElement(cs,{name:e.name,text:e.text,type:e.type,buttons:e.buttons}),ms={xs:tt.size48,s:tt.size56,m:tt.size72,l:tt.size100,xl:tt.size120},Yt=({model:e})=>{const a=()=>{if(e.name){if(e.name.startsWith("#")){window.location.hash=e.name.substr(1);return}y.args[e.name]=!0,y.push()}};return t.createElement("div",{"data-test":e.name,onClick:a},t.createElement(Or,{styles:{root:{cursor:e.name?"pointer":"initial"},details:{paddingRight:0}},text:e.title,secondaryText:e.subtitle,tertiaryText:e.caption,imageUrl:e.image,imageInitials:e.initials,initialsColor:f(e.initials_color),size:e.size?ms[e.size]:tt.size72}))},us={suggestionsHeaderText:"Suggestions",noResultsFoundText:"No results found"},ps=({model:e})=>{const a=t.useMemo(()=>e.choices.map(({name:s,label:c})=>({key:s,name:c||s})),[e.choices]),[n,r]=t.useState(a.filter(({key:s})=>{var c;return(c=e.values)==null?void 0:c.includes(s)})),l=(s,c)=>{if(!s)return[];const d=m=>m.toLowerCase().includes(s.toLowerCase());return a.filter(m=>d(m.name)&&!(c==null?void 0:c.includes(m)))},i=s=>{r(s||[]),y.args[e.name]=s?s.map(({key:c})=>c):null,e.trigger&&y.push()},o=()=>a;return t.useEffect(()=>{y.args[e.name]=e.values||null},[]),t.createElement(t.Fragment,null,e.label&&t.createElement(je,{required:e.required},e.label),t.createElement(bi,{inputProps:{"data-test":e.name},removeButtonAriaLabel:"Remove",onResolveSuggestions:l,onChange:i,pickerSuggestionsProps:us,itemLimit:e.max_choices,selectedItems:n,disabled:e.disabled,onEmptyResolveSuggestions:o}))},fs="modulepreload",Zn={},gs="",Me=function(a,n){return!n||n.length===0?a():Promise.all(n.map(r=>{if(r=`${gs}${r}`,r in Zn)return;Zn[r]=!0;const l=r.endsWith(".css"),i=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${r}"]${i}`))return;const o=document.createElement("link");if(o.rel=l?"stylesheet":fs,l||(o.as="script",o.crossOrigin=""),o.href=r,document.head.appendChild(o),l)return new Promise((s,c)=>{o.addEventListener("load",s),o.addEventListener("error",c)})})).then(()=>a())};let Rt=["$gray","$blue","$green","$amber","$tangerine","$purple","$cyan","$mint","$pink","$brown"];(async()=>{const{registerInteraction:e}=await Me(()=>import("./index.ce1f283d.js"),["static/index.ce1f283d.js","static/vendor.2f0b4f78.js"]);e("drag_move",{start:[{trigger:"plot:mousedown",action:"scale-translate:start"}],processing:[{trigger:"plot:mousemove",action:"scale-translate:translate",throttle:{wait:100,leading:!0,trailing:!1}}],end:[{trigger:"plot:mouseup",action:"scale-translate:end"}]});const a=n=>(n.gEvent.preventDefault(),n.gEvent.originalEvent.deltaY>0);e("scale_zoom",{start:[{trigger:"plot:mousewheel",isEnable:n=>a(n.event),action:"scale-zoom:zoomOut",throttle:{wait:100,leading:!0,trailing:!1}},{trigger:"plot:mousewheel",isEnable:n=>!a(n.event),action:"scale-zoom:zoomIn",throttle:{wait:100,leading:!0,trailing:!1}}]}),e("brush",{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"plot:mousedown",action:["brush:start","rect-mask:start","rect-mask:show"]}],processing:[{trigger:"plot:mousemove",action:["rect-mask:resize"]}],end:[{trigger:"plot:mouseup",action:["brush:filter","brush:end","rect-mask:end","rect-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush:reset"]}]})})();const Pl=()=>({defaultColor:ee("$themePrimary"),labels:{style:{fill:ee("$text")}},geometries:{point:{"hollow-circle":{default:{style:{fill:"transparent"}}}},interval:{rect:{selected:{style:{stroke:ee("$text")}}}}},components:{annotation:{dataMarker:{point:{style:{stroke:ee("$themePrimary"),fill:ee("$card")}}},line:{style:{fill:ee("$neutralPrimaryAlt")}},region:{style:{fill:ee("$themePrimary"),fillOpacity:.3}}},legend:{common:{itemName:{style:{fill:ee("$text")}},pageNavigator:{text:{style:{fill:ee("$text")}},marker:{style:{fill:ee("$themePrimary"),inactiveFill:ee("$themePrimary")}}}},continuous:{label:{style:{fill:ee("$text")}},handler:{style:{fill:ee("$neutralPrimaryAlt")}}}},axis:{top:{title:{style:{fill:ee("$text")}}},right:{title:{style:{fill:ee("$text")}}},bottom:{title:{style:{fill:ee("$text")}}},left:{title:{style:{fill:ee("$text")}}},circle:{label:{style:{fill:ee("$text")}}},radius:{label:{style:{fill:ee("$text")}}},common:{label:{style:{fill:ee("$text")}},grid:{line:{style:{stroke:ee("$neutralPrimaryAlt"),strokeOpacity:.2}}},line:{style:{stroke:ee("$neutralPrimaryAlt"),strokeOpacity:.6}},tickLine:{style:{stroke:ee("$neutralPrimaryAlt"),strokeOpacity:.6}}}}}}),hs=(e,a)=>ks[ar(e,a,"x")+ar(e,a,"y")],we=e=>typeof e=="number",ys=e=>typeof e=="boolean",V=e=>typeof e=="string",Vt=e=>e.trim().split(/\s+/g),Dl=e=>Vt(e).map(a=>parseInt(a,10)),aa=(e,a)=>{for(const n of e)if(n){const r=n[a];r&&V(r)&&(n[a]=new Date(r.includes("T")?r:`${r}T00:00:00`))}},na=(e,a,n,r)=>{for(const l of e)l&&(l[r]=[l[a],l[n]])},er=(e,a,n,r,l,i,o)=>{for(const s of e)s&&(s[o]=[s[a],s[n],s[r],s[l],s[i]])},vs=" 0 1 2 _q1 _q2 _q3".split(" "),bs=Vt("min max nice scale title"),Ll=e=>vs.map(a=>e+a),Al=e=>bs.map(a=>`${e}_${a}`),_n=e=>e.map(a=>[a,a+"_field",a+"_format"]),on=_n(Ll("x")),Rl=_n(Ll("y")),tr=Al("x"),xs=Al("y"),Es=_n(Vt("color shape size dodge label")),ws=[...on,...Rl,...Es],ar=(e,a,n)=>{const r=n+"_field",l=n+"_scale";for(const i of a){const o=i,s=o[r];if(o[l]==="time")return"t";if(V(s))for(const d of e){const m=d[s];if(we(m))return"c";if(V(m))return"d"}}return"c"},ks={cc:0,dd:1,tt:2,dc:4,cd:3,tc:5,ct:6,td:7,dt:8},nr={},Cs=(e,a)=>(n,r)=>{const l=n?n[e]:r;return l!=null?(nr[e]=l,a(nr)):""},$s=e=>{const a=e;for(let n=0;n<on.length;n++){const r=on[n],l=Rl[n];for(let i=0;i<r.length;i++){const o=a[r[i]];a[r[i]]=a[l[i]],a[l[i]]=o}}for(let n=0;n<tr.length;n++){const r=tr[n],l=xs[n],i=a[r];a[r]=a[l],a[l]=i}},Ns=e=>{const a=e;for(const[n,r,l]of ws){const i=a[n];if(V(i)){const o=So(i);if(o){const[s,c]=o;a[n]=void 0,a[r]=s,c&&(a[l]=Cs(s,c))}}}return e},rr=(e,a)=>{for(const n of a)if(n.x_scale==="time"){for(const{x_field:r,x0_field:l}of a)V(r)&&aa(e,r),V(l)&&aa(e,l);V(n.x)&&(n.x=new Date(n.x)),V(n.x0)&&(n.x0=new Date(n.x0));break}for(const n of a)if(n.y_scale==="time"){for(const{y_field:r,y0_field:l}of a)V(r)&&aa(e,r),V(l)&&aa(e,l);V(n.y)&&(n.y=new Date(n.y)),V(n.y0)&&(n.y0=new Date(n.y0));break}for(const{x_field:n,x0_field:r}of a)V(n)&&V(r)&&na(e,r,n,n);for(const{y_field:n,y0_field:r}of a)V(n)&&V(r)&&na(e,r,n,n);for(const n of a){const{type:r,x1_field:l,x2_field:i,y_field:o}=n;r==="interval"&&V(l)&&V(i)&&V(o)&&(n.x_field=l+" - "+i,na(e,l,i,n.x_field))}for(const n of a){const{type:r,y1_field:l,y2_field:i,x_field:o}=n;r==="interval"&&V(l)&&V(i)&&V(o)&&(n.y_field=l+" - "+i,na(e,l,i,n.y_field))}for(const n of a){const{type:r,x1_field:l,x_q1_field:i,x_q2_field:o,x_q3_field:s,x2_field:c,y_field:d}=n;r==="schema"&&V(l)&&V(i)&&V(o)&&V(s)&&V(c)&&V(d)&&(n.x_field=[l,i,o,s,c].join("-"),er(e,l,i,o,s,c,n.x_field))}for(const n of a){const{type:r,x_field:l,y1_field:i,y_q1_field:o,y_q2_field:s,y_q3_field:c,y2_field:d}=n;r==="schema"&&V(i)&&V(o)&&V(s)&&V(c)&&V(d)&&V(l)&&(n.y_field=[i,o,s,c,d].join("-"),er(e,i,o,s,c,d,n.y_field))}return e},Ss=({x:e,x0:a,y:n,y0:r,label:l,fill_color:i,fill_opacity:o,stroke_color:s,stroke_opacity:c,stroke_size:d,stroke_dash:m,ref_stroke_color:u,ref_stroke_opacity:p,ref_stroke_dash:g,ref_stroke_size:h,label_fill_color:w,label_fill_opacity:L,label_stroke_color:E,label_stroke_opacity:v,label_stroke_size:k,label_font_size:I,label_font_weight:P,label_line_height:b,label_align:$})=>{const S=Bl(w,L,E,v,k,I,P,b,$),R=sn(i,o,s,c,d,m),D=sn(void 0,void 0,u,p,h,g);return e!=null&&n!=null?a!=null&&r!=null?[{type:"region",start:[a,r],end:[e,n],text:V(l)?{content:l,style:S}:void 0,style:R}]:[{type:"dataMarker",position:[e,n],text:V(l)?{content:l,style:S}:null,point:{style:R},line:{style:D}}]:e!=null?a!=null?[{type:"region",start:[a,"min"],end:[e,"max"],text:V(l)?{content:l,style:S}:null,style:R}]:[{type:"line",start:[e,"min"],end:[e,"max"],text:V(l)?{content:l,style:S,position:"start"}:void 0,style:D}]:r!=null?[{type:"region",start:["min",r],end:["max",n],text:V(l)?{content:l,style:S}:null,style:R}]:[{type:"line",start:["min",n],end:["max",n],text:V(l)?{content:l,style:S,position:"start"}:void 0,style:D}]},_s=({type:e,x_field:a,y_field:n,color_field:r,color_range:l,color_domain:i,color:o,shape_field:s,shape_range:c,shape:d,size_field:m,size_range:u,size:p,stack:g,dodge:h,dodge_field:w,curve:L,fill_color:E,fill_opacity:v,stroke_color:k,stroke_opacity:I,stroke_dash:P,stroke_size:b,label_field:$,label_format:S,label_offset:R,label_offset_x:D,label_offset_y:G,label_rotation:X,label_position:_,label_overlap:H,label_fill_color:x,label_fill_opacity:C,label_stroke_color:T,label_stroke_opacity:O,label_stroke_size:J,label_font_size:ae,label_font_weight:ce,label_line_height:K,label_align:re})=>{const U={};V(e)&&(U.type=e);const ne=[];if(V(w)?ne.push({type:"dodge",marginRatio:0,dodgeBy:w}):h==="auto"&&ne.push({type:"dodge",marginRatio:0}),g==="auto"&&ne.push({type:"stack"}),ne.length&&(U.adjust=ne),V(a)&&V(n)&&(U.position={fields:[a,n]}),V(r)){const F=V(l)?Vt(l).map(ee):Rt;if(U.color={fields:[r],values:F},i&&i.length==F.length){const M=i.reduce((q,A,Q)=>(q[A]=F[Q],q),{});U.color.callback=q=>M[q]}}else U.color=ee(V(o)?o:"$themePrimary");if(V(s)?V(c)?U.shape={fields:[s],values:Vt(c)}:U.shape={fields:[s]}:V(d)&&(U.shape=d),e==="schema"&&(U.shape="box"),V(m)?V(u)?U.size={fields:[m],values:Dl(u)}:U.size={fields:[m]}:we(p)&&(U.size=p),V($)){const F=Bl(x,C,T,O,J,ae,ce,K,re),M={};switch(F&&(M.style=F),H){case"hide":M.layout={type:"overlap"};break;case"overlap":M.layout={type:"fixedOverlap"};break;case"constrain":M.layout={type:"limitInShape"};break}if(we(R)&&(M.offset=R),we(D)&&(M.offsetX=D),we(G)&&(M.offsetY=G),V(X)){const q=N.parseI(X);isNaN(q)?M.autoRotate=X!=="none":M.rotate=q*Math.PI/180}switch(_){case"top":case"bottom":case"middle":case"left":case"right":M.position=_}S?U.label={fields:[$],callback:q=>({content:S(null,q)})}:U.label={fields:[$]},Object.keys(M).length&&(U.label.cfg=M)}if(V(L))switch(L){case"smooth":U.shape="smooth";break;case"step-before":U.shape="vh";break;case"step":U.shape="hvh";break;case"step-after":U.shape="hv";break}const ke=sn(E,v,k,I,b,P);return ke&&(U.style=ke),U},sn=(e,a,n,r,l,i)=>{const o={};return V(e)&&(o.fill=ee(e)),we(a)&&(o.fillOpacity=a),V(n)&&(o.stroke=ee(n)),we(r)&&(o.strokeOpacity=r),we(l)&&(o.lineWidth=l),V(i)&&(o.lineDash=Dl(i)),Object.keys(o).length?o:void 0},Bl=(e,a,n,r,l,i,o,s,c)=>{const d={};if(d.fill=ee(V(e)?e:"$neutralPrimaryAlt"),we(a)&&(d.fillOpacity=a),V(n)&&(d.stroke=ee(n)),we(r)&&(d.strokeOpacity=r),we(l)&&(d.lineWidth=l),we(i)&&(d.fontSize=i),V(o)){const m=N.parseU(o);d.fontWeight=isNaN(m)?o:m}return we(s)&&(d.lineHeight=s),V(c)&&(d.textAlign=c),Object.keys(d).length?d:void 0},Ts=e=>{const a={},n={};for(const r of e)if(r.x_field){const[l,i]=lr(r.x_scale,r.x_format,r.x_title,r.x_min,r.x_max,r.x_nice);a[r.x_field]=l,i&&(n[r.x_field]=i);break}for(const r of e)if(r.y_field){const[l,i]=lr(r.y_scale,r.y_format,r.y_title,r.y_min,r.y_max,r.y_nice);a[r.y_field]=l,i&&(n[r.y_field]=i);break}return[a,n]},Ps=e=>{switch(e){case"time-category":return"timeCat";case"power":return"pow"}return e},lr=(e,a,n,r,l,i)=>{const o={},s={label:{autoHide:!1,autoRotate:!0},title:null};return V(e)&&(o.type=Ps(e)),a&&(o.formatter=c=>a(void 0,c)),V(n)&&(o.alias=n,s.title={}),we(r)&&(o.min=r),we(l)&&(o.max=l),o.nice=ys(i)?i:!0,[o,s]},Ds=e=>{for(const{coord:a}of e)if(V(a))return a},Ls=(e,a)=>{const n=Ds(a),r=e===3,l=r?[["transpose"]]:void 0;if(r)for(const i of a)$s(i);return n?l?{type:n,actions:l}:{type:n}:l?{actions:l}:void 0},Il=e=>{const a=[],n=[];for(const r of e){const{x:l,y:i}=r;l!=null||i!=null?n.push(...Ss(r)):a.push(_s(r))}return[a,n]},As=(e,a,n,r)=>{const l=Ls(a,n),[i,o]=Ts(n),[s,c]=Il(n);return{container:e,autoFit:!0,renderer:"canvas",theme:Pl(),options:{animate:!1,coordinate:l,scales:i,axes:o,geometries:s,annotations:c,interactions:r.map(d=>({type:d}))}}},cn=z({card:{display:"flex",flexDirection:"column",padding:se.gap},body:{flexGrow:1,display:"flex"},plot:{userSelect:"none","-webkit-user-select":"none",$nest:{svg:{position:"absolute",top:0,left:0,right:0,bottom:0}}}}),dn=document.createElement("div");dn.className="g2-tooltip";const Rs=({items:e})=>t.createElement(t.Fragment,null,e.map(({data:a,mappingData:n,color:r})=>Object.keys(a).map((l,i)=>t.createElement("li",{key:i,className:"g2-tooltip-list-item","data-index":i,style:{display:"flex",alignItems:"center",marginBottom:4}},t.createElement("span",{style:{backgroundColor:(n==null?void 0:n.color)||r},className:"g2-tooltip-marker"}),t.createElement("span",{style:{display:"inline-flex",flex:1,justifyContent:"space-between"}},t.createElement("span",{style:{marginRight:16}},l,":"),t.createElement("span",null,(Array.isArray(a[l])?a[l]:[a[l]]).map((o,s)=>{const c=o instanceof Date?o.toISOString().split("T")[0]:o;return s>0?` - ${c}`:c}))))))),Tn=({model:e})=>{const a=t.useRef(null),n=t.useRef(null),r=t.useRef(null),l=t.useRef(null),i=(u,p)=>{var h;const g=a.current;!g||(g.clientHeight!==p||g.clientWidth!==u)&&((h=n.current)==null||h.destroy(),o())},o=async()=>{Rt=Rt.map(ee);const u=a.current;if(!u)return;u.clientHeight<30&&(u.style.height="300px");const p=N.unpack(e.data),g=N.unpack(e.plot),h=g.marks.map(Ns),w={marks:h},L=hs(p,h),E=rr(p,w.marks),{Chart:v}=await Me(()=>import("./index.ce1f283d.js"),["static/index.ce1f283d.js","static/vendor.2f0b4f78.js"]),k=w.marks?new v(As(u,L,w.marks,e.interactions||[])):null;if(r.current=w,k){if(k.tooltip({title:" ",showCrosshairs:!0,crosshairs:{type:"xy"},domStyles:{"g2-tooltip":{backgroundColor:f("$card"),color:f("$text")}},customContent:(I,P)=>(Vr.render(t.createElement(Rs,{items:P}),dn),dn)}),n.current=k,k.data(E),e.plot.marks.filter(({x:I,y:P})=>I==null&&P==null).forEach(({interactive:I=!0},P)=>k.geometries[P].customInfo({interactive:I})),e.events)for(const I of e.events)switch(I){case"select_marks":k.interaction("element-single-selected"),k.on("element:statechange",P=>{var $;const b=P.gEvent.originalEvent;b.stateStatus&&b.state==="selected"&&e.name&&b.element.geometry.customOption.interactive&&y.emit(e.name,I,[($=b.element)==null?void 0:$.data])})}k.render(),setTimeout(()=>i(u.clientWidth,u.clientHeight),300),l.current=N.on(Da,()=>{Rt=Rt.map(ee);const[I,P]=Il(h);k.updateOptions({geometries:I,annotations:P}),k.theme(Pl()),k.render(!0)})}};t.useEffect(()=>(o(),()=>{var u;return(u=l.current)==null?void 0:u.dispose()}),[]),t.useEffect(()=>{if(!a.current||!n.current||!r.current)return;const p=N.unpack(e.data),g=rr(p,r.current.marks);n.current.changeData(g)},[n,r,e]);const{width:s="auto",height:c="auto",name:d}=e,m=s==="auto"&&c==="auto"?{flexGrow:1}:{width:wt(s),height:c};return t.createElement("div",{"data-test":d,style:m,className:cn.plot,ref:a})},Bs=j(({name:e,state:a,changed:n})=>({render:()=>{const{title:l="Untitled",plot:i,data:o,events:s,interactions:c}=a;return t.createElement("div",{className:cn.card},t.createElement("div",{className:"wave-s12 wave-w6"},l),t.createElement("div",{className:cn.body},t.createElement(Tn,{model:{name:e,plot:i,data:o,events:s,interactions:c}})))},changed:n}));Y.register("plot",Bs);const Is=({model:e})=>{const{label:a,caption:n="Please wait...",value:r,name:l}=e;return t.createElement("div",{"data-test":l},t.createElement(tn,{label:a,description:n,percentComplete:r}))},zs=({model:e})=>{const{min:a=0,max:n=100,step:r=1,min_value:l,max_value:i=n,disabled:o,trigger:s,name:c,label:d}=e,m=t.useCallback((p,g)=>{g&&(y.args[c]=g)},[c]),u=t.useCallback(()=>{s&&y.push()},[s]);return t.useEffect(()=>{y.args[c]=[typeof l=="number"&&l>a&&l<=n?l:a,typeof i=="number"&&i>a&&i<=n?i:n]},[]),t.createElement("div",{"data-test":c},t.createElement(jr,{ranged:!0,max:n,min:a,step:r,label:d,defaultLowerValue:l,defaultValue:i,disabled:o,onChange:m,onChanged:u}))},Ms=z({separator:{boxSizing:"border-box"}}),Fs=({model:e})=>t.createElement("div",{"data-test":e.name,className:Ms.separator},t.createElement(_a,null,e.label)),Ws=({model:e})=>{const{min:a=0,max:n=100,step:r=1,value:l=0}=e,i=l<a?a:l>n?n:l,o=c=>y.args[e.name]=c,s=t.useCallback((c,d)=>{e.trigger&&y.push()},[e.trigger]);return t.useEffect(()=>{y.args[e.name]=i},[]),t.createElement(jr,{"data-test":e.name,buttonProps:{"data-test":e.name},label:e.label,min:a,max:n,step:r,defaultValue:i,showValue:!0,originFromZero:a<0&&n>=0,onChange:o,onChanged:s,disabled:e.disabled})},Hs=500,Os=(e,a)=>{const n=Math.pow(10,a);return Math.round(e*n)/n},Vs=e=>{var n,r;const a=/[1-9]([0]+$)|\.([0-9]*)/.exec(String(e));return a&&(-((n=a[1])==null?void 0:n.length)||((r=a[2])==null?void 0:r.length))||0},js=({model:{name:e,trigger:a,label:n,disabled:r,min:l=0,max:i=100,step:o=1,value:s=0}})=>{const[c,d]=t.useState(String(s)),m=Math.max(Vs(o),0),u=t.useCallback(v=>{const k=Os(v,m);return!isNaN(k)&&isFinite(k)?k:s},[m,s]),p=()=>{const v=Math.min(u(Number(c)+o),i);return y.args[e]=v,a&&y.push(),d(String(v)),String(v)},g=()=>{const v=Math.max(u(Number(c)-o),l);return y.args[e]=v,a&&y.push(),d(String(v)),String(v)},h=t.useCallback(v=>{const k=/\.$|\.\d*0+$/,I=u(Number(v)),P=I>i?i:I<l?l:I;if(v==="-")d("-");else if(!m)d(String(P).split(".")[0]);else if(k.test(v)){const[b,$=""]=v.split(".");d(`${b}.${$.slice(0,m)}`)}else d(String(P));return P},[i,l,u,m]),w=t.useCallback(v=>{y.args[e]=v,a&&y.push()},[e,a]),L=t.useRef(y.debounce(Hs,w)),E=v=>{const k=h(v.target.value);a?L.current(k):w(k)};return t.useEffect(()=>{y.args[e]=s<l?l:s>i?i:s},[]),t.createElement(Xr,{inputProps:{"data-test":e,value:c},label:n,onInput:E,min:l,max:i,step:o,onIncrement:p,onDecrement:g,disabled:r})},lt=z({stats:{display:"flex",alignItems:"flex-start",overflowX:"auto"},inset:{background:f("$page"),padding:xe(10,15)},stat:{display:"flex",alignItems:"center"},lhs:{width:45,marginRight:"0.5em"},icon:{height:45,width:45},statCaption:{color:f("$text5")}}),Xs={start:"flex-start",end:"flex-end",center:"center",between:"space-between",around:"space-around"},Fa="2em",Us=({model:e})=>{var l;const a=e.justify?e.justify==="start"?{marginRight:Fa}:e.justify==="end"?{marginLeft:Fa}:{}:{marginRight:Fa},n=Xs[(l=e.justify)!=null?l:""],r=e.items.map(({label:i,value:o,caption:s,icon:c,icon_color:d},m)=>t.createElement("div",{key:`${m}:${i}`,className:lt.stat,style:a},c&&t.createElement("div",{className:lt.lhs,style:d?{color:f(d)}:void 0},t.createElement($e,{className:lt.icon,iconName:c,styles:{root:{"> span":{height:"100%",width:"100%"}}}})),t.createElement("div",null,t.createElement("div",{className:"wave-s12 wave-w5"},i),o&&t.createElement("div",{className:"wave-s24 wave-w3"},o),s&&t.createElement("div",{className:B(lt.statCaption,"wave-s13")},s))));return t.createElement("div",{className:B(lt.stats,e.inset?lt.inset:""),style:{justifyContent:n}},r)},ir=z({stepNumber:{background:"var(--text)",color:"var(--card)",alignItems:"center",borderRadius:"50%",display:"inline-flex",justifyContent:"center",fontSize:tl(.8),height:24,minWidth:24,width:24},disabled:{opacity:.5}}),or={root:{fontSize:24}},Gs=({model:e})=>{const a=e.items,n=l=>l>0&&!a[l-1].done?ir.disabled:"",r=(l,i)=>t.createElement(t.Fragment,{key:i},t.createElement(Le,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",grow:1},t.createElement(Le,{className:l.done?"":n(i),horizontalAlign:"center",styles:{root:{paddingRight:10,paddingLeft:10}}},l.done?t.createElement($e,{styles:or,iconName:"CompletedSolid"}):l.icon?t.createElement($e,{styles:or,iconName:l.icon}):t.createElement("span",{className:ir.stepNumber},i+1),t.createElement(fe,{block:!0,nowrap:!0,styles:{root:{padding:10}}},l.label))),a.length-1!==i&&t.createElement(_a,{styles:{root:{width:"100%"}}}));return t.createElement(Le,{"data-test":e.name,horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center"},a.map(r))},qs=z({card:{display:"flex",flexDirection:"column",justifyContent:"center"}}),Qs=({name:e,label:a,caption:n,icon:r,items:l,value:i})=>{y.args[e]=!1;const o=()=>{if(e.startsWith("#")){window.location.hash=e.substr(1);return}y.args[e]=i===void 0||i,y.push()};return{key:e,text:a,ariaLabel:n||a,title:n,iconOnly:!a,iconProps:r?{iconName:r}:void 0,subMenuProps:l?{items:xt(l),styles:Gt}:void 0,onClick:o}},xt=e=>e.map(Qs),Ys=j(({name:e,state:a,changed:n})=>({render:()=>{const{items:l,overflow_items:i,secondary_items:o}=a,s=xt(l),c=i?xt(i):void 0,d=o?xt(o):void 0;return t.createElement("div",{className:qs.card},t.createElement(Ut,{"data-test":e,items:s,overflowItems:c,overflowButtonProps:{ariaLabel:"More"},farItems:d,ariaLabel:"Use left and right arrow keys to navigate between commands."}))},changed:n}));Y.register("toolbar",Ys,{effect:Je.Transparent});const sr=z({container:{display:"inline",cursor:"pointer"},icon:{fontSize:18}}),Ks=({model:e})=>{const a=t.useRef(null),[n,r]=t.useState(!0),l=()=>r(!1),i=()=>r(!0);return t.createElement("div",{"data-test":e.name,className:sr.container,ref:a,onClick:l},t.createElement(at,{className:sr.icon,iconName:"MoreVertical"}),t.createElement(ka,{items:xt(e.commands.map(o=>ie(W({},o),{value:e.rowId}))),target:a,hidden:n,onDismiss:i,isBeakVisible:!0,directionalHint:$a.bottomCenter,calloutProps:{styles:{beak:{border:be(1,f("$neutralQuaternaryAlt"))}}},styles:Gt}))},Js=({model:e,icon:a})=>t.createElement($e,{"data-test":e.name,iconName:a,styles:{root:{fontSize:"1.2rem",color:e.color||"inherit"}}}),Zs=({model:e})=>{const a=t.useRef(null);return t.useEffect(()=>{var n;(n=a.current.querySelectorAll("a"))==null||n.forEach(r=>{e.target&&(r.target=e.target)})},[e.target]),t.createElement("div",{"data-test":e.name,ref:a},t.createElement(Se,{source:e.content}))},ec=z({container:{position:"absolute",top:0,left:0,right:0,bottom:0}}),Pn=({thickness:e,color:a,value:n})=>{const r=t.useRef(null),[l,i]=t.useState(null),o=t.useCallback(()=>{if(!r.current)return;const{width:c,height:d}=r.current.getBoundingClientRect();if(!d){setTimeout(o,300);return}const m=Math.min(c,d),u=m/2,p=m/2-e,g=ga()({outerRadius:u,innerRadius:p,startAngle:0,endAngle:2*Math.PI}),h=ga()({outerRadius:u,innerRadius:p,startAngle:0,endAngle:2*Math.PI*n});i(t.createElement("svg",{viewBox:`0 0 ${c} ${d}`,style:{position:"absolute",top:0,left:0,right:0,bottom:0}},t.createElement("g",{transform:m===d?`translate(${(c-2*u)/2}, 0)`:`translate(0, ${(d-2*u)/2})`},t.createElement("path",{d:g,fill:a,fillOpacity:.15,transform:`translate(${u},${u})`}),t.createElement("path",{d:h,fill:a,transform:`translate(${u},${u})`}))))},[a,e,n]),s=kt(1e3,o);return t.useEffect(()=>(window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[]),t.useLayoutEffect(o,[n,a,e,o]),t.createElement("div",{ref:r,className:ec.container},l)},Wa=z({container:{position:"relative",width:50,height:50},percentContainer:{position:"absolute",top:0,left:0,bottom:0,right:0},percent:{color:f("$text6")}}),tc=({model:e,progress:a})=>t.createElement("div",{"data-test":e.name,className:Wa.container},t.createElement(Pn,{thickness:2,color:f(e.color||"$red"),value:a}),t.createElement(Le,{horizontalAlign:"center",verticalAlign:"center",className:B(Wa.percentContainer,"wave-s12")},t.createElement("div",{className:Wa.percent},`${Math.round(a*100)}%`))),ac=z({tag:{borderRadius:4,padding:xe(4,16),"&:not(:first-child)":{marginLeft:8}}}),nc=({model:e,serializedTags:a})=>{const n=(r,l)=>{var d;const i=(d=e.tags)==null?void 0:d.find(({label:m})=>m===r),o=(i==null?void 0:i.color)||"$text",s=f(o),c=f((i==null?void 0:i.label_color)||Ht(o));return t.createElement("span",{key:l,style:{background:s,color:c},className:B(ac.tag,"wave-s12 wave-w6")},r)};return t.createElement("div",{"data-test":e.name},a.split(",").map(n))},cr=z({sortableHeader:{$nest:{".ms-DetailsHeader-cellName":{position:"relative",paddingRight:15}}},sortingIcon:{marginLeft:10,fontSize:tl(1.1),position:"absolute",top:-2,right:-5}}),rc={contentWrapper:{borderTop:"none",".ms-List-page:first-child .ms-List-cell:first-child > .ms-DetailsRow":{borderTop:be(2,"transparent")}}},lc={always:Aa.always,"on-hover":Aa.onHover,hidden:Aa.hidden},ic=function(e,a){return e.reduce((n,r)=>((n[r[a]]=n[r[a]]||[]).push(r),n),{})},dr=(e,a)=>(n,r)=>{let l=n[e.key],i=r[e.key];switch(e.dataType){case"number":return l=+l,i=+i,a?l-i:i-l;case"time":l=Date.parse(l),i=Date.parse(i);break;default:l=l.toLowerCase(),i=i.toLowerCase();break}return a?i>l?-1:1:i>l?1:-1},mr=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),oc=e=>e.map(a=>{const n=JSON.stringify(a);return n.substr(1,n.length-2)}).join(`
`),sc=({onFilterChange:e,col:a,listProps:n,selectedFiltersRef:r,setFiltersInBulk:l})=>{var u;const i=(p,g)=>{var h;return!!r.current&&((h=r.current[p])==null?void 0:h.includes(g))},[o,s]=t.useState(((u=a.cellType)==null?void 0:u.tag)?Array.from(n.items.reduce((p,{key:g,text:h,data:w})=>(g.split(",").forEach(L=>p.set(L,{key:L,text:h,data:w,checked:i(w,L)})),p),new Map).values()):n.items.map(p=>ie(W({},p),{checked:i(p.data,p.key)}))),c=()=>{s(o.map(p=>ie(W({},p),{checked:!0}))),l(a.key,o.map(p=>p.key))},d=()=>{s(o.map(p=>ie(W({},p),{checked:!1}))),l(a.key,[])},m=(p,g)=>(h,w)=>{s(L=>L.map(E=>E.key===g?ie(W({},E),{checked:w}):E)),e(p,g,w)};return t.createElement("div",{style:{padding:10}},t.createElement(fe,{variant:"mediumPlus",styles:{root:{paddingTop:10,paddingBottom:10,fontWeight:"bold"}},block:!0},"Show only"),t.createElement(fe,{variant:"small"},t.createElement(Ae,{onClick:c},"Select All")," | ",t.createElement(Ae,{onClick:d},"Deselect All")),o.map(({key:p,data:g,checked:h})=>t.createElement(Xt,{key:p,label:p,checked:h,onChange:m(g,p),styles:{root:{marginBottom:5},checkmark:{display:"flex"}}})))},ur=t.forwardRef(({model:e,onFilterChange:a,items:n,filteredItems:r,selection:l,selectedFilters:i,isMultiple:o,groups:s,expandedRefs:c,sort:d,setFiltersInBulk:m},u)=>{var _,H;const[p,g]=t.useState(null),h=t.useRef(i),w=(x,C)=>{if(x.target.closest('[data-icon-name="ChevronDown"]'))I(C,x);else if(C.isSortable){const O=C.iconName==="SortDown"||!C.iconName;d(C,O),E(L.map(J=>(C.key===J.key?J.iconName=O?"SortUp":"SortDown":J.iconName=void 0,J)))}},[L,E]=t.useState(e.columns.map(x=>{var O;const C=x.min_width?x.min_width.endsWith("px")?+x.min_width.substring(0,x.min_width.length-2):+x.min_width:150,T=x.max_width?x.max_width.endsWith("px")?+x.max_width.substring(0,x.max_width.length-2):+x.max_width:void 0;return{key:x.name,name:x.label,fieldName:x.name,minWidth:C,maxWidth:T,headerClassName:x.sortable?cr.sortableHeader:void 0,iconClassName:x.sortable?cr.sortingIcon:void 0,onColumnClick:w,columnActionsMode:x.filterable?Mn.hasDropdown:Mn.clickable,cellType:x.cell_type,dataType:x.data_type,isSortable:x.sortable,cellOverflow:x.cell_overflow,styles:{root:{height:48},cellName:{color:f("$neutralPrimary")}},isResizable:!0,isMultiline:!!((O=x.cell_type)==null?void 0:O.markdown)||x.cell_overflow==="wrap",filters:x.filterable&&e.pagination?x.filters:void 0}})),v=((_=e.columns.find(x=>x.link))==null?void 0:_.name)||(e.columns[0].link===!1?void 0:e.columns[0].name),k=t.useCallback(x=>C=>C?t.createElement(sc,{onFilterChange:a,col:x,listProps:C,selectedFiltersRef:h,setFiltersInBulk:m}):null,[a,m]),I=t.useCallback((x,C)=>{const T=x.filters||n.map(O=>O[x.fieldName||x.key]);g({items:Array.from(new Set(T)).map(O=>({key:O,text:O,data:x.fieldName||x.key})),target:C.target,directionalHint:$a.bottomLeftEdge,gapSpace:10,isBeakVisible:!0,onRenderMenuList:k(x),onDismiss:()=>g(null)})},[n,k]),P=t.useCallback(x=>x?t.createElement(xi,{stickyPosition:Ei.Header,isScrollSynced:!0},t.createElement(wi,ie(W({},x),{isAllCollapsed:s==null?void 0:s.every(C=>C.isCollapsed),styles:ie(W({},x.styles),{root:{padding:0,height:48,lineHeight:"48px",background:f("$neutralLight"),borderBottom:"none"},cellSizerEnd:{marginLeft:-8},cellIsGroupExpander:{height:48}})}))):t.createElement("span",null),[s]),b=t.useCallback(x=>x?t.createElement(ki,ie(W({},x),{styles:{root:{position:"sticky",top:48,backgroundColor:f("$card"),zIndex:1}}})):t.createElement("span",null),[]),$=x=>c.current=x?{}:null,S=({key:x,isCollapsed:C})=>{c.current?C?c.current[x]=!1:delete c.current[x]:c.current={[x]:!1}},R=x=>x?t.createElement(Si,ie(W({},x),{styles:{cell:{alignSelf:"center",fontSize:14,lineHeight:20,color:f("$text9")},checkCell:{display:"flex",alignItems:"center"},root:{width:"100%",border:be(2,"transparent"),borderTop:be(2,f("$neutralLight")),background:f("$card"),minHeight:48,"&:hover":{background:f("$neutralLight"),border:`${be(2,f("$themePrimary"))} !important`}}}})):null,D=x=>{y.args[e.name]=[x.key],y.push()},G=(x,C,T)=>{var ae,ce,K,re,U;if(!x||!T)return t.createElement("span",null);const O=({children:ne})=>T.cellOverflow==="tooltip"?t.createElement(Za,{id:x.key,styles:{root:{"::after":{content:"",display:"block"}}},content:ne,overflowMode:_i.Parent,title:ne},ne):t.createElement(t.Fragment,null,ne);let J=x[T.fieldName];if((ae=T.cellType)==null?void 0:ae.progress)return t.createElement(tc,{model:T.cellType.progress,progress:x[T.key]});if((ce=T.cellType)==null?void 0:ce.icon)return t.createElement(Js,{model:T.cellType.icon,icon:x[T.key]});if((K=T.cellType)==null?void 0:K.tag)return t.createElement(nc,{model:T.cellType.tag,serializedTags:x[T.key]});if((re=T.cellType)==null?void 0:re.menu)return t.createElement(Ks,{model:ie(W({},T.cellType.menu),{rowId:String(x.key)})});if((U=T.cellType)==null?void 0:U.markdown)return t.createElement(Zs,{model:ie(W({},T.cellType.markdown),{content:x[T.key]})});if(T.dataType==="time"){const ne=Number(J);J=new Date(isNaN(ne)?J:ne).toLocaleString()}if(T.key===v){const ne=()=>{y.args[e.name]=[x.key],y.push()};return t.createElement(Ae,{onClick:ne},t.createElement(O,null,J))}return t.createElement(O,null,J)},X=x=>{const C=e.columns.some(O=>{var J;return(J=O.cell_type)==null?void 0:J.progress})?76:48;return 48+(x.isCollapsed?0:C*x.count)};return t.useEffect(()=>{h.current=i},[i]),t.useImperativeHandle(u,()=>({resetSortIcons:()=>{E(L.map(x=>(x.iconName&&(x.iconName=void 0),x)))}})),t.createElement(t.Fragment,null,t.createElement(Ci,{styles:rc,items:r,columns:L,constrainMode:$i.unconstrained,layoutMode:Ni.fixedColumns,groups:s,groupProps:{onToggleCollapseAll:$,onRenderHeader:b,headerProps:{onToggleCollapse:S},isAllGroupsCollapsed:(H=e.groups)==null?void 0:H.every(({collapsed:x=!0})=>x)},getGroupHeight:X,selection:l,selectionMode:o?Fn.multiple:Fn.none,selectionPreservedOnEmptyClick:!0,onItemInvoked:o?void 0:D,onRenderRow:R,onRenderItemColumn:G,onRenderDetailsHeader:P,checkboxVisibility:lc[e.checkbox_visibility||"on-hover"]}),p&&t.createElement(ka,W({},p)))}),cc=({currentPage:e,onPageChange:a,pagination:n})=>{const{total_rows:r,rows_per_page:l}=n,i=Math.ceil(r/l),o={rootDisabled:{background:"transparent"},root:{marginLeft:-8}},s=e===i||i===0;return t.createElement("span",null,t.createElement("span",{style:{marginRight:15}},r?t.createElement(t.Fragment,null,t.createElement("b",null,(e-1)*l+1)," to ",t.createElement("b",null,s?r:e*l)," of ",t.createElement("b",null,r)):t.createElement(t.Fragment,null,t.createElement("b",null,"0")," to ",t.createElement("b",null,"0")," of ",t.createElement("b",null,"0"))),t.createElement(vt,{iconProps:{iconName:"DoubleChevronLeft"},disabled:e===1,onClick:()=>a(1),styles:o,title:"First page"}),t.createElement(vt,{iconProps:{iconName:"ChevronLeft"},disabled:e===1,onClick:()=>a(e-1),styles:o,title:"Previous page"}),t.createElement("span",{style:{margin:ye(0,8)}},"Page ",t.createElement("b",null,e)," of ",t.createElement("b",null,i||1)),t.createElement(vt,{iconProps:{iconName:"ChevronRight"},disabled:s,onClick:()=>a(e+1),styles:o,title:"Next page"}),t.createElement(vt,{iconProps:{iconName:"DoubleChevronRight"},disabled:s,onClick:()=>a(i),styles:o,title:"Last page"}))},dc=({m:e,isFilterable:a,isSearchable:n,displayedRows:r,reset:l,currentPage:i,onPageChange:o})=>{const s=[],c={root:{background:f("$card")}},d=()=>{var w,L;if(e.pagination&&((w=e.events)==null?void 0:w.includes("download"))){y.emit(e.name,"download",!0);return}const m=((L=e.groups?e.groups.flatMap(({rows:E})=>E):e.rows)==null?void 0:L.map(({cells:E})=>E))||[],u=oc([e.columns.map(({label:E,name:v})=>E||v),...m]),p=document.createElement("a"),g=new Blob([u],{type:"octet/stream"}),h=window.URL.createObjectURL(g);p.href=h,p.download="exported_data.csv",p.click(),window.URL.revokeObjectURL(h)};return e.downloadable&&s.push({key:"download",text:"Download data",iconProps:{iconName:"Download"},onClick:d,buttonStyles:c}),e.resettable&&s.push({key:"reset",text:"Reset table",iconProps:{iconName:"Refresh"},onClick:l,buttonStyles:c}),t.createElement(Le,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"center",className:"wave-s12",styles:{root:{background:f("$neutralLight"),borderRadius:"0 0 4px 4px",paddingLeft:12,height:46,position:"absolute",bottom:0,left:0,right:0}}},!e.pagination&&(a||n)&&t.createElement(fe,{variant:"smallPlus",block:!0,styles:{root:{whiteSpace:"nowrap",color:f("$text")}}},t.createElement("b",{style:{paddingLeft:5}},r)),e.pagination&&t.createElement(cc,{pagination:e.pagination,currentPage:i,onPageChange:o}),!!s.length&&t.createElement(Hr,{grow:1},t.createElement(Ut,{items:s,styles:{root:{background:f("$neutralLight"),".ms-Button--commandBar":{background:"transparent"}},primarySet:{justifyContent:"flex-end"}}})))},mc=({model:e})=>{var ke;const a=!e.groups&&e.groupable,n=t.useCallback(F=>{const M={key:F.name};for(let q=0,A=F.cells.length;q<A;q++){const Q=e.columns[q];M[Q.name]=F.cells[q]}return M},[e.columns]),r=t.useMemo(()=>e.groups?e.groups.reduce((F,{rows:M,label:q,collapsed:A=!0})=>(F.push(...M.map(Q=>ie(W({},n(Q)),{group:q,collapsed:A}))),F),[]):(e.rows||[]).map(n),[e.rows,e.groups,n]),l=Boolean(((ke=e.values)==null?void 0:ke.length)||e.multiple),[i,o]=t.useState(r),[s,c]=t.useState(1),d=t.useMemo(()=>e.columns.filter(({searchable:F})=>F).map(({name:F})=>F),[e.columns]),[m,u]=t.useState(""),[p,g]=t.useState(null),[h,w]=t.useState(),L=t.useRef({}),[E,v]=t.useState("*"),k=t.useRef(null),I=t.useRef(null),P=t.useMemo(()=>a?[{key:"*",text:"(No Grouping)"},...e.columns.map(F=>({key:F.name,text:F.label}))]:[],[e.columns,a]),b=t.useCallback(F=>{o(F?r.filter(M=>Object.keys(F).every(q=>!F[q].length||F[q].some(A=>String(M[q]).includes(A)))):r)},[r]),$=(F,M)=>{if(M===null)return!1;const q=M[F];return q===void 0||q},S=t.useCallback((F,M)=>{var Q;let q,A=[];if(e.groups)q=M.reduce((Z,{group:le},Ce)=>{const ge=Z[Z.length-1];return(ge==null?void 0:ge.key)===le?ge.count++:Z.push({key:le,name:le,startIndex:Ce,count:1,isCollapsed:$(le,L.current)}),Z},[]);else{let Z=0;A=ic(M,F);const le=Object.keys(A),Ce=(Q=e.columns.find(ge=>ge.name===F))==null?void 0:Q.data_type;q=le.map((ge,nt)=>{if(nt!==0){const Jt=le[nt-1];Z+=A[Jt].length}const Kt=Ce==="time"?new Date(ge).toLocaleString():ge;return{key:ge,name:Kt,startIndex:Z,count:A[ge].length,isCollapsed:$(ge,L.current)}}).sort(({name:ge},{name:nt})=>{const Kt=Number(ge),Jt=Number(nt);if(!isNaN(Kt)&&!isNaN(Jt))return Kt-Jt;const An=Date.parse(ge),Rn=Date.parse(nt);return!isNaN(An)&&!isNaN(Rn)?An-Rn:nt<ge?1:-1})}return{groupedBy:A,groups:q}},[e.columns,e.groups]),R=t.useCallback(()=>{v(F=>(o(M=>{const{groupedBy:q,groups:A}=S(F,M);return w(A),e.groups?M:Object.values(q).flatMap(Q=>Q)}),F))},[e.groups,S]),D=t.useCallback(()=>{u(F=>{const M=F.toLowerCase();return!M||!d.length||o(q=>q.filter(A=>d.some(Q=>A[Q].toLowerCase().includes(M)))),F||""})},[d]),G=F=>{y.emit(e.name,"search",{value:F,cols:d}),c(1)},X=t.useRef(y.debounce(500,G)),_=t.useCallback((F,M="")=>{var q;if(u(M),e.pagination&&((q=e.events)==null?void 0:q.includes("search"))){X.current(M);return}if(!M&&!p){o(r),w(A=>(A&&R(),A));return}b(p),D(),w(A=>(A&&R(),A))},[e.pagination,e.events,p,b,D,r,R]),H=(F,M)=>{if(!!M){if(e.pagination){y.emit(e.name,"group_by",!0),c(1);return}ae(),M.key!=="*"&&(v(M.key),L.current={},R())}},x=t.useCallback(F=>{var M;e.pagination&&((M=e.events)==null?void 0:M.includes("page_change"))&&(c(F),y.emit(e.name,"page_change",{offset:(F-1)*e.pagination.rows_per_page}),(k==null?void 0:k.current)&&(k.current._contentContainer.current.scrollTop=0))},[e.events,e.name,e.pagination]),C=!!d.length,T=e.columns.some(F=>F.filterable),O=e.downloadable||e.resettable||C||T||!!e.pagination,J=t.useCallback((F,M,q)=>{g(A=>{var Z;const Q=A||{};return q?Q[F]?Q[F].push(M):Q[F]=[M]:Q[F]=Q[F].filter(le=>le!==M),e.pagination&&((Z=e.events)==null?void 0:Z.includes("filter"))?(y.emit(e.name,"filter",Q),c(1)):(b(Q),D(),w(le=>(le&&R(),le))),Q})},[b,R,e.events,e.name,e.pagination,D]),ae=t.useCallback(()=>{var F,M;if(g(null),u(""),w(void 0),e.groups&&R(),L.current={},v("*"),(F=I.current)==null||F.resetSortIcons(),e.pagination&&((M=e.events)==null?void 0:M.includes("reset"))){y.emit(e.name,"reset",!0),c(1);return}b(null),D()},[b,R,e.events,e.groups,e.name,e.pagination,D]),ce=t.useMemo(()=>new Ti({onSelectionChanged:()=>{y.args[e.name]=ce.getSelection().map(F=>F.key)}}),[e.name]),K=()=>{if(e.height)return e.height;if(r.length>10)return 500;const F=d.length||a?80:0,M=50,q=e.columns.some(Z=>{var le;return(le=Z.cell_type)==null?void 0:le.progress})?76:48,A=e.downloadable||e.resettable||d.length||e.columns.some(Z=>Z.filterable)?46:0,Q=2;return F+M+r.length*q+A+Q},re=t.useCallback((F,M)=>{var q;if(e.pagination&&((q=e.events)==null?void 0:q.includes("sort"))){y.emit(e.name,"sort",{[F.fieldName||F.name]:M}),c(1);return}w(A=>(o(A?Q=>[...A].sort((Z,le)=>Z.startIndex-le.startIndex).reduce((Z,le)=>[...Z,...Q.slice(le.startIndex,Z.length+le.count).sort(dr(F,M))],[])||[]:Q=>[...Q].sort(dr(F,M))),A))},[e.events,e.name,e.pagination]),U=t.useCallback((F,M)=>{g(q=>{var Q;const A=ie(W({},q),{[F]:M});return e.pagination&&((Q=e.events)==null?void 0:Q.includes("filter"))?(y.emit(e.name,"filter",A),c(1)):(b(A),D(),w(Z=>(Z&&R(),Z))),A})},[e.pagination,e.events,e.name,b,D,R]);t.useEffect(()=>{y.args[e.name]=[],l&&e.values&&(e.values.forEach(F=>ce.setKeySelected(F,!0,!1)),y.args[e.name]=e.values)},[]),t.useEffect(()=>o(r),[r]),t.useEffect(()=>{var F;e.groups&&(L.current=(F=e.groups)==null?void 0:F.reduce((M,{label:q,collapsed:A=!0})=>(A||(M[q]=!1),M),{}),R())},[R,e.groups]);const ne=t.useMemo(()=>({model:e,onFilterChange:J,items:r,filteredItems:i,selectedFilters:p,groups:h,expandedRefs:L,selection:ce,sort:re,isMultiple:l,setFiltersInBulk:U}),[i,h,L,l,r,e,J,p,ce,re,U]);return t.createElement("div",{"data-test":e.name,style:{position:"relative",height:K()}},t.createElement(Le,{horizontal:!0,horizontalAlign:"space-between",verticalAlign:"end"},a&&!e.pagination&&t.createElement(Na,{"data-test":"groupby",label:"Group by",selectedKey:E,onChange:H,options:P,styles:{root:{width:300}}}),!!d.length&&t.createElement(Fr,{"data-test":"search",placeholder:"Search",onChange:_,value:m,styles:{root:{width:"50%",maxWidth:500}}})),t.createElement(Wr,{componentRef:k,scrollbarVisibility:Pi.auto,styles:{root:{top:a||d.length?80:0,bottom:O?46:0},stickyAbove:{right:he("12px"),border:be(2,"transparent"),zIndex:2},contentContainer:{border:be(2,f("$neutralLight")),borderRadius:"4px 4px 0 0"}}},l?t.createElement(Di,{selection:ce},t.createElement(ur,W({ref:I},ne))):t.createElement(ur,W({ref:I},ne))),O&&t.createElement(dc,{m:e,currentPage:s,onPageChange:x,isSearchable:C,isFilterable:T,displayedRows:`${mr(i.length)} of ${mr(r.length)}`,reset:ae}))},uc=z({pivot:{minHeight:46,overflowX:"auto",overflowY:"hidden"}}),pc=({model:e})=>{var i;const a=o=>{const s=o==null?void 0:o.props.itemKey;if(!!s){if(l(s),s.startsWith("#")){window.location.hash=s.substr(1);return}e.name?s!==y.args[e.name]&&(y.args[e.name]=s,y.push()):(y.args[s]=!0,y.push())}},n=(i=e.items)==null?void 0:i.map(o=>t.createElement(Ur,{key:o.name,itemIcon:o.icon,itemKey:o.name,headerText:o.label})),[r,l]=t.useState(e.value);return t.useEffect(()=>l(e.value),[e.value]),t.createElement("div",{className:uc.pivot},t.createElement(Gr,{"data-test":e.name,className:e.link?"w-tabs-link":"w-tabs",selectedKey:r,linkFormat:e.link?"links":"tabs",onLinkClick:a},n))},fc=({model:e})=>{const a=Ca.compile(e.content||""),n=N.unpack(e.data);return t.createElement("div",{"data-test":e.name},t.createElement(Sn,{model:{content:a(n||{})}}))},gc=j(({name:e,state:a,changed:n})=>{const r=Ca.compile(a.content||"");return{render:()=>{const i=N.unpack(a.data);return t.createElement(Nl,{name:e,title:Et(a.title,i),content:r(i||{})})},changed:n}});Y.register("template",gc);const hc=z({text:{position:"relative",$nest:{p:{margin:ye(0,0,10,0)}}}}),yc={xl:"xLarge",l:"large",m:"medium",s:"small",xs:"xSmall"},vc=e=>yc[e]||"mediumPlus",it=({content:e,name:a,size:n,commands:r})=>{const l=a&&`${a}-menu`;return t.createElement("div",{className:hc.text},t.createElement(fe,{"data-test":a,variant:vc(n||"m"),block:!0,styles:{root:{color:f("$text")}}},t.createElement(Se,{source:e})),!!(r==null?void 0:r.length)&&t.createElement(Cn,{name:l,commands:r}))},bc=500,xc=({model:e})=>{var o;const[a,n]=t.useState((o=e.value)!=null?o:""),r=t.useRef(kt(bc,y.push)),l=({target:s},c)=>{c=c||s.value,y.args[e.name]=c!=null?c:e.value||"",e.trigger&&r.current(),n(c),e.value=c},i={"data-test":e.name,label:e.label,value:a,errorMessage:e.error,required:e.required,disabled:e.disabled,readOnly:e.readonly,onChange:l,iconProps:e.icon?{iconName:e.icon}:void 0,placeholder:e.placeholder,prefix:e.prefix,suffix:e.suffix,multiline:e.multiline,spellCheck:e.spellcheck,type:e.password?"password":void 0};return t.useEffect(()=>{var s,c;y.args[e.name]=(s=e.value)!=null?s:"",n((c=e.value)!=null?c:"")},[e.value,e.name]),e.mask?t.createElement(Li,W({mask:e.mask},i)):t.createElement(ze,W({styles:e.multiline&&e.height&&!e.height.endsWith("%")?{field:{height:e.height},fieldGroup:{minHeight:e.height}}:void 0},i))},Te=z({title:{color:f("$neutralPrimary"),marginBottom:8},tags:{display:"flex",flexWrap:"wrap",marginTop:1},tag:{cursor:"pointer",padding:xe(4,16),textAlign:"center",borderRadius:4},tagWrapper:{marginRight:4,marginBottom:4,border:be(2,f("$card")),padding:1},mark:{position:"relative",padding:xe(2,0)},firstMark:{paddingLeft:4,borderTopLeftRadius:4,borderBottomLeftRadius:4},lastMark:{paddingRight:4,borderTopRightRadius:4,borderBottomRightRadius:4},content:{margin:ye(12,0),paddingTop:2,lineHeight:"26px"},removeIcon:{cursor:"pointer",position:"absolute",left:-8,top:-7,transform:"rotate(45deg)",fontSize:16,fontWeight:100,lineHeight:"initial",color:f("$neutralPrimary"),zIndex:1},iconUnderlay:{width:10,height:10,position:"absolute",left:-5,top:-3,background:f("$card")},readonly:{pointerEvents:"none"},checkbox:{$nest:{"&:hover":{backgroundColor:f("$neutralLighter"),color:f("$neutralDark")}}}}),pr=(e,a,n)=>{let r=e+1,l=e-1;for(;r<=a.length-1&&!isNaN(+a[r].text);)a[r].tag=n,r++;for(;l>=0&&!isNaN(+a[l].text);)a[l].tag=n,l--},zl=({tags:e,activateTag:a,activeTag:n})=>t.createElement("div",{className:Te.tags},e.map(({name:r,color:l,label:i})=>{const o=z({tag:{background:f(l),color:Ht(l)},activeTag:{border:be(2,f("$themePrimary")),borderRadius:6}});return t.createElement("div",{key:r,"data-test":r,className:B(Te.tagWrapper,n===r?o.activeTag:"")},t.createElement("div",{className:B(Te.tag,o.tag,"wave-s12"),onClick:a(r)},i))})),Ec=({model:{name:e,title:a,tags:n,items:r,trigger:l,readonly:i}})=>{var X;const[o,s]=t.useState(i||(X=n[0])==null?void 0:X.name),[c,d]=t.useState(),[m,u]=t.useState(!0),p=t.useRef(),g=new Map(n.map(_=>[_.name,_.color])),[h,w]=t.useState(r.reduce((_,{text:H,tag:x})=>(H.split(/([^a-z])/ig).filter(C=>C!=="").forEach(C=>{const T=_.length===0?0:_[_.length-1].end+1,O=_.length===0?C.length-1:_[_.length-1].end+C.length;_.push(...C.split("").map(J=>({text:J,tag:x,start:T,end:O})))}),_),[])),L=()=>{let _="",H;y.args[e]=h.reduce((x,{text:C,tag:T},O,J)=>(O===J.length-1?T!==H?(x.push({text:_,tag:H}),x.push({text:C,tag:T})):x.push({text:_+C,tag:T}):O!==0&&T!==H?(x.push({text:_,tag:H}),_=C):_+=C,H=T,x),[]),l&&y.push()},E=_=>()=>s(_),v=_=>H=>{var C;H.stopPropagation();const x=h[_].tag;for(let T=_;((C=h[T])==null?void 0:C.tag)===x;T++)h[T].tag=void 0;p.current=void 0,w([...h]),L()},k=()=>{h.forEach(_=>_.tag=void 0),w([...h]),L()},I=_=>{var O,J;if(!p.current)return;const H=p.current,x=m?Math.max(H.end,_.end):Math.max(H.key,_.key),C=m?Math.min(H.start,_.start):Math.min(H.key,_.key),T=(O=window.getSelection())==null?void 0:O.toString().replace(/\r?\n|\r/g,"");for(let ae=C;ae<=x;ae++)!m&&T&&x-C+1!==T.length&&(ae===C&&T.charAt(0)!==h[ae].text||ae===x&&T.charAt(T.length-1)!==h[ae].text)||(h[ae].tag=o);m&&(isNaN(+h[H.key].text)||pr(H.key,h,o),H.key!==_.key&&!isNaN(+h[_.key].text)&&pr(_.key,h,o)),w([...h]),L(),(J=window.getSelection())==null||J.removeAllRanges(),p.current=void 0},P=_=>()=>d(_),b=()=>d(null),$=(_,H)=>{var x,C,T;if(c===null||((x=h[c])==null?void 0:x.tag)!==H||((C=h[_-1])==null?void 0:C.tag)===H)return!1;if(_===c)return!0;for(let O=_;((T=h[O])==null?void 0:T.tag)===H;O++)if(O===c)return!0;return!1},S=(_,H,x)=>{var ae,ce;const C=g.get(x);if(!C)return _;const T={visibility:$(H,x)?"visible":"hidden"},O=((ae=h[H-1])==null?void 0:ae.tag)!==x,J=((ce=h[H+1])==null?void 0:ce.tag)!==x;return t.createElement("mark",{onMouseOver:P(H),onMouseOut:b,className:B(Te.mark,O?Te.firstMark:"",J?Te.lastMark:""),style:{backgroundColor:f(C),color:Ht(C)}},_,t.createElement($e,{iconName:"CircleAdditionSolid","data-test":"remove-icon",styles:{root:T},className:B(Te.removeIcon,"wave-w6"),onMouseUp:v(H)}),t.createElement("span",{style:T,className:Te.iconUnderlay}))},R=_=>()=>p.current=_,D=_=>()=>I(_),G=_=>{var x,C,T,O,J;const H=(x=_.relatedTarget)==null?void 0:x.nodeName;if(p.current!==void 0&&H!=="P"&&H!=="MARK"){const ae=(J=(O=(T=(C=window.getSelection())==null?void 0:C.focusNode)==null?void 0:T.parentElement)==null?void 0:O.dataset)==null?void 0:J.keys;ae&&I(JSON.parse(ae))}};return t.useEffect(()=>{y.args[e]=r},[]),t.createElement("div",{"data-test":e,className:i?Te.readonly:""},t.createElement("div",{className:B("wave-s16 wave-w6",Te.title)},a),t.createElement(zl,{tags:n,activateTag:E,activeTag:o}),t.createElement("div",{style:{display:"flex"}},t.createElement(Xt,{label:"Smart selection",checked:m,onChange:()=>u(_=>!_),className:Te.checkbox,styles:{root:{alignItems:"center",paddingLeft:8,paddingRight:8}}}),t.createElement(Ut,{styles:{root:{padding:0}},items:[{key:"remove-all",text:"Remove all selections",onClick:k,disabled:!h.find(_=>_.tag),iconProps:{iconName:"DependencyRemove",styles:{root:{fontSize:20}}}}]})),t.createElement("div",{className:B(Te.content,"wave-s16 wave-t7 wave-w3"),onMouseUp:G},h.map(({start:_,end:H,text:x,tag:C},T)=>{const O=o?g.get(o):void 0;return t.createElement("p",{key:T,"data-keys":`{ "key": ${T}, "start": ${_}, "end": ${H} }`,onMouseDown:R({key:T,start:_,end:H}),onMouseUp:D({key:T,start:_,end:H}),style:{display:"inline",padding:"4px 0px"},className:O?Ai({$nest:{"&::selection":{background:O,color:Ht(O)}}}):void 0},C?S(x,T,C):x)})))},ra=z({title:{color:f("$primary"),marginBottom:8},canvas:{display:"block",margin:"0 auto",cursor:"crosshair",position:"absolute",top:0,left:0,right:0,bottom:0},canvasContainer:{position:"relative",margin:8}}),pe=4,wc=5,kc=5,mn=(e,a,n)=>{if(!n)return!1;const{x2:r,x1:l,y2:i,y1:o}=n,s=Math.min(l,r),c=Math.max(l,r),d=Math.min(o,i),m=Math.max(o,i);return e>s&&e<c&&a>d&&a<m},Ha=(e,a)=>({cursor_x:e.clientX-a.left,cursor_y:e.clientY-a.top}),la=(e,a,n,r)=>{e.beginPath(),e.fillStyle=r;const l=new Path2D;l.arc(a,n,pe,0,2*Math.PI),e.fill(l),e.closePath()},fr=(e,{x1:a,x2:n,y1:r,y2:l},i,o=!1)=>{e.beginPath(),e.lineWidth=3,e.strokeStyle=i,e.strokeRect(a,r,n-a,l-r),e.closePath(),o&&(e.beginPath(),e.fillStyle="rgba(0, 0, 0, 0.3)",e.fillRect(a,r,n-a,l-r),e.closePath(),la(e,a,r,i),la(e,n,r,i),la(e,n,l,i),la(e,a,l,i))},Ml=(e,a,{x1:n,y1:r,x2:l,y2:i},o=!1)=>{const s=o?n:Math.min(n,l),c=o?l:Math.max(n,l),d=o?r:Math.min(r,i),m=o?i:Math.max(r,i);if(e>s-pe&&e<s+pe&&a>d-pe&&a<d+pe)return"topLeft";if(e>s-pe&&e<s+pe&&a>m-pe&&a<m+pe)return"topRight";if(e>c-pe&&e<c+pe&&a>d-pe&&a<d+pe)return"bottomLeft";if(e>c-pe&&e<c+pe&&a>m-pe&&a<m+pe)return"bottomRight"},gr=(e,a,n)=>{const r=Ml(a,n,e);if(r==="topLeft"||r==="bottomRight")return"nwse-resize";if(r==="bottomLeft"||r==="topRight")return"nesw-resize"},hr=(e,a,n,r)=>{const l=e.find(i=>mn(a,n,i.shape.rect));return(l==null?void 0:l.isFocused)&&l.shape.rect?gr(l.shape.rect,a,n)||"move":(r==null?void 0:r.shape.rect)?gr(r.shape.rect,a,n)||"crosshair":l?"pointer":"crosshair"},yr=(e,a,n,r,{width:l,height:i})=>Math.abs(a-e)<=wc||Math.abs(r-n)<=kc?void 0:{x1:e>l?l:e<0?0:e,x2:a>l?l:a<0?0:a,y1:n>i?i:n<0?0:n,y2:r>i?i:r<0?0:r},Cc=({model:e})=>{var I;const a=t.useMemo(()=>new Map(e.tags.map(P=>[P.name,ee(P.color)])),[e.tags]),[n,r]=t.useState(((I=e.tags[0])==null?void 0:I.name)||""),[l,i]=t.useState([]),o=t.useRef(null),s=t.useRef(null),[c,d]=t.useState(1),m=t.useRef(void 0),u=t.useRef(void 0),p=t.useRef(void 0),g=t.useRef(void 0),h=t.useCallback(P=>()=>r(P),[r]),w=t.useCallback(()=>{const P=s.current,b=u.current;!b||!P||(b.clearRect(0,0,P.width,P.height),i($=>($.forEach(S=>{S.shape.rect&&fr(b,S.shape.rect,a.get(S.tag)||ee("$red"),S.isFocused)}),$)))},[a]),L=P=>{if(P.button!==0)return;const b=s.current;if(!b)return;const{cursor_x:$,cursor_y:S}=Ha(P,b.getBoundingClientRect()),R=l.find(({isFocused:D})=>D);(R==null?void 0:R.shape.rect)&&(p.current=Ml($,S,R.shape.rect,!0)),m.current={x:$,y:S}},E=P=>{var X;const b=s.current,$=u.current;if(!b||!$)return;const{cursor_x:S,cursor_y:R}=Ha(P,b.getBoundingClientRect()),D=l.find(({isFocused:_})=>_),G=m.current;if(G){const _=l.find(C=>mn(S,R,C.shape.rect)),H=G.x,x=G.y;if(G.dragging=!0,(D==null?void 0:D.shape.rect)&&p.current)p.current==="topLeft"?(D.shape.rect.x1+=S-H,D.shape.rect.y1+=R-x):p.current==="topRight"?(D.shape.rect.x1+=S-H,D.shape.rect.y2+=R-x):p.current==="bottomLeft"?(D.shape.rect.x2+=S-H,D.shape.rect.y1+=R-x):p.current==="bottomRight"&&(D.shape.rect.x2+=S-H,D.shape.rect.y2+=R-x),m.current={x:S,y:R},w();else if(g.current||(_==null?void 0:_.isFocused)){if(g.current=g.current||_,b.style.cursor="move",!((X=g.current)==null?void 0:X.shape.rect))return;const C=g.current.shape.rect,T=S-H,O=R-x,J=C.x1+T,ae=C.x2+T,ce=C.y1+O,K=C.y2+O,{width:re,height:U}=b;J<C.x1&&J<0?C.x1=Math.max(0,J):ae<C.x2&&ae<0?C.x2=Math.max(0,ae):ce<C.y1&&ce<0?C.y1=Math.max(0,ce):K<C.y2&&K<0?C.y2=Math.max(0,K):J>C.x1&&J>re?C.x1=Math.min(J,re):ae>C.x2&&ae>re?C.x2=Math.min(ae,re):ce>C.y1&&ce>U?C.y1=Math.min(ce,U):K>C.y2&&K>U?C.y2=Math.min(K,U):(C.x1=J,C.x2=ae,C.y1=ce,C.y2=K),m.current={x:S,y:R},w()}else{i(T=>T.map(O=>ie(W({},O),{isFocused:!1}))),w();const C=yr(H,S,x,R,b);C&&fr($,C,a.get(n)||ee("$red"))}}else b.style.cursor=hr(l,S,R,D)},v=P=>{const b=s.current;if(!b)return;const $=m.current,S=b.getBoundingClientRect(),{cursor_x:R,cursor_y:D}=Ha(P,S),G=[...l];if($&&!p.current){const X=yr($.x,R,$.y,D,b);X&&G.unshift({shape:{rect:X},tag:n})}if(!p.current&&!($==null?void 0:$.dragging)&&P.type!=="mouseleave"){G.forEach(_=>_.isFocused=!1);const X=l.find(_=>mn(R,D,_.shape.rect));X&&(X.isFocused=!0)}m.current=void 0,g.current=void 0,p.current="",b.style.cursor=hr(G,R,D,G.find(({isFocused:X})=>X)),i(G),w()},k=(P,b)=>{!b||(i($=>b.key==="remove-selected"?$.filter(S=>!S.isFocused):[]),w())};return t.useEffect(()=>{const P=new Image;P.src=e.image,P.onload=()=>{const b=o.current,$=s.current;if(!b||!$)return;u.current=$.getContext("2d");const S=b.getContext("2d");if(!S)return;const R=e.image_height?+e.image_height.replace("px",""):P.naturalHeight,D=R/P.naturalHeight;d(D),b.height=R,b.width=P.naturalWidth*D,$.height=R,$.width=P.naturalWidth*D,$.style.zIndex="1",$.parentElement.style.height=me(R),S.drawImage(P,0,0,P.width,P.height,0,0,P.width*D,P.height*D),i((e.items||[]).map(({tag:G,shape:X})=>X.rect?{tag:G,shape:{rect:{x1:X.rect.x1*D,x2:X.rect.x2*D,y1:X.rect.y1*D,y2:X.rect.y2*D}}}:{tag:G,shape:X})),w()}},[e.name,e.image,e.image_height,w,e.items]),t.useEffect(()=>{y.args[e.name]=l.map(({tag:P,shape:b})=>b.rect?{tag:P,shape:{rect:{x1:b.rect.x1/c,x2:b.rect.x2/c,y1:b.rect.y1/c,y2:b.rect.y2/c}}}:{tag:P,shape:b})},[c,l,e.name]),t.createElement("div",{"data-test":e.name},t.createElement("div",{className:B("wave-s16 wave-w6",ra.title)},e.title),t.createElement(zl,{tags:e.tags,activateTag:h,activeTag:n}),t.createElement(Ut,{styles:{root:{padding:0}},items:[{key:"remove-selected",text:"Remove selection",onClick:k,disabled:l.every(P=>!P.isFocused),iconProps:{iconName:"RemoveContent",styles:{root:{fontSize:20}}}},{key:"remove-all",text:"Remove all",onClick:k,disabled:l.length===0,iconProps:{iconName:"DependencyRemove",styles:{root:{fontSize:20}}}}]}),t.createElement("div",{className:ra.canvasContainer},t.createElement("canvas",{ref:o,className:ra.canvas}),t.createElement("canvas",{ref:s,className:ra.canvas,onMouseMove:E,onMouseDown:L,onMouseLeave:v,onClick:v})))},$c=({model:e})=>{const a=t.useCallback((n,r)=>{y.args[e.name]=!!r,e.trigger&&y.push()},[e.name,e.trigger]);return t.useEffect(()=>{y.args[e.name]=!!e.value},[]),t.createElement(Ri,{"data-test":e.name,label:e.label,defaultChecked:e.value,onChange:a,disabled:e.disabled,onText:"On",offText:"Off",inlineLabel:!0})},un=z({card:{display:"flex",flexDirection:"column",padding:24},body:{marginTop:16,flexGrow:1,display:"flex"},plot:{$nest:{canvas:{position:"absolute",top:0,left:0,right:0,bottom:0}}}}),Fl=({model:e})=>{const a=t.useRef(null),n=t.useRef(),r=t.useCallback(async()=>{if(n.current&&e.data){const m=(await Me(()=>import("./vega.module.7cb1a248.js").then(function(u){return u.v}),["static/vega.module.7cb1a248.js","static/vendor.2f0b4f78.js"])).changeset().remove(()=>!0).insert(N.unpack(e.data));n.current.view.change("source_0",m).run()}},[e.data]),l=t.useCallback(async()=>{const m=a.current;if(!m)return;const u=JSON.parse(e.specification);isNaN(u.height)?m.clientHeight<30&&(m.style.height="300px"):m.style.height=`${u.height+10}px`;const p=N.unpack(e.data),g=m.clientWidth-10,h=m.clientHeight-10;p&&(u.data={values:p});const{default:w}=await Me(()=>import("./vega-embed.module.06bc0aae.js"),["static/vega-embed.module.06bc0aae.js","static/vega.module.7cb1a248.js","static/vendor.2f0b4f78.js"]);n.current=await w(m,u,{mode:e.grammar||"vega-lite",defaultStyle:!1,renderer:"canvas",actions:!1,config:{autosize:{type:"fit",resize:!0},view:{discreteWidth:g,discreteHeight:h,continuousWidth:g,continuousHeight:h}}})},[e.data,e.grammar,e.specification]),i=kt(1e3,l),{name:o,width:s="auto",height:c="auto"}=e,d=s==="auto"&&c==="auto"?{flexGrow:1}:{width:wt(s),height:c};return t.useEffect(()=>{r()},[r,e]),t.useEffect(()=>(l(),window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)),[]),t.createElement("div",{"data-test":o,className:un.plot,style:ie(W({},d),{position:"relative"}),ref:a})},Nc=j(({name:e,state:a,changed:n})=>({render:()=>{const{specification:l,data:i,title:o,grammar:s="vega-lite"}=a;return t.createElement("div",{"data-test":e,className:un.card},t.createElement("div",{className:"wave-s12 wave-w6"},o),t.createElement("div",{className:un.body},t.createElement(Fl,{model:{specification:l,data:i,grammar:s}})))},changed:n}));Y.register("vega",Nc);const vr=z({card:{display:"inline-flex",alignItems:"center",cursor:"pointer",$nest:{"&:hover":{color:f("$themePrimary")},"&:hover button":{color:f("$themePrimary")}}},icon:{fontSize:18}}),Sc=({model:e})=>{const{name:a,items:n,icon:r,image:l}=e,i=t.useRef(null),[o,s]=t.useState(!0),c=()=>s(d=>!d);return t.createElement("div",{"data-test":a,className:B(vr.card,"w-menu"),ref:i,onClick:c},l&&t.createElement(Or,{imageUrl:l,size:tt.size48,styles:{details:{padding:0}}}),r&&t.createElement(at,{className:vr.icon,iconName:r}),t.createElement(ka,{items:xt(n),target:i,hidden:o,onDismiss:c,isBeakVisible:!0,directionalHint:$a.bottomRightEdge,calloutProps:{styles:{beak:{border:be(1,f("$neutralQuaternaryAlt"))}}},styles:Gt}),t.createElement(yn,{iconProps:{iconName:"CaretSolidDown",styles:{root:{fontSize:12}}},styles:{root:{padding:0}}}))},br=z({container:{display:"flex",justifyContent:"center"},tag:{display:"flex",justifyContent:"center",alignItems:"center",borderRadius:4,boxSizing:"border-box",minWidth:49,height:49,padding:"0 18px",marginRight:10}}),_c=({model:e})=>{const a=e.items.map((n,r)=>{const l=n.color||"$text",i=f(n.label_color||Ht(l));return t.createElement("div",{key:r,style:{background:f(l),color:i},className:B(br.tag,"wave-s18 wave-w6")},n.label)});return t.createElement("div",{className:br.container},a)},ot=z({toolbar:{paddingTop:16,paddingLeft:16},toolbarTime:{fontSize:26,cursor:"pointer",$nest:{"&:hover":{backgroundColor:f("$neutralLighter"),color:f("$neutralDark")}}},toolbarText:{fontSize:26},toolbarLabel:{maxWidth:"70%"}}),Tc={placement:"bottom-start",sx:{"& .MuiPaper-root":{borderRadius:"2px",boxShadow:`${f("$text1")} 0px 6.4px 14.4px 0px, ${f("$text2")} 0px 1.2px 3.6px 0px`},"& .MuiTypography-root, [role=listbox]>span":{fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif'}}},Pc=t.lazy(()=>Me(()=>import("./index.6d97a6f7.js"),["static/index.6d97a6f7.js","static/vendor.2f0b4f78.js","static/useThemeProps.b60c7b26.js","static/Paper.b0a60de2.js"]).then(({ThemeProvider:e})=>({default:e}))),Dc=t.lazy(()=>Me(()=>import("./index.9f6e68e5.js"),["static/index.9f6e68e5.js","static/LocalizationProvider.44110c99.js","static/vendor.2f0b4f78.js","static/useThemeProps.b60c7b26.js"]).then(({LocalizationProvider:e})=>({default:e}))),Lc=t.lazy(()=>Me(()=>import("./index.d70e8ca0.js"),["static/index.d70e8ca0.js","static/vendor.2f0b4f78.js","static/useThemeProps.b60c7b26.js","static/Paper.b0a60de2.js","static/LocalizationProvider.44110c99.js"]).then(({TimePicker:e})=>({default:e}))),Ac={1:1,5:5,10:10,15:15,20:20,30:30,60:60},St=e=>new Date(`2000-01-01T${e.slice(0,5)}:00`),Rc=e=>{const[a,n]=t.useState(),[r,l]=t.useState(),[i,o]=t.useState();return t.useEffect(()=>{Me(()=>import("./index.32208328.js"),["static/index.32208328.js","static/index.8cd79a25.js","static/vendor.2f0b4f78.js"]).then(({AdapterDateFns:s})=>l(()=>s)),Me(()=>import("./index.6d97a6f7.js"),["static/index.6d97a6f7.js","static/vendor.2f0b4f78.js","static/useThemeProps.b60c7b26.js","static/Paper.b0a60de2.js"]).then(({createTheme:s})=>n(s(e))),Me(()=>import("./index.8cd79a25.js").then(function(s){return s.u}),[]).then(({default:s})=>o(()=>s))},[]),{theme:a,AdapterDateFns:r,format:i}},xr=()=>t.createElement("div",{"data-test":"lazyload",style:{height:59}},t.createElement(bn,{styles:{root:{height:"100%"}},size:xn.small})),Bc=({setOpenView:e,time:a,label:n,switchAmPm:r})=>t.createElement("div",{className:ot.toolbar},n&&t.createElement(je,{className:ot.toolbarLabel},n),t.createElement(fe,{className:ot.toolbarText},t.createElement(fe,{className:ot.toolbarTime,onClick:()=>e("hours")},(a==null?void 0:a.substring(0,2))||"--"),":",t.createElement(fe,{className:ot.toolbarTime,onClick:()=>e("minutes")},(a==null?void 0:a.substring(3,5))||"--")," ",t.createElement(fe,{className:ot.toolbarTime,onClick:r},(a==null?void 0:a.substring(6,8))||""))),Ic=({model:e})=>{const{hour_format:a="12",label:n,disabled:r,min:l,max:i,placeholder:o,required:s,minutes_step:c=1}=e,[d,m]=t.useState(e.value?St(e.value):null),[u,p]=t.useState(!1),g=t.useRef(null),h=()=>{m(S=>{const R=new Date(S);return R.setTime(R.getTime()+12*60*60*1e3),R})},w=S=>{y.args[e.name]=S?b(S,"24"):null,e.trigger&&y.push()},L=()=>setTimeout(()=>{var S;return(S=document.activeElement)==null?void 0:S.blur()}),{palette:E}=Bi(),v={palette:{background:{paper:f("$card")},primary:{main:E.themePrimary,contrastText:f("$neutralLight")},text:{primary:E.neutralPrimary,secondary:f("$neutralSecondary"),disabled:f("$neutralTertiaryAlt")},action:{active:E.themePrimary,disabled:f("$neutralLight"),hover:f("$neutralLight"),hoverOpacity:.04}}},{format:k,AdapterDateFns:I,theme:P}=Rc(v),b=(S,R)=>k?k(S,R==="12"?"hh:mm aa":"HH:mm"):"",$=(S,R="00:00",D="00:00")=>`Wrong input. Please enter the time in range from ${b(St(R),S)} 
        to ${b(St(D),S)}.`;return t.useEffect(()=>{k&&(y.args[e.name]=d?b(d,"24"):null)},[k]),t.useEffect(()=>{P&&(P.palette.primary.main=E.themePrimary,P.palette.text.primary=E.neutralPrimary,P.palette.action.active=E.themePrimary)},[E.themePrimary,P]),t.createElement(t.Fragment,null,t.createElement(t.Suspense,{fallback:t.createElement(xr,null)},P&&I&&k?t.createElement(Pc,{theme:P},t.createElement(Dc,{dateAdapter:I},t.createElement(Lc,{value:d,label:n,open:u,onChange:S=>m(S),onAccept:S=>w(S),onClose:()=>p(!1),ampm:a==="12",showToolbar:!0,ToolbarComponent:({parsedValue:S,setOpenView:R,ampm:D})=>t.createElement(Bc,{setOpenView:R,time:S&&b(S,D?"12":"24"),label:n,switchAmPm:h}),PopperProps:W({anchorEl:()=>g.current},Tc),minTime:l?St(l):void 0,maxTime:i?St(i):void 0,minutesStep:Ac[c],disabled:r,onOpen:L,renderInput:({inputProps:S,error:R})=>t.createElement("div",{ref:g,"data-test":e.name},t.createElement(ze,{iconProps:{iconName:"Clock"},onClick:()=>p(!0),onChange:S==null?void 0:S.onChange,placeholder:o,disabled:r,readOnly:!0,value:d?b(d,a):"",label:n,required:s,styles:{field:{cursor:"pointer",height:32},icon:{bottom:7}},errorMessage:R?$(a,l,i):void 0}))}))):t.createElement(xr,null)))},zc={items:[]},fa=z({card:{padding:15},vertical:{display:"flex",flexDirection:"column",flexGrow:1,$nest:{'> [data-visible="true"] ~ div':{marginTop:10}}},horizontal:{display:"flex",alignItems:"center",$nest:{'> [data-visible="true"] ~ div':{marginLeft:8}}},inset:{background:f("$page"),padding:xe(10,15)}}),Ee=({items:e,alignment:a,inset:n})=>{const r=e.map((l,i)=>{const[o]=Object.keys(l),{name:s,visible:c=!0,width:d="auto"}=l[o],m=c?{}:{display:"none"},u=o==="links"?"flex-start":void 0;return t.createElement("div",{key:s||`${o}-${i}`,"data-visible":c,style:ie(W({},m),{width:d,alignSelf:u})},t.createElement(Mc,{model:l}))});return t.createElement("div",{className:B(a?fa.horizontal:fa.vertical,n?fa.inset:""),style:{justifyContent:wn[a||""]}},r)},pn=({model:e})=>t.createElement(Ee,{items:e.items,alignment:e.justify||"start",inset:e.inset}),Mc=({model:e})=>e.text?t.createElement(oe,{content:e.text.tooltip,expand:!1},t.createElement(it,{name:e.text.name,content:e.text.content,size:e.text.size})):e.text_xl?t.createElement(oe,{content:e.text_xl.tooltip,expand:!1},t.createElement(it,{name:e.text_xl.name,content:e.text_xl.content,size:"xl",commands:e.text_xl.commands})):e.text_l?t.createElement(oe,{content:e.text_l.tooltip,expand:!1},t.createElement(it,{name:e.text_l.name,content:e.text_l.content,size:"l",commands:e.text_l.commands})):e.text_m?t.createElement(oe,{content:e.text_m.tooltip,expand:!1},t.createElement(it,{name:e.text_m.name,content:e.text_m.content})):e.text_s?t.createElement(oe,{content:e.text_s.tooltip,expand:!1},t.createElement(it,{name:e.text_s.name,content:e.text_s.content,size:"s"})):e.text_xs?t.createElement(oe,{content:e.text_xs.tooltip,expand:!1},t.createElement(it,{name:e.text_xs.name,content:e.text_xs.content,size:"xs"})):e.label?t.createElement(oe,{content:e.label.tooltip,expand:!1},t.createElement(is,{model:e.label})):e.link?t.createElement(oe,{content:e.link.tooltip,expand:!1},t.createElement($l,{model:e.link})):e.links?t.createElement(os,{model:e.links}):e.separator?t.createElement(Fs,{model:e.separator}):e.progress?t.createElement(oe,{content:e.progress.tooltip},t.createElement(Is,{model:e.progress})):e.message_bar?t.createElement(ds,{model:e.message_bar}):e.textbox?t.createElement(oe,{content:e.textbox.tooltip},t.createElement(xc,{model:e.textbox})):e.checkbox?t.createElement(oe,{content:e.checkbox.tooltip,expand:!1},t.createElement(Wo,{model:e.checkbox})):e.toggle?t.createElement(oe,{content:e.toggle.tooltip,expand:!1},t.createElement($c,{model:e.toggle})):e.choice_group?t.createElement(oe,{content:e.choice_group.tooltip},t.createElement(Oo,{model:e.choice_group})):e.dropdown?t.createElement(oe,{content:e.dropdown.tooltip},t.createElement(Jo,{model:e.dropdown})):e.checklist?t.createElement(oe,{content:e.checklist.tooltip},t.createElement(Ho,{model:e.checklist})):e.combobox?t.createElement(oe,{content:e.combobox.tooltip},t.createElement(Go,{model:e.combobox})):e.slider?t.createElement(oe,{content:e.slider.tooltip},t.createElement(Ws,{model:e.slider})):e.spinbox?t.createElement(oe,{content:e.spinbox.tooltip},t.createElement(js,{model:e.spinbox})):e.date_picker?t.createElement(oe,{content:e.date_picker.tooltip},t.createElement(Ko,{model:e.date_picker})):e.color_picker?t.createElement(oe,{content:e.color_picker.tooltip},t.createElement(Uo,{model:e.color_picker})):e.file_upload?t.createElement(oe,{content:e.file_upload.tooltip},t.createElement(ts,{model:e.file_upload})):e.table?t.createElement(oe,{content:e.table.tooltip},t.createElement(mc,{model:e.table})):e.buttons?t.createElement(zo,{model:e.buttons}):e.tabs?t.createElement(pc,{model:e.tabs}):e.button?t.createElement(oe,{content:e.button.tooltip,showIcon:!1,expand:!1},t.createElement(Mo,{model:e.button})):e.expander?t.createElement(Zo,{model:W({},e.expander)}):e.frame?t.createElement(ns,{model:e.frame}):e.markup?t.createElement(Sn,{model:e.markup}):e.template?t.createElement(fc,{model:e.template}):e.picker?t.createElement(oe,{content:e.picker.tooltip},t.createElement(ps,{model:e.picker})):e.range_slider?t.createElement(oe,{content:e.range_slider.tooltip},t.createElement(zs,{model:e.range_slider})):e.stepper?t.createElement(oe,{content:e.stepper.tooltip},t.createElement(Gs,{model:e.stepper})):e.visualization?t.createElement(Tn,{model:e.visualization}):e.vega_visualization?t.createElement(Fl,{model:e.vega_visualization}):e.stats?t.createElement(Us,{model:e.stats}):e.inline?t.createElement(pn,{model:e.inline}):e.image?t.createElement(Cl,{model:e.image}):e.persona?t.createElement(Yt,{model:e.persona}):e.text_annotator?t.createElement(Ec,{model:e.text_annotator}):e.image_annotator?t.createElement(Cc,{model:e.image_annotator}):e.mini_button?t.createElement(xl,{model:e.mini_button}):e.mini_buttons?t.createElement(Fo,{model:e.mini_buttons}):e.facepile?t.createElement(es,{model:e.facepile}):e.copyable_text?t.createElement(Vo,{model:e.copyable_text}):e.menu?t.createElement(Sc,{model:e.menu}):e.tags?t.createElement(_c,{model:e.tags}):e.time_picker?t.createElement(Ic,{model:e.time_picker}):t.createElement(Wt,{messageBarType:Oe.severeWarning},"This component could not be rendered."),Fc=j(({name:e,state:a,changed:n})=>({render:()=>{const l=W(W({},zc),a),i=l.title,o=N.unpack(l.items);return t.createElement("div",{"data-test":e,className:fa.card},i&&t.createElement("div",{className:"wave-s12 wave-w6"},i),t.createElement(Ee,{items:o}))},changed:n}));Y.register("form",Fc);const Oa=z({card:{padding:24,$nest:{".wave-markdown":{marginTop:12,$nest:{"&:first-child":{marginTop:0},"h1, h2, h3, h4, h5, h6":{marginBlock:0,color:f("$neutralPrimary")},h1:{margin:ye(18,0),fontSize:20,fontWeight:600,letterSpacing:"-0.017em",lineHeight:me(28)},h2:{margin:ye(12,0),fontSize:18,fontWeight:500,letterSpacing:"-0.014em",lineHeight:me(25.2)},h3:{margin:ye(8,0),fontSize:16,fontWeight:400,letterSpacing:"-0.011em",lineHeight:me(22.4)},p:{fontSize:14,letterSpacing:"-0.006em",lineHeight:me(20),color:f("$text7"),marginBlock:0}}}}},title:{color:f("$neutralPrimary")},miniBtns:{marginLeft:-4}}),Wc=j(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,content:i,items:o}=a;return t.createElement("section",{"data-test":e,className:Oa.card},t.createElement("div",{className:B("wave-s20 wave-w6",Oa.title)},l),o&&t.createElement("div",{className:Oa.miniBtns},t.createElement(Ee,{items:o})),i&&t.createElement(Se,{source:i}))},changed:n}));Y.register("article",Wc);const Hc=z({card:{display:"flex",flexDirection:"column",justifyContent:"center"}}),Oc=j(({name:e,state:a,changed:n})=>{const r=a.items.map(({name:i,label:o})=>({key:i,text:o,onClick:()=>{if(i.startsWith("#")){window.location.hash=i.substr(1);return}y.args[i]=!0,y.push()}}));return{render:()=>t.createElement("div",{"data-test":e,className:Hc.card},t.createElement(Ii,{items:r,styles:{root:{margin:0}}})),changed:n}});Y.register("breadcrumbs",Oc,{effect:Je.Transparent});class Wl{constructor(a,n){this.x=a,this.y=n}}function Vc(e,a){const n=e.x-a.x,r=e.y-a.y;return n*n+r*r}function jc(e,a,n){let r=a.x,l=a.y,i=n.x-r,o=n.y-l;if(i!==0||o!==0){const s=((e.x-r)*i+(e.y-l)*o)/(i*i+o*o);s>1?(r=n.x,l=n.y):s>0&&(r+=i*s,l+=o*s)}return i=e.x-r,o=e.y-l,i*i+o*o}const Xc={x:0,y:0};function Uc(e,a){let n=e[0],r=Xc;const l=[n];for(let i=1,o=e.length;i<o;i++)r=e[i],Vc(r,n)>a&&(l.push(r),n=r);return n!==r&&l.push(r),l}function fn(e,a,n,r,l){let i=r,o=0;for(let s=a+1;s<n;s++){const c=jc(e[s],e[a],e[n]);c>i&&(o=s,i=c)}i>r&&(o-a>1&&fn(e,a,o,r,l),l.push(e[o]),n-o>1&&fn(e,o,n,r,l))}function Gc(e,a){const n=e.length-1,r=[e[0]];return fn(e,0,n,a,r),r.push(e[n]),r}function qc(e,a,n){if(e.length<=2)return e;const r=a!==void 0?a*a:1;return e=n?e:Uc(e,r),e=Gc(e,r),e}const Er=z({card:{display:"flex",flexDirection:"column",padding:se.gap,overflow:"auto"},layers:{position:"relative"}}),ia=e=>{const a=new Array(e.length*2);let n=0;for(const r of e)a[n++]=r.x,a[n++]=r.y;return a},Va=e=>{const a=new Array(e.length/2);let n=0;for(let r=0,l=a.length;r<l;r++)a[r]=new Wl(e[n++],e[n++]);return a},ja=(e,a,n)=>{const r=document.createElement("canvas"),l=r.getContext("2d",{alpha:!0});if(!l)throw new Error("failed obtaining canvas context");const i=window.devicePixelRatio||1,o=l.webkitBackingStorePixelRatio||l.mozBackingStorePixelRatio||l.msBackingStorePixelRatio||l.oBackingStorePixelRatio||l.backingStorePixelRatio||1,s=i/o;return r.style.outline="1px solid #ccc",r.style.position="absolute",i!==o?(r.width=e*s,r.height=a*s,l.scale(s,s),r.style.width=me(e),r.style.height=me(a)):(r.width=e,r.height=a),{el:r,g:l,w:e,h:a,r:s}},Qc=e=>{const a=e.toString(16);return a.length===1?`0${a}`:a},Xa=(()=>{const e=new Map;for(let a=0;a<256;a++)e.set(a,Qc(a));return e})(),Yc=(e,a,n)=>{let r=e;const l=new Map;return{put:c=>{const d=r++;r>=16581375&&(r=0),l.set(d,c);const m=d>>16&255,u=d>>8&255,p=d&255;return`#${Xa.get(m)}${Xa.get(u)}${Xa.get(p)}`},test:(c,d)=>{const m=a.getImageData(c*n,d*n,1,1).data;if(m[3]===255)return l.get((m[0]<<16)+(m[1]<<8)+m[2])},clear:()=>{l.clear(),r=e}}},Kc=e=>e.charAt(0).toUpperCase()+e.slice(1),Jc=(()=>{const e=[];for(const a in nn)e.push({name:Kc(a),color:nn[a]});return e})(),Zc=j(({name:e,state:a,changed:n})=>{const r=N.box([]),l=N.box([]),i=N.box(1),o=N.box("black"),s=N.box(3),c=N.box(),d=[["Fine",3],["Medium",5],["Bold",7]],m=t.createRef(),u=b=>{b.lineJoin="round",b.lineCap="round"},p=(b,$)=>b===$||b.x===$.x&&b.y===$.y,g=(b,$)=>{const S=s(),R=Math.floor(S/2);b.fillRect($.x-R,$.y-R,S,S)},h=(b,$,S)=>{if(p($,S)){g(b,$);return}b.beginPath(),b.moveTo($.x,$.y),b.lineTo(S.x,S.y),b.stroke()},w=(b,$,S)=>{b.strokeRect($.x,$.y,S.x-$.x,S.y-$.y)},L=(b,$,S)=>{b.fillRect($.x,$.y,S.x-$.x,S.y-$.y)},E=(b,$)=>{switch($.length){case 1:g(b,$[0]);return;case 2:h(b,$[0],$[1]);return;default:{b.beginPath();let S=$[0];b.moveTo(S.x,S.y);for(let R=1,D=$.length;R<D;R++)S=$[R],b.lineTo(S.x,S.y);b.stroke()}}},v=()=>{const b=m.current;if(!b){window.setTimeout(v,500);return}const{width:$,height:S}=a,R=ja($,S),D=ja($,S),G=ja($,S),X=R.el,_=R.g,H=D.g,x=G.g;X.style.cursor="crosshair",b.appendChild(D.el),b.appendChild(X),u(_),u(H);let C=[];const T=Yc(0,x,G.r),O=A=>A.clearRect(0,0,$,S),J=(A,Q,Z)=>{A.set(`${e} data ${Q}`,Z)},ae=(A,Q)=>{const Z=y.fork();J(Z,A,Q),Z.push()},ce=A=>{const Q=y.fork();for(const Z of A)J(Q,Z,null);Q.push()},K=A=>{C.length>1?C[1]=A:C.push(A)},re=(A,Q)=>{const Z=new Wl(A,Q);switch(i()){case 1:{C.push(Z);const le=C.length,Ce=C[le-1];h(_,Ce,C.length===1?Ce:C[le-2])}break;case 2:{if(K(Z),C.length<2)return;O(_),h(_,C[0],C[1])}break;case 3:{if(K(Z),C.length<2)return;O(_),w(_,C[0],C[1])}break;case 4:{if(K(Z),C.length<2)return;O(_),L(_,C[0],C[1])}break;default:{const le=T.test(A,Q);if(le!==void 0){const Ce=r();ae(Ce[le],null)}}}},U=(A,Q,Z)=>{switch(A){case 1:return{t:1,p:ia(qc(C,2,!0)),c:Q,l:Z};case 2:return C.length===2?{t:2,p:ia(C),c:Q,l:Z}:void 0;case 3:return C.length===2?{t:3,p:ia(C),c:Q,l:Z}:void 0;case 4:return C.length===2?{t:4,p:ia(C),c:Q}:void 0}},ne=()=>{if(!C.length)return;const A=U(i(),o(),s());A&&(ke(A,0),ae(new Date().toISOString(),JSON.stringify(A))),C=[],O(_)},ke=(A,Q)=>{switch(A.t){case 1:case 2:{const Z=Va(A.p);H.strokeStyle=A.c,H.lineWidth=A.l,E(H,Z),x.strokeStyle=T.put(Q),x.lineWidth=A.l,E(x,Z)}break;case 3:{const Z=Va(A.p),[le,Ce]=Z;H.strokeStyle=A.c,H.lineWidth=A.l,w(H,le,Ce),x.strokeStyle=T.put(Q),x.lineWidth=A.l,w(x,le,Ce)}break;case 4:{const Z=Va(A.p),[le,Ce]=Z;H.fillStyle=A.c,L(H,le,Ce),x.fillStyle=T.put(Q),L(x,le,Ce)}break}},F=A=>{O(H),O(x),A.forEach(ke)},M=A=>{const Q=X.getBoundingClientRect();re(A.clientX-Q.left,A.clientY-Q.top)},q=()=>{X.removeEventListener("mousemove",M),X.removeEventListener("mouseup",q),X.removeEventListener("mouseout",q),ne()};X.addEventListener("mousedown",A=>{M(A),X.addEventListener("mousemove",M),X.addEventListener("mouseup",q),X.addEventListener("mouseout",q)}),N.to(l,F),N.to(o,A=>{_.strokeStyle=A,_.fillStyle=A}),N.to(s,A=>{_.lineWidth=A}),N.on(c,()=>ce(r()))},k=[{key:"tool",iconProps:{iconName:"Edit"},subMenuProps:{items:[{key:"pen",text:"Pen",iconProps:{iconName:"Edit"},onClick:()=>{i(1)}},{key:"line",text:"Line",iconProps:{iconName:"Line"},onClick:()=>{i(2)}},{key:"rect",text:"Rectangle",iconProps:{iconName:"RectangleShape"},onClick:()=>{i(3)}},{key:"solid_rect",text:"Solid Rectangle",iconProps:{iconName:"RectangleShapeSolid"},onClick:()=>{i(4)}}]}},{key:"color",iconProps:{iconName:"Color"},subMenuProps:{items:Jc.map(({name:b,color:$})=>({key:$,text:b,iconProps:{iconName:"CircleFill",style:{color:$}},onClick:()=>{o($)}}))}},{key:"lineWidth",iconProps:{iconName:"LineThickness"},subMenuProps:{items:d.map(([b,$])=>({key:b,text:b,iconProps:{iconName:"Edit"},onClick:()=>{s($)}}))}},{key:"erase",iconProps:{iconName:"EraseTool"},onClick:()=>{i(0)}},{key:"clear",iconProps:{iconName:"Clear"},onClick:()=>{c(!0)}}],I=b=>{if(!b)return{};const $={};for(const S in b)$[S]=JSON.parse(b[S]);return $};return{init:v,render:()=>{const b=I(a.data),$=Object.keys(b).sort();return r($),l($.map(S=>b[S])),t.createElement("div",{"data-test":e,className:Er.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",null,t.createElement(Ut,{items:k,ariaLabel:"Use left and right arrow keys to navigate between commands"})),t.createElement("div",{ref:m,className:Er.layers}))},changed:n}});Y.register("canvas",Zc);const Ze=z({card:{display:"flex",flexDirection:"column",padding:se.gap,overflow:"auto"},history:{flexGrow:1,overflow:"auto"},message:{padding:xe(6,0)},header:{marginBottom:2},user:{marginRight:5},date:{color:f("$text7")},body:{paddingLeft:10,borderLeft:be(1,f("$text3"))}}),ed=({inputB:e})=>{const[a,n]=t.useState(""),r=t.useCallback((i,o)=>{n(o||"")},[]),l=({key:i,target:o},s)=>{if(i=="Enter"){let c=s!=null?s:o.value;if(!c)return;c=c.trim(),n(""),c.length&&e(c)}};return t.createElement(ze,{label:"Send a message",multiline:!0,autoAdjustHeight:!0,onKeyUp:l,onChange:r,value:a})},td=e=>{if(!e)return{};const a={};for(const n in e)a[n]=JSON.parse(e[n]);return a},ad=j(({name:e,state:a,changed:n})=>{let r=[];const l=t.createRef(),i=N.box("",()=>!1),o=()=>{const c=l.current;c&&(c.scrollTop=c.scrollHeight)},s=()=>{const c=td(a.data),d=Object.keys(c).sort(),m=d.map(u=>{const{u:p,m:g}=c[u];return t.createElement("div",{key:`${p}|${u}|${g}`,className:Ze.message},t.createElement("div",{className:B("wave-s12",Ze.header)},t.createElement("span",{className:B("wave-w6",Ze.user)},p),t.createElement("span",{className:B("wave-s10",Ze.date)},new Date(u).toLocaleString())),t.createElement("div",{className:Ze.body},g))});return r=d,t.createElement("div",{"data-test":e,className:Ze.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",{ref:l,className:Ze.history},m),t.createElement("div",null,t.createElement(ed,{inputB:i})))};return N.on(i,c=>{var g,h;const d=y.fork(),m=(g=a.capacity)!=null?g:50,u=r.length;if(u>=m)for(let w=0;w<u-m+1;w++)d.set(`${e} data ${r[w]}`,null);const p={u:(h=xa.username)!=null?h:"?",m:c};d.set(`${e} data ${new Date().toISOString()}`,JSON.stringify(p)),d.push()}),{render:s,init:o,update:o,changed:n}});Y.register("chat",ad);const Hl=[{view:"canvas",icon:"EditCreate",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Canvas"},{name:"width",optional:!1,t:"spinbox",value:400,min:400,max:2048,step:50},{name:"height",optional:!1,t:"spinbox",value:300,min:300,max:1536,step:50},{name:"data",optional:!1,t:"record",value:{}}]},{view:"chat",icon:"OfficeChat",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Chat"},{name:"data",optional:!1,t:"record",value:{}},{name:"capacity",optional:!0,t:"spinbox",value:50,min:10,max:1e4,step:10}]},{view:"frame",icon:"PageAdd",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Frame"},{name:"path",optional:!0,t:"textbox",value:""},{name:"content",optional:!0,t:"textarea",value:""}]},{view:"markdown",icon:"InsertTextBox",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Content"},{name:"content",optional:!1,t:"textarea",value:"Hello, World!"}]},{view:"markup",icon:"FileHTML",attrs:[{name:"box",optional:!1,t:"box",value:'{"zone":"Body"}'},{name:"title",optional:!1,t:"textbox",value:"Untitled Content"},{name:"content",optional:!1,t:"textarea",value:"<div/>"}]}],ue=se.gap,nd=(e,a)=>{const n=(e==null?void 0:e.length)||0,r=(a==null?void 0:a.reduce((l,i)=>{var o,s;return l+(((s=(o=i.button)==null?void 0:o.label)==null?void 0:s.length)||0)+15},0))||0;return n+r>54},Bt=N.box(null),rd=j(()=>{let e,a=null;const n=(s,c)=>s?Wn({from:{transform:c},to:{transform:"none"}}):Wn({from:{transform:"none"},to:{transform:c}}),r=(s="top-right",c)=>{if(window.innerWidth<500+ue)return s.includes("top")?{top:0,right:0,left:0,margin:"0 auto",animationName:n(c,"translateY(-100%)")}:{bottom:0,right:0,left:0,margin:"0 auto",animationName:n(c,"translateY(100%)")};switch(s){case"top-right":return{top:ue,right:ue,animationName:n(c,`translateX(calc(100% + ${ue}px))`)};case"top-center":return{top:ue,right:0,left:0,margin:"0 auto",animationName:n(c,`translateY(calc(-100% - ${ue}px))`)};case"top-left":return{top:ue,left:ue,animationName:n(c,`translateX(calc(-100% - ${ue}px))`)};case"bottom-right":return{bottom:ue,right:ue,animationName:n(c,`translateX(calc(100% + ${ue}px))`)};case"bottom-center":return{bottom:ue,right:0,left:0,margin:"0 auto",animationName:n(c,`translateY(calc(100% + ${ue}px))`)};case"bottom-left":return{bottom:ue,left:ue,animationName:n(c,`translateX(calc(-100% - ${ue}px))`)}}},l=()=>{window.clearTimeout(e),a=Bt();const{name:s,events:c}=a||{},d=c==null?void 0:c.find(m=>m==="dismissed");d&&s&&y.emit(s,d,!0),Bt(null)};return{render:()=>{var w,L;const s=Bt(),c=!!s,d=s||a,{iconName:m,color:u,background:p}=_l[(d==null?void 0:d.type)||"info"],g=(w=d==null?void 0:d.buttons)==null?void 0:w.filter(({button:E})=>E),h=nd(d==null?void 0:d.text,g);return(s==null?void 0:s.timeout)!==-1&&c&&(e=window.setTimeout(l,((s==null?void 0:s.timeout)||5)*1e3)),((L=d==null?void 0:d.text)==null?void 0:L.length)?t.createElement(Wt,{messageBarType:Tl(d==null?void 0:d.type),messageBarIconProps:{iconName:m},actions:(g==null?void 0:g.length)?t.createElement(Ee,{items:g||[],alignment:"end"}):void 0,isMultiline:h,onDismiss:l,className:Sl.messageBar,styles:{root:W({background:p,color:u,borderRadius:4,".ms-Link":{color:u,fontWeight:600},".ms-Link:hover":{textDecoration:"none",color:u},padding:16,minHeight:24,position:"fixed",animationDuration:"0.5s",animationFillMode:"forwards",maxWidth:500,width:ve(100),zIndex:999},r(d==null?void 0:d.position,c)),content:{alignItems:h?"start":"center"},icon:{fontSize:24,color:u,display:"inline-flex"},iconContainer:{margin:0,marginRight:16,display:"flex",alignItems:"center"},text:{margin:0},innerText:{whiteSpace:he("initial")},dismissal:{fontSize:16,height:"auto",marginLeft:16,padding:0,".ms-Button-flexContainer":{display:"block"}},dismissSingleLine:{display:"flex"},actions:{margin:0,marginTop:h?12:void 0}}},t.createElement(Se,{source:d==null?void 0:d.text})):t.createElement(t.Fragment,null)},notificationBarB:Bt,dispose:()=>window.clearTimeout(e)}}),gt=N.box(null);var ld=j(()=>{const e=()=>{const{name:n,events:r}=gt()||{};n&&(r==null||r.forEach(l=>{l==="dismissed"&&y.emit(n,l,!0)})),gt(null)};return{render:()=>{const{title:n,width:r="600px",items:l=[],closable:i,primary:o,blocking:s=!1}=gt()||{},c={title:n,onDismiss:e,showCloseButton:i,type:i?bt.close:o?bt.largeHeader:bt.normal};return t.createElement(Sa,{hidden:!gt(),onDismiss:e,dialogContentProps:c,modalProps:{isBlocking:s},minWidth:r,maxWidth:r},t.createElement(Ee,{items:l}))},dialogB:gt}});const id=async e=>{if("Notification"in window)Notification.permission==="granted"?new Notification(e):Notification.permission!=="denied"&&await Notification.requestPermission()==="granted"&&new Notification(e);else return};let Ua=null;const wr={},kr=e=>{Ua&&Ua.remove();const a=Ua=document.createElement("script");a.type="text/javascript",a.appendChild(document.createTextNode(e)),document.body.appendChild(a)},od=e=>{let a=window;for(const n of e.split("."))if(a=a[n],!a)return!1;return!0},sd=e=>!e.some(a=>!od(a)),cd=e=>document.getElementById(e)||document.querySelector(e),dd=e=>!e.some(a=>!cd(a)),md=e=>{e.forEach(({path:a,asynchronous:n,cross_origin:r,referrer_policy:l,integrity:i})=>{if(wr[a])return;const o=document.createElement("script");o.type="text/javascript",o.src=a,n&&(o.async=!0),r&&(o.crossOrigin=r),l&&(o.referrerPolicy=l),i&&(o.integrity=i),document.body.appendChild(o),o.addEventListener("load",()=>{wr[a]=!0})})},ud=({content:e,requires:a,targets:n})=>{const r=()=>!(a&&a.length&&!sd(a)||n&&n.length&&!dd(n));if(r()){kr(e);return}let l=0;const i=setInterval(()=>{r()?(clearInterval(i),kr(e)):(l++,l>100&&(clearInterval(i),console.error("Failed to execute inline script: one or more of the requirements were not found.")))},10)},ht=N.box(null);var pd=j(()=>{const e=()=>{const{name:n,events:r}=ht()||{},l=r==null?void 0:r.find(i=>i==="dismissed");l&&n&&y.emit(n,l,!0),ht(null)};return{render:()=>{const{title:n,width:r="600px",items:l=[],closable:i=!1,blocking:o=!1}=ht()||{};return t.createElement(Ta,{isOpen:!!ht(),headerText:n,type:qr.custom,customWidth:r,onDismiss:e,hasCloseButton:i,overlayProps:o?{style:{cursor:"default"}}:void 0,isBlocking:!0,isLightDismiss:!o},t.createElement(Ee,{items:l}))},sidePanelB:ht}});let wa=null;const fd=e=>{const a={};for(const n in e){const r=e[n];r&&(a[n]=n==="#"?r:!0)}return a},gd=e=>{if(!!wa)switch(wa.type){case"ga":case"gtag":{const a=window;a.gtag&&a.gtag("event","sync",fd(e))}}},hd=e=>{if(!wa)switch(e.type){case"ga":case"gtag":{const a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=`https://www.googletagmanager.com/gtag/js?id=${e.id}`,document.body.appendChild(a),a.addEventListener("load",()=>{const n=window;n.dataLayer=n.dataLayer||[];function r(){n.dataLayer.push(arguments)}n.gtag=r,n.gtag("js",new Date),n.gtag("config",e.id)})}wa=e}};N.on(sl,e=>window.setTimeout(()=>gd(e),0));const Ol=N.box(""),Vl=N.box("");N.on(Ol,e=>window.document.title=e);N.on(Vl,e=>{const a=document.querySelector("link[rel*='icon']"),n=document.querySelector("link[rel*='apple-touch-icon']");a&&(a.href=e),n&&(n.href=e)});const La=N.box([]),Cr=({state:e})=>{const{title:a,icon:n,refresh:r,notification:l,notification_bar:i,redirect:o,layouts:s,dialog:c,side_panel:d,theme:m,themes:u,tracker:p,scripts:g,script:h,stylesheet:w,stylesheets:L}=e;if(o){try{const{location:E}=window,v=new URL(`${E.origin}${E.pathname}${o}`);o===v.hash?E.hash=o:E.replace(o)}catch(E){console.error(`Could not redirect: ${o} is an invalid URL`,E)}delete e.redirect}if(gt(c?W({},c):null),ht(d?W({},d):null),setTimeout(()=>Bt(i?W({},i):null),0),a&&Ol(a),n&&Vl(n),typeof r=="number"&&r===0&&N.disconnect(),m&&Da(m),u&&rl(u),l&&id(l),p&&hd(p),s&&La(s),g&&md(g),h&&(delete e.script,ud(h)),w){const E=document.createElement("style"),{content:v,media:k}=w;E.innerText=v,k&&(E.media=k),document.head.appendChild(E),delete e.stylesheet}L&&(L.forEach(({path:E,media:v,cross_origin:k})=>{const I=document.createElement("link");I.rel="stylesheet",I.href=E,I.as="style",v&&(I.media=v),k&&(I.crossOrigin=k),document.head.appendChild(I)}),delete e.stylesheets)},yd=j(()=>({render:()=>t.createElement(t.Fragment,null)}));Y.register("meta",yd);const _t=z({fab:{position:"fixed",right:20,bottom:20,width:56,height:56,color:f("$card"),background:f("$text"),borderRadius:"50%",fontSize:20,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:`0px 3px 5px ${f("$text0")}`,$nest:{"&:hover":{boxShadow:`0px 12px 20px ${f("$text2")}`}}},panelActions:{marginTop:10},cards:{display:"flex",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start"},card:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",cursor:"pointer",margin:3,padding:3,border:be(1,f("$text3")),$nest:{"&:hover":{backgroundColor:f("$text0")}}},cardIcon:{width:50,height:50,fontSize:22,display:"flex",justifyContent:"center",alignItems:"center",color:f("$text7")},cardCaption:{marginTop:5,fontSize:11,width:82,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"center"}}),It=e=>e.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),vd=(e,a)=>{const n={};for(const r of e)n[a(r)]=r;return n},bd=vd(Hl,e=>e.view),gn=e=>N.parseU(e.replace(/px$/,"")),jl=(e,a)=>{for(const n of a)n.zones?jl(e,n.zones):e.push(n.name)},Xl=()=>{const e=La();return e&&e.length?e[0]:kn.layout},xd=e=>{var a;return(a=ya.find(n=>n.layout.name===e.name))!=null?a:kn},Ed={root:{marginTop:15}},Ft=({children:e})=>t.createElement(_a,{styles:Ed},e),wd={root:{marginTop:5,marginBottom:5},labelWrapper:{width:90}},yt=j(({label:e,defaultValue:a,min:n,max:r,step:l,onChange:i})=>{const o=u=>{const p=N.parseU(u);return isNaN(p)?0:p},s=u=>{i(o(u.target.value))},c=u=>{const p=Math.min(r,o(u)+l);return i(p),String(p)},d=u=>{const p=Math.max(n,o(u)-l);return i(p),String(p)};return{render:()=>t.createElement(Xr,{label:e,min:n,max:r,step:l,defaultValue:""+a,onBlur:s,onIncrement:c,onDecrement:d,styles:wd})}}),$r=j(({view:e,card:a})=>{const{attrs:n}=bd[e],r=!a,l={},i={},o=[],s=Xl();jl(o,s.zones);for(const{name:L,value:E}of n)l[L]=i[L]=E;if(a){const{state:L}=a;for(const E in L)l[E]=i[E]=L[E]}let c=a?a.name:`${e}${new Date().toISOString()}`;const d=()=>{De(zt)},m=()=>{const L=y.fork();if(r){const E=W(W({view:e},l),i);L.put(c,E)}else for(const E in i){const v=i[E];v!==l[E]&&L.set(`${c} ${E}`,v)}L.push(),De(zt)},u=()=>{De(ol)},p=()=>{De(zt)},g=({target:L},E)=>{c=E||L.value},h=()=>t.createElement(Le,{horizontal:!0,tokens:{childrenGap:10}},t.createElement(Fe,{onClick:m},r?"Add card":"Save changes"),t.createElement(Xe,{onClick:r?u:p},"Back"));return{render:()=>{const L=n.map(E=>{const{name:v}=E;switch(E.t){case"textbox":{const k=({target:I},P)=>{i[v]=P||I.value};return t.createElement(ze,{key:v,label:It(v),defaultValue:i[v],onChange:k})}case"textarea":{const k=({target:I},P)=>{i[v]=P||I.value};return t.createElement(ze,{key:v,label:It(v),defaultValue:i[v],multiline:!0,onChange:k,styles:{field:{minHeight:300}}})}case"spinbox":{const{min:k,max:I,step:P,value:b}=E,$=b<k?k:b>I?I:b,S=R=>{i[v]=R};return i[v]=$,t.createElement(yt,{key:v,label:It(v)+":",min:k,max:I,step:P,defaultValue:i[v],onChange:S})}case"record":return t.createElement("div",{key:v});case"box":{const k=o.map(T=>({key:T,text:T})),I=T=>{const O=JSON.parse(i[v]);T(O),i[v]=JSON.stringify(O)},P=(T,O)=>I(J=>J[T]=O),b=T=>I(O=>{delete O[T]}),$=(T,O)=>{O&&P("zone",O.key)},S=T=>{T?P("order",T):b("order")},R=T=>{T?P("size",`${T}`):b("size")},D=T=>{T?P("width",`${T}px`):b("width")},G=T=>{T?P("height",`${T}px`):b("height")},{zone:X,order:_,size:H,width:x,height:C}=JSON.parse(i[v]);return t.createElement("div",{key:v},t.createElement(Ft,null,"Box"),t.createElement(Na,{label:"Zone",options:k,defaultSelectedKey:X,onChange:$}),t.createElement(yt,{defaultValue:_!=null?_:0,label:"Order:",min:0,max:25,step:1,onChange:S}),t.createElement(yt,{defaultValue:H?N.parseU(H):0,label:"Size:",min:0,max:25,step:1,onChange:R}),t.createElement(yt,{defaultValue:x?gn(x):0,label:"Width (px):",min:0,max:1e4,step:10,onChange:D}),t.createElement(yt,{defaultValue:C?gn(C):0,label:"Height (px):",min:0,max:1e4,step:10,onChange:G}),t.createElement(Ft,null,"Properties"))}}});return t.createElement(Ta,{headerText:r?"Add card":"Edit card",isOpen:!0,isLightDismiss:!0,onDismiss:d,onRenderFooterContent:h,isFooterAtBottom:!0},t.createElement(Ft,null,It(e)," Card"),r?t.createElement(ze,{label:"Card Name",defaultValue:c,onChange:g}):null,t.createElement("div",null,L))}}}),kd=j(({title:e,text:a,acceptCaption:n,cancelCaption:r,onAccept:l})=>{const i=N.box(!1),o=()=>{i(!0)},s=()=>{l(),i(!0)};return{render:()=>t.createElement(Sa,{hidden:i(),onDismiss:o,dialogContentProps:{type:bt.normal,title:e,subText:a},modalProps:{styles:{main:{maxWidth:450}}}},t.createElement(vn,null,t.createElement(Xe,{onClick:o,text:r}),t.createElement(Fe,{onClick:s,text:n}))),hiddenB:i}}),Ul=j(({pageSetupB:e})=>{const a=e(),n=ya.map(({name:o})=>({key:o,text:o})),r=(o,s)=>{if(!s)return;const c=ya.find(d=>d.name===s.key);c&&(a.layoutDef=c,e(W({},a)))},l=o=>{a.width=o,e(W({},a))};return{render:()=>t.createElement(t.Fragment,null,t.createElement(Na,{label:"Page Layout",options:n,defaultSelectedKey:a.layoutDef.name,onChange:r}),t.createElement(yt,{defaultValue:a.width,label:"Page Width:",min:0,max:4e3,step:50,onChange:l}))}}),Cd=j(({visibleB:e})=>{const a=N.box({layoutDef:kn,width:0}),n=()=>{const{layoutDef:i,width:o}=a(),s=W({},i.layout),c=y.fork();o&&(s.width=`${o}px`),c.put("__editor__",{view:"editor",box:"",mode:"public"}),c.put("__meta__",{view:"meta",box:"",layouts:[s]}),c.push()},r=()=>{e(!1)};return{render:()=>t.createElement(Sa,{hidden:!e(),onDismiss:r,dialogContentProps:{type:bt.largeHeader,title:"Edit this page?",subText:"Don't worry, you can always change these settings later."},modalProps:{isBlocking:!1,styles:{main:{maxWidth:450}}}},t.createElement(Ul,{pageSetupB:a}),t.createElement(vn,null,t.createElement(Xe,{onClick:r,text:"Back to safety"}),t.createElement(Fe,{onClick:n,text:"Start Editing"}))),visibleB:e}}),$d=()=>{const e=va();return e&&e.t===N.WaveEventType.Page?e.page:null},Nd=j(({name:e,changed:a})=>{const n=()=>{De(ol)},r=()=>{De(zt)};return{render:()=>{let i=null;const o=De();switch(o.t){case ft.Add:i=t.createElement($r,{view:o.view});break;case ft.Edit:{const s=$d();if(s){const{name:c}=o,d=s.get(c);d&&(i=t.createElement($r,{view:d.state.view,card:d}))}}break;case ft.Delete:{const{name:s}=o,c=()=>{const d=y.fork();d.del(s),d.push()};i=t.createElement(kd,{key:N.xid(),title:"Delete Card?",text:"This card will be permanently deleted.",acceptCaption:"Delete Card",cancelCaption:"Don't delete",onAccept:c})}break;case ft.Pick:{const s=Xl(),c=N.box({layoutDef:xd(s),width:s.width?gn(s.width):0}),d=Hl.map(({view:p,icon:g})=>{const h=()=>{De({t:ft.Add,view:p})};return t.createElement("div",{key:p,className:_t.card,onClick:h},t.createElement("div",{className:_t.cardIcon},t.createElement(at,{iconName:g})),t.createElement("div",{className:_t.cardCaption},It(p)))}),m=()=>{const p=y.fork(),{layoutDef:g,width:h}=c(),w=W({},g.layout);h&&(w.width=`${h}px`),p.set("__meta__ layouts",[w]),p.push()},u=()=>t.createElement(Le,{horizontal:!0,tokens:{childrenGap:10}},t.createElement(Fe,{onClick:m},"Apply changes"));i=t.createElement(Ta,{headerText:"Edit this page",isLightDismiss:!0,onDismiss:r,isOpen:!0,onRenderFooterContent:u,isFooterAtBottom:!0},t.createElement(Ft,null,"Add Content"),t.createElement("div",{className:_t.cards},d),t.createElement(Ft,null,"Page Setup"),t.createElement(Ul,{key:N.xid(),pageSetupB:c}))}break}return t.createElement(t.Fragment,null,t.createElement("div",{"data-test":e,className:_t.fab,onClick:n},t.createElement(at,{iconName:"WindowEdit"})),i)},changed:a,editorActionB:De}});Y.register("editor",Nd);const Sd=e=>{const a={display:"flex"},n=po[e.direction||""],r=wn[e.justify||""],l=ll[e.align||""],i=il[e.wrap||""];return n&&(a.flexDirection=n),r&&(a.justifyContent=r),l&&(a.alignItems=l),i&&(a.flexWrap="wrap",a.alignContent=i),a},_d=j(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,style:Sd(a)},t.createElement($n,{view:a.item_view,props:a.item_props,data:a.data})),changed:n}));Y.register("flex",_d);const Ga=z({card:{display:"flex",justifyContent:"space-between",padding:24},center:{margin:"0 auto",$nest:{".wave-markdown":{textAlign:"center"}}},caption:{$nest:{".wave-markdown>*:first-child":{marginTop:0}}}}),Td=j(({name:e,state:a,changed:n})=>({render:()=>{const{caption:l,items:i}=a;return t.createElement("div",{"data-test":e,className:Ga.card},t.createElement("div",{className:B("wave-s13",Ga.caption,i?"":Ga.center)},t.createElement(Se,{source:l})),i&&t.createElement(Ee,{items:i}))},changed:n}));Y.register("footer",Td,{effect:Je.Transparent,marginless:!0});const Pd=e=>{const a=e._t||"u",n={};delete e._t;for(const r in e)n[r.replace(/_./g,l=>l.substr(1).toUpperCase())]=e[r];return[a,n]},qa=(e,a)=>{const n=[];for(const r of a)n.push(e[r]);for(const r of a)delete e[r];return n},de=e=>e.split(/\s/g).map(a=>+a),st=(e,a,n)=>{const r=e.length,l=new Array(r);for(let i=0;i<r;i++)l[i]=n(e[i],a[i]);return l},oa=(e,a,n,r)=>{const l=e.length,i=new Array(l);for(let o=0;o<l;o++)i[o]=r(e[o],a[o],n[o]);return i},Dd={basis:Mi,"basis-closed":Fi,"basis-open":Wi,cardinal:Hi,"cardinal-closed":Oi,"cardinal-open":Vi,smooth:Yr,"smooth-closed":ji,"smooth-open":Xi,linear:Pa,"linear-closed":Ui,"monotone-x":Gi,"monotone-y":qi,natural:Qi,step:Kr,"step-after":Jr,"step-before":Zr},sa=()=>0,Ue=e=>e[0],Ge=e=>e[1],ca=e=>e[2],Ld=z({card:{position:"absolute",left:se.gap,top:se.gap,right:se.gap,bottom:se.gap}}),Ad=j(({name:e,state:a,changed:n})=>{const r=(i,o)=>{const[s,c]=Pd(i);switch(s){case"a":{const[d,m,u,p]=qa(c,["r1","r2","a1","a2"]),g=ga()({innerRadius:d,outerRadius:m,startAngle:u*Math.PI/180,endAngle:p*Math.PI/180});return t.createElement("path",ie(W({key:o},c),{d:g}))}case"c":return t.createElement("circle",W({key:o},c));case"e":return t.createElement("ellipse",W({key:o},c));case"i":return t.createElement("image",W({key:o},c));case"l":return t.createElement("line",W({key:o},c));case"p":return t.createElement("path",W({key:o},c));case"pg":return t.createElement("polygon",W({key:o},c));case"pl":return t.createElement("polyline",W({key:o},c));case"r":return t.createElement("rect",W({key:o},c));case"s":{const[d,m,u,p,g,h]=qa(c,["x","y","x0","y0","curve","radial"]),w=Dd[g]||Pa,L=h?p===""?Zt().angle(Ue).outerRadius(Ge).innerRadius(sa).curve(w)(st(de(d),de(m),(E,v)=>[E,v])):p?Zt().angle(Ue).outerRadius(ca).innerRadius(Ge).curve(w)(oa(de(d),de(p),de(m),(E,v,k)=>[E,v,k])):u===""?Zt().endAngle(Ue).startAngle(sa).radius(Ge).curve(w)(st(de(d),de(m),(E,v)=>[E,v])):u?Zt().endAngle(Ge).startAngle(Ue).radius(ca).curve(w)(oa(de(u),de(d),de(m),(E,v,k)=>[E,v,k])):zi().curve(w)(st(de(d),de(m),(E,v)=>[E,v])):p===""?At().x(Ue).y1(Ge).y0(sa).curve(w)(st(de(d),de(m),(E,v)=>[E,v])):p?At().x(Ue).y1(ca).y0(Ge).curve(w)(oa(de(d),de(p),de(m),(E,v,k)=>[E,v,k])):u===""?At().x1(Ue).x0(sa).y(Ge).curve(w)(st(de(d),de(m),(E,v)=>[E,v])):u?At().x1(Ge).x0(Ue).y(ca).curve(w)(oa(de(u),de(d),de(m),(E,v,k)=>[E,v,k])):Qr().curve(w)(st(de(d),de(m),(E,v)=>[E,v]));return t.createElement("path",ie(W({key:o},c),{d:L}))}case"t":{const[d]=qa(c,["text"]);return t.createElement("text",W({key:o},c),d)}default:return t.createElement("use",W({key:o},c))}};return{render:()=>{const{view_box:i,width:o,height:s,stage:c,scene:d}=a,m=c?N.unpack(c).map(r):[],u=d?N.unpack(d).map(({d:p,o:g},h)=>r(W(W({},p?JSON.parse(p):{}),g?JSON.parse(g):{}),h)):[];return t.createElement("div",{"data-test":e,className:Ld.card},t.createElement("svg",{viewBox:i,width:o,height:s},t.createElement("g",null,m),t.createElement("g",null,u)))},changed:n}});Y.register("graphics",Ad);const Qa=z({card:{display:"flex",flexDirection:"column"},body:{flexGrow:1,overflow:"auto",$nest:{">*":{borderBottom:"1px solid var(--text1)",padding:"5px 0"}}},table:{width:"100%"}}),Rd=j(({name:e,state:a,changed:n})=>({render:()=>{let l=N.unpack(a.cells);Array.isArray(l)||(l=[{title:"Data"}]);const i=l.map((c,d)=>t.createElement("th",{key:d},c.title)),o=l.map(({view:c,props:d,value:m})=>({view:c,props:N.unpack(d),value:m})),s=N.unpack(a.data).map((c,d)=>{const m=o.map(({view:u,props:p,value:g},h)=>{if(g!=null)return t.createElement("td",null,t.createElement(te,{data:c,format:g}));{const w={name:N.xid(),state:ie(W({},p),{view:u,data:c}),changed:N.box()};return t.createElement("td",null,t.createElement(Qt,{key:h,card:w}))}});return t.createElement("tr",{key:d},m)});return t.createElement("div",{"data-test":e,className:Qa.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title||"Untitled"),t.createElement("div",{className:Qa.body},t.createElement("table",{className:Qa.table},t.createElement("thead",null,t.createElement("tr",null,i)),t.createElement("tbody",null,s))))},changed:n}));Y.register("grid",Rd);const et=z({card:{display:"flex",flexDirection:"column"},title:{color:f("$themePrimary")},icon:{fontSize:56,display:"flex",justifyContent:"center"},header:{padding:xe(24,24,0),textAlign:"center"},img:{maxHeight:100},brand:{marginBottom:10},secondaryItems:{padding:24},persona:{$nest:{".ms-Persona":{flexDirection:"column",height:"auto"},".ms-Persona-details":{alignItems:"center",padding:0},".ms-Persona-primaryText":{fontWeight:500,marginTop:12}}}}),Gl=({items:e,value:a,hideNav:n})=>{const r=e.map(l=>({name:l.label,collapseByDefault:l.collapsed,links:l.items.map(({name:i,label:o,icon:s,disabled:c,tooltip:d})=>({key:i,name:o,icon:s,disabled:c,title:d,style:c?{opacity:.7}:void 0,url:"",onClick:()=>{if(n&&n(),i.startsWith("#")){window.location.hash=i.substr(1);return}y.args[i]=!0,y.push()}}))}));return t.createElement(Yi,{groups:r,selectedKey:a,styles:{groupContent:{marginBottom:0}}})},Bd=j(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,subtitle:i,icon:o,icon_color:s="$text",image:c,persona:d,secondary_items:m,color:u="card"}=a;return t.createElement("div",{"data-test":e,className:B(Nn(yl(u)),et.card),style:{background:f(`$${u}`)}},t.createElement("div",{className:et.header},(c||o)&&t.createElement("div",{className:et.brand},c&&t.createElement("img",{src:c,className:et.img}),o&&!c&&t.createElement($e,{iconName:o,className:et.icon,style:{color:f(s)}})),l&&t.createElement("div",{className:B("wave-s24 wave-w6",u==="card"?"wave-p9":"wave-c9")},l),i&&t.createElement("div",{className:B("wave-s13",u==="card"?"wave-t8":"wave-c8")},i),!c&&!o&&(d==null?void 0:d.persona)&&t.createElement("div",{className:et.persona},t.createElement(Yt,{model:d.persona}))),t.createElement(Gl,W({},a)),m&&t.createElement("div",{className:et.secondaryItems,style:{marginTop:a.items.length?"auto":"initial"}},t.createElement(Ee,{items:m})))},changed:n}));Y.register("nav",Bd,{effect:Je.Flat,marginless:!0});const Re=z({card:{position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",padding:xe(10,15),$nest:{".ms-layer":{display:"none"}}},inline:{display:"flex",alignItems:"center",cursor:"default",zIndex:1},center:ie(W({},Ke()),{position:"absolute",top:0,left:0,bottom:0,right:0}),burger:W({cursor:"pointer",fontSize:he(me(24)),width:25,height:40},Ke()),logo:{width:56,height:56,marginRight:15,borderRadius:2,cursor:"pointer"},icon:{fontSize:36,marginRight:15,display:"flex"},title:{color:f("$themePrimary")},nudgeUp:{marginTop:-5}}),Id=j(({items:e,isOpenB:a})=>{const n=()=>a(!1);return{render:()=>t.createElement(Ta,{isLightDismiss:!0,type:qr.smallFixedNear,isOpen:a(),onDismiss:n,hasCloseButton:!1},t.createElement(Gl,{items:e,hideNav:n})),isOpenB:a}}),zd=j(({name:e,state:a,changed:n})=>{const r=N.box(!1),l=()=>r(!0),i=()=>window.location.hash="";return{render:()=>{const{title:s,subtitle:c,icon:d,icon_color:m,nav:u,items:p,image:g,secondary_items:h,color:w="primary"}=a;return t.createElement("div",{"data-test":e,className:B(Re.card,Nn(yl(w))),style:{background:w==="transparent"?"transparent":f(`$${w}`)}},t.createElement("div",{className:Re.inline},u&&t.createElement($e,{onClick:l,className:B(Re.icon,Re.burger),iconName:"GlobalNavButton",style:{color:w==="primary"?f("$card"):void 0}}),g&&t.createElement(Ki,{src:g,className:Re.logo,imageFit:Ji.centerCover,onClick:i}),d&&!g&&t.createElement($e,{className:Re.icon,iconName:d,style:{color:f(m)}}),t.createElement("div",{className:Re.nudgeUp},t.createElement("div",{className:B(w!=="primary"?Re.title:"","wave-s24 wave-w5")},s),c&&t.createElement("div",{className:B(Re.nudgeUp,"wave-s12")},c))),h&&t.createElement("div",{className:Re.center},t.createElement(pn,{model:{items:h}})),p&&t.createElement("div",{style:{zIndex:1,marginRight:a.commands?30:void 0}},t.createElement(pn,{model:{items:p}})),u&&t.createElement(Id,{items:u,isOpenB:r}))},changed:n}});Y.register("header",zd,{effect:Je.Transparent,marginless:!0});const Ya=z({body:{position:"relative"},rail:{position:"absolute",width:"100%",opacity:.15},bar:{position:"absolute"}}),ql=({thickness:e,color:a,value:n})=>t.createElement("div",{className:Ya.body,style:{height:e}},t.createElement("div",{className:Ya.rail,style:{height:e,backgroundColor:a}}),t.createElement("div",{className:Ya.bar,style:{width:`${Math.round(n*100)}%`,height:e,backgroundColor:a}})),Tt=z({card:{display:"flex",flexDirection:"column",justifyContent:"space-between",padding:se.gap},values:{display:"flex",justifyContent:"space-between"},aux_value:{color:"var(--text7)"},caption:{color:"var(--text5)"},captions:{display:"flex",justifyContent:"space-between",color:"var(--text7)"}}),Md=j(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data);return t.createElement("div",{"data-test":e,className:Tt.card},t.createElement(te,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement(te,{data:l,format:a.caption,className:B(Tt.caption,"wave-s13")}),t.createElement("div",null,t.createElement("div",{className:B(Tt.values,"wave-s18 wave-w3")},t.createElement("div",null,t.createElement(te,{data:l,format:a.value})),t.createElement(te,{data:l,format:a.aux_value,className:Tt.aux_value})),t.createElement(ql,{thickness:2,color:f(a.plot_color),value:a.progress}),t.createElement("div",{className:B(Tt.captions,"wave-s12")},t.createElement("div",null,t.createElement(te,{data:l,format:a.value_caption})),t.createElement("div",null,t.createElement(te,{data:l,format:a.aux_value_caption})))))},changed:n}));Y.register("large_bar_stat",Md);const da=z({card:{display:"flex",flexDirection:"column",padding:15},values:{display:"flex",alignItems:"baseline"},aux_value:{marginLeft:5,color:"var(--text6)"},caption:{color:"var(--text5)"}}),Fd=j(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,className:da.card},t.createElement(te,{data:a.data,format:a.title,className:"wave-s12 wave-w6"}),t.createElement("div",{className:da.values},t.createElement(te,{data:a.data,defaultValue:a.value,format:a.value,className:"wave-s40 wave-w2"}),t.createElement(te,{data:a.data,format:a.aux_value,className:da.aux_value})),t.createElement(te,{data:a.data,format:a.caption,className:B(da.caption,"wave-s13")})),changed:n}));Y.register("large_stat",Fd);const Nr=z({card:{display:"flex",flexDirection:"column"},body:{flexGrow:1,overflow:"auto",$nest:{">*":{borderBottom:"1px solid var(--text1)",padding:"5px 0"}}}}),Wd=j(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,className:Nr.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",{className:Nr.body},t.createElement($n,{view:a.item_view,props:a.item_props,data:a.data}))),changed:n}));Y.register("list",Wd);const Pt=z({item:{display:"flex",justifyContent:"space-between"},left:{flexDirection:"column"},right:{flexDirection:"column"},caption:{color:f("text5")},aux_value:{color:f("text5")}}),Hd={title:"Untitled"},Od=j(({name:e,state:a,changed:n})=>({render:()=>{const l=W(W({},Hd),a),i=N.unpack(l.data);return t.createElement("div",{"data-test":e,className:Pt.item},t.createElement("div",{className:Pt.left},t.createElement(te,{data:i,format:l.title,className:"wave-s12 wave-w6"}),t.createElement(te,{data:i,format:l.caption,className:B(Pt.caption,"wave-s13")})),t.createElement("div",{className:Pt.right},t.createElement(te,{data:i,format:l.value,className:"wave-s12"}),t.createElement(te,{data:i,format:l.aux_value,className:B(Pt.aux_value,"wave-s13")})))},changed:n}));Y.register("list_item1",Od);const Vd=j(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e},t.createElement("pre",null,JSON.stringify(a,null,2))),changed:n}));Y.register("",Vd);const jt=20,Sr=jt*16,jd="#ffffff #bfbfbf #808080 #404040 #000000 #6699ff #3366cc #003399 #99cc33 #00cc00 #669900 #ffcc00 #ff9900 #ff6600 #cc0000".split(/\s+/g),ct=z({card:{display:"flex",flexDirection:"column",padding:se.gap},canvas:{display:"flex",flexWrap:"wrap",width:Sr,height:Sr},swatches:{paddingTop:10,marginTop:15,borderTop:"1px solid #ccc"},pixel:{display:"inline-block",width:jt,height:jt}}),Xd=e=>{const a=Math.floor(e/16),n=e%16,r=n%2===1;return a%2===0?r?"#fff":"#ddd":r?"#ddd":"#fff"},Ud=j(({name:e,state:a,changed:n})=>{let r="#000";const l=o=>{const s=y.fork();s.set(`${e} data ${o}`,r==="none"?null:[r]),s.push()};return{render:()=>{const o=N.unpack(a.data),s=jd.map((d,m)=>t.createElement("div",{key:m,className:ct.pixel,style:{backgroundColor:d},onClick:()=>r=d})),c=o.map((d,m)=>{const u=d?d.color:Xd(m);return t.createElement("div",{key:m,className:ct.pixel,style:{backgroundColor:u},onClick:()=>l(m)})});return t.createElement("div",{"data-test":e,className:ct.card},t.createElement("div",{className:"wave-s12 wave-w6"},a.title),t.createElement("div",{className:ct.canvas},c),t.createElement("div",{className:ct.swatches},t.createElement("div",{className:ct.pixel},t.createElement("svg",{onClick:()=>r="none",viewBox:"0 0 433.25 433.25",width:jt,height:jt},t.createElement("path",{d:"M418.4,192.331c19.8-19.8,19.8-51.9,0-71.7l-0.1-0.1l-78.6-78.3c-19.8-19.8-51.9-19.7-71.8,0l-169.5,169.6l-54.2,54.1 c-19.8,19.7-19.8,51.8-0.1,71.6l48.3,48.3H10c-5.5,0-10,4.5-10,10s4.5,10,10,10h297.4c5.5,0,10-4.5,10-10s-4.5-10-10-10H225 l23.9-23.7L418.4,192.331z M196.7,385.831h-76.1l-62.3-62.4c-12-12-11.9-31.4,0-43.4l47.1-47l122.2,122L196.7,385.831z M119.6,218.931l162.5-162.5c12-12,31.5-12,43.5,0l78.6,78.4c12,12,12,31.4,0,43.5l-162.4,162.8L119.6,218.931z"}))),s))},changed:n}});Y.register("pixel_art",Ud);const Ql=2,Dt=z({card:{display:"flex",flexDirection:"column"},content:{padding:al},img:{flexGrow:1,minHeight:150,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},persona:{marginBottom:16,$nest:{".ms-Persona":{flexDirection:"column",height:"auto"},".ms-Persona-image":{border:be(Ql,f("$neutralTertiary"))},".ms-Persona-details":{alignItems:"center",padding:0},".ms-Persona-primaryText":{fontWeight:500,marginTop:12,color:f("$neutralPrimary")}}},items:{marginTop:16}}),Gd=j(({name:e,state:a,changed:n})=>{const r=({size:i="m"})=>{const o=-al-Ql;switch(i){case"xs":return o-24;case"s":return o-28;case"m":return o-36;case"l":return o-50;case"xl":return o-60}};return{render:()=>{const{image:i,persona:o,items:s,height:c}=a;return t.createElement("div",{"data-test":e,className:Dt.card},t.createElement("div",{className:Dt.img,style:{backgroundImage:`url('${i}')`}}),t.createElement("div",{className:Dt.content,style:{height:c}},o.persona&&t.createElement("div",{className:Dt.persona,style:{marginTop:r(o.persona)}},t.createElement(Yt,{model:o.persona})),s&&t.createElement("div",{className:Dt.items},t.createElement(Ee,{items:s}))))},changed:n}});Y.register("profile",Gd);const dt=z({card:{display:"flex",flexDirection:"column"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",padding:24,paddingBottom:16,marginTop:-4,$nest:{".ms-Persona-primaryText":{fontSize:16,lineHeight:me(22),fontWeight:500},".ms-Persona-secondaryText":{fontSize:14,lineHeight:me(20),color:f("$text7")},".ms-Persona-image":{height:"40px !important",width:"40px !important"},".ms-Persona-imageArea":{height:"40px !important",width:"40px !important"}}},aux_value:{marginBottom:5},content:{padding:24,paddingTop:16},img:{flexGrow:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},items:{marginTop:12}}),qd=j(({name:e,state:a,changed:n})=>({render:()=>{const{persona:l,image:i,aux_value:o,caption:s,items:c}=a;return l.persona&&(l.persona.size="xs"),t.createElement("div",{"data-test":e,className:dt.card},t.createElement("div",{className:dt.header},l.persona&&t.createElement(Yt,{model:l.persona}),o&&t.createElement("div",{className:B("wave-s12 wave-t7",dt.aux_value)},o)),t.createElement("div",{className:dt.img,style:{backgroundImage:`url('${i}')`}}),(s||c)&&t.createElement("div",{className:dt.content},s&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t7"},s),c&&t.createElement("div",{className:dt.items},t.createElement(Ee,{items:c}))))},changed:n}));Y.register("post",qd);const Lt=z({card:{display:"flex",flexDirection:"column",justifyContent:"space-between",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},clickable:{cursor:"pointer"},header:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},content:{padding:24,paddingBottom:0,color:f("$text")},items:{$nest:{"& .ms-Icon, & .ms-Button-label":{color:f("$text")}}}}),Qd=j(({name:e,state:a,changed:n})=>({render:()=>{const{image:l,title:i,name:o,label:s,caption:c,items:d}=a,m=()=>{if(o.startsWith("#")){window.location.hash=o.substr(1);return}y.args[o]=o,y.push()};return t.createElement("div",{"data-test":e,onClick:o&&!s?m:void 0,className:B(Lt.card,o&&!s?Lt.clickable:""),style:{backgroundImage:`url('${l}')`}},t.createElement("div",{className:Lt.content,style:{background:f("$card7"),boxShadow:`0px 6px 30px 30px ${f("$card7")}`}},t.createElement("div",{className:Lt.header},i&&t.createElement("div",{className:"wave-s20 wave-w6"},i),d&&t.createElement("div",{className:Lt.items},t.createElement(Ee,{items:d}))),c&&t.createElement("div",{className:"wave-s14 wave-t8"},c)),s&&t.createElement(Fe,{onClick:m,text:s,styles:{root:{margin:"0 24px 24px 0",alignSelf:"flex-end"}}}))},changed:n}));Y.register("preview",Qd);const Yd=j(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e},t.createElement($n,{view:a.item_view,props:a.item_props,data:a.data})),changed:n}));Y.register("repeat",Yd);const Ka=z({card:{display:"flex",paddingTop:5},rhs:{flexGrow:1,marginLeft:15},subtitle:{$nest:{">div>p":{margin:0}}}}),Kd=j(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,subtitle:i,items:o}=a,s=N.unpack(o),c=o&&t.createElement("div",{className:Ka.rhs},t.createElement(Ee,{items:s,alignment:"end"}));return t.createElement("div",{"data-test":e,className:Ka.card},t.createElement("div",null,t.createElement("div",{className:"wave-s14 wave-w6"},l),t.createElement("div",{className:B(Ka.subtitle,"wave-s12")},t.createElement(Se,{source:i}))),c)},changed:n}));Y.register("section",Kd,{effect:Je.Transparent});const Jd={linear:Pa,smooth:Yr,step:Kr,"step-after":Jr,"step-before":Zr},Zd=z({container:{width:"100%",height:"100%",position:"relative",flexGrow:1,minHeight:32}}),Dn=({value:e,color:a,data:n,zeroValue:r,curve:l})=>{const i=t.useRef(null),[o,s]=t.useMemo(()=>{let[p,g]=el(n,h=>h[e]);return r!=null&&(p=Math.min(r,p),g=Math.max(r,g)),[p,g]},[n,e,r]),[c,d]=t.useState(null),m=t.useCallback(()=>{if(!i.current)return;const{width:p,height:g}=i.current.getBoundingClientRect();if(!g){setTimeout(m,300);return}const h=an().domain([0,n.length-1]).range([0,p]),w=an().domain([o,s]).range([g,2]),L=Jd[l]||Pa,E=Qr().defined(k=>k&&k[e]!=null).x((k,I)=>h(I)).y(k=>w(k[e])).curve(L),v=At().defined(k=>k&&k[e]!=null).x((k,I)=>h(I)).y0(k=>w(r==null?o:r)).y1(k=>w(k[e])).curve(L);d(t.createElement("svg",{viewBox:`0 0 ${p} ${g}`,style:{position:"absolute",top:0,left:0,right:0,bottom:0}},t.createElement("path",{d:v(n),fill:a,fillOpacity:"0.1",strokeLinejoin:"round",strokeLinecap:"round"}),t.createElement("path",{d:E(n),fill:"none",stroke:a,strokeWidth:"1.5",strokeLinejoin:"round",strokeLinecap:"round"})))},[a,l,n,s,o,e,r]),u=kt(1e3,m);return t.useEffect(()=>(window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)),[]),t.useLayoutEffect(m,[e,a,n,r,l,o,s,m]),t.createElement("div",{ref:i,className:Zd.container},c)},em=z({container:{width:"100%",height:"100%",position:"relative",flexGrow:1,minHeight:32}}),Ln=({value:e,category:a="x",color:n,data:r,zeroValue:l})=>{const i=t.useRef(null),[o,s]=t.useState(null),[c,d]=t.useMemo(()=>{let[p,g]=el(r,h=>h[e]);return l!=null&&(p=Math.min(l,p),g=Math.max(l,g)),[p,g]},[r,e,l]),m=t.useCallback(()=>{if(!i.current)return;const{width:p,height:g}=i.current.getBoundingClientRect();if(!g){setTimeout(m,300);return}const h=Zi().domain(r.map(E=>E[a])).range([0,p]).paddingInner(.1),w=an().domain([c,d]).range([g,0]),L=r.map((E,v)=>{const k=h(E[a]),I=w(E[e]);return t.createElement("rect",{key:v,fill:n,x:k,y:I,width:2,height:g-I})});s(t.createElement("svg",{viewBox:`0 0 ${p} ${g}`,style:{position:"absolute",top:0,left:0,right:0,bottom:0}},L))},[a,n,r,d,c,e]),u=kt(1e3,m);return t.useEffect(()=>(window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)),[]),t.useLayoutEffect(m,[e,a,n,r,l,c,d,m]),t.createElement("div",{ref:i,className:em.container},o)},_r=z({card:{display:"flex",flexDirection:"column"},text:{display:"flex",justifyContent:"space-between",padding:xe(8,se.gap)}}),tm=j(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=a.plot_type==="interval"?t.createElement(Ln,{data:N.unpack(a.plot_data),category:a.plot_category,value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value}):t.createElement(Dn,{data:N.unpack(a.plot_data),value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value,curve:a.plot_curve||"linear"});return t.createElement("div",{"data-test":e,className:_r.card},t.createElement("div",{className:_r.text},t.createElement(te,{data:l,format:a.title||"Untitled",className:"wave-s12 wave-w6"}),t.createElement(te,{data:l,format:a.value,className:"wave-s12"})),i)},changed:n}));Y.register("small_series_stat",tm);const Tr=z({card:{display:"flex",flexDirection:"column",padding:se.gap},value:{lineHeight:"28px"}}),am=j(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data);return t.createElement("div",{"data-test":e,className:Tr.card},t.createElement(te,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement(te,{data:l,format:a.value,className:B(Tr.value,"wave-s24 wave-w3")}))},changed:n}));Y.register("small_stat",am);const Be=z({card:{display:"flex",flexDirection:"column",padding:15},items:{overflow:"auto",flexGrow:1,marginTop:"1em"},item:{display:"flex",justifyContent:"space-between",borderBottom:"1px solid #ddd",padding:"0.5em 0",$nest:{"&:last-child":{borderBottom:"none"}}},icon:{padding:"0.2em 0.5em 0em 0.1em"},lhs:{flexGrow:1},rhs:{textAlign:"right"},caption:{opacity:.7},auxValue:{opacity:.7},clickable:{cursor:"pointer",$nest:{"&:hover":{backgroundColor:"#fafafa"}}}}),nm=j(({name:e,state:a,changed:n})=>({render:()=>{const{name:l,title:i,subtitle:o,items:s}=a,c=s.map(({name:d,label:m,caption:u,value:p,value_color:g,aux_value:h,icon:w,icon_color:L},E)=>{const v=d?()=>cl(l,d):void 0;return t.createElement("div",{key:d!=null?d:`${E}:${m}`,className:v?B(Be.item,Be.clickable):Be.item,onClick:v},w&&t.createElement("div",{className:Be.icon,style:L?{color:f(L)}:void 0},t.createElement(at,{iconName:w})),t.createElement("div",{className:Be.lhs},t.createElement("div",{className:"wave-s12 wave-w6"},m),u&&t.createElement("div",{className:B(Be.caption,"wave-s12")},u)),t.createElement("div",{className:Be.rhs},p&&t.createElement("div",{className:"wave-s13 wave-w6",style:g?{color:f(g)}:void 0},p),h&&t.createElement("div",{className:B(Be.auxValue,"wave-s12")},h)))});return t.createElement("div",{"data-test":e,className:Be.card},t.createElement("div",{className:"wave-s12 wave-w6"},i),o&&t.createElement("div",{className:"wave-s12"},o),t.createElement("div",{className:Be.items},c))},changed:n}));Y.register("stat_list",nm);const qe=z({card:{display:"flex",flexDirection:"column",padding:15,overflow:"auto"},items:{flexGrow:1,overflow:"auto",marginTop:"1em"},table:{borderSpacing:0,width:"100%",$nest:{tbody:{$nest:{th:{borderTop:"1px solid #ddd",textAlign:"left",padding:"0.5em 1em 0.5em 0"},td:{borderTop:"1px solid #ddd",padding:"0.5em 0 0.5em 1em"}}},td:{textAlign:"right",verticalAlign:"top"}}},thead:{opacity:.4,$nest:{th:{textAlign:"right",width:"1%",whiteSpace:"nowrap",padding:"0.5em 0 0.5em 1em"},"th:first-child":{textAlign:"left",width:"100%",padding:"0.5em 1em 0.5em 0"}}},header:{display:"flex"},caption:{opacity:.7},icon:{padding:"0.2em 0.5em 0em 0.1em"},clickable:{cursor:"pointer",$nest:{"&:hover":{backgroundColor:f("$themeLighter"),color:f("$themeDarker")}}}}),rm=j(({name:e,state:a,changed:n})=>({render:()=>{const{name:l,title:i,columns:o,subtitle:s,items:c}=a,d=o.map((u,p)=>t.createElement("th",{key:`${p}:${u}`},u)),m=c.map(({name:u,label:p,values:g,caption:h,icon:w,icon_color:L,colors:E},v)=>{const k=u?()=>cl(l,u):void 0,I=g.map((P,b)=>t.createElement("td",{key:`${b}:${P}`,style:E&&E[b]?{color:f(E[b])}:void 0},P));return t.createElement("tr",{key:u!=null?u:`${v}:${p}`,className:k?qe.clickable:void 0,onClick:k},t.createElement("th",{key:"label"},t.createElement("div",{className:qe.header},w&&t.createElement("div",{className:qe.icon,style:L?{color:f(L)}:void 0},t.createElement(at,{iconName:w})),t.createElement("div",null,t.createElement("div",{className:"wave-w6"},p),h&&t.createElement("div",{className:B(qe.caption,"wave-s12 wave-w4")},h)))),I)});return t.createElement("div",{"data-test":e,className:qe.card},t.createElement("div",{className:"wave-s12 wave-w6"},i),s&&t.createElement("div",{className:"wave-s12"},s),t.createElement("div",{className:qe.items},t.createElement("table",{className:B(qe.table,"wave-s13")},t.createElement("thead",{className:B(qe.thead,"wave-w6")},t.createElement("tr",null,d)),t.createElement("tbody",null,m))))},changed:n}));Y.register("stat_table",rm);const lm=z({card:{display:"flex",flexDirection:"column",justifyContent:"center",minHeight:46}}),im=j(({name:e,state:a,changed:n})=>{const r=i=>{const o=i==null?void 0:i.props.itemKey;if(!!o){if(o.startsWith("#")){window.location.hash=o.substr(1);return}a.name?y.args[a.name]=o:y.args[o]=!0,y.push()}};return{render:()=>{const i=a.link?"links":"tabs",o=a.items.map(({name:s,label:c,icon:d})=>t.createElement(Ur,{key:s,itemKey:s,headerText:c,itemIcon:d}));return t.createElement("div",{"data-test":e,className:lm.card},t.createElement(Gr,{linkFormat:i,onLinkClick:r,defaultSelectedKey:a.value},o))},changed:n}});Y.register("tab",im,{effect:Je.Transparent});const mt=z({card:{display:"flex",flexDirection:"column"},clickable:{cursor:"pointer"},header:{position:"absolute",left:0,bottom:0,right:0,padding:24,paddingBottom:16,color:f("$neutralPrimary"),display:"flex",justifyContent:"space-between",alignItems:"center"},content:{marginBottom:16,$nest:{"&:first-child":{marginTop:0},"h1, h2, h3, h4, h5, h6":{marginBlock:0,color:f("$neutralPrimary")},h1:{margin:ye(18,0),fontSize:20,fontWeight:600,letterSpacing:"-0.017em",lineHeight:me(28)},h2:{margin:ye(12,0),fontSize:18,fontWeight:500,letterSpacing:"-0.014em",lineHeight:me(25.2)},h3:{margin:ye(8,0),fontSize:16,fontWeight:400,letterSpacing:"-0.011em",lineHeight:me(22.4)},p:{fontSize:14,letterSpacing:"-0.006em",lineHeight:me(20),color:f("$text7"),marginBlock:0}}},body:{margin:ye(16,24,24,24)},img:{position:"relative",flexGrow:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),om=j(({name:e,state:a,changed:n})=>{const{title:r,subtitle:l,image:i,name:o,items:s,content:c,value:d}=a,m=()=>{if(!!o){if(o.startsWith("#")){window.location.hash=o.substr(1);return}y.args[o]=o,y.push()}},u=()=>{const{r:g,g:h,b:w}=Ve(ee("$card"))||{r:255,g:255,b:255};return`linear-gradient(rgba(${g}, ${h}, ${w}, 0) 0%, rgba(${g}, ${h}, ${w}, 0.5) 50%, ${f("$card")} 100%)`};return{render:()=>t.createElement("div",{"data-test":e,onClick:m,className:B(mt.card,o?mt.clickable:"")},t.createElement("div",{className:mt.img,style:{backgroundImage:`url('${i}')`}},t.createElement("div",{className:mt.header,style:{background:u()}},t.createElement("div",null,t.createElement("div",{className:"wave-s20 wave-w6"},r),l&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t8"},l)),d&&t.createElement("div",{className:"wave-s16"},d))),(c||s)&&t.createElement("div",{className:mt.body},c&&t.createElement("div",{className:mt.content},t.createElement(Se,{source:c})),s&&t.createElement(Ee,{items:s}))),changed:n}});Y.register("tall_article_preview",om);const ma=z({card:{display:"flex",flexDirection:"column",padding:se.gap,position:"relative"},body:{position:"relative",display:"flex",flexGrow:1},value_overlay:{position:"absolute",top:0,right:0,bottom:0,left:0,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},aux_value:{color:"var(--text7)"}}),sm=j(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data);return t.createElement("div",{"data-test":e,className:ma.card},t.createElement(te,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement("div",{className:ma.body},t.createElement(Pn,{thickness:2,color:f(a.plot_color),value:a.progress}),t.createElement("div",{className:ma.value_overlay},t.createElement(te,{data:l,format:a.value,className:"wave-s24 wave-w3"}),t.createElement(te,{data:l,format:a.aux_value,className:B(ma.aux_value,"wave-s12")}))))},changed:n}));Y.register("tall_gauge_stat",sm);const cm={root:{fontSize:48,color:f("$neutralPrimary")}},We=z({card:{padding:24},imgContainer:W({},Ke()),textContainer:{textAlign:"center"},clickable:{cursor:"pointer"},header:{marginTop:16,marginBottom:8},title:{color:f("$neutralPrimary")},category:{marginTop:-2,color:f("$themeDark")},iconWrapper:W({background:f("$text1"),height:80,width:80,boxSizing:"border-box",borderRadius:ve(50)},Ke()),img:{flexGrow:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"}}),dm=j(({name:e,state:a,changed:n})=>{const{title:r,caption:l,icon:i,image:o,category:s,name:c,image_height:d="150px",label:m}=a,u=()=>{if(c.startsWith("#")){window.location.hash=c.substr(1);return}y.args[c]=c,y.push()};return{render:()=>t.createElement("div",{"data-test":e,onClick:c&&!m?u:void 0,className:B(We.card,c&&!m?We.clickable:"")},t.createElement("div",{className:We.imgContainer},o?t.createElement("div",{className:We.img,style:{backgroundImage:`url('${o}')`,height:d}}):t.createElement("div",{className:We.iconWrapper},t.createElement($e,{iconName:i||"MiniExpand",styles:cm}))),t.createElement("div",{className:We.textContainer},t.createElement("div",{className:We.header},t.createElement("div",{className:B("wave-s20 wave-w6 wave-t9",We.title)},r),s&&t.createElement("div",{className:B("wave-s14 wave-w4 wave-t5",We.category)},s)),l&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t7"},t.createElement(Se,{source:l})),m&&t.createElement(Xe,{text:m,styles:{root:{marginTop:16}},onClick:u}))),changed:n}});Y.register("tall_info",dm);const Ja=z({card:{display:"flex",flexDirection:"column"},text:{padding:se.gap},aux_value:{color:"var(--text7)"}}),mm=j(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=a.plot_type==="interval"?t.createElement(Ln,{data:N.unpack(a.plot_data),category:a.plot_category,value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value}):t.createElement(Dn,{data:N.unpack(a.plot_data),value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value,curve:a.plot_curve||"linear"});return t.createElement("div",{"data-test":e,className:Ja.card},t.createElement("div",{className:Ja.text},t.createElement(te,{data:l,format:a.title||"Untitled",className:"wave-s12 wave-w6"}),t.createElement(te,{data:l,format:a.value,className:"wave-s24 wave-w3"}),t.createElement(te,{data:l,format:a.aux_value,className:B(Ja.aux_value,"wave-s12")})),i)},changed:n}));Y.register("tall_series_stat",mm);const Pr=z({card:{display:"flex",flexDirection:"column",textAlign:"center",padding:24,justifyContent:"space-around"},value:{color:f("$themePrimary")}}),um=j(({name:e,state:a,changed:n})=>({render:()=>t.createElement("div",{"data-test":e,className:Pr.card},a.items.map(({label:l,value:i},o)=>t.createElement("div",{key:`${o}-${l}`},i&&t.createElement("div",{className:B(Pr.value,"wave-s40 wave-w4")},i),t.createElement("div",{className:"wave-s14 wave-w2"},l)))),changed:n}));Y.register("tall_stats",um);const ua=z({card:{padding:se.gap,display:"flex",flexDirection:"column"},content:{flexGrow:1,display:"flex",flexDirection:"column",justifyContent:"flex-end"},values:{display:"flex",alignItems:"baseline"},aux_value:{marginLeft:5,color:f("$text7")}}),pm=j(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data);return t.createElement("div",{"data-test":e,className:ua.card},t.createElement(te,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement("div",{className:ua.content},t.createElement("div",{className:ua.values},t.createElement(te,{data:l,format:a.value,className:"wave-s18 wave-w3"}),t.createElement(te,{data:l,format:a.aux_value,className:B(ua.aux_value,"wave-s13")})),t.createElement(ql,{thickness:2,color:f(a.plot_color),value:a.progress})))},changed:n}));Y.register("wide_bar_stat",pm);const Qe=z({card:{display:"flex",padding:xe(8,se.gap)},lhs:{position:"relative",width:"100%"},rhs:{marginLeft:se.gap,alignSelf:"center"},values:{display:"flex",alignItems:"baseline"},percentContainer:W({position:"absolute",top:0,right:0,bottom:0,left:0},Ke()),percent:{opacity:.5},title:{overflow:"visible"},aux_value:{color:f("$text7"),marginLeft:5}}),fm=14,gm=9,Dr=4,hm=j(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=Et(a.value,a.data),o=Et(a.aux_value,a.data),s=i.match(/[^0-9]/g).length,c=o.match(/[^0-9]/g).length,d=fm*Math.max(i.length,Dr+s),m=gm*Math.max(o.length,Dr+c);return t.createElement("div",{"data-test":e,className:Qe.card},t.createElement("div",{className:Qe.lhs},t.createElement(Pn,{thickness:2,color:f(a.plot_color),value:a.progress}),t.createElement("div",{className:Qe.percentContainer},t.createElement("div",{className:Qe.percent},`${Math.round(a.progress*100)}%`))),t.createElement("div",{className:Qe.rhs},t.createElement(te,{data:l,format:a.title,className:B(Qe.title,"wave-s12 wave-w6")}),t.createElement("div",{className:Qe.values},t.createElement(te,{data:l,format:a.value,style:{minWidth:d},className:"wave-s24 wave-w3"}),t.createElement(te,{data:l,format:a.aux_value,style:{minWidth:m},className:B(Qe.aux_value,"wave-s13")}))))},changed:n}));Y.register("wide_gauge_stat",hm);const ym={root:{fontSize:48,color:f("$neutralPrimary"),fontWeight:600}},_e=z({card:{display:"flex",padding:24},right:{flexDirection:"row-reverse"},rhs:{display:"flex",flexDirection:"column"},lhs:{textAlign:"center",display:"flex",marginRight:16},imgSpecified:{width:ve(50),minWidth:ve(50)},clickable:{cursor:"pointer"},title:{color:f("$neutralPrimary")},subtitle:{marginTop:1},category:{color:f("$themeDark"),marginBottom:-1},header:{marginTop:-5,marginBottom:13},iconWrapper:ie(W({},Ke()),{background:f("$text1"),height:80,width:80,padding:8,boxSizing:"border-box",borderRadius:ve(50)}),img:{flexGrow:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",borderRadius:4}}),vm=j(({name:e,state:a,changed:n})=>{const{title:r,caption:l,icon:i,image:o,category:s,name:c,subtitle:d,label:m,align:u="left"}=a,p=()=>{if(c.startsWith("#")){window.location.hash=c.substr(1);return}y.args[c]=c,y.push()};return{render:()=>t.createElement("div",{"data-test":e,onClick:c&&!m?p:void 0,className:B(_e.card,c&&!m?_e.clickable:"",u==="right"?_e.right:"")},t.createElement("div",{className:B(_e.lhs,!i&&o?_e.imgSpecified:"")},o?t.createElement("div",{className:_e.img,style:{backgroundImage:`url('${o}')`}}):t.createElement($e,{iconName:i||"MiniExpand",className:_e.iconWrapper,styles:ym})),t.createElement("div",{className:_e.rhs},t.createElement("div",{className:_e.header},s&&t.createElement("div",{className:B("wave-s14 wave-w5 wave-t7",_e.category)},s),t.createElement("div",{className:B("wave-s20 wave-w6",_e.title)},r),d&&t.createElement("div",{className:B("wave-s14 wave-w5 wave-t7",_e.subtitle)},d)),l&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t7",style:{marginBottom:m?16:void 0}},t.createElement(Se,{source:l})),m&&t.createElement(Fe,{onClick:p,text:m,styles:{root:{marginTop:"auto",alignSelf:"flex-start"}}}))),changed:n}});Y.register("wide_info",vm);const Ie=z({card:{padding:24,display:"flex",justifyContent:"space-between",maxHeight:ve(100)},lhs:{maxWidth:ve(50),flexGrow:1},title:{color:f("$neutralPrimary"),marginBottom:24,marginTop:-7},value:{color:f("$neutralPrimary"),marginTop:-5},description:{marginLeft:4,marginBottom:16},label:{marginTop:-3,marginBottom:4},pie:{maxWidth:ve(65),flexGrow:1,display:"flex"},pieText:{textAnchor:"middle",fontSize:10,fill:f("$neutralLighterAlt")},pieLegend:{display:"flex"},colorPreview:{borderRadius:4,minWidth:16,height:16}}),bm=j(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,pies:i}=a,o=eo().domain(i.map(({label:m})=>m)).range(i.map(({color:m})=>m)),s=0,c=50,d=ga();return t.createElement("div",{"data-test":e,className:Ie.card},t.createElement("div",{className:Ie.lhs},t.createElement("div",{className:B("wave-s20 wave-w6",Ie.title)},l),i.map(({label:m,aux_value:u},p)=>t.createElement("div",{key:p,className:Ie.pieLegend},t.createElement("div",{className:Ie.colorPreview,style:{background:f(o(m))}}),t.createElement("div",{className:Ie.description},t.createElement("div",{className:B("wave-s16 wave-w6 wave-t7",Ie.label)},m),u&&t.createElement("div",{className:B("wave-s24 wave-w7",Ie.value)},u))))),t.createElement("div",{className:Ie.pie},t.createElement("svg",{viewBox:"0 0 100 100",width:"100%",height:"100%"},to().value(m=>m.fraction)(i).map(({startAngle:m,endAngle:u,data:p},g)=>{const[h,w]=d.centroid({innerRadius:s,outerRadius:c,startAngle:m,endAngle:u});return t.createElement(t.Fragment,{key:g},t.createElement("path",{d:d({innerRadius:s,outerRadius:c,startAngle:m,endAngle:u}),fill:f(o(p.label)),transform:`translate(${c}, ${c})`}),t.createElement("text",{className:Ie.pieText,transform:`translate(${h+c}, ${w+c})`},p.value))}))))},changed:n}));Y.register("wide_pie_stat",bm);const pa=z({card:{display:"flex",padding:24},lhs:{marginTop:-5,marginRight:16,width:ve(35)},rhs:{width:ve(65)},title:{color:f("$neutralPrimary"),marginBottom:13}}),xm=j(({name:e,state:a,changed:n})=>({render:()=>{const{title:l,caption:i,data:o,plot:s}=a;return t.createElement("div",{"data-test":e,className:pa.card},t.createElement("div",{className:pa.lhs},t.createElement("div",{className:B("wave-s20 wave-w5 wave-t9",pa.title)},l),i&&t.createElement("div",{className:"wave-s14 wave-w4 wave-t7"},i)),t.createElement("div",{className:pa.rhs},t.createElement(Tn,{model:{data:o,plot:s}})))},changed:n}));Y.register("wide_plot",xm);const ut=z({card:{display:"flex",padding:se.gap},plot:{display:"flex",width:ve(50)},text:{width:ve(50),paddingLeft:se.gap},values:{display:"flex",alignItems:"baseline"},value:{lineHeight:"28px"},aux_value:{color:f("$text7"),marginLeft:5}}),Em=j(({name:e,state:a,changed:n})=>({render:()=>{const l=N.unpack(a.data),i=a.plot_type==="interval"?t.createElement(Ln,{data:N.unpack(a.plot_data),category:a.plot_category,value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value}):t.createElement(Dn,{data:N.unpack(a.plot_data),value:a.plot_value,color:f(a.plot_color),zeroValue:a.plot_zero_value,curve:a.plot_curve||"linear"});return t.createElement("div",{"data-test":e,className:ut.card},t.createElement("div",{className:ut.plot},i),t.createElement("div",{className:ut.text},t.createElement(te,{data:l,format:a.title,className:"wave-s12 wave-w6"}),t.createElement("div",{className:ut.values},t.createElement(te,{data:l,format:a.value,className:B(ut.value,"wave-s24 wave-w3")}),t.createElement(te,{data:l,format:a.aux_value,className:B(ut.aux_value,"wave-s13")}))))},changed:n}));Y.register("wide_series_stat",Em);const He=z({card:{display:"flex",flexDirection:"column",padding:24},clickable:{cursor:"pointer"},header:{display:"flex",justifyContent:"space-between",alignItems:"flex-end",marginBottom:24,$nest:{".ms-Persona-primaryText":{fontSize:16,lineHeight:me(22),fontWeight:500},".ms-Persona-secondaryText":{fontSize:14,lineHeight:me(20),color:f("$text7")},".ms-Persona-image":{height:he("40px"),width:he("40px")},".ms-Persona-imageArea":{height:he("40px"),width:he("40px")}}},aux_value:{marginBottom:4},content:{flex:1,display:"flex"},img:{marginRight:24,flex:1,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center"},rhs:{flex:1,display:"flex",flexDirection:"column",justifyContent:"space-between"},items:{$nest:{"& .ms-Icon, & .ms-Button-label":{color:f("$text")}}},title:{marginBottom:8,lineHeight:.6}}),wm=j(({name:e,state:a,changed:n})=>({render:()=>{const{persona:l,aux_value:i,name:o,image:s,title:c,caption:d,items:m,content:u}=a,p=()=>{if(!!o){if(o.startsWith("#")){window.location.hash=o.substr(1);return}y.args[o]=o,y.push()}};return l.persona&&(l.persona.size="xs"),t.createElement("div",{"data-test":e,onClick:p,className:B(He.card,o?He.clickable:"")},t.createElement("div",{className:He.header},l.persona&&t.createElement(Yt,{model:l.persona}),i&&t.createElement("div",{className:B("wave-s12 wave-t7",He.aux_value)},i)),t.createElement("div",{className:He.content},t.createElement("div",{className:He.img,style:{backgroundImage:`url('${s}')`}}),t.createElement("div",{className:He.rhs},t.createElement("div",null,c&&t.createElement("div",{className:B("wave-s16 wave-w6",He.title)},c),(u||d)&&t.createElement("div",{style:{marginBottom:m?24:0},className:"wave-s14 wave-w4 wave-t7"},u?t.createElement(Se,{source:u}):d)),m&&t.createElement("div",{className:He.items},t.createElement(Ee,{items:m})))))},changed:n}));Y.register("wide_article_preview",wm);const km=z({live:{backgroundColor:"#ff2938",color:"#fff",fontSize:11,fontWeight:700,letterSpacing:4,textAlign:"center",margin:ye(5,0,10),padding:xe(2,0),borderRadius:2}}),Cm=()=>t.createElement("div",null,t.createElement("svg",{width:"35.964439mm",height:"9.0737419mm",viewBox:"0 0 35.964439 9.0737419"},t.createElement("g",{transform:"matrix(0.54446153,0,0,0.54446153,-16.152559,-20.599374)"},t.createElement("path",{d:"m 44.823532,48.430372 q 0,0.633406 -0.452432,1.085839 -0.429811,0.429811 -1.063217,0.429811 h -5.564924 l -5.632788,4.230247 q -0.384568,0.294081 -0.837,0.316703 -0.452433,0.04524 -0.859623,-0.203595 -0.339324,-0.203595 -0.542919,-0.54292 -0.203595,-0.339324 -0.203595,-0.769135 v -9.093899 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 v 6.062599 l 3.642084,-2.737218 q 0.407189,-0.294082 0.904865,-0.294082 h 4.54695 v -3.031299 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 0.633406,0 1.063217,0.452433 0.452432,0.429811 0.452432,1.063217 z"}),t.createElement("path",{d:"m 61.789719,48.430372 q 0,0.633406 -0.452433,1.085839 -0.429811,0.429811 -1.063217,0.429811 -0.633406,0 -1.085839,-0.429811 -0.429811,-0.452433 -0.429811,-1.085839 v -6.062599 l -9.704683,7.261546 q -0.520298,0.384568 -1.153704,0.316703 -0.633405,-0.09049 -1.017973,-0.633406 -0.384568,-0.520298 -0.27146,-1.10846 0.09049,-0.610784 0.588163,-0.995352 l 12.14782,-9.071278 q 0.361946,-0.271459 0.791757,-0.294081 0.429811,-0.04524 0.791758,0.13573 0.384568,0.158351 0.610784,0.520298 0.248838,0.361946 0.248838,0.837 z"}),t.createElement("path",{d:"m 78.507067,43.001179 q 0.384568,0.520297 0.27146,1.131082 -0.09049,0.588162 -0.588162,0.97273 l -12.147821,9.071278 q -0.384568,0.271459 -0.814379,0.294081 -0.407189,0.04524 -0.791757,-0.13573 -0.361946,-0.158351 -0.610784,-0.520298 -0.226217,-0.361946 -0.226217,-0.837 v -9.093899 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 v 6.062599 l 9.704683,-7.261546 q 0.520298,-0.384568 1.153704,-0.294081 0.633406,0.06786 1.017973,0.610784 z"}),t.createElement("path",{d:"m 95.722092,52.977322 q 0,0.633406 -0.452433,1.063217 -0.429811,0.452433 -1.063217,0.452433 h -6.062599 q -0.633406,0 -1.085839,-0.452433 -0.429811,-0.429811 -0.429811,-1.063217 v -3.0313 h -4.546949 q -0.633406,0 -1.085839,-0.429811 -0.429811,-0.452433 -0.429811,-1.085839 v -4.546949 q 0,-0.633406 0.429811,-1.063217 0.452433,-0.452433 1.085839,-0.452433 h 12.125198 q 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 0,0.633406 -0.452433,1.085838 -0.429811,0.429812 -1.063217,0.429812 H 83.596893 v 1.515649 h 4.54695 q 0.633406,0 1.063217,0.452433 0.452433,0.429811 0.452433,1.063217 v 3.0313 h 4.546949 q 0.633406,0 1.063217,0.429811 0.452433,0.452433 0.452433,1.085839 z"}))),t.createElement("div",{className:B("wave-pulse",km.live)},"LIVE")),$m={xs:"0px",s:"576px",m:"768px",l:"992px",xl:"1200px"},Lr=N.box([]),hn=N.box(null),Yl=N.box(),Ar=e=>{var a;return parseInt((a=$m[e])!=null?a:e,10)},Rr={order:0},Nm=({zone:e,order:a,size:n,width:r,height:l})=>({zone:e,order:a||0,grow:n?N.parseU(n):NaN,width:r,height:l}),Sm=(e,a)=>{try{if(a[0]==="["){const n=JSON.parse(a);if(a=n[e],a||(a=n[0]),!a)return Rr}return a[0]==="{"?Nm(JSON.parse(a)):{zone:a,order:0}}catch{return Rr}},_m=(e,a)=>{const n=[],r=[];for(const l of e)(a(l)?n:r).push(l);return[n,r]};N.on(La,e=>{const a=e.map((n,r)=>{const l=e[r+1],i=Ar(n.breakpoint),o=l?Ar(l.breakpoint)-1:0,s=window.matchMedia(o?`(min-width:${i}px) and (max-width:${o}.98px)`:`(min-width:${i}px)`),c=m=>{m.matches&&(hn({layout:n,index:r}),Yl({}))},d={layout:n,min:i,max:o,mq:s,listener:c};return s.addListener(c),s.matches&&hn({layout:n,index:r}),d});for(const{mq:n,listener:r}of Lr())n.removeListener(r);Lr(a)});const Tm=z({flex:{position:"relative",display:"flex"}}),Pm=(e,a)=>{var r,l,i;const n={flexDirection:e.direction==="row"?"row":"column",justifyContent:wn[(r=e.justify)!=null?r:""],alignItems:ll[(l=e.align)!=null?l:""],alignContent:il[(i=e.wrap)!=null?i:""],flexWrap:e.wrap?"wrap":void 0};if(e.size){const o=N.parseU(e.size);isNaN(o)?a==="row"?(n.width=e.size,n.minWidth=e.size):(n.height=e.size,n.minHeight=e.size):o>0&&(n.flexGrow=o)}else a==="row"&&(n.flexGrow=1);return n},Dm=({card:e,slot:a})=>{const{width:n,height:r,grow:l}=a,i=e.name==="__unhandled_error__"?1:void 0,o={position:"relative",zIndex:i};return l||l===0||n||r?(l&&(o.flexGrow=l),n&&(o.width=n),r&&(o.height=r),(n==="0px"||r==="0px")&&(o.margin=0)):o.flexGrow=1,o},Kl=e=>{var a;return{zone:e,sections:(a=e.zones)==null?void 0:a.map(Kl),cardslots:[]}},Jl=(e,a)=>{const{zone:n,sections:r}=e;if(n.name===a)return e;if(r)for(const l of r){const i=Jl(l,a);if(i)return i}return null},Zl=e=>{const{sections:a}=e;if(a)for(const n of a)Zl(n);e.cardslots.sort((n,r)=>n.slot.order-r.slot.order)},ei=({section:e,hasEditor:a,direction:n})=>{const{zone:r,cardslots:l,sections:i}=e,o=i?i.map(s=>t.createElement(ei,{key:s.zone.name,section:s,hasEditor:a,direction:r.direction})):l.length?l.map(s=>{const{card:c}=s;return t.createElement("div",{key:c.id,className:hl(c),style:Dm(s)},t.createElement(Qt,{card:c}),t.createElement(Cn,{name:c.name,commands:c.state.commands,changedB:c.changed,canEdit:a}))}):null;return t.createElement("div",{"data-test":r.name,className:Tm.flex,style:Pm(r,n)},o)},Lm=({name:e,cards:a})=>{var h;const n=hn();if(!n)return t.createElement(t.Fragment,null);const{layout:r,index:l}=n,i=Kl({name:"__main__",zones:r.zones,size:"1"}),{width:o,min_width:s,max_width:c,height:d,min_height:m,max_height:u}=r,p=a.find(w=>w.state.view==="editor");for(const w of a){const L=Sm(l,w.state.box),E=Jl(i,(h=L.zone)!=null?h:"");E==null||E.cardslots.push({card:w,slot:L})}Zl(i);const g={display:"flex",flexDirection:"column",width:o!=null?o:"100%",minWidth:s,maxWidth:c,height:d,minHeight:m,maxHeight:u};return d==="100%"&&(g.display="flex",g.flexDirection="column"),t.createElement("div",{"data-test":e,style:g},t.createElement(ei,{section:i,hasEditor:!!p}),p&&t.createElement(Qt,{card:p}))},Am=j(({page:e})=>{let a=null,n=null;const{changed:r}=e;return{render:()=>{const i=e.items(),[o,s]=_m(i,c=>c.state.view==="meta");return o.length&&(n==null||n.dispose(),a=o[0],Cr(a),n=N.on(a.changed,()=>Cr(a))),La().length?t.createElement(Lm,{name:e.key,cards:s}):t.createElement(Ao,{name:e.key,cards:s})},changed:r,resizedB:Yl}}),Ne=z({app:{position:"absolute",left:0,top:0,right:0,bottom:0,backgroundColor:f("$page"),color:f("$text"),display:"flex",justifyContent:"center",overflow:"auto"},centerFullHeight:{height:ve(100),display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:f("$page"),color:f("$text")},freeOverlay:{position:"fixed",left:0,top:0,right:0,bottom:0,opacity:0,zIndex:-1},busyOverlay:{position:"fixed",left:0,top:0,right:0,bottom:0,opacity:.8,zIndex:999,transition:"opacity 500ms 500ms"},notFoundOverlay:{display:"flex",flexDirection:"column",alignItems:"center"}}),Rm=j(()=>({render:()=>t.createElement("div",{className:ba()?Ne.busyOverlay:Ne.freeOverlay},t.createElement(bn,{className:Ne.centerFullHeight,label:"Loading...",size:xn.large})),busyB:ba})),Bm=j(()=>{const e=N.box(!1),a=()=>{e(!0)};return{render:()=>t.createElement("div",{className:Ne.notFoundOverlay},t.createElement(Cm,null),xa.editable&&t.createElement(t.Fragment,null,t.createElement(Xe,{onClick:a},"Edit this page..."),t.createElement(Cd,{visibleB:e})))}}),Im=j(()=>{const e=()=>y.push(),a=({detail:i})=>{y.args[i]=!0,y.push()};return{init:()=>{ko(y.socketURL),window.addEventListener("hashchange",e),window.addEventListener("md-link-click",a)},render:()=>{const i=va();if(i)switch(i.t){case N.WaveEventType.Page:{const o=i.page;return t.createElement(ao,{applyTheme:!0},t.createElement("div",{className:Ne.app},t.createElement(Am,{key:o.key,page:o}),t.createElement(Rm,null),t.createElement(ld,null),t.createElement(pd,null),t.createElement(rd,null)))}case N.WaveEventType.Error:{const o=i.code===N.WaveErrorCode.PageNotFound?t.createElement(Bm,null):"Unknown Remote Error";return t.createElement("div",{className:B(Ne.centerFullHeight,Ne.app)},o)}case N.WaveEventType.Exception:{const o=`Unhandled exception: ${i.error}`;return t.createElement("div",{className:B(Ne.centerFullHeight,Ne.app)},o)}case N.WaveEventType.Disconnect:{const o=`Disconnected. Reconnecting in ${i.retry}s`;return t.createElement("div",{className:B(Ne.centerFullHeight,Ne.app,Ne.notFoundOverlay)},t.createElement("div",null,o),t.createElement("div",null,"Make sure your Wave server is running and the environment network policies allow websocket connections."))}}return t.createElement(bn,{className:Ne.centerFullHeight,size:xn.large,label:"Loading ..."})},dispose:()=>{window.removeEventListener("hashchange",e),window.removeEventListener("md-link-click",a)},contentB:va}}),zm=z({login:{width:"100%",minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"}}),Mm=()=>{const e=`${y.initURL}${window.location.search}`;return t.createElement("div",{className:zm.login},t.createElement("form",{action:e,method:"POST"},t.createElement(en,{type:"default",secondaryText:"using OpenID Connect."},"Log In")))},Fm=()=>{const e=[{path:y.loginURL,exact:!0,render:()=>t.createElement(Mm,null)},{path:y.baseURL,exact:!1,render:()=>t.createElement(Im,null)}];return t.createElement(no,null,t.createElement(ro,null,e.map((a,n)=>t.createElement(lo,{key:n,path:a.path,exact:a.exact,render:a.render}))))};Boolean(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Wm(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)})}Ir({defaultFontStyle:{fontFamily:"Inter"},palette:uo.fluentPalette});const Hm=Object.entries(io).reduce((e,[a,n])=>("displayName"in n&&(e[a.slice(0,-4)]=t.createElement(n)),e),{});oo({icons:Hm});Vr.render(t.createElement(Fm,null),document.getElementById("root"));Wm();export{Vm as __vite_legacy_guard};
