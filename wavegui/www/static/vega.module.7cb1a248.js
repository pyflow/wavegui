import{be as nh,bf as Hv,bg as ih,bh as Wv,bi as Eo,bj as _A,bk as Co,bl as Do,bm as MA,bn as So,bo as Fo,bp as Fs,bq as Gm,br as Vm,bs as Xm,bt as Km,bu as kA,bv as AA,bw as EA,bx as CA,by as DA,bz as Gv,bA as SA,bB as FA,bC as $A,bD as Vv,b7 as TA,bE as RA}from"./vendor.2f0b4f78.js";function De(t,e,n){return t.fields=e||[],t.fname=n,t}function kt(t){return t==null?null:t.fname}function Zt(t){return t==null?null:t.fields}function Xv(t){return t.length===1?NA(t[0]):OA(t)}const NA=t=>function(e){return e[t]},OA=t=>{const e=t.length;return function(n){for(let i=0;i<e;++i)n=n[t[i]];return n}};function R(t){throw Error(t)}function Bl(t){const e=[],n=t.length;let i=null,r=0,a="",o,u,s;t=t+"";function l(){e.push(a+t.substring(o,u)),a="",o=u+1}for(o=u=0;u<n;++u)if(s=t[u],s==="\\")a+=t.substring(o,u),a+=t.substring(++u,++u),o=u;else if(s===i)l(),i=null,r=-1;else{if(i)continue;o===r&&s==='"'||o===r&&s==="'"?(o=u+1,i=s):s==="."&&!r?u>o?l():o=u+1:s==="["?(u>o&&l(),r=o=u+1):s==="]"&&(r||R("Access path missing open bracket: "+t),r>0&&l(),r=0,o=u+1)}return r&&R("Access path missing closing bracket: "+t),i&&R("Access path missing closing quote: "+t),u>o&&(u++,l()),e}function ke(t,e,n){const i=Bl(t);return t=i.length===1?i[0]:t,De((n&&n.get||Xv)(i),[t],e||t)}const eu=ke("id"),de=De(t=>t,[],"identity"),li=De(()=>0,[],"zero"),fa=De(()=>1,[],"one"),Xe=De(()=>!0,[],"true"),ni=De(()=>!1,[],"false");function Tu(t,e,n){const i=[e].concat([].slice.call(n));console[t].apply(console,i)}const Kv=0,Jd=1,Zv=2,Jv=3,Qv=4;function tx(t,e){let n=t||Kv;return{level(i){return arguments.length?(n=+i,this):n},error(){return n>=Jd&&Tu(e||"error","ERROR",arguments),this},warn(){return n>=Zv&&Tu(e||"warn","WARN",arguments),this},info(){return n>=Jv&&Tu(e||"log","INFO",arguments),this},debug(){return n>=Qv&&Tu(e||"log","DEBUG",arguments),this}}}var Y=Array.isArray;function J(t){return t===Object(t)}const Zm=t=>t!=="__proto__";function ex(...t){return t.reduce((e,n)=>{for(const i in n)if(i==="signals")e.signals=zA(e.signals,n.signals);else{const r=i==="legend"?{layout:1}:i==="style"?!0:null;Qd(e,i,n[i],r)}return e},{})}function Qd(t,e,n,i){if(!Zm(e))return;let r,a;if(J(n)&&!Y(n)){a=J(t[e])?t[e]:t[e]={};for(r in n)i&&(i===!0||i[r])?Qd(a,r,n[r]):Zm(r)&&(a[r]=n[r])}else t[e]=n}function zA(t,e){if(t==null)return e;const n={},i=[];function r(a){n[a.name]||(n[a.name]=1,i.push(a))}return e.forEach(r),t.forEach(r),i}function it(t){return t[t.length-1]}function Kt(t){return t==null||t===""?null:+t}const nx=t=>e=>t*Math.exp(e),ix=t=>e=>Math.log(t*e),rx=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),ax=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,$s=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Ll(t,e,n,i){const r=n(t[0]),a=n(it(t)),o=(a-r)*e;return[i(r-o),i(a-o)]}function ox(t,e){return Ll(t,e,Kt,de)}function ux(t,e){var n=Math.sign(t[0]);return Ll(t,e,ix(n),nx(n))}function sx(t,e,n){return Ll(t,e,$s(n),$s(1/n))}function lx(t,e,n){return Ll(t,e,rx(n),ax(n))}function Pl(t,e,n,i,r){const a=i(t[0]),o=i(it(t)),u=e!=null?i(e):(a+o)/2;return[r(u+(a-u)*n),r(u+(o-u)*n)]}function t0(t,e,n){return Pl(t,e,n,Kt,de)}function e0(t,e,n){const i=Math.sign(t[0]);return Pl(t,e,n,ix(i),nx(i))}function Ts(t,e,n,i){return Pl(t,e,n,$s(i),$s(1/i))}function n0(t,e,n,i){return Pl(t,e,n,rx(i),ax(i))}function fx(t){return 1+~~(new Date(t).getMonth()/3)}function cx(t){return 1+~~(new Date(t).getUTCMonth()/3)}function G(t){return t!=null?Y(t)?t:[t]:[]}function hx(t,e,n){let i=t[0],r=t[1],a;return r<i&&(a=r,r=i,i=a),a=r-i,a>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-a),i+a]}function Q(t){return typeof t=="function"}const BA="descending";function i0(t,e,n){n=n||{},e=G(e)||[];const i=[],r=[],a={},o=n.comparator||LA;return G(t).forEach((u,s)=>{u!=null&&(i.push(e[s]===BA?-1:1),r.push(u=Q(u)?u:ke(u,null,n)),(Zt(u)||[]).forEach(l=>a[l]=1))}),r.length===0?null:De(o(r,i),Object.keys(a))}const Il=(t,e)=>(t<e||t==null)&&e!=null?-1:(t>e||e==null)&&t!=null?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),LA=(t,e)=>t.length===1?PA(t[0],e[0]):IA(t,e,t.length),PA=(t,e)=>function(n,i){return Il(t(n),t(i))*e},IA=(t,e,n)=>(e.push(0),function(i,r){let a,o=0,u=-1;for(;o===0&&++u<n;)a=t[u],o=Il(a(i),a(r));return o*e[u]});function ee(t){return Q(t)?t:()=>t}function r0(t,e){let n;return i=>{n&&clearTimeout(n),n=setTimeout(()=>(e(i),n=null),t)}}function Z(t){for(let e,n,i=1,r=arguments.length;i<r;++i){e=arguments[i];for(n in e)t[n]=e[n]}return t}function Fn(t,e){let n=0,i,r,a,o;if(t&&(i=t.length))if(e==null){for(r=t[n];n<i&&(r==null||r!==r);r=t[++n]);for(a=o=r;n<i;++n)r=t[n],r!=null&&(r<a&&(a=r),r>o&&(o=r))}else{for(r=e(t[n]);n<i&&(r==null||r!==r);r=e(t[++n]));for(a=o=r;n<i;++n)r=e(t[n]),r!=null&&(r<a&&(a=r),r>o&&(o=r))}return[a,o]}function dx(t,e){const n=t.length;let i=-1,r,a,o,u,s;if(e==null){for(;++i<n;)if(a=t[i],a!=null&&a>=a){r=o=a;break}if(i===n)return[-1,-1];for(u=s=i;++i<n;)a=t[i],a!=null&&(r>a&&(r=a,u=i),o<a&&(o=a,s=i))}else{for(;++i<n;)if(a=e(t[i],i,t),a!=null&&a>=a){r=o=a;break}if(i===n)return[-1,-1];for(u=s=i;++i<n;)a=e(t[i],i,t),a!=null&&(r>a&&(r=a,u=i),o<a&&(o=a,s=i))}return[u,s]}const UA=Object.prototype.hasOwnProperty;function V(t,e){return UA.call(t,e)}const Ru={};function ca(t){let e={},n;function i(a){return V(e,a)&&e[a]!==Ru}const r={size:0,empty:0,object:e,has:i,get(a){return i(a)?e[a]:void 0},set(a,o){return i(a)||(++r.size,e[a]===Ru&&--r.empty),e[a]=o,this},delete(a){return i(a)&&(--r.size,++r.empty,e[a]=Ru),this},clear(){r.size=r.empty=0,r.object=e={}},test(a){return arguments.length?(n=a,r):n},clean(){const a={};let o=0;for(const u in e){const s=e[u];s!==Ru&&(!n||!n(s))&&(a[u]=s,++o)}r.size=o,r.empty=0,r.object=e=a}};return t&&Object.keys(t).forEach(a=>{r.set(a,t[a])}),r}function gx(t,e,n,i,r,a){if(!n&&n!==0)return a;const o=+n;let u=t[0],s=it(t),l;s<u&&(l=u,u=s,s=l),l=Math.abs(e-u);const f=Math.abs(s-e);return l<f&&l<=o?i:f<=o?r:a}function z(t,e,n){const i=t.prototype=Object.create(e.prototype);return Object.defineProperty(i,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),Z(i,n)}function Rr(t,e,n,i){let r=e[0],a=e[e.length-1],o;return r>a&&(o=r,r=a,a=o),n=n===void 0||n,i=i===void 0||i,(n?r<=t:r<t)&&(i?t<=a:t<a)}function mx(t){return typeof t=="boolean"}function xi(t){return Object.prototype.toString.call(t)==="[object Date]"}function px(t){return t&&Q(t[Symbol.iterator])}function Mi(t){return typeof t=="number"}function yx(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function vt(t){return typeof t=="string"}function a0(t,e,n){t&&(t=e?G(t).map(u=>u.replace(/\\(.)/g,"$1")):G(t));const i=t&&t.length,r=n&&n.get||Xv,a=u=>r(e?[u]:Bl(u));let o;if(!i)o=function(){return""};else if(i===1){const u=a(t[0]);o=function(s){return""+u(s)}}else{const u=t.map(a);o=function(s){let l=""+u[0](s),f=0;for(;++f<i;)l+="|"+u[f](s);return l}}return De(o,t,"key")}function vx(t,e){const n=t[0],i=it(t),r=+e;return r?r===1?i:n+r*(i-n):n}const qA=1e4;function xx(t){t=+t||qA;let e,n,i;const r=()=>{e={},n={},i=0},a=(o,u)=>(++i>t&&(n=e,e={},i=1),e[o]=u);return r(),{clear:r,has:o=>V(e,o)||V(n,o),get:o=>V(e,o)?e[o]:V(n,o)?a(o,n[o]):void 0,set:(o,u)=>V(e,o)?e[o]=u:a(o,u)}}function bx(t,e,n,i){const r=e.length,a=n.length;if(!a)return e;if(!r)return n;const o=i||new e.constructor(r+a);let u=0,s=0,l=0;for(;u<r&&s<a;++l)o[l]=t(e[u],n[s])>0?n[s++]:e[u++];for(;u<r;++u,++l)o[l]=e[u];for(;s<a;++s,++l)o[l]=n[s];return o}function Wa(t,e){let n="";for(;--e>=0;)n+=t;return n}function wx(t,e,n,i){const r=n||" ",a=t+"",o=e-a.length;return o<=0?a:i==="left"?Wa(r,o)+a:i==="center"?Wa(r,~~(o/2))+a+Wa(r,Math.ceil(o/2)):a+Wa(r,o)}function nu(t){return t&&it(t)-t[0]||0}function H(t){return Y(t)?"["+t.map(H)+"]":J(t)||vt(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function o0(t){return t==null||t===""?null:!t||t==="false"||t==="0"?!1:!!t}const jA=t=>Mi(t)||xi(t)?t:Date.parse(t);function u0(t,e){return e=e||jA,t==null||t===""?null:e(t)}function s0(t){return t==null||t===""?null:t+""}function cn(t){const e={},n=t.length;for(let i=0;i<n;++i)e[t[i]]=!0;return e}function _x(t,e,n,i){const r=i!=null?i:"\u2026",a=t+"",o=a.length,u=Math.max(0,e-r.length);return o<=e?a:n==="left"?r+a.slice(o-u):n==="center"?a.slice(0,Math.ceil(u/2))+r+a.slice(o-~~(u/2)):a.slice(0,u)+r}function ri(t,e,n){if(t)if(e){const i=t.length;for(let r=0;r<i;++r){const a=e(t[r]);a&&n(a,r,t)}}else t.forEach(n)}const YA=/^([A-Za-z]+:)?\/\//,HA=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,WA=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,Jm="file://";function GA(t,e){return n=>({options:n||{},sanitize:XA,load:VA,fileAccess:!!e,file:KA(e),http:JA(t)})}async function VA(t,e){const n=await this.sanitize(t,e),i=n.href;return n.localFile?this.file(i):this.http(i,e)}async function XA(t,e){e=Z({},this.options,e);const n=this.fileAccess,i={href:null};let r,a,o;const u=HA.test(t.replace(WA,""));(t==null||typeof t!="string"||!u)&&R("Sanitize failure, invalid URI: "+H(t));const s=YA.test(t);return(o=e.baseURL)&&!s&&(!t.startsWith("/")&&o[o.length-1]!=="/"&&(t="/"+t),t=o+t),a=(r=t.startsWith(Jm))||e.mode==="file"||e.mode!=="http"&&!s&&n,r?t=t.slice(Jm.length):t.startsWith("//")&&(e.defaultProtocol==="file"?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(i,"localFile",{value:!!a}),i.href=t,e.target&&(i.target=e.target+""),e.rel&&(i.rel=e.rel+""),e.context==="image"&&e.crossOrigin&&(i.crossOrigin=e.crossOrigin+""),i}function KA(t){return t?e=>new Promise((n,i)=>{t.readFile(e,(r,a)=>{r?i(r):n(a)})}):ZA}async function ZA(){R("No file system access.")}function JA(t){return t?async function(e,n){const i=Z({},this.options.http,n),r=n&&n.response,a=await t(e,i);return a.ok?Q(a[r])?a[r]():a.text():R(a.status+""+a.statusText)}:QA}async function QA(){R("No HTTP fetch method available.")}const tE=t=>t!=null&&t===t,eE=t=>t==="true"||t==="false"||t===!0||t===!1,nE=t=>!Number.isNaN(Date.parse(t)),Mx=t=>!Number.isNaN(+t)&&!(t instanceof Date),iE=t=>Mx(t)&&Number.isInteger(+t),rh={boolean:o0,integer:Kt,number:Kt,date:u0,string:s0,unknown:de},Nu=[eE,iE,Mx,nE],rE=["boolean","integer","number","date"];function kx(t,e){if(!t||!t.length)return"unknown";const n=t.length,i=Nu.length,r=Nu.map((a,o)=>o+1);for(let a=0,o=0,u,s;a<n;++a)for(s=e?t[a][e]:t[a],u=0;u<i;++u)if(r[u]&&tE(s)&&!Nu[u](s)&&(r[u]=0,++o,o===Nu.length))return"string";return rE[r.reduce((a,o)=>a===0?o:a,0)-1]}function Ax(t,e){return e.reduce((n,i)=>(n[i]=kx(t,i),n),{})}var Qm={},Vf={},Xf=34,Aa=10,Kf=13;function Ex(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function aE(t,e){var n=Ex(t);return function(i,r){return e(n(i),r,t)}}function tp(t){var e=Object.create(null),n=[];return t.forEach(function(i){for(var r in i)r in e||n.push(e[r]=r)}),n}function ye(t,e){var n=t+"",i=n.length;return i<e?new Array(e-i+1).join(0)+n:n}function oE(t){return t<0?"-"+ye(-t,6):t>9999?"+"+ye(t,6):ye(t,4)}function uE(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),i=t.getUTCSeconds(),r=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":oE(t.getUTCFullYear())+"-"+ye(t.getUTCMonth()+1,2)+"-"+ye(t.getUTCDate(),2)+(r?"T"+ye(e,2)+":"+ye(n,2)+":"+ye(i,2)+"."+ye(r,3)+"Z":i?"T"+ye(e,2)+":"+ye(n,2)+":"+ye(i,2)+"Z":n||e?"T"+ye(e,2)+":"+ye(n,2)+"Z":"")}function sE(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function i(c,h){var d,g,m=r(c,function(p,y){if(d)return d(p,y-1);g=p,d=h?aE(p,h):Ex(p)});return m.columns=g||[],m}function r(c,h){var d=[],g=c.length,m=0,p=0,y,v=g<=0,x=!1;c.charCodeAt(g-1)===Aa&&--g,c.charCodeAt(g-1)===Kf&&--g;function b(){if(v)return Vf;if(x)return x=!1,Qm;var M,w=m,k;if(c.charCodeAt(w)===Xf){for(;m++<g&&c.charCodeAt(m)!==Xf||c.charCodeAt(++m)===Xf;);return(M=m)>=g?v=!0:(k=c.charCodeAt(m++))===Aa?x=!0:k===Kf&&(x=!0,c.charCodeAt(m)===Aa&&++m),c.slice(w+1,M-1).replace(/""/g,'"')}for(;m<g;){if((k=c.charCodeAt(M=m++))===Aa)x=!0;else if(k===Kf)x=!0,c.charCodeAt(m)===Aa&&++m;else if(k!==n)continue;return c.slice(w,M)}return v=!0,c.slice(w,g)}for(;(y=b())!==Vf;){for(var _=[];y!==Qm&&y!==Vf;)_.push(y),y=b();h&&(_=h(_,p++))==null||d.push(_)}return d}function a(c,h){return c.map(function(d){return h.map(function(g){return f(d[g])}).join(t)})}function o(c,h){return h==null&&(h=tp(c)),[h.map(f).join(t)].concat(a(c,h)).join(`
`)}function u(c,h){return h==null&&(h=tp(c)),a(c,h).join(`
`)}function s(c){return c.map(l).join(`
`)}function l(c){return c.map(f).join(t)}function f(c){return c==null?"":c instanceof Date?uE(c):e.test(c+="")?'"'+c.replace(/"/g,'""')+'"':c}return{parse:i,parseRows:r,format:o,formatBody:u,formatRows:s,formatRow:l,formatValue:f}}function ep(t){const e=function(n,i){const r={delimiter:t};return l0(n,i?Z(i,r):r)};return e.responseType="text",e}function l0(t,e){return e.header&&(t=e.header.map(H).join(e.delimiter)+`
`+t),sE(e.delimiter).parse(t+"")}l0.responseType="text";function lE(t){return typeof Buffer=="function"&&Q(Buffer.isBuffer)?Buffer.isBuffer(t):!1}function f0(t,e){const n=e&&e.property?ke(e.property):de;return J(t)&&!lE(t)?fE(n(t),e):n(JSON.parse(t))}f0.responseType="json";function fE(t,e){return!Y(t)&&px(t)&&(t=[...t]),e&&e.copy?JSON.parse(JSON.stringify(t)):t}function cE(t){return t}function hE(t){if(t==null)return cE;var e,n,i=t.scale[0],r=t.scale[1],a=t.translate[0],o=t.translate[1];return function(u,s){s||(e=n=0);var l=2,f=u.length,c=new Array(f);for(c[0]=(e+=u[0])*i+a,c[1]=(n+=u[1])*r+o;l<f;)c[l]=u[l],++l;return c}}function dE(t,e){for(var n,i=t.length,r=i-e;r<--i;)n=t[r],t[r++]=t[i],t[i]=n}function gE(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(n){return np(t,n)})}:np(t,e)}function np(t,e){var n=e.id,i=e.bbox,r=e.properties==null?{}:e.properties,a=Cx(t,e);return n==null&&i==null?{type:"Feature",properties:r,geometry:a}:i==null?{type:"Feature",id:n,properties:r,geometry:a}:{type:"Feature",id:n,bbox:i,properties:r,geometry:a}}function Cx(t,e){var n=hE(t.transform),i=t.arcs;function r(f,c){c.length&&c.pop();for(var h=i[f<0?~f:f],d=0,g=h.length;d<g;++d)c.push(n(h[d],d));f<0&&dE(c,g)}function a(f){return n(f)}function o(f){for(var c=[],h=0,d=f.length;h<d;++h)r(f[h],c);return c.length<2&&c.push(c[0]),c}function u(f){for(var c=o(f);c.length<4;)c.push(c[0]);return c}function s(f){return f.map(u)}function l(f){var c=f.type,h;switch(c){case"GeometryCollection":return{type:c,geometries:f.geometries.map(l)};case"Point":h=a(f.coordinates);break;case"MultiPoint":h=f.coordinates.map(a);break;case"LineString":h=o(f.arcs);break;case"MultiLineString":h=f.arcs.map(o);break;case"Polygon":h=s(f.arcs);break;case"MultiPolygon":h=f.arcs.map(s);break;default:return null}return{type:c,coordinates:h}}return l(e)}function mE(t,e){var n={},i={},r={},a=[],o=-1;e.forEach(function(l,f){var c=t.arcs[l<0?~l:l],h;c.length<3&&!c[1][0]&&!c[1][1]&&(h=e[++o],e[o]=l,e[f]=h)}),e.forEach(function(l){var f=u(l),c=f[0],h=f[1],d,g;if(d=r[c])if(delete r[d.end],d.push(l),d.end=h,g=i[h]){delete i[g.start];var m=g===d?d:d.concat(g);i[m.start=d.start]=r[m.end=g.end]=m}else i[d.start]=r[d.end]=d;else if(d=i[h])if(delete i[d.start],d.unshift(l),d.start=c,g=r[c]){delete r[g.end];var p=g===d?d:g.concat(d);i[p.start=g.start]=r[p.end=d.end]=p}else i[d.start]=r[d.end]=d;else d=[l],i[d.start=c]=r[d.end=h]=d});function u(l){var f=t.arcs[l<0?~l:l],c=f[0],h;return t.transform?(h=[0,0],f.forEach(function(d){h[0]+=d[0],h[1]+=d[1]})):h=f[f.length-1],l<0?[h,c]:[c,h]}function s(l,f){for(var c in l){var h=l[c];delete f[h.start],delete h.start,delete h.end,h.forEach(function(d){n[d<0?~d:d]=1}),a.push(h)}}return s(r,i),s(i,r),e.forEach(function(l){n[l<0?~l:l]||a.push([l])}),a}function pE(t){return Cx(t,yE.apply(this,arguments))}function yE(t,e,n){var i,r,a;if(arguments.length>1)i=vE(t,e,n);else for(r=0,i=new Array(a=t.arcs.length);r<a;++r)i[r]=r;return{type:"MultiLineString",arcs:mE(t,i)}}function vE(t,e,n){var i=[],r=[],a;function o(c){var h=c<0?~c:c;(r[h]||(r[h]=[])).push({i:c,g:a})}function u(c){c.forEach(o)}function s(c){c.forEach(u)}function l(c){c.forEach(s)}function f(c){switch(a=c,c.type){case"GeometryCollection":c.geometries.forEach(f);break;case"LineString":u(c.arcs);break;case"MultiLineString":case"Polygon":s(c.arcs);break;case"MultiPolygon":l(c.arcs);break}}return f(e),r.forEach(n==null?function(c){i.push(c[0].i)}:function(c){n(c[0].g,c[c.length-1].g)&&i.push(c[0].i)}),i}const xE={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function Dx(t,e){let n,i,r,a;return t=f0(t,e),e&&e.feature?(n=gE,r=e.feature):e&&e.mesh?(n=pE,r=e.mesh,a=xE[e.filter]):R("Missing TopoJSON feature or mesh parameter."),i=(i=t.objects[r])?n(t,i,a):R("Invalid TopoJSON object: "+r),i&&i.features||[i]}Dx.responseType="json";const ss={dsv:l0,csv:ep(","),tsv:ep("	"),json:f0,topojson:Dx};function c0(t,e){return arguments.length>1?(ss[t]=e,this):V(ss,t)?ss[t]:null}function Sx(t){const e=c0(t);return e&&e.responseType||"text"}var bE=Math.sqrt(50),wE=Math.sqrt(10),_E=Math.sqrt(2);function ME(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=bE?r*=10:a>=wE?r*=5:a>=_E&&(r*=2),e<t?-r:r}function kE(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Rs(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function Gr(t){return t=Rs(Math.abs(t)),t?t[1]:NaN}function AE(t,e){return function(n,i){for(var r=n.length,a=[],o=0,u=t[0],s=0;r>0&&u>0&&(s+u+1>i&&(u=Math.max(1,i-s)),a.push(n.substring(r-=u,r+u)),!((s+=u+1)>i));)u=t[o=(o+1)%t.length];return a.reverse().join(e)}}function EE(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var CE=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function $o(t){if(!(e=CE.exec(t)))throw new Error("invalid format: "+t);var e;return new h0({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}$o.prototype=h0.prototype;function h0(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}h0.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function DE(t){t:for(var e=t.length,n=1,i=-1,r;n<e;++n)switch(t[n]){case".":i=r=n;break;case"0":i===0&&(i=n),r=n;break;default:if(!+t[n])break t;i>0&&(i=0);break}return i>0?t.slice(0,i)+t.slice(r+1):t}var Fx;function SE(t,e){var n=Rs(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(Fx=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=i.length;return a===o?i:a>o?i+new Array(a-o+1).join("0"):a>0?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+Rs(t,Math.max(0,e+a-1))[0]}function ip(t,e){var n=Rs(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}var rp={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:kE,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>ip(t*100,e),r:ip,s:SE,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function ap(t){return t}var op=Array.prototype.map,up=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function $x(t){var e=t.grouping===void 0||t.thousands===void 0?ap:AE(op.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",i=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?ap:EE(op.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"\u2212":t.minus+"",s=t.nan===void 0?"NaN":t.nan+"";function l(c){c=$o(c);var h=c.fill,d=c.align,g=c.sign,m=c.symbol,p=c.zero,y=c.width,v=c.comma,x=c.precision,b=c.trim,_=c.type;_==="n"?(v=!0,_="g"):rp[_]||(x===void 0&&(x=12),b=!0,_="g"),(p||h==="0"&&d==="=")&&(p=!0,h="0",d="=");var M=m==="$"?n:m==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",w=m==="$"?i:/[%p]/.test(_)?o:"",k=rp[_],C=/[defgprs%]/.test(_);x=x===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function A(E){var F=M,$=w,O,D,N;if(_==="c")$=k(E)+$,E="";else{E=+E;var L=E<0||1/E<0;if(E=isNaN(E)?s:k(Math.abs(E),x),b&&(E=DE(E)),L&&+E==0&&g!=="+"&&(L=!1),F=(L?g==="("?g:u:g==="-"||g==="("?"":g)+F,$=(_==="s"?up[8+Fx/3]:"")+$+(L&&g==="("?")":""),C){for(O=-1,D=E.length;++O<D;)if(N=E.charCodeAt(O),48>N||N>57){$=(N===46?r+E.slice(O+1):E.slice(O))+$,E=E.slice(0,O);break}}}v&&!p&&(E=e(E,1/0));var U=F.length+E.length+$.length,W=U<y?new Array(y-U+1).join(h):"";switch(v&&p&&(E=e(W+E,W.length?y-$.length:1/0),W=""),d){case"<":E=F+E+$+W;break;case"=":E=F+W+E+$;break;case"^":E=W.slice(0,U=W.length>>1)+F+E+$+W.slice(U);break;default:E=W+F+E+$;break}return a(E)}return A.toString=function(){return c+""},A}function f(c,h){var d=l((c=$o(c),c.type="f",c)),g=Math.max(-8,Math.min(8,Math.floor(Gr(h)/3)))*3,m=Math.pow(10,-g),p=up[8+g/3];return function(y){return d(m*y)+p}}return{format:l,formatPrefix:f}}var Ou,Tx,Rx;FE({thousands:",",grouping:[3],currency:["$",""]});function FE(t){return Ou=$x(t),Tx=Ou.format,Rx=Ou.formatPrefix,Ou}function $E(t){return Math.max(0,-Gr(Math.abs(t)))}function TE(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Gr(e)/3)))*3-Gr(Math.abs(t)))}function RE(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Gr(e)-Gr(t))+1}var Zf=new Date,Jf=new Date;function zt(t,e,n,i){function r(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return r.floor=function(a){return t(a=new Date(+a)),a},r.ceil=function(a){return t(a=new Date(a-1)),e(a,1),t(a),a},r.round=function(a){var o=r(a),u=r.ceil(a);return a-o<u-a?o:u},r.offset=function(a,o){return e(a=new Date(+a),o==null?1:Math.floor(o)),a},r.range=function(a,o,u){var s=[],l;if(a=r.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return s;do s.push(l=new Date(+a)),e(a,u),t(a);while(l<a&&a<o);return s},r.filter=function(a){return zt(function(o){if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},function(o,u){if(o>=o)if(u<0)for(;++u<=0;)for(;e(o,-1),!a(o););else for(;--u>=0;)for(;e(o,1),!a(o););})},n&&(r.count=function(a,o){return Zf.setTime(+a),Jf.setTime(+o),t(Zf),t(Jf),Math.floor(n(Zf,Jf))},r.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?r.filter(i?function(o){return i(o)%a===0}:function(o){return r.count(0,o)%a===0}):r}),r}var ah=zt(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});ah.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?zt(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):ah};var Nx=ah;const To=1e3,ki=To*60,Ro=ki*60,d0=Ro*24,Ox=d0*7;var NE=zt(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*To)},function(t,e){return(e-t)/To},function(t){return t.getUTCSeconds()}),zx=NE,OE=zt(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*To)},function(t,e){t.setTime(+t+e*ki)},function(t,e){return(e-t)/ki},function(t){return t.getMinutes()}),zE=OE,BE=zt(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*To-t.getMinutes()*ki)},function(t,e){t.setTime(+t+e*Ro)},function(t,e){return(e-t)/Ro},function(t){return t.getHours()}),LE=BE,PE=zt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ki)/d0,t=>t.getDate()-1),ls=PE;function sr(t){return zt(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n*7)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*ki)/Ox})}var Bx=sr(0);sr(1);sr(2);sr(3);sr(4);sr(5);sr(6);var IE=zt(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()}),sp=IE,Lx=zt(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Lx.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:zt(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)})};var UE=Lx,qE=zt(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*ki)},function(t,e){return(e-t)/ki},function(t){return t.getUTCMinutes()}),jE=qE,YE=zt(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*Ro)},function(t,e){return(e-t)/Ro},function(t){return t.getUTCHours()}),HE=YE,WE=zt(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/d0},function(t){return t.getUTCDate()-1}),fs=WE;function lr(t){return zt(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n*7)},function(e,n){return(n-e)/Ox})}var Px=lr(0);lr(1);lr(2);lr(3);lr(4);lr(5);lr(6);var GE=zt(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()}),lp=GE,Ix=zt(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Ix.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:zt(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})};var VE=Ix;function XE(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function KE(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=ZE(t));function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=i(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:i,center:a,right:r}}function ZE(t){return(e,n)=>XE(t(e),n)}var JE=Math.sqrt(50),QE=Math.sqrt(10),t6=Math.sqrt(2);function fp(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=JE?r*=10:a>=QE?r*=5:a>=t6&&(r*=2),e<t?-r:r}const It="year",Ae="quarter",Jt="month",Dt="week",Ee="date",Xt="day",$n="dayofyear",ze="hours",Be="minutes",Ke="seconds",hn="milliseconds",g0=[It,Ae,Jt,Dt,Ee,Xt,$n,ze,Be,Ke,hn],Qf=g0.reduce((t,e,n)=>(t[e]=1+n,t),{});function m0(t){const e=G(t).slice(),n={};return e.length||R("Missing time unit."),e.forEach(r=>{V(Qf,r)?n[r]=1:R("Invalid time unit: ".concat(r,"."))}),(n[Dt]||n[Xt]?1:0)+(n[Ae]||n[Jt]||n[Ee]?1:0)+(n[$n]?1:0)>1&&R("Incompatible time units: ".concat(t)),e.sort((r,a)=>Qf[r]-Qf[a]),e}const e6={[It]:"%Y ",[Ae]:"Q%q ",[Jt]:"%b ",[Ee]:"%d ",[Dt]:"W%U ",[Xt]:"%a ",[$n]:"%j ",[ze]:"%H:00",[Be]:"00:%M",[Ke]:":%S",[hn]:".%L",["".concat(It,"-").concat(Jt)]:"%Y-%m ",["".concat(It,"-").concat(Jt,"-").concat(Ee)]:"%Y-%m-%d ",["".concat(ze,"-").concat(Be)]:"%H:%M"};function Ux(t,e){const n=Z({},e6,e),i=m0(t),r=i.length;let a="",o=0,u,s;for(o=0;o<r;)for(u=i.length;u>o;--u)if(s=i.slice(o,u).join("-"),n[s]!=null){a+=n[s],o=u;break}return a.trim()}const qi=new Date;function p0(t){return qi.setFullYear(t),qi.setMonth(0),qi.setDate(1),qi.setHours(0,0,0,0),qi}function qx(t){return Yx(new Date(t))}function jx(t){return oh(new Date(t))}function Yx(t){return ls.count(p0(t.getFullYear())-1,t)}function oh(t){return Bx.count(p0(t.getFullYear())-1,t)}function uh(t){return p0(t).getDay()}function n6(t,e,n,i,r,a,o){if(0<=t&&t<100){const u=new Date(-1,e,n,i,r,a,o);return u.setFullYear(t),u}return new Date(t,e,n,i,r,a,o)}function Hx(t){return Gx(new Date(t))}function Wx(t){return sh(new Date(t))}function Gx(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return fs.count(e-1,t)}function sh(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Px.count(e-1,t)}function lh(t){return qi.setTime(Date.UTC(t,0,1)),qi.getUTCDay()}function i6(t,e,n,i,r,a,o){if(0<=t&&t<100){const u=new Date(Date.UTC(-1,e,n,i,r,a,o));return u.setUTCFullYear(n.y),u}return new Date(Date.UTC(t,e,n,i,r,a,o))}function Vx(t,e,n,i,r){const a=e||1,o=it(t),u=(y,v,x)=>(x=x||y,r6(n[x],i[x],y===o&&a,v)),s=new Date,l=cn(t),f=l[It]?u(It):ee(2012),c=l[Jt]?u(Jt):l[Ae]?u(Ae):li,h=l[Dt]&&l[Xt]?u(Xt,1,Dt+Xt):l[Dt]?u(Dt,1):l[Xt]?u(Xt,1):l[Ee]?u(Ee,1):l[$n]?u($n,1):fa,d=l[ze]?u(ze):li,g=l[Be]?u(Be):li,m=l[Ke]?u(Ke):li,p=l[hn]?u(hn):li;return function(y){s.setTime(+y);const v=f(s);return r(v,c(s),h(s,v),d(s),g(s),m(s),p(s))}}function r6(t,e,n,i){const r=n<=1?t:i?(a,o)=>i+n*Math.floor((t(a,o)-i)/n):(a,o)=>n*Math.floor(t(a,o)/n);return e?(a,o)=>e(r(a,o),o):r}function Vr(t,e,n){return e+t*7-(n+6)%7}const a6={[It]:t=>t.getFullYear(),[Ae]:t=>Math.floor(t.getMonth()/3),[Jt]:t=>t.getMonth(),[Ee]:t=>t.getDate(),[ze]:t=>t.getHours(),[Be]:t=>t.getMinutes(),[Ke]:t=>t.getSeconds(),[hn]:t=>t.getMilliseconds(),[$n]:t=>Yx(t),[Dt]:t=>oh(t),[Dt+Xt]:(t,e)=>Vr(oh(t),t.getDay(),uh(e)),[Xt]:(t,e)=>Vr(1,t.getDay(),uh(e))},o6={[Ae]:t=>3*t,[Dt]:(t,e)=>Vr(t,0,uh(e))};function Xx(t,e){return Vx(t,e||1,a6,o6,n6)}const u6={[It]:t=>t.getUTCFullYear(),[Ae]:t=>Math.floor(t.getUTCMonth()/3),[Jt]:t=>t.getUTCMonth(),[Ee]:t=>t.getUTCDate(),[ze]:t=>t.getUTCHours(),[Be]:t=>t.getUTCMinutes(),[Ke]:t=>t.getUTCSeconds(),[hn]:t=>t.getUTCMilliseconds(),[$n]:t=>Gx(t),[Dt]:t=>sh(t),[Xt]:(t,e)=>Vr(1,t.getUTCDay(),lh(e)),[Dt+Xt]:(t,e)=>Vr(sh(t),t.getUTCDay(),lh(e))},s6={[Ae]:t=>3*t,[Dt]:(t,e)=>Vr(t,0,lh(e))};function Kx(t,e){return Vx(t,e||1,u6,s6,i6)}const l6={[It]:UE,[Ae]:sp.every(3),[Jt]:sp,[Dt]:Bx,[Ee]:ls,[Xt]:ls,[$n]:ls,[ze]:LE,[Be]:zE,[Ke]:zx,[hn]:Nx},f6={[It]:VE,[Ae]:lp.every(3),[Jt]:lp,[Dt]:Px,[Ee]:fs,[Xt]:fs,[$n]:fs,[ze]:HE,[Be]:jE,[Ke]:zx,[hn]:Nx};function ha(t){return l6[t]}function da(t){return f6[t]}function Zx(t,e,n){return t?t.offset(e,n):void 0}function Jx(t,e,n){return Zx(ha(t),e,n)}function Qx(t,e,n){return Zx(da(t),e,n)}function tb(t,e,n,i){return t?t.range(e,n,i):void 0}function eb(t,e,n,i){return tb(ha(t),e,n,i)}function nb(t,e,n,i){return tb(da(t),e,n,i)}const Ga=1e3,Va=Ga*60,Xa=Va*60,Ul=Xa*24,c6=Ul*7,cp=Ul*30,fh=Ul*365,ib=[It,Jt,Ee,ze,Be,Ke,hn],Ka=ib.slice(0,-1),Za=Ka.slice(0,-1),Ja=Za.slice(0,-1),h6=Ja.slice(0,-1),d6=[It,Dt],hp=[It,Jt],rb=[It],Ea=[[Ka,1,Ga],[Ka,5,5*Ga],[Ka,15,15*Ga],[Ka,30,30*Ga],[Za,1,Va],[Za,5,5*Va],[Za,15,15*Va],[Za,30,30*Va],[Ja,1,Xa],[Ja,3,3*Xa],[Ja,6,6*Xa],[Ja,12,12*Xa],[h6,1,Ul],[d6,1,c6],[hp,1,cp],[hp,3,3*cp],[rb,1,fh]];function ab(t){const e=t.extent,n=t.maxbins||40,i=Math.abs(nu(e))/n;let r=KE(u=>u[2]).right(Ea,i),a,o;return r===Ea.length?(a=rb,o=fp(e[0]/fh,e[1]/fh,n)):r?(r=Ea[i/Ea[r-1][2]<Ea[r][2]/i?r-1:r],a=r[0],o=r[1]):(a=ib,o=Math.max(fp(e[0],e[1],n),1)),{units:a,step:o}}function tc(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function ec(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ca(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function ob(t){var e=t.dateTime,n=t.date,i=t.time,r=t.periods,a=t.days,o=t.shortDays,u=t.months,s=t.shortMonths,l=Da(r),f=Sa(r),c=Da(a),h=Sa(a),d=Da(o),g=Sa(o),m=Da(u),p=Sa(u),y=Da(s),v=Sa(s),x={a:L,A:U,b:W,B:lt,c:null,d:vp,e:vp,f:z6,g:W6,G:V6,H:R6,I:N6,j:O6,L:ub,m:B6,M:L6,p:At,q:ie,Q:wp,s:_p,S:P6,u:I6,U:U6,V:q6,w:j6,W:Y6,x:null,X:null,y:H6,Y:G6,Z:X6,"%":bp},b={a:re,A:jt,b:Ue,B:_a,c:null,d:xp,e:xp,f:Q6,g:lC,G:cC,H:K6,I:Z6,j:J6,L:lb,m:tC,M:eC,p:Ma,q:ka,Q:wp,s:_p,S:nC,u:iC,U:rC,V:aC,w:oC,W:uC,x:null,X:null,y:sC,Y:fC,Z:hC,"%":bp},_={a:A,A:E,b:F,B:$,c:O,d:pp,e:pp,f:S6,g:mp,G:gp,H:yp,I:yp,j:A6,L:D6,m:k6,M:E6,p:C,q:M6,Q:$6,s:T6,S:C6,u:v6,U:x6,V:b6,w:y6,W:w6,x:D,X:N,y:mp,Y:gp,Z:_6,"%":F6};x.x=M(n,x),x.X=M(i,x),x.c=M(e,x),b.x=M(n,b),b.X=M(i,b),b.c=M(e,b);function M(P,et){return function(at){var B=[],pe=-1,pt=0,Fe=P.length,$e,zi,Wm;for(at instanceof Date||(at=new Date(+at));++pe<Fe;)P.charCodeAt(pe)===37&&(B.push(P.slice(pt,pe)),(zi=dp[$e=P.charAt(++pe)])!=null?$e=P.charAt(++pe):zi=$e==="e"?" ":"0",(Wm=et[$e])&&($e=Wm(at,zi)),B.push($e),pt=pe+1);return B.push(P.slice(pt,pe)),B.join("")}}function w(P,et){return function(at){var B=Ca(1900,void 0,1),pe=k(B,P,at+="",0),pt,Fe;if(pe!=at.length)return null;if("Q"in B)return new Date(B.Q);if("s"in B)return new Date(B.s*1e3+("L"in B?B.L:0));if(et&&!("Z"in B)&&(B.Z=0),"p"in B&&(B.H=B.H%12+B.p*12),B.m===void 0&&(B.m="q"in B?B.q:0),"V"in B){if(B.V<1||B.V>53)return null;"w"in B||(B.w=1),"Z"in B?(pt=ec(Ca(B.y,0,1)),Fe=pt.getUTCDay(),pt=Fe>4||Fe===0?nh.ceil(pt):nh(pt),pt=Hv.offset(pt,(B.V-1)*7),B.y=pt.getUTCFullYear(),B.m=pt.getUTCMonth(),B.d=pt.getUTCDate()+(B.w+6)%7):(pt=tc(Ca(B.y,0,1)),Fe=pt.getDay(),pt=Fe>4||Fe===0?ih.ceil(pt):ih(pt),pt=Wv.offset(pt,(B.V-1)*7),B.y=pt.getFullYear(),B.m=pt.getMonth(),B.d=pt.getDate()+(B.w+6)%7)}else("W"in B||"U"in B)&&("w"in B||(B.w="u"in B?B.u%7:"W"in B?1:0),Fe="Z"in B?ec(Ca(B.y,0,1)).getUTCDay():tc(Ca(B.y,0,1)).getDay(),B.m=0,B.d="W"in B?(B.w+6)%7+B.W*7-(Fe+5)%7:B.w+B.U*7-(Fe+6)%7);return"Z"in B?(B.H+=B.Z/100|0,B.M+=B.Z%100,ec(B)):tc(B)}}function k(P,et,at,B){for(var pe=0,pt=et.length,Fe=at.length,$e,zi;pe<pt;){if(B>=Fe)return-1;if($e=et.charCodeAt(pe++),$e===37){if($e=et.charAt(pe++),zi=_[$e in dp?et.charAt(pe++):$e],!zi||(B=zi(P,at,B))<0)return-1}else if($e!=at.charCodeAt(B++))return-1}return B}function C(P,et,at){var B=l.exec(et.slice(at));return B?(P.p=f.get(B[0].toLowerCase()),at+B[0].length):-1}function A(P,et,at){var B=d.exec(et.slice(at));return B?(P.w=g.get(B[0].toLowerCase()),at+B[0].length):-1}function E(P,et,at){var B=c.exec(et.slice(at));return B?(P.w=h.get(B[0].toLowerCase()),at+B[0].length):-1}function F(P,et,at){var B=y.exec(et.slice(at));return B?(P.m=v.get(B[0].toLowerCase()),at+B[0].length):-1}function $(P,et,at){var B=m.exec(et.slice(at));return B?(P.m=p.get(B[0].toLowerCase()),at+B[0].length):-1}function O(P,et,at){return k(P,e,et,at)}function D(P,et,at){return k(P,n,et,at)}function N(P,et,at){return k(P,i,et,at)}function L(P){return o[P.getDay()]}function U(P){return a[P.getDay()]}function W(P){return s[P.getMonth()]}function lt(P){return u[P.getMonth()]}function At(P){return r[+(P.getHours()>=12)]}function ie(P){return 1+~~(P.getMonth()/3)}function re(P){return o[P.getUTCDay()]}function jt(P){return a[P.getUTCDay()]}function Ue(P){return s[P.getUTCMonth()]}function _a(P){return u[P.getUTCMonth()]}function Ma(P){return r[+(P.getUTCHours()>=12)]}function ka(P){return 1+~~(P.getUTCMonth()/3)}return{format:function(P){var et=M(P+="",x);return et.toString=function(){return P},et},parse:function(P){var et=w(P+="",!1);return et.toString=function(){return P},et},utcFormat:function(P){var et=M(P+="",b);return et.toString=function(){return P},et},utcParse:function(P){var et=w(P+="",!0);return et.toString=function(){return P},et}}}var dp={"-":"",_:" ","0":"0"},Bt=/^\s*\d+/,g6=/^%/,m6=/[\\^$*+?|[\]().{}]/g;function ut(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",a=r.length;return i+(a<n?new Array(n-a+1).join(e)+r:r)}function p6(t){return t.replace(m6,"\\$&")}function Da(t){return new RegExp("^(?:"+t.map(p6).join("|")+")","i")}function Sa(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function y6(t,e,n){var i=Bt.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function v6(t,e,n){var i=Bt.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function x6(t,e,n){var i=Bt.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function b6(t,e,n){var i=Bt.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function w6(t,e,n){var i=Bt.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function gp(t,e,n){var i=Bt.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function mp(t,e,n){var i=Bt.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function _6(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function M6(t,e,n){var i=Bt.exec(e.slice(n,n+1));return i?(t.q=i[0]*3-3,n+i[0].length):-1}function k6(t,e,n){var i=Bt.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function pp(t,e,n){var i=Bt.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function A6(t,e,n){var i=Bt.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function yp(t,e,n){var i=Bt.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function E6(t,e,n){var i=Bt.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function C6(t,e,n){var i=Bt.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function D6(t,e,n){var i=Bt.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function S6(t,e,n){var i=Bt.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function F6(t,e,n){var i=g6.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function $6(t,e,n){var i=Bt.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function T6(t,e,n){var i=Bt.exec(e.slice(n));return i?(t.s=+i[0],n+i[0].length):-1}function vp(t,e){return ut(t.getDate(),e,2)}function R6(t,e){return ut(t.getHours(),e,2)}function N6(t,e){return ut(t.getHours()%12||12,e,2)}function O6(t,e){return ut(1+Wv.count(Eo(t),t),e,3)}function ub(t,e){return ut(t.getMilliseconds(),e,3)}function z6(t,e){return ub(t,e)+"000"}function B6(t,e){return ut(t.getMonth()+1,e,2)}function L6(t,e){return ut(t.getMinutes(),e,2)}function P6(t,e){return ut(t.getSeconds(),e,2)}function I6(t){var e=t.getDay();return e===0?7:e}function U6(t,e){return ut(_A.count(Eo(t)-1,t),e,2)}function sb(t){var e=t.getDay();return e>=4||e===0?Co(t):Co.ceil(t)}function q6(t,e){return t=sb(t),ut(Co.count(Eo(t),t)+(Eo(t).getDay()===4),e,2)}function j6(t){return t.getDay()}function Y6(t,e){return ut(ih.count(Eo(t)-1,t),e,2)}function H6(t,e){return ut(t.getFullYear()%100,e,2)}function W6(t,e){return t=sb(t),ut(t.getFullYear()%100,e,2)}function G6(t,e){return ut(t.getFullYear()%1e4,e,4)}function V6(t,e){var n=t.getDay();return t=n>=4||n===0?Co(t):Co.ceil(t),ut(t.getFullYear()%1e4,e,4)}function X6(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ut(e/60|0,"0",2)+ut(e%60,"0",2)}function xp(t,e){return ut(t.getUTCDate(),e,2)}function K6(t,e){return ut(t.getUTCHours(),e,2)}function Z6(t,e){return ut(t.getUTCHours()%12||12,e,2)}function J6(t,e){return ut(1+Hv.count(Do(t),t),e,3)}function lb(t,e){return ut(t.getUTCMilliseconds(),e,3)}function Q6(t,e){return lb(t,e)+"000"}function tC(t,e){return ut(t.getUTCMonth()+1,e,2)}function eC(t,e){return ut(t.getUTCMinutes(),e,2)}function nC(t,e){return ut(t.getUTCSeconds(),e,2)}function iC(t){var e=t.getUTCDay();return e===0?7:e}function rC(t,e){return ut(MA.count(Do(t)-1,t),e,2)}function fb(t){var e=t.getUTCDay();return e>=4||e===0?So(t):So.ceil(t)}function aC(t,e){return t=fb(t),ut(So.count(Do(t),t)+(Do(t).getUTCDay()===4),e,2)}function oC(t){return t.getUTCDay()}function uC(t,e){return ut(nh.count(Do(t)-1,t),e,2)}function sC(t,e){return ut(t.getUTCFullYear()%100,e,2)}function lC(t,e){return t=fb(t),ut(t.getUTCFullYear()%100,e,2)}function fC(t,e){return ut(t.getUTCFullYear()%1e4,e,4)}function cC(t,e){var n=t.getUTCDay();return t=n>=4||n===0?So(t):So.ceil(t),ut(t.getUTCFullYear()%1e4,e,4)}function hC(){return"+0000"}function bp(){return"%"}function wp(t){return+t}function _p(t){return Math.floor(+t/1e3)}var _r,cb,hb,db,gb;dC({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function dC(t){return _r=ob(t),cb=_r.format,hb=_r.parse,db=_r.utcFormat,gb=_r.utcParse,_r}function Qa(t){const e={};return n=>e[n]||(e[n]=t(n))}function gC(t,e){return n=>{const i=t(n),r=i.indexOf(e);if(r<0)return i;let a=mC(i,r);const o=a<i.length?i.slice(a):"";for(;--a>r;)if(i[a]!=="0"){++a;break}return i.slice(0,a)+o}}function mC(t,e){let n=t.lastIndexOf("e"),i;if(n>0)return n;for(n=t.length;--n>e;)if(i=t.charCodeAt(n),i>=48&&i<=57)return n+1}function mb(t){const e=Qa(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(i){const r=$o(i||",");if(r.precision==null){switch(r.precision=12,r.type){case"%":r.precision-=2;break;case"e":r.precision-=1;break}return gC(e(r),e(".1f")(1)[1])}else return e(r)},formatSpan(i,r,a,o){o=$o(o==null?",f":o);const u=ME(i,r,a),s=Math.max(Math.abs(i),Math.abs(r));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=TE(u,s))||(o.precision=l),n(o,s);case"":case"e":case"g":case"p":case"r":{isNaN(l=RE(u,s))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=$E(u))||(o.precision=l-(o.type==="%")*2);break}}return e(o)}}}let ch;pb();function pb(){return ch=mb({format:Tx,formatPrefix:Rx})}function yb(t){return mb($x(t))}function Ns(t){return arguments.length?ch=yb(t):ch}function Mp(t,e,n){n=n||{},J(n)||R("Invalid time multi-format specifier: ".concat(n));const i=e(Ke),r=e(Be),a=e(ze),o=e(Ee),u=e(Dt),s=e(Jt),l=e(Ae),f=e(It),c=t(n[hn]||".%L"),h=t(n[Ke]||":%S"),d=t(n[Be]||"%I:%M"),g=t(n[ze]||"%I %p"),m=t(n[Ee]||n[Xt]||"%a %d"),p=t(n[Dt]||"%b %d"),y=t(n[Jt]||"%B"),v=t(n[Ae]||"%B"),x=t(n[It]||"%Y");return b=>(i(b)<b?c:r(b)<b?h:a(b)<b?d:o(b)<b?g:s(b)<b?u(b)<b?m:p:f(b)<b?l(b)<b?y:v:x)(b)}function vb(t){const e=Qa(t.format),n=Qa(t.utcFormat);return{timeFormat:i=>vt(i)?e(i):Mp(e,ha,i),utcFormat:i=>vt(i)?n(i):Mp(n,da,i),timeParse:Qa(t.parse),utcParse:Qa(t.utcParse)}}let hh;xb();function xb(){return hh=vb({format:cb,parse:hb,utcFormat:db,utcParse:gb})}function bb(t){return vb(ob(t))}function No(t){return arguments.length?hh=bb(t):hh}const dh=(t,e)=>Z({},t,e);function wb(t,e){const n=t?yb(t):Ns(),i=e?bb(e):No();return dh(n,i)}function y0(t,e){const n=arguments.length;return n&&n!==2&&R("defaultLocale expects either zero or two arguments."),n?dh(Ns(t),No(e)):dh(Ns(),No())}function pC(){return pb(),xb(),y0()}function _b(t,e,n,i){e=e||{};const r=c0(e.type||"json");return r||R("Unknown data format type: "+e.type),t=r(t,e),e.parse&&yC(t,e.parse,n,i),V(t,"columns")&&delete t.columns,t}function yC(t,e,n,i){if(!t.length)return;const r=No();n=n||r.timeParse,i=i||r.utcParse;let a=t.columns||Object.keys(t[0]),o,u,s,l,f,c;e==="auto"&&(e=Ax(t,a)),a=Object.keys(e);const h=a.map(d=>{const g=e[d];let m,p;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return m=g.split(/:(.+)?/,2),p=m[1],(p[0]==="'"&&p[p.length-1]==="'"||p[0]==='"'&&p[p.length-1]==='"')&&(p=p.slice(1,-1)),(m[0]==="utc"?i:n)(p);if(!rh[g])throw Error("Illegal format pattern: "+d+":"+g);return rh[g]});for(s=0,f=t.length,c=a.length;s<f;++s)for(o=t[s],l=0;l<c;++l)u=a[l],o[u]=h[l](o[u])}const ql=GA(typeof fetch!="undefined"&&fetch,null);function jl(t){const e=t||de,n=[],i={};return n.add=r=>{const a=e(r);return i[a]||(i[a]=1,n.push(r)),n},n.remove=r=>{const a=e(r);if(i[a]){i[a]=0;const o=n.indexOf(r);o>=0&&n.splice(o,1)}return n},n}async function cs(t,e){try{await e(t)}catch(n){t.error(n)}}const Mb=Symbol("vega_id");let vC=1;function Yl(t){return!!(t&&j(t))}function j(t){return t[Mb]}function kb(t,e){return t[Mb]=e,t}function ft(t){const e=t===Object(t)?t:{data:t};return j(e)?e:kb(e,vC++)}function v0(t){return Hl(t,ft({}))}function Hl(t,e){for(const n in t)e[n]=t[n];return e}function Ab(t,e){return kb(e,j(t))}function fr(t,e){return t?e?(n,i)=>t(n,i)||j(e(n))-j(e(i)):(n,i)=>t(n,i)||j(n)-j(i):null}function Eb(t){return t&&t.constructor===cr}function cr(){const t=[],e=[],n=[],i=[],r=[];let a=null,o=!1;return{constructor:cr,insert(u){const s=G(u),l=s.length;for(let f=0;f<l;++f)t.push(s[f]);return this},remove(u){const s=Q(u)?i:e,l=G(u),f=l.length;for(let c=0;c<f;++c)s.push(l[c]);return this},modify(u,s,l){const f={field:s,value:ee(l)};return Q(u)?(f.filter=u,r.push(f)):(f.tuple=u,n.push(f)),this},encode(u,s){return Q(u)?r.push({filter:u,field:s}):n.push({tuple:u,field:s}),this},clean(u){return a=u,this},reflow(){return o=!0,this},pulse(u,s){const l={},f={};let c,h,d,g,m,p;for(c=0,h=s.length;c<h;++c)l[j(s[c])]=1;for(c=0,h=e.length;c<h;++c)m=e[c],l[j(m)]=-1;for(c=0,h=i.length;c<h;++c)g=i[c],s.forEach(v=>{g(v)&&(l[j(v)]=-1)});for(c=0,h=t.length;c<h;++c)m=t[c],p=j(m),l[p]?l[p]=1:u.add.push(ft(t[c]));for(c=0,h=s.length;c<h;++c)m=s[c],l[j(m)]<0&&u.rem.push(m);function y(v,x,b){b?v[x]=b(v):u.encode=x,o||(f[j(v)]=v)}for(c=0,h=n.length;c<h;++c)d=n[c],m=d.tuple,g=d.field,p=l[j(m)],p>0&&(y(m,g,d.value),u.modifies(g));for(c=0,h=r.length;c<h;++c)d=r[c],g=d.filter,s.forEach(v=>{g(v)&&l[j(v)]>0&&y(v,d.field,d.value)}),u.modifies(d.field);if(o)u.mod=e.length||i.length?s.filter(v=>l[j(v)]>0):s.slice();else for(p in f)u.mod.push(f[p]);return(a||a==null&&(e.length||i.length))&&u.clean(!0),u}}}const hs="_:mod:_";function Wl(){Object.defineProperty(this,hs,{writable:!0,value:{}})}Wl.prototype={set(t,e,n,i){const r=this,a=r[t],o=r[hs];return e!=null&&e>=0?(a[e]!==n||i)&&(a[e]=n,o[e+":"+t]=-1,o[t]=-1):(a!==n||i)&&(r[t]=n,o[t]=Y(n)?1+n.length:-1),r},modified(t,e){const n=this[hs];if(arguments.length){if(Y(t)){for(let i=0;i<t.length;++i)if(n[t[i]])return!0;return!1}}else{for(const i in n)if(n[i])return!0;return!1}return e!=null&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[hs]={},this}};let xC=0;const bC="pulse",wC=new Wl,_C=1,MC=2;function mt(t,e,n,i){this.id=++xC,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,i)}function kp(t){return function(e){const n=this.flags;return arguments.length===0?!!(n&t):(this.flags=e?n|t:n&~t,this)}}mt.prototype={targets(){return this._targets||(this._targets=jl(eu))},set(t){return this.value!==t?(this.value=t,1):0},skip:kp(_C),modified:kp(MC),parameters(t,e,n){e=e!==!1;const i=this._argval=this._argval||new Wl,r=this._argops=this._argops||[],a=[];let o,u,s,l;const f=(c,h,d)=>{d instanceof mt?(d!==this&&(e&&d.targets().add(this),a.push(d)),r.push({op:d,name:c,index:h})):i.set(c,h,d)};for(o in t)if(u=t[o],o===bC)G(u).forEach(c=>{c instanceof mt?c!==this&&(c.targets().add(this),a.push(c)):R("Pulse parameters must be operator instances.")}),this.source=u;else if(Y(u))for(i.set(o,-1,Array(s=u.length)),l=0;l<s;++l)f(o,l,u[l]);else f(o,-1,u);return this.marshall().clear(),n&&(r.initonly=!0),a},marshall(t){const e=this._argval||wC,n=this._argops;let i,r,a,o;if(n){const u=n.length;for(r=0;r<u;++r)i=n[r],a=i.op,o=a.modified()&&a.stamp===t,e.set(i.name,i.index,a.value,o);if(n.initonly){for(r=0;r<u;++r)i=n[r],i.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,i,r;if(t)for(e=0,n=t.length;e<n;++e)i=t[e],r=i.op,r._targets&&r._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),i=e.call(this,n,t);if(n.clear(),i!==this.value)this.value=i;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};function kC(t,e,n,i){let r=1,a;return t instanceof mt?a=t:t&&t.prototype instanceof mt?a=new t:Q(t)?a=new mt(null,t):(r=0,a=new mt(t,e)),this.rank(a),r&&(i=n,n=e),n&&this.connect(a,a.parameters(n,i)),this.touch(a),a}function AC(t,e){const n=t.rank,i=e.length;for(let r=0;r<i;++r)if(n<e[r].rank){this.rerank(t);return}}let EC=0;function Gl(t,e,n){this.id=++EC,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function ii(t,e,n){return new Gl(t,e,n)}Gl.prototype={_filter:Xe,_apply:de,targets(){return this._targets||(this._targets=jl(eu))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,i=n?n.length:0;for(let r=0;r<i;++r)n[r].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=ii(t);return this.targets().add(e),e},apply(t){const e=ii(null,t);return this.targets().add(e),e},merge(){const t=ii();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter(()=>{const n=Date.now();return n-e>t?(e=n,1):0})},debounce(t){const e=ii();return this.targets().add(ii(null,null,r0(t,n=>{const i=n.dataflow;e.receive(n),i&&i.run&&i.run()}))),e},between(t,e){let n=!1;return t.targets().add(ii(null,null,()=>n=!0)),e.targets().add(ii(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=Xe,this._targets=null}};function CC(t,e,n,i){const r=this,a=ii(n,i),o=function(l){l.dataflow=r;try{a.receive(l)}catch(f){r.error(f)}finally{r.run()}};let u;typeof t=="string"&&typeof document!="undefined"?u=document.querySelectorAll(t):u=G(t);const s=u.length;for(let l=0;l<s;++l)u[l].addEventListener(e,o);return a}function DC(t,e){const n=this.locale();return _b(t,e,n.timeParse,n.utcParse)}function SC(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))}async function FC(t,e){const n=this;let i=0,r;try{r=await n.loader().load(t,{context:"dataflow",response:Sx(e&&e.type)});try{r=n.parse(r,e)}catch(a){i=-2,n.warn("Data ingestion failed",t,a)}}catch(a){i=-1,n.warn("Loading failed",t,a)}return{data:r,status:i}}async function $C(t,e,n){const i=this,r=i._pending||TC(i);r.requests+=1;const a=await i.request(e,n);return i.pulse(t,i.changeset().remove(Xe).insert(a.data||[])),r.done(),a}function TC(t){let e;const n=new Promise(i=>e=i);return n.requests=0,n.done=()=>{--n.requests===0&&(t._pending=null,e(t))},t._pending=n}const RC={skip:!0};function NC(t,e,n,i,r){return(t instanceof mt?zC:OC)(this,t,e,n,i,r),this}function OC(t,e,n,i,r,a){const o=Z({},a,RC);let u,s;Q(n)||(n=ee(n)),i===void 0?u=l=>t.touch(n(l)):Q(i)?(s=new mt(null,i,r,!1),u=l=>{s.evaluate(l);const f=n(l),c=s.value;Eb(c)?t.pulse(f,c,a):t.update(f,c,o)}):u=l=>t.update(n(l),i,o),e.apply(u)}function zC(t,e,n,i,r,a){if(i===void 0)e.targets().add(n);else{const o=a||{},u=new mt(null,BC(n,i),r,!1);u.modified(o.force),u.rank=e.rank,e.targets().add(u),n&&(u.skip(!0),u.value=n.value,u.targets().add(n),t.connect(n,[u]))}}function BC(t,e){return e=Q(e)?e:ee(e),t?function(n,i){const r=e(n,i);return t.skip()||(t.skip(r!==this.value).value=r),r}:e}function LC(t){t.rank=++this._rank}function PC(t){const e=[t];let n,i,r;for(;e.length;)if(this.rank(n=e.pop()),i=n._targets)for(r=i.length;--r>=0;)e.push(n=i[r]),n===t&&R("Cycle detected in dataflow graph.")}const Os={},xn=1<<0,ai=1<<1,Un=1<<2,IC=xn|ai,Ap=xn|Un,Mr=xn|ai|Un,Ep=1<<3,Fa=1<<4,Cp=1<<5,Dp=1<<6;function bi(t,e,n){this.dataflow=t,this.stamp=e==null?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function nc(t,e){const n=[];return ri(t,e,i=>n.push(i)),n}function Sp(t,e){const n={};return t.visit(e,i=>{n[j(i)]=1}),i=>n[j(i)]?null:i}function zu(t,e){return t?(n,i)=>t(n,i)&&e(n,i):e}bi.prototype={StopPropagation:Os,ADD:xn,REM:ai,MOD:Un,ADD_REM:IC,ADD_MOD:Ap,ALL:Mr,REFLOW:Ep,SOURCE:Fa,NO_SOURCE:Cp,NO_FIELDS:Dp,fork(t){return new bi(this.dataflow).init(this,t)},clone(){const t=this.fork(Mr);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(Mr|Fa)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new bi(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,t.fields&&!(e&Dp)&&(n.fields=t.fields),e&xn?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),e&ai?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),e&Un?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),e&Cp?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||Mr;return e&xn&&this.add.length||e&ai&&this.rem.length||e&Un&&this.mod.length},reflow(t){if(t)return this.fork(Mr).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(Un,Sp(this,xn))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return Y(t)?t.forEach(n=>e[n]=!0):e[t]=!0,this},modified(t,e){const n=this.fields;return(e||this.mod.length)&&n?arguments.length?Y(t)?t.some(i=>n[i]):n[t]:!!n:!1},filter(t,e){const n=this;return t&xn&&(n.addF=zu(n.addF,e)),t&ai&&(n.remF=zu(n.remF,e)),t&Un&&(n.modF=zu(n.modF,e)),t&Fa&&(n.srcF=zu(n.srcF,e)),n},materialize(t){t=t||Mr;const e=this;return t&xn&&e.addF&&(e.add=nc(e.add,e.addF),e.addF=null),t&ai&&e.remF&&(e.rem=nc(e.rem,e.remF),e.remF=null),t&Un&&e.modF&&(e.mod=nc(e.mod,e.modF),e.modF=null),t&Fa&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,i=e;if(t&Fa)return ri(n.source,n.srcF,i),n;t&xn&&ri(n.add,n.addF,i),t&ai&&ri(n.rem,n.remF,i),t&Un&&ri(n.mod,n.modF,i);const r=n.source;if(t&Ep&&r){const a=n.add.length+n.mod.length;a===r.length||(a?ri(r,Sp(n,Ap),i):ri(r,n.srcF,i))}return n}};function x0(t,e,n,i){const r=this,a=n.length;let o=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=i||null,this.pulses=n;for(let u=0;u<a;++u){const s=n[u];if(s.stamp===e){if(s.fields){const l=r.fields||(r.fields={});for(const f in s.fields)l[f]=1}s.changed(r.ADD)&&(o|=r.ADD),s.changed(r.REM)&&(o|=r.REM),s.changed(r.MOD)&&(o|=r.MOD)}}this.changes=o}z(x0,bi,{fork(t){const e=new bi(this.dataflow).init(this,t&this.NO_FIELDS);return t!==void 0&&(t&e.ADD&&this.visit(e.ADD,n=>e.add.push(n)),t&e.REM&&this.visit(e.REM,n=>e.rem.push(n)),t&e.MOD&&this.visit(e.MOD,n=>e.mod.push(n))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?Y(t)?t.some(i=>n[i]):n[t]:0},filter(){R("MultiPulse does not support filtering.")},materialize(){R("MultiPulse does not support materialization.")},visit(t,e){const n=this,i=n.pulses,r=i.length;let a=0;if(t&n.SOURCE)for(;a<r;++a)i[a].visit(t,e);else for(;a<r;++a)i[a].stamp===n.stamp&&i[a].visit(t,e);return n}});async function UC(t,e,n){const i=this,r=[];if(i._pulse)return Cb(i);if(i._pending&&await i._pending,e&&await cs(i,e),!i._touched.length)return i.debug("Dataflow invoked, but nothing to do."),i;const a=++i._clock;i._pulse=new bi(i,a,t),i._touched.forEach(f=>i._enqueue(f,!0)),i._touched=jl(eu);let o=0,u,s,l;try{for(;i._heap.size()>0;){if(u=i._heap.pop(),u.rank!==u.qrank){i._enqueue(u,!0);continue}s=u.run(i._getPulse(u,t)),s.then?s=await s:s.async&&(r.push(s.async),s=Os),s!==Os&&u._targets&&u._targets.forEach(f=>i._enqueue(f)),++o}}catch(f){i._heap.clear(),l=f}if(i._input={},i._pulse=null,i.debug(`Pulse ${a}: ${o} operators`),l&&(i._postrun=[],i.error(l)),i._postrun.length){const f=i._postrun.sort((c,h)=>h.priority-c.priority);i._postrun=[];for(let c=0;c<f.length;++c)await cs(i,f[c].callback)}return n&&await cs(i,n),r.length&&Promise.all(r).then(f=>i.runAsync(null,()=>{f.forEach(c=>{try{c(i)}catch(h){i.error(h)}})})),i}async function qC(t,e,n){for(;this._running;)await this._running;const i=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(i,i),this._running}function jC(t,e,n){return this._pulse?Cb(this):(this.evaluate(t,e,n),this)}function YC(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(i){this.error(i)}}function Cb(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}function HC(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))}function WC(t,e){const n=t.source,i=this._clock;return n&&Y(n)?new x0(this,i,n.map(r=>r.pulse),e):this._input[t.id]||GC(this._pulse,n&&n.pulse)}function GC(t,e){return e&&e.stamp===t.stamp?e:(t=t.fork(),e&&e!==Os&&(t.source=e.source),t)}const b0={skip:!1,force:!1};function VC(t,e){const n=e||b0;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this}function XC(t,e,n){const i=n||b0;return(t.set(e)||i.force)&&this.touch(t,i),this}function KC(t,e,n){this.touch(t,n||b0);const i=new bi(this,this._clock+(this._pulse?0:1)),r=t.pulse&&t.pulse.source||[];return i.target=t,this._input[t.id]=e.pulse(i,r),this}function ZC(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),Db(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let i;return e.length?(i=e[0],e[0]=n,JC(e,0,t)):i=n,i}}}function Db(t,e,n,i){let r,a;const o=t[n];for(;n>e;){if(a=n-1>>1,r=t[a],i(o,r)<0){t[n]=r,n=a;continue}break}return t[n]=o}function JC(t,e,n){const i=e,r=t.length,a=t[e];let o=(e<<1)+1,u;for(;o<r;)u=o+1,u<r&&n(t[o],t[u])>=0&&(o=u),t[e]=t[o],e=o,o=(e<<1)+1;return t[e]=a,Db(t,i,e,n)}function Ur(){this.logger(tx()),this.logLevel(Jd),this._clock=0,this._rank=0,this._locale=y0();try{this._loader=ql()}catch{}this._touched=jl(eu),this._input={},this._pulse=null,this._heap=ZC((t,e)=>t.qrank-e.qrank),this._postrun=[]}function $a(t){return function(){return this._log[t].apply(this,arguments)}}Ur.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:$a("error"),warn:$a("warn"),info:$a("info"),debug:$a("debug"),logLevel:$a("level"),cleanThreshold:1e4,add:kC,connect:AC,rank:LC,rerank:PC,pulse:KC,touch:VC,update:XC,changeset:cr,ingest:SC,parse:DC,preload:$C,request:FC,events:CC,on:NC,evaluate:UC,run:jC,runAsync:qC,runAfter:YC,_enqueue:HC,_getPulse:WC};function S(t,e){mt.call(this,t,null,e)}z(S,mt,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then(n=>this.pulse=n):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const Xr={};function Sb(t){const e=Fb(t);return e&&e.Definition||null}function Fb(t){return t=t&&t.toLowerCase(),V(Xr,t)?Xr[t]:null}function w0(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function QC(t){return t===null?NaN:+t}function*t4(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(i=+i)>=i&&(yield i)}}function e4(t,e){let n=0,i,r=0,a=0;if(e===void 0)for(let o of t)o!=null&&(o=+o)>=o&&(i=o-r,r+=i/++n,a+=i*(o-r));else{let o=-1;for(let u of t)(u=e(u,++o,t))!=null&&(u=+u)>=u&&(i=u-r,r+=i/++n,a+=i*(u-r))}if(n>1)return a/(n-1)}function n4(t,e){const n=e4(t,e);return n&&Math.sqrt(n)}function Fp(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function $p(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function $b(t,e,n=0,i=t.length-1,r=w0){for(;i>n;){if(i-n>600){const s=i-n+1,l=e-n+1,f=Math.log(s),c=.5*Math.exp(2*f/3),h=.5*Math.sqrt(f*c*(s-c)/s)*(l-s/2<0?-1:1),d=Math.max(n,Math.floor(e-l*c/s+h)),g=Math.min(i,Math.floor(e+(s-l)*c/s+h));$b(t,e,d,g,r)}const a=t[e];let o=n,u=i;for(Ta(t,n,e),r(t[i],a)>0&&Ta(t,n,i);o<u;){for(Ta(t,o,u),++o,--u;r(t[o],a)<0;)++o;for(;r(t[u],a)>0;)--u}r(t[n],a)===0?Ta(t,n,u):(++u,Ta(t,u,i)),u<=e&&(n=u+1),e<=u&&(i=u-1)}return t}function Ta(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function gh(t,e,n){if(t=Float64Array.from(t4(t,n)),!!(i=t.length)){if((e=+e)<=0||i<2)return $p(t);if(e>=1)return Fp(t);var i,r=(i-1)*e,a=Math.floor(r),o=Fp($b(t,a).subarray(0,a+1)),u=$p(t.subarray(a+1));return o+(u-o)*(r-a)}}function i4(t,e,n=QC){if(!!(i=t.length)){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,a=Math.floor(r),o=+n(t[a],a,t),u=+n(t[a+1],a+1,t);return o+(u-o)*(r-a)}}function r4(t,e){return gh(t,.5,e)}function*Tb(t,e){if(e==null)for(let n of t)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of t)i=e(i,++n,t),i!=null&&i!==""&&(i=+i)>=i&&(yield i)}}function _0(t,e,n){const i=Float64Array.from(Tb(t,n));return i.sort(w0),e.map(r=>i4(i,r))}function M0(t,e){return _0(t,[.25,.5,.75],e)}function k0(t,e){const n=t.length,i=n4(t,e),r=M0(t,e),a=(r[2]-r[0])/1.34,o=Math.min(i,a)||i||Math.abs(r[0])||1;return 1.06*o*Math.pow(n,-.2)}function Rb(t){const e=t.maxbins||20,n=t.base||10,i=Math.log(n),r=t.divide||[5,2];let a=t.extent[0],o=t.extent[1],u,s,l,f,c,h;const d=t.span||o-a||Math.abs(a)||1;if(t.step)u=t.step;else if(t.steps){for(f=d/e,c=0,h=t.steps.length;c<h&&t.steps[c]<f;++c);u=t.steps[Math.max(0,c-1)]}else{for(s=Math.ceil(Math.log(e)/i),l=t.minstep||0,u=Math.max(l,Math.pow(n,Math.round(Math.log(d)/i)-s));Math.ceil(d/u)>e;)u*=n;for(c=0,h=r.length;c<h;++c)f=u/r[c],f>=l&&d/f<=e&&(u=f)}f=Math.log(u);const g=f>=0?0:~~(-f/i)+1,m=Math.pow(n,-g-1);return(t.nice||t.nice===void 0)&&(f=Math.floor(a/u+m)*u,a=a<f?f-u:f,o=Math.ceil(o/u)*u),{start:a,stop:o===a?a+u:o,step:u}}var Ze=Math.random;function a4(t){Ze=t}function Nb(t,e,n,i){if(!t.length)return[void 0,void 0];const r=Float64Array.from(Tb(t,i)),a=r.length,o=e;let u,s,l,f;for(l=0,f=Array(o);l<o;++l){for(u=0,s=0;s<a;++s)u+=r[~~(Ze()*a)];f[l]=u/a}return f.sort(w0),[gh(f,n/2),gh(f,1-n/2)]}function Ob(t,e,n,i){i=i||(h=>h);const r=t.length,a=new Float64Array(r);let o=0,u=1,s=i(t[0]),l=s,f=s+e,c;for(;u<r;++u){if(c=i(t[u]),c>=f){for(l=(s+l)/2;o<u;++o)a[o]=l;f=c+e,s=c}l=c}for(l=(s+l)/2;o<u;++o)a[o]=l;return n?o4(a,e+e/4):a}function o4(t,e){const n=t.length;let i=0,r=1,a,o;for(;t[i]===t[r];)++r;for(;r<n;){for(a=r+1;t[r]===t[a];)++a;if(t[r]-t[r-1]<e){for(o=r+(i+a-r-r>>1);o<r;)t[o++]=t[r];for(;o>r;)t[o--]=t[i]}i=r,r=a}return t}function u4(t){return function(){return t=(1103515245*t+12345)%2147483647,t/2147483647}}function s4(t,e){e==null&&(e=t,t=0);let n,i,r;const a={min(o){return arguments.length?(n=o||0,r=i-n,a):n},max(o){return arguments.length?(i=o||0,r=i-n,a):i},sample(){return n+Math.floor(r*Ze())},pdf(o){return o===Math.floor(o)&&o>=n&&o<i?1/r:0},cdf(o){const u=Math.floor(o);return u<n?0:u>=i?1:(u-n+1)/r},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*r):NaN}};return a.min(t).max(e)}const zb=Math.sqrt(2*Math.PI),l4=Math.SQRT2;let Ra=NaN;function Vl(t,e){t=t||0,e=e==null?1:e;let n=0,i=0,r,a;if(Ra===Ra)n=Ra,Ra=NaN;else{do n=Ze()*2-1,i=Ze()*2-1,r=n*n+i*i;while(r===0||r>1);a=Math.sqrt(-2*Math.log(r)/r),n*=a,Ra=i*a}return t+n*e}function A0(t,e,n){n=n==null?1:n;const i=(t-(e||0))/n;return Math.exp(-.5*i*i)/(n*zb)}function Xl(t,e,n){e=e||0,n=n==null?1:n;const i=(t-e)/n,r=Math.abs(i);let a;if(r>37)a=0;else{const o=Math.exp(-r*r/2);let u;r<7.07106781186547?(u=.0352624965998911*r+.700383064443688,u=u*r+6.37396220353165,u=u*r+33.912866078383,u=u*r+112.079291497871,u=u*r+221.213596169931,u=u*r+220.206867912376,a=o*u,u=.0883883476483184*r+1.75566716318264,u=u*r+16.064177579207,u=u*r+86.7807322029461,u=u*r+296.564248779674,u=u*r+637.333633378831,u=u*r+793.826512519948,u=u*r+440.413735824752,a=a/u):(u=r+.65,u=r+4/u,u=r+3/u,u=r+2/u,u=r+1/u,a=o/u/2.506628274631)}return i>0?1-a:a}function Kl(t,e,n){return t<0||t>1?NaN:(e||0)+(n==null?1:n)*l4*f4(2*t-1)}function f4(t){let e=-Math.log((1-t)*(1+t)),n;return e<6.25?(e-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*e,n=128584807152564e-32+n*e,n=11157877678025181e-33+n*e,n=-1333171662854621e-31+n*e,n=20972767875968562e-33+n*e,n=6637638134358324e-30+n*e,n=-4054566272975207e-29+n*e,n=-8151934197605472e-29+n*e,n=26335093153082323e-28+n*e,n=-12975133253453532e-27+n*e,n=-5415412054294628e-26+n*e,n=10512122733215323e-25+n*e,n=-4112633980346984e-24+n*e,n=-29070369957882005e-24+n*e,n=42347877827932404e-23+n*e,n=-13654692000834679e-22+n*e,n=-13882523362786469e-21+n*e,n=.00018673420803405714+n*e,n=-.000740702534166267+n*e,n=-.006033670871430149+n*e,n=.24015818242558962+n*e,n=1.6536545626831027+n*e):e<16?(e=Math.sqrt(e)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*e,n=-27517406297064545e-23+n*e,n=18239629214389228e-24+n*e,n=15027403968909828e-22+n*e,n=-4013867526981546e-21+n*e,n=29234449089955446e-22+n*e,n=12475304481671779e-21+n*e,n=-47318229009055734e-21+n*e,n=6828485145957318e-20+n*e,n=24031110387097894e-21+n*e,n=-.0003550375203628475+n*e,n=.0009532893797373805+n*e,n=-.0016882755560235047+n*e,n=.002491442096107851+n*e,n=-.003751208507569241+n*e,n=.005370914553590064+n*e,n=1.0052589676941592+n*e,n=3.0838856104922208+n*e):Number.isFinite(e)?(e=Math.sqrt(e)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*e,n=15076572693500548e-25+n*e,n=-3789465440126737e-24+n*e,n=761570120807834e-23+n*e,n=-1496002662714924e-23+n*e,n=2914795345090108e-23+n*e,n=-6771199775845234e-23+n*e,n=22900482228026655e-23+n*e,n=-99298272942317e-20+n*e,n=4526062597223154e-21+n*e,n=-1968177810553167e-20+n*e,n=7599527703001776e-20+n*e,n=-.00021503011930044477+n*e,n=-.00013871931833623122+n*e,n=1.0103004648645344+n*e,n=4.849906401408584+n*e):n=1/0,n*t}function E0(t,e){let n,i;const r={mean(a){return arguments.length?(n=a||0,r):n},stdev(a){return arguments.length?(i=a==null?1:a,r):i},sample:()=>Vl(n,i),pdf:a=>A0(a,n,i),cdf:a=>Xl(a,n,i),icdf:a=>Kl(a,n,i)};return r.mean(t).stdev(e)}function C0(t,e){const n=E0();let i=0;const r={data(a){return arguments.length?(t=a,i=a?a.length:0,r.bandwidth(e)):t},bandwidth(a){return arguments.length?(e=a,!e&&t&&(e=k0(t)),r):e},sample(){return t[~~(Ze()*i)]+e*n.sample()},pdf(a){let o=0,u=0;for(;u<i;++u)o+=n.pdf((a-t[u])/e);return o/e/i},cdf(a){let o=0,u=0;for(;u<i;++u)o+=n.cdf((a-t[u])/e);return o/i},icdf(){throw Error("KDE icdf not supported.")}};return r.data(t)}function D0(t,e){return t=t||0,e=e==null?1:e,Math.exp(t+Vl()*e)}function S0(t,e,n){if(t<=0)return 0;e=e||0,n=n==null?1:n;const i=(Math.log(t)-e)/n;return Math.exp(-.5*i*i)/(n*zb*t)}function F0(t,e,n){return Xl(Math.log(t),e,n)}function $0(t,e,n){return Math.exp(Kl(t,e,n))}function Bb(t,e){let n,i;const r={mean(a){return arguments.length?(n=a||0,r):n},stdev(a){return arguments.length?(i=a==null?1:a,r):i},sample:()=>D0(n,i),pdf:a=>S0(a,n,i),cdf:a=>F0(a,n,i),icdf:a=>$0(a,n,i)};return r.mean(t).stdev(e)}function Lb(t,e){let n=0,i;function r(o){const u=[];let s=0,l;for(l=0;l<n;++l)s+=u[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)u[l]/=s;return u}const a={weights(o){return arguments.length?(i=r(e=o||[]),a):e},distributions(o){return arguments.length?(o?(n=o.length,t=o):(n=0,t=[]),a.weights(e)):t},sample(){const o=Ze();let u=t[n-1],s=i[0],l=0;for(;l<n-1;s+=i[++l])if(o<s){u=t[l];break}return u.sample()},pdf(o){let u=0,s=0;for(;s<n;++s)u+=i[s]*t[s].pdf(o);return u},cdf(o){let u=0,s=0;for(;s<n;++s)u+=i[s]*t[s].cdf(o);return u},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(t).weights(e)}function T0(t,e){return e==null&&(e=t==null?1:t,t=0),t+(e-t)*Ze()}function R0(t,e,n){return n==null&&(n=e==null?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function N0(t,e,n){return n==null&&(n=e==null?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function O0(t,e,n){return n==null&&(n=e==null?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function Pb(t,e){let n,i;const r={min(a){return arguments.length?(n=a||0,r):n},max(a){return arguments.length?(i=a==null?1:a,r):i},sample:()=>T0(n,i),pdf:a=>R0(a,n,i),cdf:a=>N0(a,n,i),icdf:a=>O0(a,n,i)};return e==null&&(e=t==null?1:t,t=0),r.min(t).max(e)}function iu(t,e,n,i){const r=i-t*t,a=Math.abs(r)<1e-24?0:(n-t*e)/r;return[e-a*t,a]}function Zl(t,e,n,i){t=t.filter(d=>{let g=e(d),m=n(d);return g!=null&&(g=+g)>=g&&m!=null&&(m=+m)>=m}),i&&t.sort((d,g)=>e(d)-e(g));const r=t.length,a=new Float64Array(r),o=new Float64Array(r);let u=0,s=0,l=0,f,c,h;for(h of t)a[u]=f=+e(h),o[u]=c=+n(h),++u,s+=(f-s)/u,l+=(c-l)/u;for(u=0;u<r;++u)a[u]-=s,o[u]-=l;return[a,o,s,l]}function ru(t,e,n,i){let r=-1,a,o;for(const u of t)a=e(u),o=n(u),a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o&&i(a,o,++r)}function ga(t,e,n,i,r){let a=0,o=0;return ru(t,e,n,(u,s)=>{const l=s-r(u),f=s-i;a+=l*l,o+=f*f}),1-a/o}function z0(t,e,n){let i=0,r=0,a=0,o=0,u=0;ru(t,e,n,(f,c)=>{++u,i+=(f-i)/u,r+=(c-r)/u,a+=(f*c-a)/u,o+=(f*f-o)/u});const s=iu(i,r,a,o),l=f=>s[0]+s[1]*f;return{coef:s,predict:l,rSquared:ga(t,e,n,r,l)}}function Ib(t,e,n){let i=0,r=0,a=0,o=0,u=0;ru(t,e,n,(f,c)=>{++u,f=Math.log(f),i+=(f-i)/u,r+=(c-r)/u,a+=(f*c-a)/u,o+=(f*f-o)/u});const s=iu(i,r,a,o),l=f=>s[0]+s[1]*Math.log(f);return{coef:s,predict:l,rSquared:ga(t,e,n,r,l)}}function Ub(t,e,n){const[i,r,a,o]=Zl(t,e,n);let u=0,s=0,l=0,f=0,c=0,h,d,g;ru(t,e,n,(v,x)=>{h=i[c++],d=Math.log(x),g=h*x,u+=(x*d-u)/c,s+=(g-s)/c,l+=(g*d-l)/c,f+=(h*g-f)/c});const[m,p]=iu(s/o,u/o,l/o,f/o),y=v=>Math.exp(m+p*(v-a));return{coef:[Math.exp(m-p*a),p],predict:y,rSquared:ga(t,e,n,o,y)}}function qb(t,e,n){let i=0,r=0,a=0,o=0,u=0,s=0;ru(t,e,n,(c,h)=>{const d=Math.log(c),g=Math.log(h);++s,i+=(d-i)/s,r+=(g-r)/s,a+=(d*g-a)/s,o+=(d*d-o)/s,u+=(h-u)/s});const l=iu(i,r,a,o),f=c=>l[0]*Math.pow(c,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:f,rSquared:ga(t,e,n,u,f)}}function B0(t,e,n){const[i,r,a,o]=Zl(t,e,n),u=i.length;let s=0,l=0,f=0,c=0,h=0,d,g,m,p;for(d=0;d<u;)g=i[d],m=r[d++],p=g*g,s+=(p-s)/d,l+=(p*g-l)/d,f+=(p*p-f)/d,c+=(g*m-c)/d,h+=(p*m-h)/d;const y=f-s*s,v=s*y-l*l,x=(h*s-c*l)/v,b=(c*y-h*l)/v,_=-x*s,M=w=>(w=w-a,x*w*w+b*w+_+o);return{coef:[_-b*a+x*a*a+o,b-2*x*a,x],predict:M,rSquared:ga(t,e,n,o,M)}}function jb(t,e,n,i){if(i===1)return z0(t,e,n);if(i===2)return B0(t,e,n);const[r,a,o,u]=Zl(t,e,n),s=r.length,l=[],f=[],c=i+1;let h,d,g,m,p;for(h=0;h<c;++h){for(g=0,m=0;g<s;++g)m+=Math.pow(r[g],h)*a[g];for(l.push(m),p=new Float64Array(c),d=0;d<c;++d){for(g=0,m=0;g<s;++g)m+=Math.pow(r[g],h+d);p[d]=m}f.push(p)}f.push(l);const y=h4(f),v=x=>{x-=o;let b=u+y[0]+y[1]*x+y[2]*x*x;for(h=3;h<c;++h)b+=y[h]*Math.pow(x,h);return b};return{coef:c4(c,y,-o,u),predict:v,rSquared:ga(t,e,n,u,v)}}function c4(t,e,n,i){const r=Array(t);let a,o,u,s;for(a=0;a<t;++a)r[a]=0;for(a=t-1;a>=0;--a)for(u=e[a],s=1,r[a]+=u,o=1;o<=a;++o)s*=(a+1-o)/o,r[a-o]+=u*Math.pow(n,o)*s;return r[0]+=i,r}function h4(t){const e=t.length-1,n=[];let i,r,a,o,u;for(i=0;i<e;++i){for(o=i,r=i+1;r<e;++r)Math.abs(t[i][r])>Math.abs(t[i][o])&&(o=r);for(a=i;a<e+1;++a)u=t[a][i],t[a][i]=t[a][o],t[a][o]=u;for(r=i+1;r<e;++r)for(a=e;a>=i;a--)t[a][r]-=t[a][i]*t[i][r]/t[i][i]}for(r=e-1;r>=0;--r){for(u=0,a=r+1;a<e;++a)u+=t[a][r]*n[a];n[r]=(t[e][r]-u)/t[r][r]}return n}const Tp=2,Rp=1e-12;function Yb(t,e,n,i){const[r,a,o,u]=Zl(t,e,n,!0),s=r.length,l=Math.max(2,~~(i*s)),f=new Float64Array(s),c=new Float64Array(s),h=new Float64Array(s).fill(1);for(let d=-1;++d<=Tp;){const g=[0,l-1];for(let p=0;p<s;++p){const y=r[p],v=g[0],x=g[1],b=y-r[v]>r[x]-y?v:x;let _=0,M=0,w=0,k=0,C=0;const A=1/Math.abs(r[b]-y||1);for(let $=v;$<=x;++$){const O=r[$],D=a[$],N=d4(Math.abs(y-O)*A)*h[$],L=O*N;_+=N,M+=L,w+=D*N,k+=D*L,C+=O*L}const[E,F]=iu(M/_,w/_,k/_,C/_);f[p]=E+F*y,c[p]=Math.abs(a[p]-f[p]),g4(r,p+1,g)}if(d===Tp)break;const m=r4(c);if(Math.abs(m)<Rp)break;for(let p=0,y,v;p<s;++p)y=c[p]/(6*m),h[p]=y>=1?Rp:(v=1-y*y)*v}return m4(r,f,o,u)}function d4(t){return(t=1-t*t*t)*t*t}function g4(t,e,n){const i=t[e];let r=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>r&&t[a]-i<=i-t[r];)n[0]=++r,n[1]=a,++a}function m4(t,e,n,i){const r=t.length,a=[];let o=0,u=0,s=[],l;for(;o<r;++o)l=t[o]+n,s[0]===l?s[1]+=(e[o]-s[1])/++u:(u=0,s[1]+=i,s=[l,e[o]],a.push(s));return s[1]+=i,a}const p4=.1*Math.PI/180;function Jl(t,e,n,i){n=n||25,i=Math.max(n,i||200);const r=d=>[d,t(d)],a=e[0],o=e[1],u=o-a,s=u/i,l=[r(a)],f=[];if(n===i){for(let d=1;d<i;++d)l.push(r(a+d/n*u));return l.push(r(o)),l}else{f.push(r(o));for(let d=n;--d>0;)f.push(r(a+d/n*u))}let c=l[0],h=f[f.length-1];for(;h;){const d=r((c[0]+h[0])/2);d[0]-c[0]>=s&&y4(c,d,h)>p4?f.push(d):(c=h,l.push(h),f.pop()),h=f[f.length-1]}return l}function y4(t,e,n){const i=Math.atan2(n[1]-t[1],n[0]-t[0]),r=Math.atan2(e[1]-t[1],e[0]-t[0]);return Math.abs(i-r)}function Hb(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function v4(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=x4(t));function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=i(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:i,center:a,right:r}}function x4(t){return(e,n)=>Hb(t(e),n)}function*b4(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let i of t)(i=e(i,++n,t))!=null&&(i=+i)>=i&&(yield i)}}function mh(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function ph(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n>r||n===void 0&&r>=r)&&(n=r)}return n}function Wb(t,e,n=0,i=t.length-1,r=Hb){for(;i>n;){if(i-n>600){const s=i-n+1,l=e-n+1,f=Math.log(s),c=.5*Math.exp(2*f/3),h=.5*Math.sqrt(f*c*(s-c)/s)*(l-s/2<0?-1:1),d=Math.max(n,Math.floor(e-l*c/s+h)),g=Math.min(i,Math.floor(e+(s-l)*c/s+h));Wb(t,e,d,g,r)}const a=t[e];let o=n,u=i;for(Na(t,n,e),r(t[i],a)>0&&Na(t,n,i);o<u;){for(Na(t,o,u),++o,--u;r(t[o],a)<0;)++o;for(;r(t[u],a)>0;)--u}r(t[n],a)===0?Na(t,n,u):(++u,Na(t,u,i)),u<=e&&(n=u+1),e<=u&&(i=u-1)}return t}function Na(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function w4(t,e,n){if(t=Float64Array.from(b4(t,n)),!!(i=t.length)){if((e=+e)<=0||i<2)return ph(t);if(e>=1)return mh(t);var i,r=(i-1)*e,a=Math.floor(r),o=mh(Wb(t,a).subarray(0,a+1)),u=ph(t.subarray(a+1));return o+(u-o)*(r-a)}}function _4(t,e){let n=0,i=0;if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&(++n,i+=r);else{let r=-1;for(let a of t)(a=e(a,++r,t))!=null&&(a=+a)>=a&&(++n,i+=a)}if(n)return i/n}function M4(t,e){return w4(t,.5,e)}function Gb(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);++i<r;)a[i]=t+i*n;return a}function k4(t){return e=>{const n=t.length;let i=1,r=String(t[0](e));for(;i<n;++i)r+="|"+t[i](e);return r}}function yh(t){return!t||!t.length?function(){return""}:t.length===1?t[0]:k4(t)}function Vb(t,e,n){return n||t+(e?"_"+e:"")}const ic=()=>{},A4={init:ic,add:ic,rem:ic,idx:0},Oo={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||t.min===void 0)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||t.max===void 0)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},au=Object.keys(Oo);function E4(t,e){return n=>Z({name:t,out:n||t},A4,e)}au.forEach(t=>{Oo[t]=E4(t,Oo[t])});function Xb(t,e){return Oo[t](e)}function Kb(t,e){return t.idx-e.idx}function C4(t){const e={};t.forEach(i=>e[i.name]=i);const n=i=>{!i.req||i.req.forEach(r=>{e[r]||n(e[r]=Oo[r]())})};return t.forEach(n),Object.values(e).sort(Kb)}function D4(){this.valid=0,this.missing=0,this._ops.forEach(t=>t.init(this))}function S4(t,e){if(t==null||t===""){++this.missing;return}t===t&&(++this.valid,this._ops.forEach(n=>n.add(this,t,e)))}function F4(t,e){if(t==null||t===""){--this.missing;return}t===t&&(--this.valid,this._ops.forEach(n=>n.rem(this,t,e)))}function $4(t){return this._out.forEach(e=>t[e.out]=e.value(this)),t}function Zb(t,e){const n=e||de,i=C4(t),r=t.slice().sort(Kb);function a(o){this._ops=i,this._out=r,this.cell=o,this.init()}return a.prototype.init=D4,a.prototype.add=S4,a.prototype.rem=F4,a.prototype.set=$4,a.prototype.get=n,a.fields=t.map(o=>o.out),a}function L0(t){this._key=t?ke(t):j,this.reset()}const qt=L0.prototype;qt.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};qt.add=function(t){this._add.push(t)};qt.rem=function(t){this._rem.push(t)};qt.values=function(){if(this._get=null,this._rem.length===0)return this._add;const t=this._add,e=this._rem,n=this._key,i=t.length,r=e.length,a=Array(i-r),o={};let u,s,l;for(u=0;u<r;++u)o[n(e[u])]=1;for(u=0,s=0;u<i;++u)o[n(l=t[u])]?o[n(l)]=0:a[s++]=l;return this._rem=[],this._add=a};qt.distinct=function(t){const e=this.values(),n={};let i=e.length,r=0,a;for(;--i>=0;)a=t(e[i])+"",V(n,a)||(n[a]=1,++r);return r};qt.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=dx(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext};qt.argmin=function(t){return this.extent(t)[0]||{}};qt.argmax=function(t){return this.extent(t)[1]||{}};qt.min=function(t){const e=this.extent(t)[0];return e!=null?t(e):void 0};qt.max=function(t){const e=this.extent(t)[1];return e!=null?t(e):void 0};qt.quartile=function(t){return(this._get!==t||!this._q)&&(this._q=M0(this.values(),t),this._get=t),this._q};qt.q1=function(t){return this.quartile(t)[0]};qt.q2=function(t){return this.quartile(t)[1]};qt.q3=function(t){return this.quartile(t)[2]};qt.ci=function(t){return(this._get!==t||!this._ci)&&(this._ci=Nb(this.values(),1e3,.05,t),this._get=t),this._ci};qt.ci0=function(t){return this.ci(t)[0]};qt.ci1=function(t){return this.ci(t)[1]};function Ai(t){S.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Ai.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:au},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};z(Ai,S,{transform(t,e){const n=this,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.modified();return n.stamp=i.stamp,n.value&&(r||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=r?n.init(t):{},e.visit(e.SOURCE,a=>n.add(a))):(n.value=n.value||n.init(t),e.visit(e.REM,a=>n.rem(a)),e.visit(e.ADD,a=>n.add(a))),i.modifies(n._outputs),n._drop=t.drop!==!1,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&i.clean(!0).runAfter(()=>this.clean()),n.changes(i)},cross(){const t=this,e=t.value,n=t._dnames,i=n.map(()=>({})),r=n.length;function a(u){let s,l,f,c;for(s in u)for(f=u[s].tuple,l=0;l<r;++l)i[l][c=f[n[l]]]=c}a(t._prev),a(e);function o(u,s,l){const f=n[l],c=i[l++];for(const h in c){const d=u?u+"|"+h:h;s[f]=c[h],l<r?o(d,s,l):e[d]||t.cell(d,s)}}o("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],i={};function r(p){const y=G(Zt(p)),v=y.length;let x=0,b;for(;x<v;++x)i[b=y[x]]||(i[b]=1,e.push(b))}this._dims=G(t.groupby),this._dnames=this._dims.map(p=>{const y=kt(p);return r(p),n.push(y),y}),this.cellkey=t.key?t.key:yh(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=t.fields||[null],o=t.ops||["count"],u=t.as||[],s=a.length,l={};let f,c,h,d,g,m;for(s!==o.length&&R("Unmatched number of fields and aggregate ops."),m=0;m<s;++m){if(f=a[m],c=o[m],f==null&&c!=="count"&&R("Null aggregate field specified."),d=kt(f),g=Vb(c,d,u[m]),n.push(g),c==="count"){this._counts.push(g);continue}h=l[d],h||(r(f),h=l[d]=[],h.field=f,this._measures.push(h)),c!=="count"&&(this._countOnly=!1),h.push(Xb(c,g))}return this._measures=this._measures.map(p=>Zb(p,p.field)),{}},cellkey:yh(),cell(t,e){let n=this.value[t];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const i=this._measures,r=i.length;n.agg=Array(r);for(let a=0;a<r;++a)n.agg[a]=new i[a](n)}return n.store&&(n.data=new L0),n},newtuple(t,e){const n=this._dnames,i=this._dims,r=i.length,a={};for(let o=0;o<r;++o)a[n[o]]=i[o](t);return e?Ab(e.tuple,a):ft(a)},clean(){const t=this.value;for(const e in t)t[e].num===0&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const i=n.agg;for(let r=0,a=i.length;r<a;++r)i[r].add(i[r].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const i=n.agg;for(let r=0,a=i.length;r<a;++r)i[r].rem(i[r].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let i=0,r=n.length;i<r;++i)e[n[i]]=t.num;if(!this._countOnly){const i=t.agg;for(let r=0,a=i.length;r<a;++r)i[r].set(e)}return e},changes(t){const e=this._adds,n=this._mods,i=this._prev,r=this._drop,a=t.add,o=t.rem,u=t.mod;let s,l,f,c;if(i)for(l in i)s=i[l],(!r||s.num)&&o.push(s.tuple);for(f=0,c=this._alen;f<c;++f)a.push(this.celltuple(e[f])),e[f]=null;for(f=0,c=this._mlen;f<c;++f)s=n[f],(s.num===0&&r?o:u).push(this.celltuple(s)),n[f]=null;return this._alen=this._mlen=0,this._prev=null,t}});const T4=1e-14;function P0(t){S.call(this,null,t)}P0.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};z(P0,S,{transform(t,e){const n=t.interval!==!1,i=this._bins(t),r=i.start,a=i.step,o=t.as||["bin0","bin1"],u=o[0],s=o[1];let l;return t.modified()?(e=e.reflow(!0),l=e.SOURCE):l=e.modified(Zt(t.field))?e.ADD_MOD:e.ADD,e.visit(l,n?f=>{const c=i(f);f[u]=c,f[s]=c==null?null:r+a*(1+(c-r)/a)}:f=>f[u]=i(f)),e.modifies(n?o:u)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=Rb(t),i=n.step;let r=n.start,a=r+Math.ceil((n.stop-r)/i)*i,o,u;(o=t.anchor)!=null&&(u=o-(r+i*Math.floor((o-r)/i)),r+=u,a+=u);const s=function(l){let f=Kt(e(l));return f==null?null:f<r?-1/0:f>a?1/0:(f=Math.max(r,Math.min(f,a-i)),r+i*Math.floor(T4+(f-r)/i))};return s.start=r,s.stop=n.stop,s.step=i,this.value=De(s,Zt(e),t.name||"bin_"+kt(e))}});function Jb(t,e,n){const i=t;let r=e||[],a=n||[],o={},u=0;return{add:s=>a.push(s),remove:s=>o[i(s)]=++u,size:()=>r.length,data:(s,l)=>(u&&(r=r.filter(f=>!o[i(f)]),o={},u=0),l&&s&&r.sort(s),a.length&&(r=s?bx(s,r,a.sort(s)):r.concat(a),a=[]),r)}}function I0(t){S.call(this,[],t)}I0.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};z(I0,S,{transform(t,e){const n=e.fork(e.ALL),i=Jb(j,this.value,n.materialize(n.ADD).add),r=t.sort,a=e.changed()||r&&(t.modified("sort")||e.modified(r.fields));return n.visit(n.REM,i.remove),this.modified(a),this.value=n.source=i.data(fr(r),a),e.source&&e.source.root&&(this.value.root=e.source.root),n}});function Qb(t){mt.call(this,null,R4,t)}z(Qb,mt);function R4(t){return this.value&&!t.modified()?this.value:i0(t.fields,t.orders)}function U0(t){S.call(this,null,t)}U0.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function N4(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase();break}return t.match(n)}z(U0,S,{transform(t,e){const n=c=>h=>{for(var d=N4(u(h),t.case,a)||[],g,m=0,p=d.length;m<p;++m)o.test(g=d[m])||c(g)},i=this._parameterCheck(t,e),r=this._counts,a=this._match,o=this._stop,u=t.field,s=t.as||["text","count"],l=n(c=>r[c]=1+(r[c]||0)),f=n(c=>r[c]-=1);return i?e.visit(e.SOURCE,l):(e.visit(e.ADD,l),e.visit(e.REM,f)),this._finish(e,s)},_parameterCheck(t,e){let n=!1;return(t.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),(t.modified("pattern")||!this._match)&&(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,i=this._tuples||(this._tuples={}),r=e[0],a=e[1],o=t.fork(t.NO_SOURCE|t.NO_FIELDS);let u,s,l;for(u in n)s=i[u],l=n[u]||0,!s&&l?(i[u]=s=ft({}),s[r]=u,s[a]=l,o.add.push(s)):l===0?(s&&o.rem.push(s),n[u]=null,i[u]=null):s[a]!==l&&(s[a]=l,o.mod.push(s));return o.modifies(e)}});function q0(t){S.call(this,null,t)}q0.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};z(q0,S,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.as||["a","b"],r=i[0],a=i[1],o=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let u=this.value;return o?(u&&(n.rem=u),u=e.materialize(e.SOURCE).source,n.add=this.value=O4(u,r,a,t.filter||Xe)):n.mod=u,n.source=this.value,n.modifies(i)}});function O4(t,e,n,i){for(var r=[],a={},o=t.length,u=0,s,l;u<o;++u)for(a[e]=l=t[u],s=0;s<o;++s)a[n]=t[s],i(a)&&(r.push(ft(a)),a={},a[e]=l);return r}const Np={kde:C0,mixture:Lb,normal:E0,lognormal:Bb,uniform:Pb},z4="distributions",Op="function",B4="field";function tw(t,e){const n=t[Op];V(Np,n)||R("Unknown distribution function: "+n);const i=Np[n]();for(const r in t)r===B4?i.data((t.from||e()).map(t[r])):r===z4?i[r](t[r].map(a=>tw(a,e))):typeof i[r]===Op&&i[r](t[r]);return i}function j0(t){S.call(this,null,t)}const ew=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],L4={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:ew},{name:"weights",type:"number",array:!0}]};j0.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:ew.concat(L4)},{name:"as",type:"string",array:!0,default:["value","density"]}]};z(j0,S,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=tw(t.distribution,P4(e)),r=t.steps||t.minsteps||25,a=t.steps||t.maxsteps||200;let o=t.method||"pdf";o!=="pdf"&&o!=="cdf"&&R("Invalid density method: "+o),!t.extent&&!i.data&&R("Missing density extent parameter."),o=i[o];const u=t.as||["value","density"],s=t.extent||Fn(i.data()),l=Jl(o,s,r,a).map(f=>{const c={};return c[u[0]]=f[0],c[u[1]]=f[1],ft(c)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function P4(t){return()=>t.materialize(t.SOURCE).source}function nw(t,e){return t?t.map((n,i)=>e[i]||kt(n)):null}function Y0(t,e,n){const i=[],r=c=>c(s);let a,o,u,s,l,f;if(e==null)i.push(t.map(n));else for(a={},o=0,u=t.length;o<u;++o)s=t[o],l=e.map(r),f=a[l],f||(a[l]=f=[],f.dims=l,i.push(f)),f.push(n(s));return i}const iw="bin";function H0(t){S.call(this,null,t)}H0.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:iw}]};const I4=(t,e)=>nu(Fn(t,e))/30;z(H0,S,{transform(t,e){if(this.value&&!(t.modified()||e.changed()))return e;const n=e.materialize(e.SOURCE).source,i=Y0(e.source,t.groupby,de),r=t.smooth||!1,a=t.field,o=t.step||I4(n,a),u=fr((g,m)=>a(g)-a(m)),s=t.as||iw,l=i.length;let f=1/0,c=-1/0,h=0,d;for(;h<l;++h){const g=i[h].sort(u);d=-1;for(const m of Ob(g,o,r,a))m<f&&(f=m),m>c&&(c=m),g[++d][s]=m}return this.value={start:f,stop:c,step:o},e.reflow(!0).modifies(s)}});function rw(t){mt.call(this,null,U4,t),this.modified(!0)}z(rw,mt);function U4(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:De(n=>e(n,t),Zt(e),kt(e))}function W0(t){S.call(this,[void 0,void 0],t)}W0.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};z(W0,S,{transform(t,e){const n=this.value,i=t.field,r=e.changed()||e.modified(i.fields)||t.modified("field");let a=n[0],o=n[1];if((r||a==null)&&(a=1/0,o=-1/0),e.visit(r?e.SOURCE:e.ADD,u=>{const s=Kt(i(u));s!=null&&(s<a&&(a=s),s>o&&(o=s))}),!Number.isFinite(a)||!Number.isFinite(o)){let u=kt(i);u&&(u=` for field "${u}"`),e.dataflow.warn(`Infinite extent${u}: [${a}, ${o}]`),a=o=void 0}this.value=[a,o]}});function G0(t,e){mt.call(this,t),this.parent=e,this.count=0}z(G0,mt,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}});function Ql(t){S.call(this,{},t),this._keys=ca();const e=this._targets=[];e.active=0,e.forEach=n=>{for(let i=0,r=e.active;i<r;++i)n(e[i],i,e)}}z(Ql,S,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,i){const r=this.value;let a=V(r,t)&&r[t],o,u;return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(u=i||(u=this._group[t])&&u.tuple,o=n.dataflow,a=new G0(n.fork(n.NO_SOURCE),this),o.add(a).connect(e(o,t,u)),r[t]=a,this.activate(a)),a},clean(){const t=this.value;let e=0;for(const n in t)if(t[n].count===0){const i=t[n].detachSubflow;i&&i(),delete t[n],++e}if(e){const n=this._targets.filter(i=>i&&i.count>0);this.initTargets(n)}},initTargets(t){const e=this._targets,n=e.length,i=t?t.length:0;let r=0;for(;r<i;++r)e[r]=t[r];for(;r<n&&e[r]!=null;++r)e[r]=null;e.active=i},transform(t,e){const n=e.dataflow,i=t.key,r=t.subflow,a=this._keys,o=t.modified("key"),u=s=>this.subflow(s,r,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,s=>{const l=j(s),f=a.get(l);f!==void 0&&(a.delete(l),u(f).rem(s))}),e.visit(e.ADD,s=>{const l=i(s);a.set(j(s),l),u(l).add(s)}),o||e.modified(i.fields)?e.visit(e.MOD,s=>{const l=j(s),f=a.get(l),c=i(s);f===c?u(c).mod(s):(a.set(l,c),u(f).rem(s),u(c).add(s))}):e.changed(e.MOD)&&e.visit(e.MOD,s=>{u(a.get(j(s))).mod(s)}),o&&e.visit(e.REFLOW,s=>{const l=j(s),f=a.get(l),c=i(s);f!==c&&(a.set(l,c),u(f).rem(s),u(c).add(s))}),e.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),e}});function aw(t){mt.call(this,null,q4,t)}z(aw,mt);function q4(t){return this.value&&!t.modified()?this.value:Y(t.name)?G(t.name).map(e=>ke(e)):ke(t.name,t.as)}function V0(t){S.call(this,ca(),t)}V0.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};z(V0,S,{transform(t,e){const n=e.dataflow,i=this.value,r=e.fork(),a=r.add,o=r.rem,u=r.mod,s=t.expr;let l=!0;e.visit(e.REM,c=>{const h=j(c);i.has(h)?i.delete(h):o.push(c)}),e.visit(e.ADD,c=>{s(c,t)?a.push(c):i.set(j(c),1)});function f(c){const h=j(c),d=s(c,t),g=i.get(h);d&&g?(i.delete(h),a.push(c)):!d&&!g?(i.set(h,1),o.push(c)):l&&d&&!g&&u.push(c)}return e.visit(e.MOD,f),t.modified()&&(l=!1,e.visit(e.REFLOW,f)),i.empty>n.cleanThreshold&&n.runAfter(i.clean),r}});function X0(t){S.call(this,[],t)}X0.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};z(X0,S,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.fields,r=nw(i,t.as||[]),a=t.index||null,o=r.length;return n.rem=this.value,e.visit(e.SOURCE,u=>{const s=i.map(g=>g(u)),l=s.reduce((g,m)=>Math.max(g,m.length),0);let f=0,c,h,d;for(;f<l;++f){for(h=v0(u),c=0;c<o;++c)h[r[c]]=(d=s[c][f])==null?null:d;a&&(h[a]=f),n.add.push(h)}}),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(r)}});function K0(t){S.call(this,[],t)}K0.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};z(K0,S,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.fields,r=i.map(kt),a=t.as||["key","value"],o=a[0],u=a[1],s=i.length;return n.rem=this.value,e.visit(e.SOURCE,l=>{for(let f=0,c;f<s;++f)c=v0(l),c[o]=r[f],c[u]=i[f](l),n.add.push(c)}),this.value=n.source=n.add,n.modifies(a)}});function Z0(t){S.call(this,null,t)}Z0.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};z(Z0,S,{transform(t,e){const n=t.expr,i=t.as,r=t.modified(),a=t.initonly?e.ADD:r?e.SOURCE:e.modified(n.fields)||e.modified(i)?e.ADD_MOD:e.ADD;return r&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(i),e.visit(a,o=>o[i]=n(o,t))}});function ow(t){S.call(this,[],t)}z(ow,S,{transform(t,e){const n=e.fork(e.ALL),i=t.generator;let r=this.value,a=t.size-r.length,o,u,s;if(a>0){for(o=[];--a>=0;)o.push(s=ft(i(t))),r.push(s);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else u=r.slice(0,-a),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(u):u,r=r.slice(-a);return n.source=this.value=r,n}});const Bu={value:"value",median:M4,mean:_4,min:ph,max:mh},j4=[];function J0(t){S.call(this,[],t)}J0.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function Y4(t){var e=t.method||Bu.value,n;if(Bu[e]==null)R("Unrecognized imputation method: "+e);else return e===Bu.value?(n=t.value!==void 0?t.value:0,()=>n):Bu[e]}function H4(t){const e=t.field;return n=>n?e(n):NaN}z(J0,S,{transform(t,e){var n=e.fork(e.ALL),i=Y4(t),r=H4(t),a=kt(t.field),o=kt(t.key),u=(t.groupby||[]).map(kt),s=W4(e.source,t.groupby,t.key,t.keyvals),l=[],f=this.value,c=s.domain.length,h,d,g,m,p,y,v,x,b,_;for(p=0,x=s.length;p<x;++p)for(h=s[p],g=h.values,d=NaN,v=0;v<c;++v)if(h[v]==null){for(m=s.domain[v],_={_impute:!0},y=0,b=g.length;y<b;++y)_[u[y]]=g[y];_[o]=m,_[a]=Number.isNaN(d)?d=i(h,r):d,l.push(ft(_))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),f.length&&(n.rem=n.materialize(n.REM).rem.concat(f)),this.value=l,n}});function W4(t,e,n,i){var r=y=>y(p),a=[],o=i?i.slice():[],u={},s={},l,f,c,h,d,g,m,p;for(o.forEach((y,v)=>u[y]=v+1),h=0,m=t.length;h<m;++h)p=t[h],g=n(p),d=u[g]||(u[g]=o.push(g)),f=(l=e?e.map(r):j4)+"",(c=s[f])||(c=s[f]=[],a.push(c),c.values=l),c[d-1]=p;return a.domain=o,a}function Q0(t){Ai.call(this,t)}Q0.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:au},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};z(Q0,Ai,{transform(t,e){const n=this,i=t.modified();let r;return n.value&&(i||e.modified(n._inputs,!0))?(r=n.value=i?n.init(t):{},e.visit(e.SOURCE,a=>n.add(a))):(r=n.value=n.value||this.init(t),e.visit(e.REM,a=>n.rem(a)),e.visit(e.ADD,a=>n.add(a))),n.changes(),e.visit(e.SOURCE,a=>{Z(a,r[n.cellkey(a)].tuple)}),e.reflow(i).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,i;for(n=0,i=this._alen;n<i;++n)this.celltuple(t[n]),t[n]=null;for(n=0,i=this._mlen;n<i;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}});function tg(t){S.call(this,null,t)}tg.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};z(tg,S,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=e.materialize(e.SOURCE).source,r=Y0(i,t.groupby,t.field),a=(t.groupby||[]).map(kt),o=t.bandwidth,u=t.cumulative?"cdf":"pdf",s=t.as||["value","density"],l=[];let f=t.extent,c=t.steps||t.minsteps||25,h=t.steps||t.maxsteps||200;u!=="pdf"&&u!=="cdf"&&R("Invalid density method: "+u),t.resolve==="shared"&&(f||(f=Fn(i,t.field)),c=h=t.steps||h),r.forEach(d=>{const g=C0(d,o)[u],m=t.counts?d.length:1,p=f||Fn(d);Jl(g,p,c,h).forEach(y=>{const v={};for(let x=0;x<a.length;++x)v[a[x]]=d.dims[x];v[s[0]]=y[0],v[s[1]]=y[1]*m,l.push(ft(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function uw(t){mt.call(this,null,G4,t)}z(uw,mt);function G4(t){return this.value&&!t.modified()?this.value:a0(t.fields,t.flat)}function sw(t){S.call(this,[],t),this._pending=null}z(sw,S,{transform(t,e){const n=e.dataflow;return this._pending?rc(this,e,this._pending):V4(t)?e.StopPropagation:t.values?rc(this,e,n.parse(t.values,t.format)):t.async?{async:n.request(t.url,t.format).then(r=>(this._pending=G(r.data),a=>a.touch(this)))}:n.request(t.url,t.format).then(i=>rc(this,e,G(i.data)))}});function V4(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}function rc(t,e,n){n.forEach(ft);const i=e.fork(e.NO_FIELDS&e.NO_SOURCE);return i.rem=t.value,t.value=i.source=i.add=n,t._pending=null,i.rem.length&&i.clean(!0),i}function eg(t){S.call(this,{},t)}eg.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};z(eg,S,{transform(t,e){const n=t.fields,i=t.index,r=t.values,a=t.default==null?null:t.default,o=t.modified(),u=n.length;let s=o?e.SOURCE:e.ADD,l=e,f=t.as,c,h,d;return r?(h=r.length,u>1&&!f&&R('Multi-field lookup requires explicit "as" parameter.'),f&&f.length!==u*h&&R('The "as" parameter has too few output field names.'),f=f||r.map(kt),c=function(g){for(var m=0,p=0,y,v;m<u;++m)if(v=i.get(n[m](g)),v==null)for(y=0;y<h;++y,++p)g[f[p]]=a;else for(y=0;y<h;++y,++p)g[f[p]]=r[y](v)}):(f||R("Missing output field names."),c=function(g){for(var m=0,p;m<u;++m)p=i.get(n[m](g)),g[f[m]]=p==null?a:p}),o?l=e.reflow(!0):(d=n.some(g=>e.modified(g.fields)),s|=d?e.MOD:0),e.visit(s,c),l.modifies(f)}});function lw(t){mt.call(this,null,X4,t)}z(lw,mt);function X4(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let i=1/0,r=-1/0,a,o;for(a=0;a<n;++a)o=e[a],o[0]<i&&(i=o[0]),o[1]>r&&(r=o[1]);return[i,r]}function fw(t){mt.call(this,null,K4,t)}z(fw,mt);function K4(t){return this.value&&!t.modified()?this.value:t.values.reduce((e,n)=>e.concat(n),[])}function cw(t){S.call(this,null,t)}z(cw,S,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function ng(t){Ai.call(this,t)}ng.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:au,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};z(ng,Ai,{_transform:Ai.prototype.transform,transform(t,e){return this._transform(Z4(t,e),e)}});function Z4(t,e){const n=t.field,i=t.value,r=(t.op==="count"?"__count__":t.op)||"sum",a=Zt(n).concat(Zt(i)),o=Q4(n,t.limit||0,e);return e.changed()&&t.set("__pivot__",null,null,!0),{key:t.key,groupby:t.groupby,ops:o.map(()=>r),fields:o.map(u=>J4(u,n,i,a)),as:o.map(u=>u+""),modified:t.modified.bind(t)}}function J4(t,e,n,i){return De(r=>e(r)===t?n(r):NaN,i,t+"")}function Q4(t,e,n){const i={},r=[];return n.visit(n.SOURCE,a=>{const o=t(a);i[o]||(i[o]=1,r.push(o))}),r.sort(Il),e?r.slice(0,e):r}function hw(t){Ql.call(this,t)}z(hw,Ql,{transform(t,e){const n=t.subflow,i=t.field,r=a=>this.subflow(j(a),n,e,a);return(t.modified("field")||i&&e.modified(Zt(i)))&&R("PreFacet does not support field modification."),this.initTargets(),i?(e.visit(e.MOD,a=>{const o=r(a);i(a).forEach(u=>o.mod(u))}),e.visit(e.ADD,a=>{const o=r(a);i(a).forEach(u=>o.add(ft(u)))}),e.visit(e.REM,a=>{const o=r(a);i(a).forEach(u=>o.rem(u))})):(e.visit(e.MOD,a=>r(a).mod(a)),e.visit(e.ADD,a=>r(a).add(a)),e.visit(e.REM,a=>r(a).rem(a))),e.clean()&&e.runAfter(()=>this.clean()),e}});function ig(t){S.call(this,null,t)}ig.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};z(ig,S,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.fields,r=nw(t.fields,t.as||[]),a=i?(u,s)=>t8(u,s,i,r):Hl;let o;return this.value?o=this.value:(e=e.addAll(),o=this.value={}),e.visit(e.REM,u=>{const s=j(u);n.rem.push(o[s]),o[s]=null}),e.visit(e.ADD,u=>{const s=a(u,ft({}));o[j(u)]=s,n.add.push(s)}),e.visit(e.MOD,u=>{n.mod.push(a(u,o[j(u)]))}),n}});function t8(t,e,n,i){for(let r=0,a=n.length;r<a;++r)e[i[r]]=n[r](t);return e}function dw(t){S.call(this,null,t)}z(dw,S,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});function rg(t){S.call(this,null,t)}rg.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const e8=1e-14;z(rg,S,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const r=e.materialize(e.SOURCE).source,a=Y0(r,t.groupby,t.field),o=(t.groupby||[]).map(kt),u=[],s=t.step||.01,l=t.probs||Gb(s/2,1-e8,s),f=l.length;return a.forEach(c=>{const h=_0(c,l);for(let d=0;d<f;++d){const g={};for(let m=0;m<o.length;++m)g[o[m]]=c.dims[m];g[i[0]]=l[d],g[i[1]]=h[d],u.push(ft(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u,n}});function gw(t){S.call(this,null,t)}z(gw,S,{transform(t,e){let n,i;return this.value?i=this.value:(n=e=e.addAll(),i=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,r=>{const a=j(r);n.rem.push(i[a]),i[a]=null}),e.visit(e.ADD,r=>{const a=v0(r);i[j(r)]=a,n.add.push(a)}),e.visit(e.MOD,r=>{const a=i[j(r)];for(const o in r)a[o]=r[o],n.modifies(o);n.mod.push(a)})),n}});function ag(t){S.call(this,[],t),this.count=0}ag.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};z(ag,S,{transform(t,e){const n=e.fork(e.NO_SOURCE),i=t.modified("size"),r=t.size,a=this.value.reduce((f,c)=>(f[j(c)]=1,f),{});let o=this.value,u=this.count,s=0;function l(f){let c,h;o.length<r?o.push(f):(h=~~((u+1)*Ze()),h<o.length&&h>=s&&(c=o[h],a[j(c)]&&n.rem.push(c),o[h]=f)),++u}if(e.rem.length&&(e.visit(e.REM,f=>{const c=j(f);a[c]&&(a[c]=-1,n.rem.push(f)),--u}),o=o.filter(f=>a[j(f)]!==-1)),(e.rem.length||i)&&o.length<r&&e.source&&(s=u=o.length,e.visit(e.SOURCE,f=>{a[j(f)]||l(f)}),s=-1),i&&o.length>r){const f=o.length-r;for(let c=0;c<f;++c)a[j(o[c])]=-1,n.rem.push(o[c]);o=o.slice(f)}return e.mod.length&&e.visit(e.MOD,f=>{a[j(f)]&&n.mod.push(f)}),e.add.length&&e.visit(e.ADD,l),(e.add.length||s<0)&&(n.add=o.filter(f=>!a[j(f)])),this.count=u,this.value=n.source=o,n}});function og(t){S.call(this,null,t)}og.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};z(og,S,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),i=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=Gb(t.start,t.stop,t.step||1).map(r=>{const a={};return a[i]=r,ft(a)}),n.add=e.add.concat(this.value),n}});function mw(t){S.call(this,null,t),this.modified(!0)}z(mw,S,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});function ug(t){S.call(this,null,t)}const pw=["unit0","unit1"];ug.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:g0,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:pw}]};z(ug,S,{transform(t,e){const n=t.field,i=t.interval!==!1,r=t.timezone==="utc",a=this._floor(t,e),o=(r?da:ha)(a.unit).offset,u=t.as||pw,s=u[0],l=u[1],f=a.step;let c=a.start||1/0,h=a.stop||-1/0,d=e.ADD;return(t.modified()||e.modified(Zt(n)))&&(e=e.reflow(!0),d=e.SOURCE,c=1/0,h=-1/0),e.visit(d,g=>{const m=n(g);let p,y;m==null?(g[s]=null,i&&(g[l]=null)):(g[s]=p=y=a(m),i&&(g[l]=y=o(p,f)),p<c&&(c=p),y>h&&(h=y))}),a.start=c,a.stop=h,e.modifies(i?u:s)},_floor(t,e){const n=t.timezone==="utc",{units:i,step:r}=t.units?{units:t.units,step:t.step||1}:ab({extent:t.extent||Fn(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),a=m0(i),o=this.value||{},u=(n?Kx:Xx)(a,r);return u.unit=it(a),u.units=a,u.step=r,u.start=o.start,u.stop=o.stop,this.value=u}});function yw(t){S.call(this,ca(),t)}z(yw,S,{transform(t,e){const n=e.dataflow,i=t.field,r=this.value,a=u=>r.set(i(u),u);let o=!0;return t.modified("field")||e.modified(i.fields)?(r.clear(),e.visit(e.SOURCE,a)):e.changed()?(e.visit(e.REM,u=>r.delete(i(u))),e.visit(e.ADD,a)):o=!1,this.modified(o),r.empty>n.cleanThreshold&&n.runAfter(r.clean),e.fork()}});function vw(t){S.call(this,null,t)}z(vw,S,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(fr(t.sort)):e.source).map(t.field))}});function n8(t,e,n,i){const r=zo[t](e,n);return{init:r.init||li,update:function(a,o){o[i]=r.next(a)}}}const zo={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,i=e.data;return n&&e.compare(i[n-1],i[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,i=e.data;return n&&e.compare(i[n-1],i[n])?++t:t}}},percent_rank:function(){const t=zo.rank(),e=t.next;return{init:t.init,next:n=>(e(n)-1)/(n.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,i=e.compare;let r=e.index;if(t<r){for(;r+1<n.length&&!i(n[r],n[r+1]);)++r;t=r}return(1+t)/n.length}}},ntile:function(t,e){e=+e,e>0||R("ntile num must be greater than zero.");const n=zo.cume_dist(),i=n.next;return{init:n.init,next:r=>Math.ceil(e*i(r))}},lag:function(t,e){return e=+e||1,{next:n=>{const i=n.index-e;return i>=0?t(n.data[i]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const i=n.index+e,r=n.data;return i<r.length?t(r[i]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return e=+e,e>0||R("nth_value nth must be greater than zero."),{next:n=>{const i=n.i0+(e-1);return i<n.i1?t(n.data[i]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const i=t(n.data[n.index]);return i!=null?e=i:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:i=>{const r=i.data;return i.index<=n?e:(n=i8(t,r,i.index))<0?(n=r.length,e=null):e=t(r[n])}}}};function i8(t,e,n){for(let i=e.length;n<i;++n)if(t(e[n])!=null)return n;return-1}const r8=Object.keys(zo);function xw(t){const e=G(t.ops),n=G(t.fields),i=G(t.params),r=G(t.as),a=this.outputs=[],o=this.windows=[],u={},s={},l=[],f=[];let c=!0;function h(d){G(Zt(d)).forEach(g=>u[g]=1)}h(t.sort),e.forEach((d,g)=>{const m=n[g],p=kt(m),y=Vb(d,p,r[g]);if(h(m),a.push(y),V(zo,d))o.push(n8(d,n[g],i[g],y));else{if(m==null&&d!=="count"&&R("Null aggregate field specified."),d==="count"){l.push(y);return}c=!1;let v=s[p];v||(v=s[p]=[],v.field=m,f.push(v)),v.push(Xb(d,y))}}),(l.length||f.length)&&(this.cell=a8(f,l,c)),this.inputs=Object.keys(u)}const bw=xw.prototype;bw.init=function(){this.windows.forEach(t=>t.init()),this.cell&&this.cell.init()};bw.update=function(t,e){const n=this.cell,i=this.windows,r=t.data,a=i&&i.length;let o;if(n){for(o=t.p0;o<t.i0;++o)n.rem(r[o]);for(o=t.p1;o<t.i1;++o)n.add(r[o]);n.set(e)}for(o=0;o<a;++o)i[o].update(t,e)};function a8(t,e,n){t=t.map(s=>Zb(s,s.field));const i={num:0,agg:null,store:!1,count:e};if(!n)for(var r=t.length,a=i.agg=Array(r),o=0;o<r;++o)a[o]=new t[o](i);if(i.store)var u=i.data=new L0;return i.add=function(s){if(i.num+=1,!n){u&&u.add(s);for(let l=0;l<r;++l)a[l].add(a[l].get(s),s)}},i.rem=function(s){if(i.num-=1,!n){u&&u.rem(s);for(let l=0;l<r;++l)a[l].rem(a[l].get(s),s)}},i.set=function(s){let l,f;for(u&&u.values(),l=0,f=e.length;l<f;++l)s[e[l]]=i.num;if(!n)for(l=0,f=a.length;l<f;++l)a[l].set(s)},i.init=function(){i.num=0,u&&u.reset();for(let s=0;s<r;++s)a[s].init()},i}function sg(t){S.call(this,{},t),this._mlen=0,this._mods=[]}sg.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:r8.concat(au)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};z(sg,S,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),i=fr(t.sort),r=yh(t.groupby),a=u=>this.group(r(u));let o=this.state;(!o||n)&&(o=this.state=new xw(t)),n||e.modified(o.inputs)?(this.value={},e.visit(e.SOURCE,u=>a(u).add(u))):(e.visit(e.REM,u=>a(u).remove(u)),e.visit(e.ADD,u=>a(u).add(u)));for(let u=0,s=this._mlen;u<s;++u)o8(this._mods[u],o,i,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(o.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=Jb(j),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}});function o8(t,e,n,i){const r=i.sort,a=r&&!i.ignorePeers,o=i.frame||[null,0],u=t.data(n),s=u.length,l=a?v4(r):null,f={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:r||ee(-1)};e.init();for(let c=0;c<s;++c)u8(f,o,c,s),a&&s8(f,l),e.update(f,u[c])}function u8(t,e,n,i){t.p0=t.i0,t.p1=t.i1,t.i0=e[0]==null?0:Math.max(0,n-Math.abs(e[0])),t.i1=e[1]==null?i:Math.min(i,n+Math.abs(e[1])+1),t.index=n}function s8(t,e){const n=t.i0,i=t.i1-1,r=t.compare,a=t.data,o=a.length-1;n>0&&!r(a[n],a[n-1])&&(t.i0=e.left(a,a[n])),i<o&&!r(a[i],a[i+1])&&(t.i1=e.right(a,a[i]))}var l8=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",aggregate:Ai,bin:P0,collect:I0,compare:Qb,countpattern:U0,cross:q0,density:j0,dotbin:H0,expression:rw,extent:W0,facet:Ql,field:aw,filter:V0,flatten:X0,fold:K0,formula:Z0,generate:ow,impute:J0,joinaggregate:Q0,kde:tg,key:uw,load:sw,lookup:eg,multiextent:lw,multivalues:fw,params:cw,pivot:ng,prefacet:hw,project:ig,proxy:dw,quantile:rg,relay:gw,sample:ag,sequence:og,sieve:mw,subflow:G0,timeunit:ug,tupleindex:yw,values:vw,window:sg});const vh=Math.PI,xh=2*vh,Ii=1e-6,f8=xh-Ii;function bh(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function hr(){return new bh}bh.prototype=hr.prototype={constructor:bh,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var a=this._x1,o=this._y1,u=n-t,s=i-e,l=a-t,f=o-e,c=l*l+f*f;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>Ii)if(!(Math.abs(f*u-s*l)>Ii)||!r)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var h=n-a,d=i-o,g=u*u+s*s,m=h*h+d*d,p=Math.sqrt(g),y=Math.sqrt(c),v=r*Math.tan((vh-Math.acos((g+c-m)/(2*p*y)))/2),x=v/y,b=v/p;Math.abs(x-1)>Ii&&(this._+="L"+(t+x*l)+","+(e+x*f)),this._+="A"+r+","+r+",0,0,"+ +(f*h>l*d)+","+(this._x1=t+b*u)+","+(this._y1=e+b*s)}},arc:function(t,e,n,i,r,a){t=+t,e=+e,n=+n,a=!!a;var o=n*Math.cos(i),u=n*Math.sin(i),s=t+o,l=e+u,f=1^a,c=a?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+s+","+l:(Math.abs(this._x1-s)>Ii||Math.abs(this._y1-l)>Ii)&&(this._+="L"+s+","+l),!!n&&(c<0&&(c=c%xh+xh),c>f8?this._+="A"+n+","+n+",0,1,"+f+","+(t-o)+","+(e-u)+"A"+n+","+n+",0,1,"+f+","+(this._x1=s)+","+(this._y1=l):c>Ii&&(this._+="A"+n+","+n+",0,"+ +(c>=vh)+","+f+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};function ct(t){return function(){return t}}var zp=Math.abs,Yt=Math.atan2,Bi=Math.cos,c8=Math.max,ac=Math.min,yn=Math.sin,Nr=Math.sqrt,Ht=1e-12,Kr=Math.PI,zs=Kr/2,ww=2*Kr;function h8(t){return t>1?0:t<-1?Kr:Math.acos(t)}function Bp(t){return t>=1?zs:t<=-1?-zs:Math.asin(t)}function d8(t){return t.innerRadius}function g8(t){return t.outerRadius}function m8(t){return t.startAngle}function p8(t){return t.endAngle}function y8(t){return t&&t.padAngle}function v8(t,e,n,i,r,a,o,u){var s=n-t,l=i-e,f=o-r,c=u-a,h=c*s-f*l;if(!(h*h<Ht))return h=(f*(e-a)-c*(t-r))/h,[t+h*s,e+h*l]}function Lu(t,e,n,i,r,a,o){var u=t-n,s=e-i,l=(o?a:-a)/Nr(u*u+s*s),f=l*s,c=-l*u,h=t+f,d=e+c,g=n+f,m=i+c,p=(h+g)/2,y=(d+m)/2,v=g-h,x=m-d,b=v*v+x*x,_=r-a,M=h*m-g*d,w=(x<0?-1:1)*Nr(c8(0,_*_*b-M*M)),k=(M*x-v*w)/b,C=(-M*v-x*w)/b,A=(M*x+v*w)/b,E=(-M*v+x*w)/b,F=k-p,$=C-y,O=A-p,D=E-y;return F*F+$*$>O*O+D*D&&(k=A,C=E),{cx:k,cy:C,x01:-f,y01:-c,x11:k*(r/_-1),y11:C*(r/_-1)}}function x8(){var t=d8,e=g8,n=ct(0),i=null,r=m8,a=p8,o=y8,u=null;function s(){var l,f,c=+t.apply(this,arguments),h=+e.apply(this,arguments),d=r.apply(this,arguments)-zs,g=a.apply(this,arguments)-zs,m=zp(g-d),p=g>d;if(u||(u=l=hr()),h<c&&(f=h,h=c,c=f),!(h>Ht))u.moveTo(0,0);else if(m>ww-Ht)u.moveTo(h*Bi(d),h*yn(d)),u.arc(0,0,h,d,g,!p),c>Ht&&(u.moveTo(c*Bi(g),c*yn(g)),u.arc(0,0,c,g,d,p));else{var y=d,v=g,x=d,b=g,_=m,M=m,w=o.apply(this,arguments)/2,k=w>Ht&&(i?+i.apply(this,arguments):Nr(c*c+h*h)),C=ac(zp(h-c)/2,+n.apply(this,arguments)),A=C,E=C,F,$;if(k>Ht){var O=Bp(k/c*yn(w)),D=Bp(k/h*yn(w));(_-=O*2)>Ht?(O*=p?1:-1,x+=O,b-=O):(_=0,x=b=(d+g)/2),(M-=D*2)>Ht?(D*=p?1:-1,y+=D,v-=D):(M=0,y=v=(d+g)/2)}var N=h*Bi(y),L=h*yn(y),U=c*Bi(b),W=c*yn(b);if(C>Ht){var lt=h*Bi(v),At=h*yn(v),ie=c*Bi(x),re=c*yn(x),jt;if(m<Kr&&(jt=v8(N,L,ie,re,lt,At,U,W))){var Ue=N-jt[0],_a=L-jt[1],Ma=lt-jt[0],ka=At-jt[1],P=1/yn(h8((Ue*Ma+_a*ka)/(Nr(Ue*Ue+_a*_a)*Nr(Ma*Ma+ka*ka)))/2),et=Nr(jt[0]*jt[0]+jt[1]*jt[1]);A=ac(C,(c-et)/(P-1)),E=ac(C,(h-et)/(P+1))}}M>Ht?E>Ht?(F=Lu(ie,re,N,L,h,E,p),$=Lu(lt,At,U,W,h,E,p),u.moveTo(F.cx+F.x01,F.cy+F.y01),E<C?u.arc(F.cx,F.cy,E,Yt(F.y01,F.x01),Yt($.y01,$.x01),!p):(u.arc(F.cx,F.cy,E,Yt(F.y01,F.x01),Yt(F.y11,F.x11),!p),u.arc(0,0,h,Yt(F.cy+F.y11,F.cx+F.x11),Yt($.cy+$.y11,$.cx+$.x11),!p),u.arc($.cx,$.cy,E,Yt($.y11,$.x11),Yt($.y01,$.x01),!p))):(u.moveTo(N,L),u.arc(0,0,h,y,v,!p)):u.moveTo(N,L),!(c>Ht)||!(_>Ht)?u.lineTo(U,W):A>Ht?(F=Lu(U,W,lt,At,c,-A,p),$=Lu(N,L,ie,re,c,-A,p),u.lineTo(F.cx+F.x01,F.cy+F.y01),A<C?u.arc(F.cx,F.cy,A,Yt(F.y01,F.x01),Yt($.y01,$.x01),!p):(u.arc(F.cx,F.cy,A,Yt(F.y01,F.x01),Yt(F.y11,F.x11),!p),u.arc(0,0,c,Yt(F.cy+F.y11,F.cx+F.x11),Yt($.cy+$.y11,$.cx+$.x11),p),u.arc($.cx,$.cy,A,Yt($.y11,$.x11),Yt($.y01,$.x01),!p))):u.arc(0,0,c,b,x,p)}if(u.closePath(),l)return u=null,l+""||null}return s.centroid=function(){var l=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,f=(+r.apply(this,arguments)+ +a.apply(this,arguments))/2-Kr/2;return[Bi(f)*l,yn(f)*l]},s.innerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:ct(+l),s):t},s.outerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:ct(+l),s):e},s.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:ct(+l),s):n},s.padRadius=function(l){return arguments.length?(i=l==null?null:typeof l=="function"?l:ct(+l),s):i},s.startAngle=function(l){return arguments.length?(r=typeof l=="function"?l:ct(+l),s):r},s.endAngle=function(l){return arguments.length?(a=typeof l=="function"?l:ct(+l),s):a},s.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:ct(+l),s):o},s.context=function(l){return arguments.length?(u=l==null?null:l,s):u},s}function _w(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Mw(t){this._context=t}Mw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function lg(t){return new Mw(t)}function kw(t){return t[0]}function Aw(t){return t[1]}function Ew(t,e){var n=ct(!0),i=null,r=lg,a=null;t=typeof t=="function"?t:t===void 0?kw:ct(t),e=typeof e=="function"?e:e===void 0?Aw:ct(e);function o(u){var s,l=(u=_w(u)).length,f,c=!1,h;for(i==null&&(a=r(h=hr())),s=0;s<=l;++s)!(s<l&&n(f=u[s],s,u))===c&&((c=!c)?a.lineStart():a.lineEnd()),c&&a.point(+t(f,s,u),+e(f,s,u));if(h)return a=null,h+""||null}return o.x=function(u){return arguments.length?(t=typeof u=="function"?u:ct(+u),o):t},o.y=function(u){return arguments.length?(e=typeof u=="function"?u:ct(+u),o):e},o.defined=function(u){return arguments.length?(n=typeof u=="function"?u:ct(!!u),o):n},o.curve=function(u){return arguments.length?(r=u,i!=null&&(a=r(i)),o):r},o.context=function(u){return arguments.length?(u==null?i=a=null:a=r(i=u),o):i},o}function Cw(t,e,n){var i=null,r=ct(!0),a=null,o=lg,u=null;t=typeof t=="function"?t:t===void 0?kw:ct(+t),e=typeof e=="function"?e:ct(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?Aw:ct(+n);function s(f){var c,h,d,g=(f=_w(f)).length,m,p=!1,y,v=new Array(g),x=new Array(g);for(a==null&&(u=o(y=hr())),c=0;c<=g;++c){if(!(c<g&&r(m=f[c],c,f))===p)if(p=!p)h=c,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),d=c-1;d>=h;--d)u.point(v[d],x[d]);u.lineEnd(),u.areaEnd()}p&&(v[c]=+t(m,c,f),x[c]=+e(m,c,f),u.point(i?+i(m,c,f):v[c],n?+n(m,c,f):x[c]))}if(y)return u=null,y+""||null}function l(){return Ew().defined(r).curve(o).context(a)}return s.x=function(f){return arguments.length?(t=typeof f=="function"?f:ct(+f),i=null,s):t},s.x0=function(f){return arguments.length?(t=typeof f=="function"?f:ct(+f),s):t},s.x1=function(f){return arguments.length?(i=f==null?null:typeof f=="function"?f:ct(+f),s):i},s.y=function(f){return arguments.length?(e=typeof f=="function"?f:ct(+f),n=null,s):e},s.y0=function(f){return arguments.length?(e=typeof f=="function"?f:ct(+f),s):e},s.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:ct(+f),s):n},s.lineX0=s.lineY0=function(){return l().x(t).y(e)},s.lineY1=function(){return l().x(t).y(n)},s.lineX1=function(){return l().x(i).y(e)},s.defined=function(f){return arguments.length?(r=typeof f=="function"?f:ct(!!f),s):r},s.curve=function(f){return arguments.length?(o=f,a!=null&&(u=o(a)),s):o},s.context=function(f){return arguments.length?(f==null?a=u=null:u=o(a=f),s):a},s}var b8={draw:function(t,e){var n=Math.sqrt(e/Kr);t.moveTo(n,0),t.arc(0,0,n,0,ww)}};function w8(t,e){var n=null;t=typeof t=="function"?t:ct(t||b8),e=typeof e=="function"?e:ct(e===void 0?64:+e);function i(){var r;if(n||(n=r=hr()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return i.type=function(r){return arguments.length?(t=typeof r=="function"?r:ct(r),i):t},i.size=function(r){return arguments.length?(e=typeof r=="function"?r:ct(+r),i):e},i.context=function(r){return arguments.length?(n=r==null?null:r,i):n},i}function Ei(){}function Bs(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function tf(t){this._context=t}tf.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Bs(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Bs(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function _8(t){return new tf(t)}function Dw(t){this._context=t}Dw.prototype={areaStart:Ei,areaEnd:Ei,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Bs(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function M8(t){return new Dw(t)}function Sw(t){this._context=t}Sw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,i=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:Bs(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function k8(t){return new Sw(t)}function Fw(t,e){this._basis=new tf(t),this._beta=e}Fw.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var i=t[0],r=e[0],a=t[n]-i,o=e[n]-r,u=-1,s;++u<=n;)s=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(i+s*a),this._beta*e[u]+(1-this._beta)*(r+s*o));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var A8=function t(e){function n(i){return e===1?new tf(i):new Fw(i,e)}return n.beta=function(i){return t(+i)},n}(.85);function Ls(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function fg(t,e){this._context=t,this._k=(1-e)/6}fg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ls(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Ls(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var E8=function t(e){function n(i){return new fg(i,e)}return n.tension=function(i){return t(+i)},n}(0);function cg(t,e){this._context=t,this._k=(1-e)/6}cg.prototype={areaStart:Ei,areaEnd:Ei,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Ls(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var C8=function t(e){function n(i){return new cg(i,e)}return n.tension=function(i){return t(+i)},n}(0);function hg(t,e){this._context=t,this._k=(1-e)/6}hg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ls(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var D8=function t(e){function n(i){return new hg(i,e)}return n.tension=function(i){return t(+i)},n}(0);function dg(t,e,n){var i=t._x1,r=t._y1,a=t._x2,o=t._y2;if(t._l01_a>Ht){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,s=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/s,r=(r*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/s}if(t._l23_a>Ht){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/f,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/f}t._context.bezierCurveTo(i,r,a,o,t._x2,t._y2)}function $w(t,e){this._context=t,this._alpha=e}$w.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:dg(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var S8=function t(e){function n(i){return e?new $w(i,e):new fg(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function Tw(t,e){this._context=t,this._alpha=e}Tw.prototype={areaStart:Ei,areaEnd:Ei,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:dg(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var F8=function t(e){function n(i){return e?new Tw(i,e):new cg(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function Rw(t,e){this._context=t,this._alpha=e}Rw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:dg(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var $8=function t(e){function n(i){return e?new Rw(i,e):new hg(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function Nw(t){this._context=t}Nw.prototype={areaStart:Ei,areaEnd:Ei,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function T8(t){return new Nw(t)}function Lp(t){return t<0?-1:1}function Pp(t,e,n){var i=t._x1-t._x0,r=e-t._x1,a=(t._y1-t._y0)/(i||r<0&&-0),o=(n-t._y1)/(r||i<0&&-0),u=(a*r+o*i)/(i+r);return(Lp(a)+Lp(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function Ip(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function oc(t,e,n){var i=t._x0,r=t._y0,a=t._x1,o=t._y1,u=(a-i)/3;t._context.bezierCurveTo(i+u,r+u*e,a-u,o-u*n,a,o)}function Ps(t){this._context=t}Ps.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:oc(this,this._t0,Ip(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,oc(this,Ip(this,n=Pp(this,t,e)),n);break;default:oc(this,this._t0,n=Pp(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function Ow(t){this._context=new zw(t)}(Ow.prototype=Object.create(Ps.prototype)).point=function(t,e){Ps.prototype.point.call(this,e,t)};function zw(t){this._context=t}zw.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,a){this._context.bezierCurveTo(e,t,i,n,a,r)}};function R8(t){return new Ps(t)}function N8(t){return new Ow(t)}function Bw(t){this._context=t}Bw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var i=Up(t),r=Up(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(i[0][a],r[0][a],i[1][a],r[1][a],t[o],e[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function Up(t){var e,n=t.length-1,i,r=new Array(n),a=new Array(n),o=new Array(n);for(r[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<n-1;++e)r[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(r[n-1]=2,a[n-1]=7,o[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)i=r[e]/a[e-1],a[e]-=i,o[e]-=i*o[e-1];for(r[n-1]=o[n-1]/a[n-1],e=n-2;e>=0;--e)r[e]=(o[e]-r[e+1])/a[e];for(a[n-1]=(t[n]+r[n-1])/2,e=0;e<n-1;++e)a[e]=2*t[e+1]-r[e+1];return[r,a]}function O8(t){return new Bw(t)}function ef(t,e){this._context=t,this._t=e}ef.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function z8(t){return new ef(t,.5)}function B8(t){return new ef(t,0)}function L8(t){return new ef(t,1)}function ma(t,e){if(typeof document!="undefined"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}const P8=()=>typeof Image!="undefined"?Image:null;function gg(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function mg(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=I8(t));function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=i(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:i,center:a,right:r}}function I8(t){return(e,n)=>gg(t(e),n)}function Lw(t){return t===null?NaN:+t}const U8=mg(gg),wh=U8.right;mg(Lw).center;var ou=wh,_h=Math.sqrt(50),Mh=Math.sqrt(10),kh=Math.sqrt(2);function Ah(t,e,n){var i,r=-1,a,o,u;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((i=e<t)&&(a=t,t=e,e=a),(u=Pw(t,e,n))===0||!isFinite(u))return[];if(u>0){let s=Math.round(t/u),l=Math.round(e/u);for(s*u<t&&++s,l*u>e&&--l,o=new Array(a=l-s+1);++r<a;)o[r]=(s+r)*u}else{u=-u;let s=Math.round(t*u),l=Math.round(e*u);for(s/u<t&&++s,l/u>e&&--l,o=new Array(a=l-s+1);++r<a;)o[r]=(s+r)/u}return i&&o.reverse(),o}function Pw(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return r>=0?(a>=_h?10:a>=Mh?5:a>=kh?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(a>=_h?10:a>=Mh?5:a>=kh?2:1)}function Eh(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=_h?r*=10:a>=Mh?r*=5:a>=kh&&(r*=2),e<t?-r:r}function q8(t,e,n=Lw){if(!!(i=t.length)){if((e=+e)<=0||i<2)return+n(t[0],0,t);if(e>=1)return+n(t[i-1],i-1,t);var i,r=(i-1)*e,a=Math.floor(r),o=+n(t[a],a,t),u=+n(t[a+1],a+1,t);return o+(u-o)*(r-a)}}function j8(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);++i<r;)a[i]=t+i*n;return a}function Nn(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Ri(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Ch=Symbol("implicit");function pg(){var t=new Map,e=[],n=[],i=Ch;function r(a){var o=a+"",u=t.get(o);if(!u){if(i!==Ch)return i;t.set(o,u=e.push(a))}return n[(u-1)%n.length]}return r.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new Map;for(const o of a){const u=o+"";t.has(u)||t.set(u,e.push(o))}return r},r.range=function(a){return arguments.length?(n=Array.from(a),r):n.slice()},r.unknown=function(a){return arguments.length?(i=a,r):i},r.copy=function(){return pg(e,n).unknown(i)},Nn.apply(r,arguments),r}function Iw(t,e,n,i,r){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*i+o*r)/6}function Uw(t){var e=t.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[i],a=t[i+1],o=i>0?t[i-1]:2*r-a,u=i<e-1?t[i+2]:2*a-r;return Iw((n-i/e)*e,o,r,a,u)}}function qw(t){var e=t.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*e),r=t[(i+e-1)%e],a=t[i%e],o=t[(i+1)%e],u=t[(i+2)%e];return Iw((n-i/e)*e,r,a,o,u)}}var nf=t=>()=>t;function jw(t,e){return function(n){return t+n*e}}function Y8(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function rf(t,e){var n=e-t;return n?jw(t,n>180||n<-180?n-360*Math.round(n/360):n):nf(isNaN(t)?e:t)}function H8(t){return(t=+t)==1?Tt:function(e,n){return n-e?Y8(e,n,t):nf(isNaN(e)?n:e)}}function Tt(t,e){var n=e-t;return n?jw(t,n):nf(isNaN(t)?e:t)}var Dh=function t(e){var n=H8(e);function i(r,a){var o=n((r=Fo(r)).r,(a=Fo(a)).r),u=n(r.g,a.g),s=n(r.b,a.b),l=Tt(r.opacity,a.opacity);return function(f){return r.r=o(f),r.g=u(f),r.b=s(f),r.opacity=l(f),r+""}}return i.gamma=t,i}(1);function Yw(t){return function(e){var n=e.length,i=new Array(n),r=new Array(n),a=new Array(n),o,u;for(o=0;o<n;++o)u=Fo(e[o]),i[o]=u.r||0,r[o]=u.g||0,a[o]=u.b||0;return i=t(i),r=t(r),a=t(a),u.opacity=1,function(s){return u.r=i(s),u.g=r(s),u.b=a(s),u+""}}}var W8=Yw(Uw),G8=Yw(qw);function yg(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(a){for(r=0;r<n;++r)i[r]=t[r]*(1-a)+e[r]*a;return i}}function Hw(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function V8(t,e){return(Hw(e)?yg:Ww)(t,e)}function Ww(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),a=new Array(n),o;for(o=0;o<i;++o)r[o]=dr(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(u){for(o=0;o<i;++o)a[o]=r[o](u);return a}}function Gw(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function nn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Vw(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=dr(t[r],e[r]):i[r]=e[r];return function(a){for(r in n)i[r]=n[r](a);return i}}var Sh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,uc=new RegExp(Sh.source,"g");function X8(t){return function(){return t}}function K8(t){return function(e){return t(e)+""}}function Xw(t,e){var n=Sh.lastIndex=uc.lastIndex=0,i,r,a,o=-1,u=[],s=[];for(t=t+"",e=e+"";(i=Sh.exec(t))&&(r=uc.exec(e));)(a=r.index)>n&&(a=e.slice(n,a),u[o]?u[o]+=a:u[++o]=a),(i=i[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:nn(i,r)})),n=uc.lastIndex;return n<e.length&&(a=e.slice(n),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?K8(s[0].x):X8(e):(e=s.length,function(l){for(var f=0,c;f<e;++f)u[(c=s[f]).i]=c.x(l);return u.join("")})}function dr(t,e){var n=typeof e,i;return e==null||n==="boolean"?nf(e):(n==="number"?nn:n==="string"?(i=Fs(e))?(e=i,Dh):Xw:e instanceof Fs?Dh:e instanceof Date?Gw:Hw(e)?yg:Array.isArray(e)?Ww:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Vw:nn)(t,e)}function Z8(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function J8(t,e){var n=rf(+t,+e);return function(i){var r=n(i);return r-360*Math.floor(r/360)}}function af(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var qp=180/Math.PI,Fh={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Kw(t,e,n,i,r,a){var o,u,s;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(s=t*n+e*i)&&(n-=t*s,i-=e*s),(u=Math.sqrt(n*n+i*i))&&(n/=u,i/=u,s/=u),t*i<e*n&&(t=-t,e=-e,s=-s,o=-o),{translateX:r,translateY:a,rotate:Math.atan2(e,t)*qp,skewX:Math.atan(s)*qp,scaleX:o,scaleY:u}}var Pu;function Q8(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Fh:Kw(e.a,e.b,e.c,e.d,e.e,e.f)}function tD(t){return t==null||(Pu||(Pu=document.createElementNS("http://www.w3.org/2000/svg","g")),Pu.setAttribute("transform",t),!(t=Pu.transform.baseVal.consolidate()))?Fh:(t=t.matrix,Kw(t.a,t.b,t.c,t.d,t.e,t.f))}function Zw(t,e,n,i){function r(l){return l.length?l.pop()+" ":""}function a(l,f,c,h,d,g){if(l!==c||f!==h){var m=d.push("translate(",null,e,null,n);g.push({i:m-4,x:nn(l,c)},{i:m-2,x:nn(f,h)})}else(c||h)&&d.push("translate("+c+e+h+n)}function o(l,f,c,h){l!==f?(l-f>180?f+=360:f-l>180&&(l+=360),h.push({i:c.push(r(c)+"rotate(",null,i)-2,x:nn(l,f)})):f&&c.push(r(c)+"rotate("+f+i)}function u(l,f,c,h){l!==f?h.push({i:c.push(r(c)+"skewX(",null,i)-2,x:nn(l,f)}):f&&c.push(r(c)+"skewX("+f+i)}function s(l,f,c,h,d,g){if(l!==c||f!==h){var m=d.push(r(d)+"scale(",null,",",null,")");g.push({i:m-4,x:nn(l,c)},{i:m-2,x:nn(f,h)})}else(c!==1||h!==1)&&d.push(r(d)+"scale("+c+","+h+")")}return function(l,f){var c=[],h=[];return l=t(l),f=t(f),a(l.translateX,l.translateY,f.translateX,f.translateY,c,h),o(l.rotate,f.rotate,c,h),u(l.skewX,f.skewX,c,h),s(l.scaleX,l.scaleY,f.scaleX,f.scaleY,c,h),l=f=null,function(d){for(var g=-1,m=h.length,p;++g<m;)c[(p=h[g]).i]=p.x(d);return c.join("")}}}var eD=Zw(Q8,"px, ","px)","deg)"),nD=Zw(tD,", ",")",")"),iD=1e-12;function jp(t){return((t=Math.exp(t))+1/t)/2}function rD(t){return((t=Math.exp(t))-1/t)/2}function aD(t){return((t=Math.exp(2*t))-1)/(t+1)}var oD=function t(e,n,i){function r(a,o){var u=a[0],s=a[1],l=a[2],f=o[0],c=o[1],h=o[2],d=f-u,g=c-s,m=d*d+g*g,p,y;if(m<iD)y=Math.log(h/l)/e,p=function(w){return[u+w*d,s+w*g,l*Math.exp(e*w*y)]};else{var v=Math.sqrt(m),x=(h*h-l*l+i*m)/(2*l*n*v),b=(h*h-l*l-i*m)/(2*h*n*v),_=Math.log(Math.sqrt(x*x+1)-x),M=Math.log(Math.sqrt(b*b+1)-b);y=(M-_)/e,p=function(w){var k=w*y,C=jp(_),A=l/(n*v)*(C*aD(e*k+_)-rD(_));return[u+A*d,s+A*g,l*C/jp(e*k+_)]}}return p.duration=y*1e3*e/Math.SQRT2,p}return r.rho=function(a){var o=Math.max(.001,+a),u=o*o,s=u*u;return t(o,u,s)},r}(Math.SQRT2,2,4);function Jw(t){return function(e,n){var i=t((e=Gm(e)).h,(n=Gm(n)).h),r=Tt(e.s,n.s),a=Tt(e.l,n.l),o=Tt(e.opacity,n.opacity);return function(u){return e.h=i(u),e.s=r(u),e.l=a(u),e.opacity=o(u),e+""}}}var uD=Jw(rf),sD=Jw(Tt);function lD(t,e){var n=Tt((t=Vm(t)).l,(e=Vm(e)).l),i=Tt(t.a,e.a),r=Tt(t.b,e.b),a=Tt(t.opacity,e.opacity);return function(o){return t.l=n(o),t.a=i(o),t.b=r(o),t.opacity=a(o),t+""}}function Qw(t){return function(e,n){var i=t((e=Xm(e)).h,(n=Xm(n)).h),r=Tt(e.c,n.c),a=Tt(e.l,n.l),o=Tt(e.opacity,n.opacity);return function(u){return e.h=i(u),e.c=r(u),e.l=a(u),e.opacity=o(u),e+""}}}var fD=Qw(rf),cD=Qw(Tt);function t_(t){return function e(n){n=+n;function i(r,a){var o=t((r=Km(r)).h,(a=Km(a)).h),u=Tt(r.s,a.s),s=Tt(r.l,a.l),l=Tt(r.opacity,a.opacity);return function(f){return r.h=o(f),r.s=u(f),r.l=s(Math.pow(f,n)),r.opacity=l(f),r+""}}return i.gamma=e,i}(1)}var hD=t_(rf),dD=t_(Tt);function vg(t,e){e===void 0&&(e=t,t=dr);for(var n=0,i=e.length-1,r=e[0],a=new Array(i<0?0:i);n<i;)a[n]=t(r,r=e[++n]);return function(o){var u=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return a[u](o-u)}}function gD(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t(i/(e-1));return n}var mD=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",interpolate:dr,interpolateArray:V8,interpolateBasis:Uw,interpolateBasisClosed:qw,interpolateDate:Gw,interpolateDiscrete:Z8,interpolateHue:J8,interpolateNumber:nn,interpolateNumberArray:yg,interpolateObject:Vw,interpolateRound:af,interpolateString:Xw,interpolateTransformCss:eD,interpolateTransformSvg:nD,interpolateZoom:oD,interpolateRgb:Dh,interpolateRgbBasis:W8,interpolateRgbBasisClosed:G8,interpolateHsl:uD,interpolateHslLong:sD,interpolateLab:lD,interpolateHcl:fD,interpolateHclLong:cD,interpolateCubehelix:hD,interpolateCubehelixLong:dD,piecewise:vg,quantize:gD});function pD(t){return function(){return t}}function $h(t){return+t}var Yp=[0,1];function _e(t){return t}function Th(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:pD(isNaN(e)?NaN:.5)}function yD(t,e){var n;return t>e&&(n=t,t=e,e=n),function(i){return Math.max(t,Math.min(e,i))}}function vD(t,e,n){var i=t[0],r=t[1],a=e[0],o=e[1];return r<i?(i=Th(r,i),a=n(o,a)):(i=Th(i,r),a=n(a,o)),function(u){return a(i(u))}}function xD(t,e,n){var i=Math.min(t.length,e.length)-1,r=new Array(i),a=new Array(i),o=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<i;)r[o]=Th(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(u){var s=ou(t,u,1,i)-1;return a[s](r[s](u))}}function uu(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function of(){var t=Yp,e=Yp,n=dr,i,r,a,o=_e,u,s,l;function f(){var h=Math.min(t.length,e.length);return o!==_e&&(o=yD(t[0],t[h-1])),u=h>2?xD:vD,s=l=null,c}function c(h){return h==null||isNaN(h=+h)?a:(s||(s=u(t.map(i),e,n)))(i(o(h)))}return c.invert=function(h){return o(r((l||(l=u(e,t.map(i),nn)))(h)))},c.domain=function(h){return arguments.length?(t=Array.from(h,$h),f()):t.slice()},c.range=function(h){return arguments.length?(e=Array.from(h),f()):e.slice()},c.rangeRound=function(h){return e=Array.from(h),n=af,f()},c.clamp=function(h){return arguments.length?(o=h?!0:_e,f()):o!==_e},c.interpolate=function(h){return arguments.length?(n=h,f()):n},c.unknown=function(h){return arguments.length?(a=h,c):a},function(h,d){return i=h,r=d,f()}}function e_(){return of()(_e,_e)}function n_(t,e,n,i){var r=Eh(t,e,n),a;switch(i=kA(i==null?",f":i),i.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return i.precision==null&&!isNaN(a=CA(r,o))&&(i.precision=a),DA(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(a=EA(r,Math.max(Math.abs(t),Math.abs(e))))&&(i.precision=a-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(a=AA(r))&&(i.precision=a-(i.type==="%")*2);break}}return Gv(i)}function gr(t){var e=t.domain;return t.ticks=function(n){var i=e();return Ah(i[0],i[i.length-1],n==null?10:n)},t.tickFormat=function(n,i){var r=e();return n_(r[0],r[r.length-1],n==null?10:n,i)},t.nice=function(n){n==null&&(n=10);var i=e(),r=0,a=i.length-1,o=i[r],u=i[a],s,l,f=10;for(u<o&&(l=o,o=u,u=l,l=r,r=a,a=l);f-- >0;){if(l=Pw(o,u,n),l===s)return i[r]=o,i[a]=u,e(i);if(l>0)o=Math.floor(o/l)*l,u=Math.ceil(u/l)*l;else if(l<0)o=Math.ceil(o*l)/l,u=Math.floor(u*l)/l;else break;s=l}return t},t}function i_(){var t=e_();return t.copy=function(){return uu(t,i_())},Nn.apply(t,arguments),gr(t)}function r_(t){var e;function n(i){return i==null||isNaN(i=+i)?e:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(t=Array.from(i,$h),n):t.slice()},n.unknown=function(i){return arguments.length?(e=i,n):e},n.copy=function(){return r_(t).unknown(e)},t=arguments.length?Array.from(t,$h):[0,1],gr(n)}function a_(t,e){t=t.slice();var n=0,i=t.length-1,r=t[n],a=t[i],o;return a<r&&(o=n,n=i,i=o,o=r,r=a,a=o),t[n]=e.floor(r),t[i]=e.ceil(a),t}function Hp(t){return Math.log(t)}function Wp(t){return Math.exp(t)}function bD(t){return-Math.log(-t)}function wD(t){return-Math.exp(-t)}function _D(t){return isFinite(t)?+("1e"+t):t<0?0:t}function MD(t){return t===10?_D:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function kD(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function Gp(t){return function(e){return-t(-e)}}function xg(t){var e=t(Hp,Wp),n=e.domain,i=10,r,a;function o(){return r=kD(i),a=MD(i),n()[0]<0?(r=Gp(r),a=Gp(a),t(bD,wD)):t(Hp,Wp),e}return e.base=function(u){return arguments.length?(i=+u,o()):i},e.domain=function(u){return arguments.length?(n(u),o()):n()},e.ticks=function(u){var s=n(),l=s[0],f=s[s.length-1],c;(c=f<l)&&(h=l,l=f,f=h);var h=r(l),d=r(f),g,m,p,y=u==null?10:+u,v=[];if(!(i%1)&&d-h<y){if(h=Math.floor(h),d=Math.ceil(d),l>0){for(;h<=d;++h)for(m=1,g=a(h);m<i;++m)if(p=g*m,!(p<l)){if(p>f)break;v.push(p)}}else for(;h<=d;++h)for(m=i-1,g=a(h);m>=1;--m)if(p=g*m,!(p<l)){if(p>f)break;v.push(p)}v.length*2<y&&(v=Ah(l,f,y))}else v=Ah(h,d,Math.min(d-h,y)).map(a);return c?v.reverse():v},e.tickFormat=function(u,s){if(s==null&&(s=i===10?".0e":","),typeof s!="function"&&(s=Gv(s)),u===1/0)return s;u==null&&(u=10);var l=Math.max(1,i*u/e.ticks().length);return function(f){var c=f/a(Math.round(r(f)));return c*i<i-.5&&(c*=i),c<=l?s(f):""}},e.nice=function(){return n(a_(n(),{floor:function(u){return a(Math.floor(r(u)))},ceil:function(u){return a(Math.ceil(r(u)))}}))},e}function o_(){var t=xg(of()).domain([1,10]);return t.copy=function(){return uu(t,o_()).base(t.base())},Nn.apply(t,arguments),t}function Vp(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function Xp(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function bg(t){var e=1,n=t(Vp(e),Xp(e));return n.constant=function(i){return arguments.length?t(Vp(e=+i),Xp(e)):e},gr(n)}function u_(){var t=bg(of());return t.copy=function(){return uu(t,u_()).constant(t.constant())},Nn.apply(t,arguments)}function Kp(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function AD(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function ED(t){return t<0?-t*t:t*t}function wg(t){var e=t(_e,_e),n=1;function i(){return n===1?t(_e,_e):n===.5?t(AD,ED):t(Kp(n),Kp(1/n))}return e.exponent=function(r){return arguments.length?(n=+r,i()):n},gr(e)}function _g(){var t=wg(of());return t.copy=function(){return uu(t,_g()).exponent(t.exponent())},Nn.apply(t,arguments),t}function CD(){return _g.apply(null,arguments).exponent(.5)}function s_(){var t=[],e=[],n=[],i;function r(){var o=0,u=Math.max(1,e.length);for(n=new Array(u-1);++o<u;)n[o-1]=q8(t,o/u);return a}function a(o){return o==null||isNaN(o=+o)?i:e[ou(n,o)]}return a.invertExtent=function(o){var u=e.indexOf(o);return u<0?[NaN,NaN]:[u>0?n[u-1]:t[0],u<n.length?n[u]:t[t.length-1]]},a.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let u of o)u!=null&&!isNaN(u=+u)&&t.push(u);return t.sort(gg),r()},a.range=function(o){return arguments.length?(e=Array.from(o),r()):e.slice()},a.unknown=function(o){return arguments.length?(i=o,a):i},a.quantiles=function(){return n.slice()},a.copy=function(){return s_().domain(t).range(e).unknown(i)},Nn.apply(a,arguments)}function l_(){var t=0,e=1,n=1,i=[.5],r=[0,1],a;function o(s){return s!=null&&s<=s?r[ou(i,s,0,n)]:a}function u(){var s=-1;for(i=new Array(n);++s<n;)i[s]=((s+1)*e-(s-n)*t)/(n+1);return o}return o.domain=function(s){return arguments.length?([t,e]=s,t=+t,e=+e,u()):[t,e]},o.range=function(s){return arguments.length?(n=(r=Array.from(s)).length-1,u()):r.slice()},o.invertExtent=function(s){var l=r.indexOf(s);return l<0?[NaN,NaN]:l<1?[t,i[0]]:l>=n?[i[n-1],e]:[i[l-1],i[l]]},o.unknown=function(s){return arguments.length&&(a=s),o},o.thresholds=function(){return i.slice()},o.copy=function(){return l_().domain([t,e]).range(r).unknown(a)},Nn.apply(gr(o),arguments)}function f_(){var t=[.5],e=[0,1],n,i=1;function r(a){return a!=null&&a<=a?e[ou(t,a,0,i)]:n}return r.domain=function(a){return arguments.length?(t=Array.from(a),i=Math.min(t.length,e.length-1),r):t.slice()},r.range=function(a){return arguments.length?(e=Array.from(a),i=Math.min(t.length,e.length-1),r):e.slice()},r.invertExtent=function(a){var o=e.indexOf(a);return[t[o-1],t[o]]},r.unknown=function(a){return arguments.length?(n=a,r):n},r.copy=function(){return f_().domain(t).range(e).unknown(n)},Nn.apply(r,arguments)}var sc=new Date,lc=new Date;function Lt(t,e,n,i){function r(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return r.floor=function(a){return t(a=new Date(+a)),a},r.ceil=function(a){return t(a=new Date(a-1)),e(a,1),t(a),a},r.round=function(a){var o=r(a),u=r.ceil(a);return a-o<u-a?o:u},r.offset=function(a,o){return e(a=new Date(+a),o==null?1:Math.floor(o)),a},r.range=function(a,o,u){var s=[],l;if(a=r.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return s;do s.push(l=new Date(+a)),e(a,u),t(a);while(l<a&&a<o);return s},r.filter=function(a){return Lt(function(o){if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},function(o,u){if(o>=o)if(u<0)for(;++u<=0;)for(;e(o,-1),!a(o););else for(;--u>=0;)for(;e(o,1),!a(o););})},n&&(r.count=function(a,o){return sc.setTime(+a),lc.setTime(+o),t(sc),t(lc),Math.floor(n(sc,lc))},r.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?r.filter(i?function(o){return i(o)%a===0}:function(o){return r.count(0,o)%a===0}):r}),r}var Rh=Lt(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Rh.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Lt(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Rh};var DD=Rh;const Yn=1e3,je=Yn*60,Hn=je*60,Ji=Hn*24,Mg=Ji*7,Zp=Ji*30,fc=Ji*365;var SD=Lt(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*Yn)},function(t,e){return(e-t)/Yn},function(t){return t.getUTCSeconds()}),Or=SD,FD=Lt(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Yn)},function(t,e){t.setTime(+t+e*je)},function(t,e){return(e-t)/je},function(t){return t.getMinutes()}),c_=FD,$D=Lt(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Yn-t.getMinutes()*je)},function(t,e){t.setTime(+t+e*Hn)},function(t,e){return(e-t)/Hn},function(t){return t.getHours()}),h_=$D,TD=Lt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*je)/Ji,t=>t.getDate()-1),d_=TD;function mr(t){return Lt(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n*7)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*je)/Mg})}var g_=mr(0);mr(1);mr(2);mr(3);mr(4);mr(5);mr(6);var RD=Lt(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()}),m_=RD,p_=Lt(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});p_.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Lt(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)})};var y_=p_,ND=Lt(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*je)},function(t,e){return(e-t)/je},function(t){return t.getUTCMinutes()}),v_=ND,OD=Lt(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*Hn)},function(t,e){return(e-t)/Hn},function(t){return t.getUTCHours()}),x_=OD,zD=Lt(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/Ji},function(t){return t.getUTCDate()-1}),b_=zD;function pr(t){return Lt(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n*7)},function(e,n){return(n-e)/Mg})}var w_=pr(0);pr(1);pr(2);pr(3);pr(4);pr(5);pr(6);var BD=Lt(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()}),__=BD,M_=Lt(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});M_.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Lt(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})};var k_=M_;function A_(t,e,n,i,r,a){const o=[[Or,1,Yn],[Or,5,5*Yn],[Or,15,15*Yn],[Or,30,30*Yn],[a,1,je],[a,5,5*je],[a,15,15*je],[a,30,30*je],[r,1,Hn],[r,3,3*Hn],[r,6,6*Hn],[r,12,12*Hn],[i,1,Ji],[i,2,2*Ji],[n,1,Mg],[e,1,Zp],[e,3,3*Zp],[t,1,fc]];function u(l,f,c){const h=f<l;h&&([l,f]=[f,l]);const d=c&&typeof c.range=="function"?c:s(l,f,c),g=d?d.range(l,+f+1):[];return h?g.reverse():g}function s(l,f,c){const h=Math.abs(f-l)/c,d=mg(([,,p])=>p).right(o,h);if(d===o.length)return t.every(Eh(l/fc,f/fc,c));if(d===0)return DD.every(Math.max(Eh(l,f,c),1));const[g,m]=o[h/o[d-1][2]<o[d][2]/h?d-1:d];return g.every(m)}return[u,s]}const[LD,PD]=A_(k_,__,w_,b_,x_,v_),[ID,UD]=A_(y_,m_,g_,d_,h_,c_);function qD(t){return new Date(t)}function jD(t){return t instanceof Date?+t:+new Date(+t)}function kg(t,e,n,i,r,a,o,u,s,l){var f=e_(),c=f.invert,h=f.domain,d=l(".%L"),g=l(":%S"),m=l("%I:%M"),p=l("%I %p"),y=l("%a %d"),v=l("%b %d"),x=l("%B"),b=l("%Y");function _(M){return(s(M)<M?d:u(M)<M?g:o(M)<M?m:a(M)<M?p:i(M)<M?r(M)<M?y:v:n(M)<M?x:b)(M)}return f.invert=function(M){return new Date(c(M))},f.domain=function(M){return arguments.length?h(Array.from(M,jD)):h().map(qD)},f.ticks=function(M){var w=h();return t(w[0],w[w.length-1],M==null?10:M)},f.tickFormat=function(M,w){return w==null?_:l(w)},f.nice=function(M){var w=h();return(!M||typeof M.range!="function")&&(M=e(w[0],w[w.length-1],M==null?10:M)),M?h(a_(w,M)):f},f.copy=function(){return uu(f,kg(t,e,n,i,r,a,o,u,s,l))},f}function YD(){return Nn.apply(kg(ID,UD,y_,m_,g_,d_,h_,c_,Or,SA).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function HD(){return Nn.apply(kg(LD,PD,k_,__,w_,b_,x_,v_,Or,FA).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function uf(){var t=0,e=1,n,i,r,a,o=_e,u=!1,s;function l(c){return c==null||isNaN(c=+c)?s:o(r===0?.5:(c=(a(c)-n)*r,u?Math.max(0,Math.min(1,c)):c))}l.domain=function(c){return arguments.length?([t,e]=c,n=a(t=+t),i=a(e=+e),r=n===i?0:1/(i-n),l):[t,e]},l.clamp=function(c){return arguments.length?(u=!!c,l):u},l.interpolator=function(c){return arguments.length?(o=c,l):o};function f(c){return function(h){var d,g;return arguments.length?([d,g]=h,o=c(d,g),l):[o(0),o(1)]}}return l.range=f(dr),l.rangeRound=f(af),l.unknown=function(c){return arguments.length?(s=c,l):s},function(c){return a=c,n=c(t),i=c(e),r=n===i?0:1/(i-n),l}}function Ni(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Ag(){var t=gr(uf()(_e));return t.copy=function(){return Ni(t,Ag())},Ri.apply(t,arguments)}function E_(){var t=xg(uf()).domain([1,10]);return t.copy=function(){return Ni(t,E_()).base(t.base())},Ri.apply(t,arguments)}function C_(){var t=bg(uf());return t.copy=function(){return Ni(t,C_()).constant(t.constant())},Ri.apply(t,arguments)}function Eg(){var t=wg(uf());return t.copy=function(){return Ni(t,Eg()).exponent(t.exponent())},Ri.apply(t,arguments)}function WD(){return Eg.apply(null,arguments).exponent(.5)}function sf(){var t=0,e=.5,n=1,i=1,r,a,o,u,s,l=_e,f,c=!1,h;function d(m){return isNaN(m=+m)?h:(m=.5+((m=+f(m))-a)*(i*m<i*a?u:s),l(c?Math.max(0,Math.min(1,m)):m))}d.domain=function(m){return arguments.length?([t,e,n]=m,r=f(t=+t),a=f(e=+e),o=f(n=+n),u=r===a?0:.5/(a-r),s=a===o?0:.5/(o-a),i=a<r?-1:1,d):[t,e,n]},d.clamp=function(m){return arguments.length?(c=!!m,d):c},d.interpolator=function(m){return arguments.length?(l=m,d):l};function g(m){return function(p){var y,v,x;return arguments.length?([y,v,x]=p,l=vg(m,[y,v,x]),d):[l(0),l(.5),l(1)]}}return d.range=g(dr),d.rangeRound=g(af),d.unknown=function(m){return arguments.length?(h=m,d):h},function(m){return f=m,r=m(t),a=m(e),o=m(n),u=r===a?0:.5/(a-r),s=a===o?0:.5/(o-a),i=a<r?-1:1,d}}function D_(){var t=gr(sf()(_e));return t.copy=function(){return Ni(t,D_())},Ri.apply(t,arguments)}function S_(){var t=xg(sf()).domain([.1,1,10]);return t.copy=function(){return Ni(t,S_()).base(t.base())},Ri.apply(t,arguments)}function F_(){var t=bg(sf());return t.copy=function(){return Ni(t,F_()).constant(t.constant())},Ri.apply(t,arguments)}function Cg(){var t=wg(sf());return t.copy=function(){return Ni(t,Cg()).exponent(t.exponent())},Ri.apply(t,arguments)}function GD(){return Cg.apply(null,arguments).exponent(.5)}function Dg(t,e,n){const i=t-e+n*2;return t?i>0?i:1:0}const VD="identity",Zr="linear",Vn="log",su="pow",lu="sqrt",lf="symlog",Qi="time",tr="utc",An="sequential",pa="diverging",Jr="quantile",ff="quantize",cf="threshold",Sg="ordinal",Nh="point",$_="band",Fg="bin-ordinal",$t="continuous",fu="discrete",cu="discretizing",Qe="interpolating",$g="temporal";function XD(t){return function(e){let n=e[0],i=e[1],r;return i<n&&(r=n,n=i,i=r),[t.invert(n),t.invert(i)]}}function KD(t){return function(e){const n=t.range();let i=e[0],r=e[1],a=-1,o,u,s,l;for(r<i&&(u=i,i=r,r=u),s=0,l=n.length;s<l;++s)n[s]>=i&&n[s]<=r&&(a<0&&(a=s),o=s);if(!(a<0))return i=t.invertExtent(n[a]),r=t.invertExtent(n[o]),[i[0]===void 0?i[1]:i[0],r[1]===void 0?r[0]:r[1]]}}function Tg(){const t=pg().unknown(void 0),e=t.domain,n=t.range;let i=[0,1],r,a,o=!1,u=0,s=0,l=.5;delete t.unknown;function f(){const c=e().length,h=i[1]<i[0],d=i[1-h],g=Dg(c,u,s);let m=i[h-0];r=(d-m)/(g||1),o&&(r=Math.floor(r)),m+=(d-m-r*(c-u))*l,a=r*(1-u),o&&(m=Math.round(m),a=Math.round(a));const p=j8(c).map(y=>m+r*y);return n(h?p.reverse():p)}return t.domain=function(c){return arguments.length?(e(c),f()):e()},t.range=function(c){return arguments.length?(i=[+c[0],+c[1]],f()):i.slice()},t.rangeRound=function(c){return i=[+c[0],+c[1]],o=!0,f()},t.bandwidth=function(){return a},t.step=function(){return r},t.round=function(c){return arguments.length?(o=!!c,f()):o},t.padding=function(c){return arguments.length?(s=Math.max(0,Math.min(1,c)),u=s,f()):u},t.paddingInner=function(c){return arguments.length?(u=Math.max(0,Math.min(1,c)),f()):u},t.paddingOuter=function(c){return arguments.length?(s=Math.max(0,Math.min(1,c)),f()):s},t.align=function(c){return arguments.length?(l=Math.max(0,Math.min(1,c)),f()):l},t.invertRange=function(c){if(c[0]==null||c[1]==null)return;const h=i[1]<i[0],d=h?n().reverse():n(),g=d.length-1;let m=+c[0],p=+c[1],y,v,x;if(!(m!==m||p!==p)&&(p<m&&(x=m,m=p,p=x),!(p<d[0]||m>i[1-h])))return y=Math.max(0,wh(d,m)-1),v=m===p?y:wh(d,p)-1,m-d[y]>a+1e-10&&++y,h&&(x=y,y=g-v,v=g-x),y>v?void 0:e().slice(y,v+1)},t.invert=function(c){const h=t.invertRange([c,c]);return h&&h[0]},t.copy=function(){return Tg().domain(e()).range(i).round(o).paddingInner(u).paddingOuter(s).align(l)},f()}function T_(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return T_(e())},t}function ZD(){return T_(Tg().paddingInner(1))}var JD=Array.prototype.map;function QD(t){return JD.call(t,Kt)}const tS=Array.prototype.slice;function R_(){let t=[],e=[];function n(i){return i==null||i!==i?void 0:e[(ou(t,i)-1)%e.length]}return n.domain=function(i){return arguments.length?(t=QD(i),n):t.slice()},n.range=function(i){return arguments.length?(e=tS.call(i),n):e.slice()},n.tickFormat=function(i,r){return n_(t[0],it(t),i==null?10:i,r)},n.copy=function(){return R_().domain(n.domain()).range(n.range())},n}const Is={};function eS(t,e,n){const i=function(){const a=e();return a.invertRange||(a.invertRange=a.invert?XD(a):a.invertExtent?KD(a):void 0),a.type=t,a};return i.metadata=cn(G(n)),i}function st(t,e,n){return arguments.length>1?(Is[t]=eS(t,e,n),this):N_(t)?Is[t]:void 0}st(VD,r_);st(Zr,i_,$t);st(Vn,o_,[$t,Vn]);st(su,_g,$t);st(lu,CD,$t);st(lf,u_,$t);st(Qi,YD,[$t,$g]);st(tr,HD,[$t,$g]);st(An,Ag,[$t,Qe]);st("".concat(An,"-").concat(Zr),Ag,[$t,Qe]);st("".concat(An,"-").concat(Vn),E_,[$t,Qe,Vn]);st("".concat(An,"-").concat(su),Eg,[$t,Qe]);st("".concat(An,"-").concat(lu),WD,[$t,Qe]);st("".concat(An,"-").concat(lf),C_,[$t,Qe]);st("".concat(pa,"-").concat(Zr),D_,[$t,Qe]);st("".concat(pa,"-").concat(Vn),S_,[$t,Qe,Vn]);st("".concat(pa,"-").concat(su),Cg,[$t,Qe]);st("".concat(pa,"-").concat(lu),GD,[$t,Qe]);st("".concat(pa,"-").concat(lf),F_,[$t,Qe]);st(Jr,s_,[cu,Jr]);st(ff,l_,cu);st(cf,f_,cu);st(Fg,R_,[fu,cu]);st(Sg,pg,fu);st($_,Tg,fu);st(Nh,ZD,fu);function N_(t){return V(Is,t)}function yr(t,e){const n=Is[t];return n&&n.metadata[e]}function Rg(t){return yr(t,$t)}function Qr(t){return yr(t,fu)}function Oh(t){return yr(t,cu)}function O_(t){return yr(t,Vn)}function nS(t){return yr(t,$g)}function z_(t){return yr(t,Qe)}function B_(t){return yr(t,Jr)}const iS=["clamp","base","constant","exponent"];function L_(t,e){const n=e[0],i=it(e)-n;return function(r){return t(n+r*i)}}function hf(t,e,n){return vg(Ng(e||"rgb",n),t)}function P_(t,e){const n=new Array(e),i=e+1;for(let r=0;r<e;)n[r]=t(++r/i);return n}function I_(t,e,n){const i=n-e;let r,a,o;return!i||!Number.isFinite(i)?ee(.5):(r=(a=t.type).indexOf("-"),a=r<0?a:a.slice(r+1),o=st(a)().domain([e,n]).range([0,1]),iS.forEach(u=>t[u]?o[u](t[u]()):0),o)}function Ng(t,e){const n=mD[rS(t)];return e!=null&&n&&n.gamma?n.gamma(e):n}function rS(t){return"interpolate"+t.toLowerCase().split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join("")}const aS={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},oS={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function U_(t){const e=t.length/6|0,n=new Array(e);for(let i=0;i<e;)n[i]="#"+t.slice(i*6,++i*6);return n}function q_(t,e){for(const n in t)Og(n,e(t[n]))}const Jp={};q_(oS,U_);q_(aS,t=>hf(U_(t)));function Og(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(Jp[t]=e,this):Jp[t]}const ds="symbol",uS="discrete",sS="gradient",lS=t=>Y(t)?t.map(e=>String(e)):String(t),fS=(t,e)=>t[1]-e[1],cS=(t,e)=>e[1]-t[1];function zg(t,e,n){let i;return Mi(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),n!=null&&(e=Math.min(e,Math.floor(nu(t.domain())/n||1)))),J(e)&&(i=e.step,e=e.interval),vt(e)&&(e=t.type===Qi?ha(e):t.type==tr?da(e):R("Only time and utc scales accept interval strings."),i&&(e=e.every(i))),e}function j_(t,e,n){let i=t.range(),r=i[0],a=it(i),o=fS;if(r>a&&(i=a,a=r,r=i,o=cS),r=Math.floor(r),a=Math.ceil(a),e=e.map(u=>[u,t(u)]).filter(u=>r<=u[1]&&u[1]<=a).sort(o).map(u=>u[0]),n>0&&e.length>1){const u=[e[0],it(e)];for(;e.length>n&&e.length>=3;)e=e.filter((s,l)=>!(l%2));e.length<3&&(e=u)}return e}function Bg(t,e){return t.bins?j_(t,t.bins):t.ticks?t.ticks(e):t.domain()}function Y_(t,e,n,i,r,a){const o=e.type;let u=lS;if(o===Qi||r===Qi)u=t.timeFormat(i);else if(o===tr||r===tr)u=t.utcFormat(i);else if(O_(o)){const s=t.formatFloat(i);if(a||e.bins)u=s;else{const l=H_(e,n,!1);u=f=>l(f)?s(f):""}}else if(e.tickFormat){const s=e.domain();u=t.formatSpan(s[0],s[s.length-1],n,i)}else i&&(u=t.format(i));return u}function H_(t,e,n){const i=Bg(t,e),r=t.base(),a=Math.log(r),o=Math.max(1,r*e/i.length),u=s=>{let l=s/Math.pow(r,Math.round(Math.log(s)/a));return l*r<r-.5&&(l*=r),l<=o};return n?i.filter(u):u}const zh={[Jr]:"quantiles",[ff]:"thresholds",[cf]:"domain"},W_={[Jr]:"quantiles",[ff]:"domain"};function G_(t,e){return t.bins?gS(t.bins):t.type===Vn?H_(t,e,!0):zh[t.type]?dS(t[zh[t.type]]()):Bg(t,e)}function hS(t,e,n){const i=e[W_[e.type]](),r=i.length;let a=r>1?i[1]-i[0]:i[0],o;for(o=1;o<r;++o)a=Math.min(a,i[o]-i[o-1]);return t.formatSpan(0,a,3*10,n)}function dS(t){const e=[-1/0].concat(t);return e.max=1/0,e}function gS(t){const e=t.slice(0,-1);return e.max=it(t),e}const mS=t=>zh[t.type]||t.bins;function V_(t,e,n,i,r,a,o){const u=W_[e.type]&&a!==Qi&&a!==tr?hS(t,e,r):Y_(t,e,n,r,a,o);return i===ds&&mS(e)?pS(u):i===uS?yS(u):vS(u)}const pS=t=>(e,n,i)=>{const r=Qp(i[n+1],Qp(i.max,1/0)),a=ty(e,t),o=ty(r,t);return a&&o?a+" \u2013 "+o:o?"< "+o:"\u2265 "+a},Qp=(t,e)=>t!=null?t:e,yS=t=>(e,n)=>n?t(e):null,vS=t=>e=>t(e),ty=(t,e)=>Number.isFinite(t)?e(t):null;function xS(t){const e=t.domain(),n=e.length-1;let i=+e[0],r=+it(e),a=r-i;if(t.type===cf){const o=n?a/n:.1;i-=o,r+=o,a=r-i}return o=>(o-i)/a}function bS(t,e,n,i){const r=i||e.type;return vt(n)&&nS(r)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&r===Qi?t.timeFormat("%A, %d %B %Y, %X"):!n&&r===tr?t.utcFormat("%A, %d %B %Y, %X UTC"):V_(t,e,5,null,n,i,!0)}function X_(t,e,n){n=n||{};const i=Math.max(3,n.maxlen||7),r=bS(t,e,n.format,n.formatType);if(Oh(e.type)){const a=G_(e).slice(1).map(r),o=a.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(a.join(", "))}else if(Qr(e.type)){const a=e.domain(),o=a.length,u=o>i?a.slice(0,i-2).map(r).join(", ")+", ending with "+a.slice(-1).map(r):a.map(r).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(u)}else{const a=e.domain();return"values from ".concat(r(a[0])," to ").concat(r(it(a)))}}let K_=0;function wS(){K_=0}const Us="p_";function Lg(t){return t&&t.gradient}function Z_(t,e,n){const i=t.gradient;let r=t.id,a=i==="radial"?Us:"";return r||(r=t.id="gradient_"+K_++,i==="radial"?(t.x1=vn(t.x1,.5),t.y1=vn(t.y1,.5),t.r1=vn(t.r1,0),t.x2=vn(t.x2,.5),t.y2=vn(t.y2,.5),t.r2=vn(t.r2,.5),a=Us):(t.x1=vn(t.x1,0),t.y1=vn(t.y1,0),t.x2=vn(t.x2,1),t.y2=vn(t.y2,0))),e[r]=t,"url("+(n||"")+"#"+a+r+")"}function vn(t,e){return t!=null?t:e}function J_(t,e){var n=[],i;return i={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:n,stop:function(r,a){return n.push({offset:r,color:a}),i}}}const ey={basis:{curve:_8},"basis-closed":{curve:M8},"basis-open":{curve:k8},bundle:{curve:A8,tension:"beta",value:.85},cardinal:{curve:E8,tension:"tension",value:0},"cardinal-open":{curve:D8,tension:"tension",value:0},"cardinal-closed":{curve:C8,tension:"tension",value:0},"catmull-rom":{curve:S8,tension:"alpha",value:.5},"catmull-rom-closed":{curve:F8,tension:"alpha",value:.5},"catmull-rom-open":{curve:$8,tension:"alpha",value:.5},linear:{curve:lg},"linear-closed":{curve:T8},monotone:{horizontal:N8,vertical:R8},natural:{curve:O8},step:{curve:z8},"step-after":{curve:L8},"step-before":{curve:B8}};function Pg(t,e,n){var i=V(ey,t)&&ey[t],r=null;return i&&(r=i.curve||i[e||"vertical"],i.tension&&n!=null&&(r=r[i.tension](n))),r}const _S={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},Oa=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function ta(t){const e=[];let n,i,r,a,o,u,s,l,f,c;const h=t.slice().replace(Oa[0],"###$1").split(Oa[1]).slice(1);for(s=0,f=h.length;s<f;++s){for(n=h[s],i=n.slice(1).trim().replace(Oa[2],"$1###$2").replace(Oa[3],"$1###$2").split(Oa[4]),o=n.charAt(0),r=[o],l=0,c=i.length;l<c;++l)(a=+i[l])===a&&r.push(a);if(u=_S[o.toLowerCase()],r.length-1>u){const d=r.length;for(l=1,e.push([o].concat(r.slice(l,l+=u))),o=o==="M"?"L":o==="m"?"l":o;l<d;l+=u)e.push([o].concat(r.slice(l,l+u)))}else e.push(r)}return e}const Ci=Math.PI/180,MS=1e-14,ji=Math.PI/2,bn=Math.PI*2,kr=Math.sqrt(3)/2;var cc={},hc={},Q_=[].join;function kS(t,e,n,i,r,a,o,u,s){const l=Q_.call(arguments);if(cc[l])return cc[l];const f=o*Ci,c=Math.sin(f),h=Math.cos(f);n=Math.abs(n),i=Math.abs(i);const d=h*(u-t)*.5+c*(s-e)*.5,g=h*(s-e)*.5-c*(u-t)*.5;let m=d*d/(n*n)+g*g/(i*i);m>1&&(m=Math.sqrt(m),n*=m,i*=m);const p=h/n,y=c/n,v=-c/i,x=h/i,b=p*u+y*s,_=v*u+x*s,M=p*t+y*e,w=v*t+x*e,k=(M-b)*(M-b)+(w-_)*(w-_);let C=1/k-.25;C<0&&(C=0);let A=Math.sqrt(C);a==r&&(A=-A);const E=.5*(b+M)-A*(w-_),F=.5*(_+w)+A*(M-b),$=Math.atan2(_-F,b-E);let D=Math.atan2(w-F,M-E)-$;D<0&&a===1?D+=bn:D>0&&a===0&&(D-=bn);const N=Math.ceil(Math.abs(D/(ji+.001))),L=[];for(let U=0;U<N;++U){const W=$+U*D/N,lt=$+(U+1)*D/N;L[U]=[E,F,W,lt,n,i,c,h]}return cc[l]=L}function AS(t){const e=Q_.call(t);if(hc[e])return hc[e];var n=t[0],i=t[1],r=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7];const f=l*o,c=-s*u,h=s*o,d=l*u,g=Math.cos(r),m=Math.sin(r),p=Math.cos(a),y=Math.sin(a),v=.5*(a-r),x=Math.sin(v*.5),b=8/3*x*x/Math.sin(v),_=n+g-b*m,M=i+m+b*g,w=n+p,k=i+y,C=w+b*y,A=k-b*p;return hc[e]=[f*_+c*M,h*_+d*M,f*C+c*A,h*C+d*A,f*w+c*k,h*w+d*k]}const qe=["l",0,0,0,0,0,0,0];function ES(t,e,n){const i=qe[0]=t[0];if(i==="a"||i==="A")qe[1]=e*t[1],qe[2]=n*t[2],qe[3]=t[3],qe[4]=t[4],qe[5]=t[5],qe[6]=e*t[6],qe[7]=n*t[7];else if(i==="h"||i==="H")qe[1]=e*t[1];else if(i==="v"||i==="V")qe[1]=n*t[1];else for(var r=1,a=t.length;r<a;++r)qe[r]=(r%2==1?e:n)*t[r];return qe}function Bo(t,e,n,i,r,a){var o,u=null,s=0,l=0,f=0,c=0,h,d,g,m;n==null&&(n=0),i==null&&(i=0),r==null&&(r=1),a==null&&(a=r),t.beginPath&&t.beginPath();for(var p=0,y=e.length;p<y;++p){switch(o=e[p],(r!==1||a!==1)&&(o=ES(o,r,a)),o[0]){case"l":s+=o[1],l+=o[2],t.lineTo(s+n,l+i);break;case"L":s=o[1],l=o[2],t.lineTo(s+n,l+i);break;case"h":s+=o[1],t.lineTo(s+n,l+i);break;case"H":s=o[1],t.lineTo(s+n,l+i);break;case"v":l+=o[1],t.lineTo(s+n,l+i);break;case"V":l=o[1],t.lineTo(s+n,l+i);break;case"m":s+=o[1],l+=o[2],t.moveTo(s+n,l+i);break;case"M":s=o[1],l=o[2],t.moveTo(s+n,l+i);break;case"c":h=s+o[5],d=l+o[6],f=s+o[3],c=l+o[4],t.bezierCurveTo(s+o[1]+n,l+o[2]+i,f+n,c+i,h+n,d+i),s=h,l=d;break;case"C":s=o[5],l=o[6],f=o[3],c=o[4],t.bezierCurveTo(o[1]+n,o[2]+i,f+n,c+i,s+n,l+i);break;case"s":h=s+o[3],d=l+o[4],f=2*s-f,c=2*l-c,t.bezierCurveTo(f+n,c+i,s+o[1]+n,l+o[2]+i,h+n,d+i),f=s+o[1],c=l+o[2],s=h,l=d;break;case"S":h=o[3],d=o[4],f=2*s-f,c=2*l-c,t.bezierCurveTo(f+n,c+i,o[1]+n,o[2]+i,h+n,d+i),s=h,l=d,f=o[1],c=o[2];break;case"q":h=s+o[3],d=l+o[4],f=s+o[1],c=l+o[2],t.quadraticCurveTo(f+n,c+i,h+n,d+i),s=h,l=d;break;case"Q":h=o[3],d=o[4],t.quadraticCurveTo(o[1]+n,o[2]+i,h+n,d+i),s=h,l=d,f=o[1],c=o[2];break;case"t":h=s+o[1],d=l+o[2],u[0].match(/[QqTt]/)===null?(f=s,c=l):u[0]==="t"?(f=2*s-g,c=2*l-m):u[0]==="q"&&(f=2*s-f,c=2*l-c),g=f,m=c,t.quadraticCurveTo(f+n,c+i,h+n,d+i),s=h,l=d,f=s+o[1],c=l+o[2];break;case"T":h=o[1],d=o[2],f=2*s-f,c=2*l-c,t.quadraticCurveTo(f+n,c+i,h+n,d+i),s=h,l=d;break;case"a":ny(t,s+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+s+n,o[7]+l+i]),s+=o[6],l+=o[7];break;case"A":ny(t,s+n,l+i,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+i]),s=o[6],l=o[7];break;case"z":case"Z":t.closePath();break}u=o}}function ny(t,e,n,i){const r=kS(i[5],i[6],i[0],i[1],i[3],i[4],i[2],e,n);for(let a=0;a<r.length;++a){const o=AS(r[a]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const iy=.5773502691896257,ry={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,bn)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/2.5;t.moveTo(-n,-i),t.lineTo(-n,i),t.lineTo(-i,i),t.lineTo(-i,n),t.lineTo(i,n),t.lineTo(i,i),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(i,-i),t.lineTo(i,-n),t.lineTo(-i,-n),t.lineTo(-i,-i),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),i=-n/2;t.rect(i,i,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,i=n/7,r=n/2.5,a=n/8;t.moveTo(-i,n),t.lineTo(i,n),t.lineTo(i,-a),t.lineTo(r,-a),t.lineTo(0,-n),t.lineTo(-r,-a),t.lineTo(-i,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,i=kr*n,r=i-n*iy,a=n/4;t.moveTo(0,-i-r),t.lineTo(-a,i-r),t.lineTo(a,i-r),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,i=kr*n,r=i-n*iy;t.moveTo(0,-i-r),t.lineTo(-n,i-r),t.lineTo(n,i-r),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,i=kr*n;t.moveTo(0,-i),t.lineTo(-n,i),t.lineTo(n,i),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,i=kr*n;t.moveTo(0,i),t.lineTo(-n,-i),t.lineTo(n,-i),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,i=kr*n;t.moveTo(i,0),t.lineTo(-i,-n),t.lineTo(-i,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,i=kr*n;t.moveTo(-i,0),t.lineTo(i,-n),t.lineTo(i,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function t3(t){return V(ry,t)?ry[t]:CS(t)}var dc={};function CS(t){if(!V(dc,t)){const e=ta(t);dc[t]={draw:function(n,i){Bo(n,e,0,0,Math.sqrt(i)/2)}}}return dc[t]}const ei=.448084975506;function DS(t){return t.x}function SS(t){return t.y}function FS(t){return t.width}function $S(t){return t.height}function Ln(t){return typeof t=="function"?t:()=>+t}function Iu(t,e,n){return Math.max(e,Math.min(t,n))}function e3(){var t=DS,e=SS,n=FS,i=$S,r=Ln(0),a=r,o=r,u=r,s=null;function l(f,c,h){var d,g=c!=null?c:+t.call(this,f),m=h!=null?h:+e.call(this,f),p=+n.call(this,f),y=+i.call(this,f),v=Math.min(p,y)/2,x=Iu(+r.call(this,f),0,v),b=Iu(+a.call(this,f),0,v),_=Iu(+o.call(this,f),0,v),M=Iu(+u.call(this,f),0,v);if(s||(s=d=hr()),x<=0&&b<=0&&_<=0&&M<=0)s.rect(g,m,p,y);else{var w=g+p,k=m+y;s.moveTo(g+x,m),s.lineTo(w-b,m),s.bezierCurveTo(w-ei*b,m,w,m+ei*b,w,m+b),s.lineTo(w,k-M),s.bezierCurveTo(w,k-ei*M,w-ei*M,k,w-M,k),s.lineTo(g+_,k),s.bezierCurveTo(g+ei*_,k,g,k-ei*_,g,k-_),s.lineTo(g,m+x),s.bezierCurveTo(g,m+ei*x,g+ei*x,m,g+x,m),s.closePath()}if(d)return s=null,d+""||null}return l.x=function(f){return arguments.length?(t=Ln(f),l):t},l.y=function(f){return arguments.length?(e=Ln(f),l):e},l.width=function(f){return arguments.length?(n=Ln(f),l):n},l.height=function(f){return arguments.length?(i=Ln(f),l):i},l.cornerRadius=function(f,c,h,d){return arguments.length?(r=Ln(f),a=c!=null?Ln(c):r,u=h!=null?Ln(h):r,o=d!=null?Ln(d):a,l):r},l.context=function(f){return arguments.length?(s=f==null?null:f,l):s},l}function n3(){var t,e,n,i,r=null,a,o,u,s;function l(c,h,d){const g=d/2;if(a){var m=u-h,p=c-o;if(m||p){var y=Math.sqrt(m*m+p*p),v=(m/=y)*s,x=(p/=y)*s,b=Math.atan2(p,m);r.moveTo(o-v,u-x),r.lineTo(c-m*g,h-p*g),r.arc(c,h,g,b-Math.PI,b),r.lineTo(o+v,u+x),r.arc(o,u,s,b,b+Math.PI)}else r.arc(c,h,g,0,bn);r.closePath()}else a=1;o=c,u=h,s=g}function f(c){var h,d=c.length,g,m=!1,p;for(r==null&&(r=p=hr()),h=0;h<=d;++h)!(h<d&&i(g=c[h],h,c))===m&&(m=!m)&&(a=0),m&&l(+t(g,h,c),+e(g,h,c),+n(g,h,c));if(p)return r=null,p+""||null}return f.x=function(c){return arguments.length?(t=c,f):t},f.y=function(c){return arguments.length?(e=c,f):e},f.size=function(c){return arguments.length?(n=c,f):n},f.defined=function(c){return arguments.length?(i=c,f):i},f.context=function(c){return arguments.length?(c==null?r=null:r=c,f):r},f}function hu(t,e){return t!=null?t:e}const du=t=>t.x||0,gu=t=>t.y||0,TS=t=>t.width||0,RS=t=>t.height||0,NS=t=>(t.x||0)+(t.width||0),OS=t=>(t.y||0)+(t.height||0),zS=t=>t.startAngle||0,BS=t=>t.endAngle||0,LS=t=>t.padAngle||0,PS=t=>t.innerRadius||0,IS=t=>t.outerRadius||0,US=t=>t.cornerRadius||0,qS=t=>hu(t.cornerRadiusTopLeft,t.cornerRadius)||0,jS=t=>hu(t.cornerRadiusTopRight,t.cornerRadius)||0,YS=t=>hu(t.cornerRadiusBottomRight,t.cornerRadius)||0,HS=t=>hu(t.cornerRadiusBottomLeft,t.cornerRadius)||0,WS=t=>hu(t.size,64),GS=t=>t.size||1,df=t=>t.defined!==!1,VS=t=>t3(t.shape||"circle"),XS=x8().startAngle(zS).endAngle(BS).padAngle(LS).innerRadius(PS).outerRadius(IS).cornerRadius(US),KS=Cw().x(du).y1(gu).y0(OS).defined(df),ZS=Cw().y(gu).x1(du).x0(NS).defined(df),JS=Ew().x(du).y(gu).defined(df),QS=e3().x(du).y(gu).width(TS).height(RS).cornerRadius(qS,jS,YS,HS),t7=w8().type(VS).size(WS),e7=n3().x(du).y(gu).defined(df).size(GS);function Ig(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function n7(t,e){return XS.context(t)(e)}function i7(t,e){const n=e[0],i=n.interpolate||"linear";return(n.orient==="horizontal"?ZS:KS).curve(Pg(i,n.orient,n.tension)).context(t)(e)}function r7(t,e){const n=e[0],i=n.interpolate||"linear";return JS.curve(Pg(i,n.orient,n.tension)).context(t)(e)}function ya(t,e,n,i){return QS.context(t)(e,n,i)}function a7(t,e){return(e.mark.shape||e.shape).context(t)(e)}function o7(t,e){return t7.context(t)(e)}function u7(t,e){return e7.context(t)(e)}var i3=1;function r3(){i3=1}function Ug(t,e,n){var i=e.clip,r=t._defs,a=e.clip_id||(e.clip_id="clip"+i3++),o=r.clipping[a]||(r.clipping[a]={id:a});return Q(i)?o.path=i(null):Ig(n)?o.path=ya(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function Ft(t){this.clear(),t&&this.union(t)}Ft.prototype={clone(){return new Ft(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,i){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),i<e?(this.y2=e,this.y1=i):(this.y1=e,this.y2=i),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const i=this.rotatedPoints(t,e,n);return this.clear().add(i[0],i[1]).add(i[2],i[3]).add(i[4],i[5]).add(i[6],i[7])},rotatedPoints(t,e,n){var{x1:i,y1:r,x2:a,y2:o}=this,u=Math.cos(t),s=Math.sin(t),l=e-e*u+n*s,f=n-e*s-n*u;return[u*i-s*r+l,s*i+u*r+f,u*i-s*o+l,s*i+u*o+f,u*a-s*r+l,s*a+u*r+f,u*a-s*o+l,s*a+u*o+f]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function gf(t){this.mark=t,this.bounds=this.bounds||new Ft}function mf(t){gf.call(this,t),this.items=this.items||[]}z(mf,gf);function qg(t){this._pending=0,this._loader=t||ql()}function ay(t){t._pending+=1}function za(t){t._pending-=1}qg.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return ay(e),e._loader.sanitize(t,{context:"href"}).then(n=>(za(e),n)).catch(()=>(za(e),null))},loadImage(t){const e=this,n=P8();return ay(e),e._loader.sanitize(t,{context:"image"}).then(i=>{const r=i.href;if(!r||!n)throw{url:r};const a=new n,o=V(i,"crossOrigin")?i.crossOrigin:"anonymous";return o!=null&&(a.crossOrigin=o),a.onload=()=>za(e),a.onerror=()=>za(e),a.src=r,a}).catch(i=>(za(e),{complete:!1,width:0,height:0,src:i&&i.url||""}))},ready(){const t=this;return new Promise(e=>{function n(i){t.pending()?setTimeout(()=>{n(!0)},10):e(i)}n(!1)})}};function Zn(t,e,n){if(e.stroke&&e.opacity!==0&&e.strokeOpacity!==0){const i=e.strokeWidth!=null?+e.strokeWidth:1;t.expand(i+(n?s7(e,i):0))}return t}function s7(t,e){return t.strokeJoin&&t.strokeJoin!=="miter"?0:e}const l7=bn-1e-8;let pf,gs,ms,Gi,Bh,ps,Lh,Ph;const ci=(t,e)=>pf.add(t,e),ys=(t,e)=>ci(gs=t,ms=e),oy=t=>ci(t,pf.y1),uy=t=>ci(pf.x1,t),Yi=(t,e)=>Bh*t+Lh*e,Hi=(t,e)=>ps*t+Ph*e,gc=(t,e)=>ci(Yi(t,e),Hi(t,e)),mc=(t,e)=>ys(Yi(t,e),Hi(t,e));function mu(t,e){return pf=t,e?(Gi=e*Ci,Bh=Ph=Math.cos(Gi),ps=Math.sin(Gi),Lh=-ps):(Bh=Ph=1,Gi=ps=Lh=0),f7}const f7={beginPath(){},closePath(){},moveTo:mc,lineTo:mc,rect(t,e,n,i){Gi?(gc(t+n,e),gc(t+n,e+i),gc(t,e+i),mc(t,e)):(ci(t+n,e+i),ys(t,e))},quadraticCurveTo(t,e,n,i){const r=Yi(t,e),a=Hi(t,e),o=Yi(n,i),u=Hi(n,i);sy(gs,r,o,oy),sy(ms,a,u,uy),ys(o,u)},bezierCurveTo(t,e,n,i,r,a){const o=Yi(t,e),u=Hi(t,e),s=Yi(n,i),l=Hi(n,i),f=Yi(r,a),c=Hi(r,a);ly(gs,o,s,f,oy),ly(ms,u,l,c,uy),ys(f,c)},arc(t,e,n,i,r,a){if(i+=Gi,r+=Gi,gs=n*Math.cos(r)+t,ms=n*Math.sin(r)+e,Math.abs(r-i)>l7)ci(t-n,e-n),ci(t+n,e+n);else{const o=l=>ci(n*Math.cos(l)+t,n*Math.sin(l)+e);let u,s;if(o(i),o(r),r!==i)if(i=i%bn,i<0&&(i+=bn),r=r%bn,r<0&&(r+=bn),r<i&&(a=!a,u=i,i=r,r=u),a)for(r-=bn,u=i-i%ji,s=0;s<4&&u>r;++s,u-=ji)o(u);else for(u=i-i%ji+ji,s=0;s<4&&u<r;++s,u=u+ji)o(u)}}};function sy(t,e,n,i){const r=(t-e)/(t+n-2*e);0<r&&r<1&&i(t+(e-t)*r)}function ly(t,e,n,i,r){const a=i-t+3*e-3*n,o=t+n-2*e,u=t-e;let s=0,l=0,f;Math.abs(a)>MS?(f=o*o+u*a,f>=0&&(f=Math.sqrt(f),s=(-o+f)/a,l=(-o-f)/a)):s=.5*u/o,0<s&&s<1&&r(fy(s,t,e,n,i)),0<l&&l<1&&r(fy(l,t,e,n,i))}function fy(t,e,n,i,r){const a=1-t,o=a*a,u=t*t;return o*a*e+3*o*t*n+3*a*u*i+u*t*r}var wi=(wi=ma(1,1))?wi.getContext("2d"):null;const Ih=new Ft;function jg(t){return function(e,n){if(!wi)return!0;t(wi,e),Ih.clear().union(e.bounds).intersect(n).round();const{x1:i,y1:r,x2:a,y2:o}=Ih;for(let u=r;u<=o;++u)for(let s=i;s<=a;++s)if(wi.isPointInPath(s,u))return!0;return!1}}function Yg(t,e){return e.contains(t.x||0,t.y||0)}function a3(t,e){const n=t.x||0,i=t.y||0,r=t.width||0,a=t.height||0;return e.intersects(Ih.set(n,i,n+r,i+a))}function o3(t,e){const n=t.x||0,i=t.y||0,r=t.x2!=null?t.x2:n,a=t.y2!=null?t.y2:i;return zr(e,n,i,r,a)}function zr(t,e,n,i,r){const{x1:a,y1:o,x2:u,y2:s}=t,l=i-e,f=r-n;let c=0,h=1,d,g,m,p;for(p=0;p<4;++p){if(p===0&&(d=-l,g=-(a-e)),p===1&&(d=l,g=u-e),p===2&&(d=-f,g=-(o-n)),p===3&&(d=f,g=s-n),Math.abs(d)<1e-10&&g<0)return!1;if(m=g/d,d<0){if(m>h)return!1;m>c&&(c=m)}else if(d>0){if(m<c)return!1;m<h&&(h=m)}}return!0}function ea(t,e){t.globalCompositeOperation=e.blend||"source-over"}function tn(t,e){return t==null?e:t}function cy(t,e){const n=e.length;for(let i=0;i<n;++i)t.addColorStop(e[i].offset,e[i].color);return t}function c7(t,e,n){const i=n.width(),r=n.height();let a;if(e.gradient==="radial")a=t.createRadialGradient(n.x1+tn(e.x1,.5)*i,n.y1+tn(e.y1,.5)*r,Math.max(i,r)*tn(e.r1,0),n.x1+tn(e.x2,.5)*i,n.y1+tn(e.y2,.5)*r,Math.max(i,r)*tn(e.r2,.5));else{const o=tn(e.x1,0),u=tn(e.y1,0),s=tn(e.x2,1),l=tn(e.y2,0);if(o===s||u===l||i===r)a=t.createLinearGradient(n.x1+o*i,n.y1+u*r,n.x1+s*i,n.y1+l*r);else{const f=ma(Math.ceil(i),Math.ceil(r)),c=f.getContext("2d");return c.scale(i,r),c.fillStyle=cy(c.createLinearGradient(o,u,s,l),e.stops),c.fillRect(0,0,i,r),t.createPattern(f,"no-repeat")}}return cy(a,e.stops)}function u3(t,e,n){return Lg(n)?c7(t,n,e.bounds):n}function qs(t,e,n){return n*=e.fillOpacity==null?1:e.fillOpacity,n>0?(t.globalAlpha=n,t.fillStyle=u3(t,e,e.fill),!0):!1}var h7=[];function na(t,e,n){var i=(i=e.strokeWidth)!=null?i:1;return i<=0?!1:(n*=e.strokeOpacity==null?1:e.strokeOpacity,n>0?(t.globalAlpha=n,t.strokeStyle=u3(t,e,e.stroke),t.lineWidth=i,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||h7),t.lineDashOffset=e.strokeDashOffset||0),!0):!1)}function d7(t,e){return t.zindex-e.zindex||t.index-e.index}function Hg(t){if(!t.zdirty)return t.zitems;var e=t.items,n=[],i,r,a;for(r=0,a=e.length;r<a;++r)i=e[r],i.index=r,i.zindex&&n.push(i);return t.zdirty=!1,t.zitems=n.sort(d7)}function dn(t,e){var n=t.items,i,r;if(!n||!n.length)return;const a=Hg(t);if(a&&a.length){for(i=0,r=n.length;i<r;++i)n[i].zindex||e(n[i]);n=a}for(i=0,r=n.length;i<r;++i)e(n[i])}function js(t,e){var n=t.items,i,r;if(!n||!n.length)return null;const a=Hg(t);for(a&&a.length&&(n=a),r=n.length;--r>=0;)if(i=e(n[r]))return i;if(n===a){for(n=t.items,r=n.length;--r>=0;)if(!n[r].zindex&&(i=e(n[r])))return i}return null}function Wg(t){return function(e,n,i){dn(n,r=>{(!i||i.intersects(r.bounds))&&s3(t,e,r,r)})}}function g7(t){return function(e,n,i){n.items.length&&(!i||i.intersects(n.bounds))&&s3(t,e,n.items[0],n.items)}}function s3(t,e,n,i){var r=n.opacity==null?1:n.opacity;r!==0&&(t(e,i)||(ea(e,n),n.fill&&qs(e,n,r)&&e.fill(),n.stroke&&na(e,n,r)&&e.stroke()))}function yf(t){return t=t||Xe,function(e,n,i,r,a,o){return i*=e.pixelRatio,r*=e.pixelRatio,js(n,u=>{const s=u.bounds;if(!(s&&!s.contains(a,o)||!s)&&t(e,u,i,r,a,o))return u})}}function pu(t,e){return function(n,i,r,a){var o=Array.isArray(i)?i[0]:i,u=e==null?o.fill:e,s=o.stroke&&n.isPointInStroke,l,f;return s&&(l=o.strokeWidth,f=o.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=f!=null?f:"butt"),t(n,i)?!1:u&&n.isPointInPath(r,a)||s&&n.isPointInStroke(r,a)}}function Gg(t){return yf(pu(t))}function Ki(t,e){return"translate("+t+","+e+")"}function Vg(t){return"rotate("+t+")"}function m7(t,e){return"scale("+t+","+e+")"}function l3(t){return Ki(t.x||0,t.y||0)}function p7(t){return Ki(t.x||0,t.y||0)+(t.angle?" "+Vg(t.angle):"")}function y7(t){return Ki(t.x||0,t.y||0)+(t.angle?" "+Vg(t.angle):"")+(t.scaleX||t.scaleY?" "+m7(t.scaleX||1,t.scaleY||1):"")}function Xg(t,e,n){function i(o,u){o("transform",p7(u)),o("d",e(null,u))}function r(o,u){return e(mu(o,u.angle),u),Zn(o,u).translate(u.x||0,u.y||0)}function a(o,u){var s=u.x||0,l=u.y||0,f=u.angle||0;o.translate(s,l),f&&o.rotate(f*=Ci),o.beginPath(),e(o,u),f&&o.rotate(-f),o.translate(-s,-l)}return{type:t,tag:"path",nested:!1,attr:i,bound:r,draw:Wg(a),pick:Gg(a),isect:n||jg(a)}}var v7=Xg("arc",n7);function x7(t,e){for(var n=t[0].orient==="horizontal"?e[1]:e[0],i=t[0].orient==="horizontal"?"y":"x",r=t.length,a=1/0,o,u;--r>=0;)t[r].defined!==!1&&(u=Math.abs(t[r][i]-n),u<a&&(a=u,o=t[r]));return o}function b7(t,e){for(var n=Math.pow(t[0].strokeWidth||1,2),i=t.length,r,a,o;--i>=0;)if(t[i].defined!==!1&&(r=t[i].x-e[0],a=t[i].y-e[1],o=r*r+a*a,o<n))return t[i];return null}function w7(t,e){for(var n=t.length,i,r,a;--n>=0;)if(t[n].defined!==!1&&(i=t[n].x-e[0],r=t[n].y-e[1],a=i*i+r*r,i=t[n].size||1,a<i*i))return t[n];return null}function Kg(t,e,n){function i(s,l){var f=l.mark.items;f.length&&s("d",e(null,f))}function r(s,l){var f=l.items;return f.length===0?s:(e(mu(s),f),Zn(s,f[0]))}function a(s,l){s.beginPath(),e(s,l)}const o=pu(a);function u(s,l,f,c,h,d){var g=l.items,m=l.bounds;return!g||!g.length||m&&!m.contains(h,d)?null:(f*=s.pixelRatio,c*=s.pixelRatio,o(s,g,f,c)?g[0]:null)}return{type:t,tag:"path",nested:!0,attr:i,bound:r,draw:g7(a),pick:u,isect:Yg,tip:n}}var _7=Kg("area",i7,x7);function M7(t,e){var n=e.clip;t.save(),Q(n)?(t.beginPath(),n(t),t.clip()):f3(t,e.group)}function f3(t,e){t.beginPath(),Ig(e)?ya(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function c3(t){const e=tn(t.strokeWidth,1);return t.strokeOffset!=null?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function k7(t,e){t("transform",l3(e))}function h3(t,e){const n=c3(e);t("d",ya(null,e,n,n))}function A7(t,e){t("class","background"),t("aria-hidden",!0),h3(t,e)}function E7(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?h3(t,e):t("d","")}function C7(t,e,n){const i=e.clip?Ug(n,e,e):null;t("clip-path",i)}function D7(t,e){if(!e.clip&&e.items){const n=e.items,i=n.length;for(let r=0;r<i;++r)t.union(n[r].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),Zn(t,e),t.translate(e.x||0,e.y||0)}function Lo(t,e,n,i){const r=c3(e);t.beginPath(),ya(t,e,(n||0)+r,(i||0)+r)}const S7=pu(Lo),F7=pu(Lo,!1),$7=pu(Lo,!0);function T7(t,e,n){dn(e,i=>{const r=i.x||0,a=i.y||0,o=i.strokeForeground,u=i.opacity==null?1:i.opacity;(i.stroke||i.fill)&&u&&(Lo(t,i,r,a),ea(t,i),i.fill&&qs(t,i,u)&&t.fill(),i.stroke&&!o&&na(t,i,u)&&t.stroke()),t.save(),t.translate(r,a),i.clip&&f3(t,i),n&&n.translate(-r,-a),dn(i,s=>{this.draw(t,s,n)}),n&&n.translate(r,a),t.restore(),o&&i.stroke&&u&&(Lo(t,i,r,a),ea(t,i),na(t,i,u)&&t.stroke())})}function R7(t,e,n,i,r,a){if(e.bounds&&!e.bounds.contains(r,a)||!e.items)return null;const o=n*t.pixelRatio,u=i*t.pixelRatio;return js(e,s=>{let l,f,c;const h=s.bounds;if(h&&!h.contains(r,a))return;f=s.x||0,c=s.y||0;const d=f+(s.width||0),g=c+(s.height||0),m=s.clip;if(m&&(r<f||r>d||a<c||a>g))return;if(t.save(),t.translate(f,c),f=r-f,c=a-c,m&&Ig(s)&&!$7(t,s,o,u))return t.restore(),null;const p=s.strokeForeground,y=e.interactive!==!1;return y&&p&&s.stroke&&F7(t,s,o,u)?(t.restore(),s):(l=js(s,v=>N7(v,f,c)?this.pick(v,n,i,f,c):null),!l&&y&&(s.fill||!p&&s.stroke)&&S7(t,s,o,u)&&(l=s),t.restore(),l||null)})}function N7(t,e,n){return(t.interactive!==!1||t.marktype==="group")&&t.bounds&&t.bounds.contains(e,n)}var O7={type:"group",tag:"g",nested:!1,attr:k7,bound:D7,draw:T7,pick:R7,isect:a3,content:C7,background:A7,foreground:E7},Po={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Zg(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(i=>{t.image=i,t.image.url=t.url})),n}function Jg(t,e){return t.width!=null?t.width:!e||!e.width?0:t.aspect!==!1&&t.height?t.height*e.width/e.height:e.width}function Qg(t,e){return t.height!=null?t.height:!e||!e.height?0:t.aspect!==!1&&t.width?t.width*e.height/e.width:e.height}function vf(t,e){return t==="center"?e/2:t==="right"?e:0}function xf(t,e){return t==="middle"?e/2:t==="bottom"?e:0}function z7(t,e,n){const i=Zg(e,n),r=Jg(e,i),a=Qg(e,i),o=(e.x||0)-vf(e.align,r),u=(e.y||0)-xf(e.baseline,a),s=!i.src&&i.toDataURL?i.toDataURL():i.src||"";t("href",s,Po["xmlns:xlink"],"xlink:href"),t("transform",Ki(o,u)),t("width",r),t("height",a),t("preserveAspectRatio",e.aspect===!1?"none":"xMidYMid")}function B7(t,e){const n=e.image,i=Jg(e,n),r=Qg(e,n),a=(e.x||0)-vf(e.align,i),o=(e.y||0)-xf(e.baseline,r);return t.set(a,o,a+i,o+r)}function L7(t,e,n){dn(e,i=>{if(n&&!n.intersects(i.bounds))return;const r=Zg(i,this);let a=Jg(i,r),o=Qg(i,r);if(a===0||o===0)return;let u=(i.x||0)-vf(i.align,a),s=(i.y||0)-xf(i.baseline,o),l,f,c,h;i.aspect!==!1&&(f=r.width/r.height,c=i.width/i.height,f===f&&c===c&&f!==c&&(c<f?(h=a/f,s+=(o-h)/2,o=h):(h=o*f,u+=(a-h)/2,a=h))),(r.complete||r.toDataURL)&&(ea(t,i),t.globalAlpha=(l=i.opacity)!=null?l:1,t.imageSmoothingEnabled=i.smooth!==!1,t.drawImage(r,u,s,a,o))})}var P7={type:"image",tag:"image",nested:!1,attr:z7,bound:B7,draw:L7,pick:yf(),isect:Xe,get:Zg,xOffset:vf,yOffset:xf},I7=Kg("line",r7,b7);function U7(t,e){var n=e.scaleX||1,i=e.scaleY||1;(n!==1||i!==1)&&t("vector-effect","non-scaling-stroke"),t("transform",y7(e)),t("d",e.path)}function vs(t,e){var n=e.path;if(n==null)return!0;var i=e.x||0,r=e.y||0,a=e.scaleX||1,o=e.scaleY||1,u=(e.angle||0)*Ci,s=e.pathCache;(!s||s.path!==n)&&((e.pathCache=s=ta(n)).path=n),u&&t.rotate&&t.translate?(t.translate(i,r),t.rotate(u),Bo(t,s,0,0,a,o),t.rotate(-u),t.translate(-i,-r)):Bo(t,s,i,r,a,o)}function q7(t,e){return vs(mu(t,e.angle),e)?t.set(0,0,0,0):Zn(t,e,!0)}var j7={type:"path",tag:"path",nested:!1,attr:U7,bound:q7,draw:Wg(vs),pick:Gg(vs),isect:jg(vs)};function Y7(t,e){t("d",ya(null,e))}function H7(t,e){var n,i;return Zn(t.set(n=e.x||0,i=e.y||0,n+e.width||0,i+e.height||0),e)}function hy(t,e){t.beginPath(),ya(t,e)}var W7={type:"rect",tag:"path",nested:!1,attr:Y7,bound:H7,draw:Wg(hy),pick:Gg(hy),isect:a3};function G7(t,e){t("transform",l3(e)),t("x2",e.x2!=null?e.x2-(e.x||0):0),t("y2",e.y2!=null?e.y2-(e.y||0):0)}function V7(t,e){var n,i;return Zn(t.set(n=e.x||0,i=e.y||0,e.x2!=null?e.x2:n,e.y2!=null?e.y2:i),e)}function d3(t,e,n){var i,r,a,o;return e.stroke&&na(t,e,n)?(i=e.x||0,r=e.y||0,a=e.x2!=null?e.x2:i,o=e.y2!=null?e.y2:r,t.beginPath(),t.moveTo(i,r),t.lineTo(a,o),!0):!1}function X7(t,e,n){dn(e,i=>{if(!(n&&!n.intersects(i.bounds))){var r=i.opacity==null?1:i.opacity;r&&d3(t,i,r)&&(ea(t,i),t.stroke())}})}function K7(t,e,n,i){return t.isPointInStroke?d3(t,e,1)&&t.isPointInStroke(n,i):!1}var Z7={type:"rule",tag:"line",nested:!1,attr:G7,bound:V7,draw:X7,pick:yf(K7),isect:o3},J7=Xg("shape",a7),Q7=Xg("symbol",o7,Yg);const dy=xx();var En={height:On,measureWidth:t1,estimateWidth:Uh,width:Uh,canvas:g3};g3(!0);function g3(t){En.width=t&&wi?t1:Uh}function Uh(t,e){return m3(Si(t,e),On(t))}function m3(t,e){return~~(.8*t.length*e)}function t1(t,e){return On(t)<=0||!(e=Si(t,e))?0:p3(e,bf(t))}function p3(t,e){const n=`(${e}) ${t}`;let i=dy.get(n);return i===void 0&&(wi.font=e,i=wi.measureText(t).width,dy.set(n,i)),i}function On(t){return t.fontSize!=null?+t.fontSize||0:11}function Di(t){return t.lineHeight!=null?t.lineHeight:On(t)+2}function t9(t){return Y(t)?t.length>1?t:t[0]:t}function yu(t){return t9(t.lineBreak&&t.text&&!Y(t.text)?t.text.split(t.lineBreak):t.text)}function e1(t){const e=yu(t);return(Y(e)?e.length-1:0)*Di(t)}function Si(t,e){const n=e==null?"":(e+"").trim();return t.limit>0&&n.length?n9(t,n):n}function e9(t){if(En.width===t1){const e=bf(t);return n=>p3(n,e)}else{const e=On(t);return n=>m3(n,e)}}function n9(t,e){var n=+t.limit,i=e9(t);if(i(e)<n)return e;var r=t.ellipsis||"\u2026",a=t.dir==="rtl",o=0,u=e.length,s;if(n-=i(r),a){for(;o<u;)s=o+u>>>1,i(e.slice(s))>n?o=s+1:u=s;return r+e.slice(o)}else{for(;o<u;)s=1+(o+u>>>1),i(e.slice(0,s))<n?o=s:u=s-1;return e.slice(0,o)+r}}function vu(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function bf(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+On(t)+"px "+vu(t,e)}function n1(t){var e=t.baseline,n=On(t);return Math.round(e==="top"?.79*n:e==="middle"?.3*n:e==="bottom"?-.21*n:e==="line-top"?.29*n+.5*Di(t):e==="line-bottom"?.29*n-.5*Di(t):0)}const i9={left:"start",center:"middle",right:"end"},go=new Ft;function wf(t){var e=t.x||0,n=t.y||0,i=t.radius||0,r;return i&&(r=(t.theta||0)-ji,e+=i*Math.cos(r),n+=i*Math.sin(r)),go.x1=e,go.y1=n,go}function r9(t,e){var n=e.dx||0,i=(e.dy||0)+n1(e),r=wf(e),a=r.x1,o=r.y1,u=e.angle||0,s;t("text-anchor",i9[e.align]||"start"),u?(s=Ki(a,o)+" "+Vg(u),(n||i)&&(s+=" "+Ki(n,i))):s=Ki(a+n,o+i),t("transform",s)}function i1(t,e,n){var i=En.height(e),r=e.align,a=wf(e),o=a.x1,u=a.y1,s=e.dx||0,l=(e.dy||0)+n1(e)-Math.round(.8*i),f=yu(e),c;if(Y(f)?(i+=Di(e)*(f.length-1),c=f.reduce((h,d)=>Math.max(h,En.width(e,d)),0)):c=En.width(e,f),r==="center"?s-=c/2:r==="right"&&(s-=c),t.set(s+=o,l+=u,s+c,l+i),e.angle&&!n)t.rotate(e.angle*Ci,o,u);else if(n===2)return t.rotatedPoints(e.angle*Ci,o,u);return t}function a9(t,e,n){dn(e,i=>{var r=i.opacity==null?1:i.opacity,a,o,u,s,l,f,c;if(!(n&&!n.intersects(i.bounds)||r===0||i.fontSize<=0||i.text==null||i.text.length===0)){if(t.font=bf(i),t.textAlign=i.align||"left",a=wf(i),o=a.x1,u=a.y1,i.angle&&(t.save(),t.translate(o,u),t.rotate(i.angle*Ci),o=u=0),o+=i.dx||0,u+=(i.dy||0)+n1(i),f=yu(i),ea(t,i),Y(f))for(l=Di(i),s=0;s<f.length;++s)c=Si(i,f[s]),i.fill&&qs(t,i,r)&&t.fillText(c,o,u),i.stroke&&na(t,i,r)&&t.strokeText(c,o,u),u+=l;else c=Si(i,f),i.fill&&qs(t,i,r)&&t.fillText(c,o,u),i.stroke&&na(t,i,r)&&t.strokeText(c,o,u);i.angle&&t.restore()}})}function o9(t,e,n,i,r,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=wf(e),u=o.x1,s=o.y1,l=i1(go,e,1),f=-e.angle*Ci,c=Math.cos(f),h=Math.sin(f),d=c*r-h*a+(u-c*u+h*s),g=h*r+c*a+(s-h*u-c*s);return l.contains(d,g)}function u9(t,e){const n=i1(go,t,2);return zr(e,n[0],n[1],n[2],n[3])||zr(e,n[0],n[1],n[4],n[5])||zr(e,n[4],n[5],n[6],n[7])||zr(e,n[2],n[3],n[6],n[7])}var s9={type:"text",tag:"text",nested:!1,attr:r9,bound:i1,draw:a9,pick:yf(o9),isect:u9},l9=Kg("trail",u7,w7),Le={arc:v7,area:_7,group:O7,image:P7,line:I7,path:j7,rect:W7,rule:Z7,shape:J7,symbol:Q7,text:s9,trail:l9};function qh(t,e,n){var i=Le[t.mark.marktype],r=e||i.bound;return i.nested&&(t=t.mark),r(t.bounds||(t.bounds=new Ft),t,n)}var gy={mark:null};function y3(t,e,n){var i=Le[t.marktype],r=i.bound,a=t.items,o=a&&a.length,u,s,l,f;if(i.nested)return o?l=a[0]:(gy.mark=t,l=gy),f=qh(l,r,n),e=e&&e.union(f)||f,e;if(e=e||t.bounds&&t.bounds.clear()||new Ft,o)for(u=0,s=a.length;u<s;++u)e.union(qh(a[u],r,n));return t.bounds=e}const f9=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function v3(t,e){return JSON.stringify(t,f9,e)}function x3(t){const e=typeof t=="string"?JSON.parse(t):t;return b3(e)}function b3(t){var e=t.marktype,n=t.items,i,r,a;if(n)for(r=0,a=n.length;r<a;++r)i=e?"mark":"group",n[r][i]=t,n[r].zindex&&(n[r][i].zdirty=!0),(e||i)==="group"&&b3(n[r]);return e&&y3(t),t}function r1(t){arguments.length?this.root=x3(t):(this.root=w3({marktype:"group",name:"root",role:"frame"}),this.root.items=[new mf(this.root)])}r1.prototype={toJSON(t){return v3(this.root,t||0)},mark(t,e,n){e=e||this.root.items[0];const i=w3(t,e);return e.items[n]=i,i.zindex&&(i.group.zdirty=!0),i}};function w3(t,e){const n={bounds:new Ft,clip:!!t.clip,group:e,interactive:t.interactive!==!1,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return t.aria!=null&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function hi(t,e,n){return!t&&typeof document!="undefined"&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function a1(t,e){e=e.toLowerCase();for(var n=t.childNodes,i=0,r=n.length;i<r;++i)if(n[i].tagName.toLowerCase()===e)return n[i]}function be(t,e,n,i){var r=t.childNodes[e],a;return(!r||r.tagName.toLowerCase()!==n.toLowerCase())&&(a=r||null,r=hi(t.ownerDocument,n,i),t.insertBefore(r,a)),r}function an(t,e){for(var n=t.childNodes,i=n.length;i>e;)t.removeChild(n[--i]);return t}function _3(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function _f(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function c9(t,e,n,i){var r=t&&t.mark,a,o;if(r&&(a=Le[r.marktype]).tip){for(o=_f(e,n),o[0]-=i[0],o[1]-=i[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=a.tip(r.items,o)}return t}function Fi(t,e){this._active=null,this._handlers={},this._loader=t||ql(),this._tooltip=e||h9}function h9(t,e,n,i){t.element().setAttribute("title",i||"")}Fi.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let i=t?t.length:0;--i>=0;)if(t[i].type===e&&(!n||t[i].handler===n))return i;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const i in e)n.push(...e[i]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(i=>{const r=new MouseEvent(t.type,t),a=hi(null,"a");for(const o in i)a.setAttribute(o,i[o]);a.dispatchEvent(r)}).catch(()=>{})},handleTooltip(t,e,n){if(e&&e.tooltip!=null){e=c9(e,t,this.canvas(),this._origin);const i=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,i)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),i=this._origin,r=t.bounds,a=r.width(),o=r.height();let u=r.x1+i[0]+n.left,s=r.y1+i[1]+n.top;for(;t.mark&&(t=t.mark.group);)u+=t.x||0,s+=t.y||0;return{x:u,y:s,width:a,height:o,left:u,top:s,right:u+a,bottom:s+o}}};function zn(t){this._el=null,this._bgcolor=null,this._loader=new qg(t)}zn.prototype={initialize(t,e,n,i,r){return this._el=t,this.resize(e,n,i,r)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,i){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=i||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then(()=>e):Promise.resolve(e)},_load(t,e){var n=this,i=n._loader[t](e);if(!n._ready){const r=n._call;n._ready=n._loader.ready().then(a=>{a&&r(),n._ready=null})}return i},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const d9="keydown",g9="keypress",m9="keyup",M3="dragenter",xs="dragleave",k3="dragover",jh="mousedown",p9="mouseup",Ys="mousemove",mo="mouseout",A3="mouseover",Hs="click",y9="dblclick",v9="wheel",E3="mousewheel",Ws="touchstart",Gs="touchmove",Vs="touchend",x9=[d9,g9,m9,M3,xs,k3,jh,p9,Ys,mo,A3,Hs,y9,v9,E3,Ws,Gs,Vs],Yh=Ys,Io=mo,Hh=Hs;function xu(t,e){Fi.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}const b9=t=>t===Ws||t===Gs||t===Vs?[Ws,Gs,Vs]:[t];function my(t,e){b9(e).forEach(n=>w9(t,n))}function w9(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?i=>t[e](i):i=>t.fire(e,i)))}function py(t,e,n){return function(i){const r=this._active,a=this.pickEvent(i);a===r?this.fire(t,i):((!r||!r.exit)&&this.fire(n,i),this._active=a,this.fire(e,i),this.fire(t,i))}}function yy(t){return function(e){this.fire(t,e),this._active=null}}z(xu,Fi,{initialize(t,e,n){return this._canvas=t&&a1(t,"canvas"),[Hs,jh,Ys,mo,xs].forEach(i=>my(this,i)),Fi.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:x9,DOMMouseScroll(t){this.fire(E3,t)},mousemove:py(Ys,A3,mo),dragover:py(k3,M3,xs),mouseout:yy(mo),dragleave:yy(xs),mousedown(t){this._down=this._active,this.fire(jh,t)},click(t){this._down===this._active&&(this.fire(Hs,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Ws,t,!0)},touchmove(t){this.fire(Gs,t,!0)},touchend(t){this.fire(Vs,t,!0),this._touch=null},fire(t,e,n){const i=n?this._touch:this._active,r=this._handlers[t];if(e.vegaType=t,t===Hh&&i&&i.href?this.handleHref(e,i,i.href):(t===Yh||t===Io)&&this.handleTooltip(e,i,t!==Io),r)for(let a=0,o=r.length;a<o;++a)r[a].handler.call(this._obj,e,i)},on(t,e){const n=this.eventName(t),i=this._handlers;return this._handlerIndex(i[n],t,e)<0&&(my(this,t),(i[n]||(i[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);return r>=0&&i.splice(r,1),this},pickEvent(t){const e=_f(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,i,r){const a=this.context();return Le[t.marktype].pick.call(this,a,t,e,n,i,r)}});function _9(){return typeof window!="undefined"&&window.devicePixelRatio||1}var M9=_9();function k9(t,e,n,i,r,a){const o=typeof HTMLElement!="undefined"&&t instanceof HTMLElement&&t.parentNode!=null,u=t.getContext("2d"),s=o?M9:r;t.width=e*s,t.height=n*s;for(const l in a)u[l]=a[l];return o&&s!==1&&(t.style.width=e+"px",t.style.height=n+"px"),u.pixelRatio=s,u.setTransform(s,0,0,s,s*i[0],s*i[1]),t}function Xs(t){zn.call(this,t),this._options={},this._redraw=!1,this._dirty=new Ft,this._tempb=new Ft}const vy=zn.prototype,A9=(t,e,n)=>new Ft().set(0,0,e,n).translate(-t[0],-t[1]);function E9(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-(n[0]%1),-(n[1]%1)),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}z(Xs,zn,{initialize(t,e,n,i,r,a){return this._options=a||{},this._canvas=this._options.externalContext?null:ma(1,1,this._options.type),t&&this._canvas&&(an(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),vy.initialize.call(this,t,e,n,i,r)},resize(t,e,n,i){if(vy.resize.call(this,t,e,n,i),this._canvas)k9(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const r=this._options.externalContext;r||R("CanvasRenderer is missing a valid canvas or context"),r.scale(this._scale,this._scale),r.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,i=this._width,r=this._height,a=this._dirty,o=A9(n,i,r);e.save();const u=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):E9(e,o.intersect(a),n);return this.clear(-n[0],-n[1],i,r),this.draw(e,t,u),e.restore(),a.clear(),this},draw(t,e,n){const i=Le[e.marktype];e.clip&&M7(t,e),i.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,i){const r=this._options,a=this.context();r.type!=="pdf"&&!r.externalContext&&a.clearRect(t,e,n,i),this._bgcolor!=null&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,i))}});function o1(t,e){Fi.call(this,t,e);const n=this;n._hrefHandler=Wh(n,(i,r)=>{r&&r.href&&n.handleHref(i,r,r.href)}),n._tooltipHandler=Wh(n,(i,r)=>{n.handleTooltip(i,r,i.type!==Io)})}const Wh=(t,e)=>n=>{let i=n.target.__data__;i=Array.isArray(i)?i[0]:i,n.vegaType=n.type,e.call(t._obj,n,i)};z(o1,Fi,{initialize(t,e,n){let i=this._svg;return i&&(i.removeEventListener(Hh,this._hrefHandler),i.removeEventListener(Yh,this._tooltipHandler),i.removeEventListener(Io,this._tooltipHandler)),this._svg=i=t&&a1(t,"svg"),i&&(i.addEventListener(Hh,this._hrefHandler),i.addEventListener(Yh,this._tooltipHandler),i.addEventListener(Io,this._tooltipHandler)),Fi.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),i=this._handlers;if(this._handlerIndex(i[n],t,e)<0){const a={type:t,handler:e,listener:Wh(this,e)};(i[n]||(i[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off(t,e){const n=this.eventName(t),i=this._handlers[n],r=this._handlerIndex(i,t,e);return r>=0&&(this._svg&&this._svg.removeEventListener(n,i[r].listener),i.splice(r,1)),this}});const C3="aria-hidden",u1="aria-label",s1="role",l1="aria-roledescription",D3="graphics-object",f1="graphics-symbol",S3=(t,e,n)=>({[s1]:t,[l1]:e,[u1]:n||void 0}),C9=cn(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),xy={axis:{desc:"axis",caption:F9},legend:{desc:"legend",caption:$9},"title-text":{desc:"title",caption:t=>`Title text '${wy(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${wy(t)}'`}},by={ariaRole:s1,ariaRoleDescription:l1,description:u1};function F3(t,e){const n=e.aria===!1;if(t(C3,n||void 0),n||e.description==null)for(const i in by)t(by[i],void 0);else{const i=e.mark.marktype;t(u1,e.description),t(s1,e.ariaRole||(i==="group"?D3:f1)),t(l1,e.ariaRoleDescription||`${i} mark`)}}function $3(t){return t.aria===!1?{[C3]:!0}:C9[t.role]?null:xy[t.role]?S9(t,xy[t.role]):D9(t)}function D9(t){const e=t.marktype,n=e==="group"||e==="text"||t.items.some(i=>i.description!=null&&i.aria!==!1);return S3(n?D3:f1,`${e} mark container`,t.description)}function S9(t,e){try{const n=t.items[0],i=e.caption||(()=>"");return S3(e.role||f1,e.desc,n.description||i(n))}catch{return null}}function wy(t){return G(t.text).join(" ")}function F9(t){const e=t.datum,n=t.orient,i=e.title?T3(t):null,r=t.context,a=r.scales[e.scale].value,o=r.dataflow.locale(),u=a.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(i?` titled '${i}'`:"")+` for a ${Qr(u)?"discrete":u} scale with ${X_(o,a,t)}`}function $9(t){const e=t.datum,n=e.title?T3(t):null,i=`${e.type||""} legend`.trim(),r=e.scales,a=Object.keys(r),o=t.context,u=o.scales[r[a[0]]].value,s=o.dataflow.locale();return R9(i)+(n?` titled '${n}'`:"")+` for ${T9(a)} with ${X_(s,u,t)}`}function T3(t){try{return G(it(t.items).items[0].text).join(" ")}catch{return null}}function T9(t){return t=t.map(e=>e+(e==="fill"||e==="stroke"?" color":"")),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+it(t)}function R9(t){return t.length?t[0].toUpperCase()+t.slice(1):t}const R3=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),N9=t=>R3(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function c1(){let t="",e="",n="";const i=[],r=()=>e=n="",a=s=>{e&&(t+=`${e}>${n}`,r()),i.push(s)},o=(s,l)=>(l!=null&&(e+=` ${s}="${N9(l)}"`),u),u={open(s,...l){a(s),e="<"+s;for(const f of l)for(const c in f)o(c,f[c]);return u},close(){const s=i.pop();return e?t+=e+(n?`>${n}</${s}>`:"/>"):t+=`</${s}>`,r(),u},attr:o,text:s=>(n+=R3(s),u),toString:()=>t};return u}const N3=t=>O3(c1(),t)+"";function O3(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,i=n.length;for(let r=0;r<i;++r)t.attr(n[r].name,n[r].value)}if(e.hasChildNodes()){const n=e.childNodes,i=n.length;for(let r=0;r<i;r++){const a=n[r];a.nodeType===3?t.text(a.nodeValue):O3(t,a)}}return t.close()}const Ks={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},z3={fill:"none","stroke-miterlimit":10},Ba=0,_y="http://www.w3.org/2000/xmlns/",Ct=Po.xmlns;function h1(t){zn.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const pc=zn.prototype;z(h1,zn,{initialize(t,e,n,i,r){return this._defs={},this._clearDefs(),t&&(this._svg=be(t,0,"svg",Ct),this._svg.setAttributeNS(_y,"xmlns",Ct),this._svg.setAttributeNS(_y,"xmlns:xlink",Po["xmlns:xlink"]),this._svg.setAttribute("version",Po.version),this._svg.setAttribute("class","marks"),an(t,1),this._root=be(this._svg,Ba,"g",Ct),di(this._root,z3),an(this._svg,Ba+1)),this.background(this._bgcolor),pc.initialize.call(this,t,e,n,i,r)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),pc.background.apply(this,arguments)},resize(t,e,n,i){return pc.resize.call(this,t,e,n,i),this._svg&&(di(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=be(t,Ba,"rect",Ct),di(n,{width:this._width,height:this._height,fill:e}));const i=N3(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),i},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),an(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,i,r,a,o,u,s;for(o=0,u=t.length;o<u;++o)if(n=t[o],i=n.mark,i.marktype!==r&&(r=i.marktype,a=Le[r]),i.zdirty&&i.dirty!==e&&(this._dirtyAll=!1,My(n,e),i.items.forEach(l=>{l.dirty=e})),!i.zdirty){if(n.exit){a.nested&&i.items.length?(s=i.items[0],s._svg&&this._update(a,s._svg,s)):n._svg&&(s=n._svg.parentNode,s&&s.removeChild(n._svg)),n._svg=null;continue}n=a.nested?i.items[0]:n,n._update!==e&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,My(n,e)):this._update(a,n._svg,n),n._update=e)}return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const i=this._svg,r=Le[e.marktype],a=e.interactive===!1?"none":null,o=r.tag==="g";let u=null,s=0;const l=ky(e,t,n,"g",i);l.setAttribute("class",_3(e));const f=$3(e);for(const h in f)oe(l,h,f[h]);o||oe(l,"pointer-events",a),oe(l,"clip-path",e.clip?Ug(this,e,e.group):null);const c=h=>{const d=this.isDirty(h),g=ky(h,l,u,r.tag,i);d&&(this._update(r,g,h),o&&B9(this,g,h)),u=g,++s};return r.nested?e.items.length&&c(e.items[0]):dn(e,c),an(l,s),l},_update(t,e,n){Wn=e,Gt=e.__values__,F3(po,n),t.attr(po,n,this);const i=P9[t.type];i&&i.call(this,t,e,n),Wn&&this.style(Wn,n)},style(t,e){if(e!=null)for(const n in Ks){let i=n==="font"?vu(e):e[n];if(i===Gt[n])continue;const r=Ks[n];i==null?t.removeAttribute(r):(Lg(i)&&(i=Z_(i,this._defs.gradient,B3())),t.setAttribute(r,i+"")),Gt[n]=i}},defs(){const t=this._svg,e=this._defs;let n=e.el,i=0;for(const r in e.gradient)n||(e.el=n=be(t,Ba+1,"defs",Ct)),i=O9(n,e.gradient[r],i);for(const r in e.clipping)n||(e.el=n=be(t,Ba+1,"defs",Ct)),i=z9(n,e.clipping[r],i);n&&(i===0?(t.removeChild(n),e.el=null):an(n,i))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});function My(t,e){for(;t&&t.dirty!==e;t=t.mark.group)if(t.dirty=e,t.mark&&t.mark.dirty!==e)t.mark.dirty=e;else return}function O9(t,e,n){let i,r,a;if(e.gradient==="radial"){let o=be(t,n++,"pattern",Ct);di(o,{id:Us+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=be(o,0,"rect",Ct),di(o,{width:1,height:1,fill:`url(${B3()}#${e.id})`}),t=be(t,n++,"radialGradient",Ct),di(t,{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else t=be(t,n++,"linearGradient",Ct),di(t,{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(i=0,r=e.stops.length;i<r;++i)a=be(t,i,"stop",Ct),a.setAttribute("offset",e.stops[i].offset),a.setAttribute("stop-color",e.stops[i].color);return an(t,i),n}function z9(t,e,n){let i;return t=be(t,n,"clipPath",Ct),t.setAttribute("id",e.id),e.path?(i=be(t,0,"path",Ct),i.setAttribute("d",e.path)):(i=be(t,0,"rect",Ct),di(i,{x:0,y:0,width:e.width,height:e.height})),an(t,1),n+1}function B9(t,e,n){e=e.lastChild.previousSibling;let i,r=0;dn(n,a=>{i=t.mark(e,a,i),++r}),an(e,1+r)}function ky(t,e,n,i,r){let a=t._svg,o;if(!a&&(o=e.ownerDocument,a=hi(o,i,Ct),t._svg=a,t.mark&&(a.__data__=t,a.__values__={fill:"default"},i==="g"))){const u=hi(o,"path",Ct);a.appendChild(u),u.__data__=t;const s=hi(o,"g",Ct);a.appendChild(s),s.__data__=t;const l=hi(o,"path",Ct);a.appendChild(l),l.__data__=t,l.__values__={fill:"default"}}return(a.ownerSVGElement!==r||L9(a,n))&&e.insertBefore(a,n?n.nextSibling:e.firstChild),a}function L9(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}let Wn=null,Gt=null;const P9={group(t,e,n){const i=Wn=e.childNodes[2];Gt=i.__values__,t.foreground(po,n,this),Gt=e.__values__,Wn=e.childNodes[1],t.content(po,n,this);const r=Wn=e.childNodes[0];t.background(po,n,this);const a=n.mark.interactive===!1?"none":null;if(a!==Gt.events&&(oe(i,"pointer-events",a),oe(r,"pointer-events",a),Gt.events=a),n.strokeForeground&&n.stroke){const o=n.fill;oe(i,"display",null),this.style(r,n),oe(r,"stroke",null),o&&(n.fill=null),Gt=i.__values__,this.style(i,n),o&&(n.fill=o),Wn=null}else oe(i,"display","none")},image(t,e,n){n.smooth===!1?(yc(e,"image-rendering","optimizeSpeed"),yc(e,"image-rendering","pixelated")):yc(e,"image-rendering",null)},text(t,e,n){const i=yu(n);let r,a,o,u;Y(i)?(a=i.map(s=>Si(n,s)),r=a.join(`
`),r!==Gt.text&&(an(e,0),o=e.ownerDocument,u=Di(n),a.forEach((s,l)=>{const f=hi(o,"tspan",Ct);f.__data__=n,f.textContent=s,l&&(f.setAttribute("x",0),f.setAttribute("dy",u)),e.appendChild(f)}),Gt.text=r)):(a=Si(n,i),a!==Gt.text&&(e.textContent=a,Gt.text=a)),oe(e,"font-family",vu(n)),oe(e,"font-size",On(n)+"px"),oe(e,"font-style",n.fontStyle),oe(e,"font-variant",n.fontVariant),oe(e,"font-weight",n.fontWeight)}};function po(t,e,n){e!==Gt[t]&&(n?I9(Wn,t,e,n):oe(Wn,t,e),Gt[t]=e)}function yc(t,e,n){n!==Gt[e]&&(n==null?t.style.removeProperty(e):t.style.setProperty(e,n+""),Gt[e]=n)}function di(t,e){for(const n in e)oe(t,n,e[n])}function oe(t,e,n){n!=null?t.setAttribute(e,n):t.removeAttribute(e)}function I9(t,e,n,i){n!=null?t.setAttributeNS(i,e,n):t.removeAttributeNS(i,e)}function B3(){let t;return typeof window=="undefined"?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function d1(t){zn.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}z(d1,zn,{svg(){return this._text},_render(t){const e=c1();e.open("svg",Z({},Po,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",z3,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Le[e.marktype],i=n.tag,r=[F3,n.attr];t.open("g",{class:_3(e),"clip-path":e.clip?Ug(this,e,e.group):null},$3(e),{"pointer-events":i!=="g"&&e.interactive===!1?"none":null});const a=o=>{const u=this.href(o);if(u&&t.open("a",u),t.open(i,this.attr(e,o,r,i!=="g"?i:null)),i==="text"){const s=yu(o);if(Y(s)){const l={x:0,dy:Di(o)};for(let f=0;f<s.length;++f)t.open("tspan",f?l:null).text(Si(o,s[f])).close()}else t.text(Si(o,s))}else if(i==="g"){const s=o.strokeForeground,l=o.fill,f=o.stroke;s&&f&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),dn(o,c=>this.mark(t,c)),t.close(),s&&f?(l&&(o.fill=null),o.stroke=f,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),u&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):dn(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(i=>{i["xlink:href"]=i.href,i.href=null,(this._hrefs||(this._hrefs={}))[e]=i})}return null},attr(t,e,n,i){const r={},a=(o,u,s,l)=>{r[l||o]=u};return Array.isArray(n)?n.forEach(o=>o(a,e,this)):n(a,e,this),i&&U9(r,e,t,i,this._defs),r},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(Object.keys(e).length+Object.keys(n).length!==0){t.open("defs");for(const r in e){const a=e[r],o=a.stops;a.gradient==="radial"?(t.open("pattern",{id:Us+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),t.close(),t.open("radialGradient",{id:r,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):t.open("linearGradient",{id:r,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let u=0;u<o.length;++u)t.open("stop",{offset:o[u].offset,"stop-color":o[u].color}).close();t.close()}for(const r in n){const a=n[r];t.open("clipPath",{id:r}),a.path?t.open("path",{d:a.path}).close():t.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),t.close()}t.close()}}});function U9(t,e,n,i,r){if(e==null||(i==="bgrect"&&n.interactive===!1&&(t["pointer-events"]="none"),i==="bgfore"&&(n.interactive===!1&&(t["pointer-events"]="none"),t.display="none",e.fill!==null)))return t;i==="image"&&e.smooth===!1&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),i==="text"&&(t["font-family"]=vu(e),t["font-size"]=On(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const a in Ks){let o=e[a];const u=Ks[a];o==="transparent"&&(u==="fill"||u==="stroke")||o!=null&&(Lg(o)&&(o=Z_(o,r.gradient,"")),t[u]=o)}return t}const L3="canvas",P3="png",I3="svg",U3="none",gi={Canvas:L3,PNG:P3,SVG:I3,None:U3},ia={};ia[L3]=ia[P3]={renderer:Xs,headless:Xs,handler:xu};ia[I3]={renderer:h1,headless:d1,handler:o1};ia[U3]={};function Mf(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(ia[t]=e,this):ia[t]}function q3(t,e,n){const i=[],r=new Ft().union(e),a=t.marktype;return a?j3(t,r,n,i):a==="group"?Y3(t,r,n,i):R("Intersect scene must be mark node or group item.")}function j3(t,e,n,i){if(q9(t,e,n)){const r=t.items,a=t.marktype,o=r.length;let u=0;if(a==="group")for(;u<o;++u)Y3(r[u],e,n,i);else for(const s=Le[a].isect;u<o;++u){const l=r[u];H3(l,e,s)&&i.push(l)}}return i}function q9(t,e,n){return t.bounds&&e.intersects(t.bounds)&&(t.marktype==="group"||t.interactive!==!1&&(!n||n(t)))}function Y3(t,e,n,i){n&&n(t.mark)&&H3(t,e,Le.group.isect)&&i.push(t);const r=t.items,a=r&&r.length;if(a){const o=t.x||0,u=t.y||0;e.translate(-o,-u);for(let s=0;s<a;++s)j3(r[s],e,n,i);e.translate(o,u)}return i}function H3(t,e,n){const i=t.bounds;return e.encloses(i)||e.intersects(i)&&n(t,e)}const vc=new Ft;function W3(t){const e=t.clip;if(Q(e))e(mu(vc.clear()));else if(e)vc.set(0,0,t.group.width,t.group.height);else return;t.bounds.intersect(vc)}const j9=1e-9;function g1(t,e,n){return t===e?!0:n==="path"?G3(t,e):t instanceof Date&&e instanceof Date?+t==+e:Mi(t)&&Mi(e)?Math.abs(t-e)<=j9:!t||!e||!J(t)&&!J(e)?t==e:Y9(t,e)}function G3(t,e){return g1(ta(t),ta(e))}function Y9(t,e){var n=Object.keys(t),i=Object.keys(e),r,a;if(n.length!==i.length)return!1;for(n.sort(),i.sort(),a=n.length-1;a>=0;a--)if(n[a]!=i[a])return!1;for(a=n.length-1;a>=0;a--)if(r=n[a],!g1(t[r],e[r],r))return!1;return typeof t==typeof e}function H9(){r3(),wS()}const ra="top",on="left",sn="right",$i="bottom",W9="top-left",G9="top-right",V9="bottom-left",X9="bottom-right",m1="start",Gh="middle",ue="end",K9="x",Z9="y",kf="group",p1="axis",y1="title",J9="frame",Q9="scope",v1="legend",V3="row-header",X3="row-footer",K3="row-title",Z3="column-header",J3="column-footer",Q3="column-title",tF="padding",eF="symbol",tM="fit",nF="fit-x",iF="fit-y",rF="pad",x1="none",Uu="all",Vh="each",b1="flush",mi="column",pi="row";function eM(t){S.call(this,null,t)}z(eM,S,{transform(t,e){const n=e.dataflow,i=t.mark,r=i.marktype,a=Le[r],o=a.bound;let u=i.bounds,s;if(a.nested)i.items.length&&n.dirty(i.items[0]),u=qu(i,o),i.items.forEach(l=>{l.bounds.clear().union(u)});else if(r===kf||t.modified())switch(e.visit(e.MOD,l=>n.dirty(l)),u.clear(),i.items.forEach(l=>u.union(qu(l,o))),i.role){case p1:case v1:case y1:e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,l=>{u.union(qu(l,o))}),e.visit(e.MOD,l=>{s=s||u.alignsWith(l.bounds),n.dirty(l),u.union(qu(l,o))}),s&&(u.clear(),i.items.forEach(l=>u.union(l.bounds)));return W3(i),e.modifies("bounds")}});function qu(t,e,n){return e(t.bounds.clear(),t,n)}const Ay=":vega_identifier:";function w1(t){S.call(this,0,t)}w1.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};z(w1,S,{transform(t,e){const n=aF(e.dataflow),i=t.as;let r=n.value;return e.visit(e.ADD,a=>a[i]=a[i]||++r),n.set(this.value=r),e}});function aF(t){return t._signals[Ay]||(t._signals[Ay]=t.add(0))}function nM(t){S.call(this,null,t)}z(nM,S,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,oF(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const i=n.marktype===kf?mf:gf;return e.visit(e.ADD,r=>i.call(r,n)),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});function oF(t){const e=t.groups,n=t.parent;return e&&e.size===1?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}function iM(t){S.call(this,null,t)}const Ey={parity:t=>t.filter((e,n)=>n%2?e.opacity=0:1),greedy:(t,e)=>{let n;return t.filter((i,r)=>!r||!rM(n.bounds,i.bounds,e)?(n=i,1):i.opacity=0)}},rM=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),Cy=(t,e)=>{for(var n=1,i=t.length,r=t[0].bounds,a;n<i;r=a,++n)if(rM(r,a=t[n].bounds,e))return!0},uF=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},sF=(t,e,n)=>{var i=t.range(),r=new Ft;return e===ra||e===$i?r.set(i[0],-1/0,i[1],1/0):r.set(-1/0,i[0],1/0,i[1]),r.expand(n||1),a=>r.encloses(a.bounds)},Dy=t=>(t.forEach(e=>e.opacity=1),t),Sy=(t,e)=>t.reflow(e.modified()).modifies("opacity");z(iM,S,{transform(t,e){const n=Ey[t.method]||Ey.parity,i=t.separation||0;let r=e.materialize(e.SOURCE).source,a,o;if(!r||!r.length)return;if(!t.method)return t.modified("method")&&(Dy(r),e=Sy(e,t)),e;if(r=r.filter(uF),!r.length)return;if(t.sort&&(r=r.slice().sort(t.sort)),a=Dy(r),e=Sy(e,t),a.length>=3&&Cy(a,i)){do a=n(a,i);while(a.length>=3&&Cy(a,i));a.length<3&&!it(r).opacity&&(a.length>1&&(it(a).opacity=0),it(r).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(o=sF(t.boundScale,t.boundOrient,+t.boundTolerance),r.forEach(s=>{o(s)||(s.opacity=0)}));const u=a[0].mark.bounds.clear();return r.forEach(s=>{s.opacity&&u.union(s.bounds)}),e}});function aM(t){S.call(this,null,t)}z(aM,S,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,i=>n.dirty(i)),e.fields&&e.fields.zindex){const i=e.source&&e.source[0];i&&(i.mark.zdirty=!0)}}});const Wt=new Ft;function Br(t,e,n){return t[e]===n?0:(t[e]=n,1)}function lF(t){var e=t.items[0].orient;return e===on||e===sn}function fF(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}function cF(t,e,n,i){var r=e.items[0],a=r.datum,o=r.translate!=null?r.translate:.5,u=r.orient,s=fF(a),l=r.range,f=r.offset,c=r.position,h=r.minExtent,d=r.maxExtent,g=a.title&&r.items[s[2]].items[0],m=r.titlePadding,p=r.bounds,y=g&&e1(g),v=0,x=0,b,_;switch(Wt.clear().union(p),p.clear(),(b=s[0])>-1&&p.union(r.items[b].bounds),(b=s[1])>-1&&p.union(r.items[b].bounds),u){case ra:v=c||0,x=-f,_=Math.max(h,Math.min(d,-p.y1)),p.add(0,-_).add(l,0),g&&ju(t,g,_,m,y,0,-1,p);break;case on:v=-f,x=c||0,_=Math.max(h,Math.min(d,-p.x1)),p.add(-_,0).add(0,l),g&&ju(t,g,_,m,y,1,-1,p);break;case sn:v=n+f,x=c||0,_=Math.max(h,Math.min(d,p.x2)),p.add(0,0).add(_,l),g&&ju(t,g,_,m,y,1,1,p);break;case $i:v=c||0,x=i+f,_=Math.max(h,Math.min(d,p.y2)),p.add(0,0).add(l,_),g&&ju(t,g,_,m,0,0,1,p);break;default:v=r.x,x=r.y}return Zn(p.translate(v,x),r),Br(r,"x",v+o)|Br(r,"y",x+o)&&(r.bounds=Wt,t.dirty(r),r.bounds=p,t.dirty(r)),r.mark.bounds.clear().union(p)}function ju(t,e,n,i,r,a,o,u){const s=e.bounds;if(e.auto){const l=o*(n+r+i);let f=0,c=0;t.dirty(e),a?f=(e.x||0)-(e.x=l):c=(e.y||0)-(e.y=l),e.mark.bounds.clear().union(s.translate(-f,-c)),t.dirty(e)}u.union(s)}const Fy=(t,e)=>Math.floor(Math.min(t,e)),$y=(t,e)=>Math.ceil(Math.max(t,e));function hF(t){var e=t.items,n=e.length,i=0,r,a;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;i<n;++i)if(r=e[i],a=r.items,r.marktype===kf)switch(r.role){case p1:case v1:case y1:break;case V3:o.rowheaders.push(...a);break;case X3:o.rowfooters.push(...a);break;case Z3:o.colheaders.push(...a);break;case J3:o.colfooters.push(...a);break;case K3:o.rowtitle=a[0];break;case Q3:o.coltitle=a[0];break;default:o.marks.push(...a)}return o}function dF(t){return new Ft().set(0,0,t.width||0,t.height||0)}function gF(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function xt(t,e,n){const i=J(t)?t[e]:t;return i!=null?i:n!==void 0?n:0}function Ty(t){return t<0?Math.ceil(-t):0}function oM(t,e,n){var i=!n.nodirty,r=n.bounds===b1?dF:gF,a=Wt.set(0,0,0,0),o=xt(n.align,mi),u=xt(n.align,pi),s=xt(n.padding,mi),l=xt(n.padding,pi),f=n.columns||e.length,c=f<=0?1:Math.ceil(e.length/f),h=e.length,d=Array(h),g=Array(f),m=0,p=Array(h),y=Array(c),v=0,x=Array(h),b=Array(h),_=Array(h),M,w,k,C,A,E,F,$,O,D,N;for(w=0;w<f;++w)g[w]=0;for(w=0;w<c;++w)y[w]=0;for(w=0;w<h;++w)E=e[w],A=_[w]=r(E),E.x=E.x||0,x[w]=0,E.y=E.y||0,b[w]=0,k=w%f,C=~~(w/f),m=Math.max(m,F=Math.ceil(A.x2)),v=Math.max(v,$=Math.ceil(A.y2)),g[k]=Math.max(g[k],F),y[C]=Math.max(y[C],$),d[w]=s+Ty(A.x1),p[w]=l+Ty(A.y1),i&&t.dirty(e[w]);for(w=0;w<h;++w)w%f===0&&(d[w]=0),w<f&&(p[w]=0);if(o===Vh)for(k=1;k<f;++k){for(N=0,w=k;w<h;w+=f)N<d[w]&&(N=d[w]);for(w=k;w<h;w+=f)d[w]=N+g[k-1]}else if(o===Uu){for(N=0,w=0;w<h;++w)w%f&&N<d[w]&&(N=d[w]);for(w=0;w<h;++w)w%f&&(d[w]=N+m)}else for(o=!1,k=1;k<f;++k)for(w=k;w<h;w+=f)d[w]+=g[k-1];if(u===Vh)for(C=1;C<c;++C){for(N=0,w=C*f,M=w+f;w<M;++w)N<p[w]&&(N=p[w]);for(w=C*f;w<M;++w)p[w]=N+y[C-1]}else if(u===Uu){for(N=0,w=f;w<h;++w)N<p[w]&&(N=p[w]);for(w=f;w<h;++w)p[w]=N+v}else for(u=!1,C=1;C<c;++C)for(w=C*f,M=w+f;w<M;++w)p[w]+=y[C-1];for(O=0,w=0;w<h;++w)O=d[w]+(w%f?O:0),x[w]+=O-e[w].x;for(k=0;k<f;++k)for(D=0,w=k;w<h;w+=f)D+=p[w],b[w]+=D-e[w].y;if(o&&xt(n.center,mi)&&c>1)for(w=0;w<h;++w)A=o===Uu?m:g[w%f],O=A-_[w].x2-e[w].x-x[w],O>0&&(x[w]+=O/2);if(u&&xt(n.center,pi)&&f!==1)for(w=0;w<h;++w)A=u===Uu?v:y[~~(w/f)],D=A-_[w].y2-e[w].y-b[w],D>0&&(b[w]+=D/2);for(w=0;w<h;++w)a.union(_[w].translate(x[w],b[w]));switch(O=xt(n.anchor,K9),D=xt(n.anchor,Z9),xt(n.anchor,mi)){case ue:O-=a.width();break;case Gh:O-=a.width()/2}switch(xt(n.anchor,pi)){case ue:D-=a.height();break;case Gh:D-=a.height()/2}for(O=Math.round(O),D=Math.round(D),a.clear(),w=0;w<h;++w)e[w].mark.bounds.clear();for(w=0;w<h;++w)E=e[w],E.x+=x[w]+=O,E.y+=b[w]+=D,a.union(E.mark.bounds.union(E.bounds.translate(x[w],b[w]))),i&&t.dirty(E);return a}function mF(t,e,n){var i=hF(e),r=i.marks,a=n.bounds===b1?pF:yF,o=n.offset,u=n.columns||r.length,s=u<=0?1:Math.ceil(r.length/u),l=s*u,f,c,h,d,g,m,p;const y=oM(t,r,n);y.empty()&&y.set(0,0,0,0),i.rowheaders&&(m=xt(n.headerBand,pi,null),f=Yu(t,i.rowheaders,r,u,s,-xt(o,"rowHeader"),Fy,0,a,"x1",0,u,1,m)),i.colheaders&&(m=xt(n.headerBand,mi,null),c=Yu(t,i.colheaders,r,u,u,-xt(o,"columnHeader"),Fy,1,a,"y1",0,1,u,m)),i.rowfooters&&(m=xt(n.footerBand,pi,null),h=Yu(t,i.rowfooters,r,u,s,xt(o,"rowFooter"),$y,0,a,"x2",u-1,u,1,m)),i.colfooters&&(m=xt(n.footerBand,mi,null),d=Yu(t,i.colfooters,r,u,u,xt(o,"columnFooter"),$y,1,a,"y2",l-u,1,u,m)),i.rowtitle&&(g=xt(n.titleAnchor,pi),p=xt(o,"rowTitle"),p=g===ue?h+p:f-p,m=xt(n.titleBand,pi,.5),Ry(t,i.rowtitle,p,0,y,m)),i.coltitle&&(g=xt(n.titleAnchor,mi),p=xt(o,"columnTitle"),p=g===ue?d+p:c-p,m=xt(n.titleBand,mi,.5),Ry(t,i.coltitle,p,1,y,m))}function pF(t,e){return e==="x1"?t.x||0:e==="y1"?t.y||0:e==="x2"?(t.x||0)+(t.width||0):e==="y2"?(t.y||0)+(t.height||0):void 0}function yF(t,e){return t.bounds[e]}function Yu(t,e,n,i,r,a,o,u,s,l,f,c,h,d){var g=n.length,m=0,p=0,y,v,x,b,_,M,w,k,C;if(!g)return m;for(y=f;y<g;y+=c)n[y]&&(m=o(m,s(n[y],l)));if(!e.length)return m;for(e.length>r&&(t.warn("Grid headers exceed limit: "+r),e=e.slice(0,r)),m+=a,v=0,b=e.length;v<b;++v)t.dirty(e[v]),e[v].mark.bounds.clear();for(y=f,v=0,b=e.length;v<b;++v,y+=c){for(M=e[v],_=M.mark.bounds,x=y;x>=0&&(w=n[x])==null;x-=h);u?(k=d==null?w.x:Math.round(w.bounds.x1+d*w.bounds.width()),C=m):(k=m,C=d==null?w.y:Math.round(w.bounds.y1+d*w.bounds.height())),_.union(M.bounds.translate(k-(M.x||0),C-(M.y||0))),M.x=k,M.y=C,t.dirty(M),p=o(p,_[l])}return p}function Ry(t,e,n,i,r,a){if(!!e){t.dirty(e);var o=n,u=n;i?o=Math.round(r.x1+a*r.width()):u=Math.round(r.y1+a*r.height()),e.bounds.translate(o-(e.x||0),u-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=o,e.y=u,t.dirty(e)}}function vF(t,e){const n=t[e]||{};return(i,r)=>n[i]!=null?n[i]:t[i]!=null?t[i]:r}function xF(t,e){let n=-1/0;return t.forEach(i=>{i.offset!=null&&(n=Math.max(n,i.offset))}),n>-1/0?n:e}function bF(t,e,n,i,r,a,o){const u=vF(n,e),s=xF(t,u("offset",0)),l=u("anchor",m1),f=l===ue?1:l===Gh?.5:0,c={align:Vh,bounds:u("bounds",b1),columns:u("direction")==="vertical"?1:t.length,padding:u("margin",8),center:u("center"),nodirty:!0};switch(e){case on:c.anchor={x:Math.floor(i.x1)-s,column:ue,y:f*(o||i.height()+2*i.y1),row:l};break;case sn:c.anchor={x:Math.ceil(i.x2)+s,y:f*(o||i.height()+2*i.y1),row:l};break;case ra:c.anchor={y:Math.floor(r.y1)-s,row:ue,x:f*(a||r.width()+2*r.x1),column:l};break;case $i:c.anchor={y:Math.ceil(r.y2)+s,x:f*(a||r.width()+2*r.x1),column:l};break;case W9:c.anchor={x:s,y:s};break;case G9:c.anchor={x:a-s,y:s,column:ue};break;case V9:c.anchor={x:s,y:o-s,row:ue};break;case X9:c.anchor={x:a-s,y:o-s,column:ue,row:ue};break}return c}function wF(t,e){var n=e.items[0],i=n.datum,r=n.orient,a=n.bounds,o=n.x,u=n.y,s,l;return n._bounds?n._bounds.clear().union(a):n._bounds=a.clone(),a.clear(),MF(t,n,n.items[0].items[0]),a=_F(n,a),s=2*n.padding,l=2*n.padding,a.empty()||(s=Math.ceil(a.width()+s),l=Math.ceil(a.height()+l)),i.type===eF&&kF(n.items[0].items[0].items[0].items),r!==x1&&(n.x=o=0,n.y=u=0),n.width=s,n.height=l,Zn(a.set(o,u,o+s,u+l),n),n.mark.bounds.clear().union(a),n}function _F(t,e){return t.items.forEach(n=>e.union(n.bounds)),e.x1=t.padding,e.y1=t.padding,e}function MF(t,e,n){var i=e.padding,r=i-n.x,a=i-n.y;if(!e.datum.title)(r||a)&&La(t,n,r,a);else{var o=e.items[1].items[0],u=o.anchor,s=e.titlePadding||0,l=i-o.x,f=i-o.y;switch(o.orient){case on:r+=Math.ceil(o.bounds.width())+s;break;case sn:case $i:break;default:a+=o.bounds.height()+s}switch((r||a)&&La(t,n,r,a),o.orient){case on:f+=Ar(e,n,o,u,1,1);break;case sn:l+=Ar(e,n,o,ue,0,0)+s,f+=Ar(e,n,o,u,1,1);break;case $i:l+=Ar(e,n,o,u,0,0),f+=Ar(e,n,o,ue,-1,0,1)+s;break;default:l+=Ar(e,n,o,u,0,0)}(l||f)&&La(t,o,l,f),(l=Math.round(o.bounds.x1-i))<0&&(La(t,n,-l,0),La(t,o,-l,0))}}function Ar(t,e,n,i,r,a,o){const u=t.datum.type!=="symbol",s=n.datum.vgrad,l=u&&(a||!s)&&!o?e.items[0]:e,f=l.bounds[r?"y2":"x2"]-t.padding,c=s&&a?f:0,h=s&&a?0:f,d=r<=0?0:e1(n);return Math.round(i===m1?c:i===ue?h-d:.5*(f-d))}function La(t,e,n,i){e.x+=n,e.y+=i,e.bounds.translate(n,i),e.mark.bounds.translate(n,i),t.dirty(e)}function kF(t){const e=t.reduce((n,i)=>(n[i.column]=Math.max(i.bounds.x2-i.x,n[i.column]||0),n),{});t.forEach(n=>{n.width=e[n.column],n.height=n.bounds.y2-n.y})}function AF(t,e,n,i,r){var a=e.items[0],o=a.frame,u=a.orient,s=a.anchor,l=a.offset,f=a.padding,c=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],d=u===on||u===sn?i:n,g=0,m=0,p=0,y=0,v=0,x;if(o!==kf?u===on?(g=r.y2,d=r.y1):u===sn?(g=r.y1,d=r.y2):(g=r.x1,d=r.x2):u===on&&(g=i,d=0),x=s===m1?g:s===ue?d:(g+d)/2,h&&h.text){switch(u){case ra:case $i:v=c.bounds.height()+f;break;case on:y=c.bounds.width()+f;break;case sn:y=-c.bounds.width()-f;break}Wt.clear().union(h.bounds),Wt.translate(y-(h.x||0),v-(h.y||0)),Br(h,"x",y)|Br(h,"y",v)&&(t.dirty(h),h.bounds.clear().union(Wt),h.mark.bounds.clear().union(Wt),t.dirty(h)),Wt.clear().union(h.bounds)}else Wt.clear();switch(Wt.union(c.bounds),u){case ra:m=x,p=r.y1-Wt.height()-l;break;case on:m=r.x1-Wt.width()-l,p=x;break;case sn:m=r.x2+Wt.width()+l,p=x;break;case $i:m=x,p=r.y2+l;break;default:m=a.x,p=a.y}return Br(a,"x",m)|Br(a,"y",p)&&(Wt.translate(m,p),t.dirty(a),a.bounds.clear().union(Wt),e.bounds.clear().union(Wt),t.dirty(a)),a.bounds}function uM(t){S.call(this,null,t)}z(uM,S,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach(i=>{t.layout&&mF(n,i,t.layout),CF(n,i,t)}),EF(t.mark.group)?e.reflow():e}});function EF(t){return t&&t.mark.role!=="legend-entry"}function CF(t,e,n){var i=e.items,r=Math.max(0,e.width||0),a=Math.max(0,e.height||0),o=new Ft().set(0,0,r,a),u=o.clone(),s=o.clone(),l=[],f,c,h,d,g,m;for(g=0,m=i.length;g<m;++g)switch(c=i[g],c.role){case p1:d=lF(c)?u:s,d.union(cF(t,c,r,a));break;case y1:f=c;break;case v1:l.push(wF(t,c));break;case J9:case Q9:case V3:case X3:case K3:case Z3:case J3:case Q3:u.union(c.bounds),s.union(c.bounds);break;default:o.union(c.bounds)}if(l.length){const p={};l.forEach(y=>{h=y.orient||sn,h!==x1&&(p[h]||(p[h]=[])).push(y)});for(const y in p){const v=p[y];oM(t,v,bF(v,y,n.legends,u,s,r,a))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,t.dirty(y),y.bounds=v,t.dirty(y)),n.autosize&&n.autosize.type===tM)switch(y.orient){case on:case sn:o.add(v.x1,0).add(v.x2,0);break;case ra:case $i:o.add(0,v.y1).add(0,v.y2)}else o.union(v)})}o.union(u).union(s),f&&o.union(AF(t,f,r,a,o)),e.clip&&o.set(0,0,e.width||0,e.height||0),DF(t,e,o,n)}function DF(t,e,n,i){const r=i.autosize||{},a=r.type;if(t._autosize<1||!a)return;let o=t._width,u=t._height,s=Math.max(0,e.width||0),l=Math.max(0,Math.ceil(-n.x1)),f=Math.max(0,e.height||0),c=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-s)),d=Math.max(0,Math.ceil(n.y2-f));if(r.contains===tF){const g=t.padding();o-=g.left+g.right,u-=g.top+g.bottom}a===x1?(l=0,c=0,s=o,f=u):a===tM?(s=Math.max(0,o-l-h),f=Math.max(0,u-c-d)):a===nF?(s=Math.max(0,o-l-h),u=f+c+d):a===iF?(o=s+l+h,f=Math.max(0,u-c-d)):a===rF&&(o=s+l+h,u=f+c+d),t._resizeView(o,u,s,f,[l,c],r.resize)}var SF=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",bound:eM,identifier:w1,mark:nM,overlap:iM,render:aM,viewlayout:uM});function sM(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);++i<r;)a[i]=t+i*n;return a}function FF(t,e){let n=0;if(e===void 0)for(let i of t)(i=+i)&&(n+=i);else{let i=-1;for(let r of t)(r=+e(r,++i,t))&&(n+=r)}return n}var _1=t=>()=>t;function $F(t,e){return function(n){return t+n*e}}function TF(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function RF(t){return(t=+t)==1?lM:function(e,n){return n-e?TF(e,n,t):_1(isNaN(e)?n:e)}}function lM(t,e){var n=e-t;return n?$F(t,n):_1(isNaN(t)?e:t)}var Ny=function t(e){var n=RF(e);function i(r,a){var o=n((r=Fo(r)).r,(a=Fo(a)).r),u=n(r.g,a.g),s=n(r.b,a.b),l=lM(r.opacity,a.opacity);return function(f){return r.r=o(f),r.g=u(f),r.b=s(f),r.opacity=l(f),r+""}}return i.gamma=t,i}(1);function NF(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,i=e.slice(),r;return function(a){for(r=0;r<n;++r)i[r]=t[r]*(1-a)+e[r]*a;return i}}function OF(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function zF(t,e){var n=e?e.length:0,i=t?Math.min(n,t.length):0,r=new Array(i),a=new Array(n),o;for(o=0;o<i;++o)r[o]=M1(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(u){for(o=0;o<i;++o)a[o]=r[o](u);return a}}function BF(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function Xh(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function LF(t,e){var n={},i={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=M1(t[r],e[r]):i[r]=e[r];return function(a){for(r in n)i[r]=n[r](a);return i}}var Kh=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,xc=new RegExp(Kh.source,"g");function PF(t){return function(){return t}}function IF(t){return function(e){return t(e)+""}}function UF(t,e){var n=Kh.lastIndex=xc.lastIndex=0,i,r,a,o=-1,u=[],s=[];for(t=t+"",e=e+"";(i=Kh.exec(t))&&(r=xc.exec(e));)(a=r.index)>n&&(a=e.slice(n,a),u[o]?u[o]+=a:u[++o]=a),(i=i[0])===(r=r[0])?u[o]?u[o]+=r:u[++o]=r:(u[++o]=null,s.push({i:o,x:Xh(i,r)})),n=xc.lastIndex;return n<e.length&&(a=e.slice(n),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?IF(s[0].x):PF(e):(e=s.length,function(l){for(var f=0,c;f<e;++f)u[(c=s[f]).i]=c.x(l);return u.join("")})}function M1(t,e){var n=typeof e,i;return e==null||n==="boolean"?_1(e):(n==="number"?Xh:n==="string"?(i=Fs(e))?(e=i,Ny):UF:e instanceof Fs?Ny:e instanceof Date?BF:OF(e)?NF:Array.isArray(e)?zF:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?LF:Xh)(t,e)}function qF(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function fM(t){S.call(this,null,t)}z(fM,S,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=this.value,a=t.scale,o=t.count==null?t.values?t.values.length:10:t.count,u=zg(a,o,t.minstep),s=t.format||Y_(n,a,u,t.formatSpecifier,t.formatType,!!t.values),l=t.values?j_(a,t.values,u):Bg(a,u);return r&&(i.rem=r),r=l.map((f,c)=>ft({index:c/(l.length-1||1),value:f,label:s(f)})),t.extra&&r.length&&r.push(ft({index:-1,extra:{value:r[0].value},label:""})),i.source=r,i.add=r,this.value=r,i}});function cM(t){S.call(this,null,t)}function jF(){return ft({})}function YF(t){const e=ca().test(n=>n.exit);return e.lookup=n=>e.get(t(n)),e}z(cM,S,{transform(t,e){var n=e.dataflow,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.item||jF,a=t.key||j,o=this.value;return Y(i.encode)&&(i.encode=null),o&&(t.modified("key")||e.modified(a))&&R("DataJoin does not support modified key function or fields."),o||(e=e.addAll(),this.value=o=YF(a)),e.visit(e.ADD,u=>{const s=a(u);let l=o.get(s);l?l.exit?(o.empty--,i.add.push(l)):i.mod.push(l):(l=r(u),o.set(s,l),i.add.push(l)),l.datum=u,l.exit=!1}),e.visit(e.MOD,u=>{const s=a(u),l=o.get(s);l&&(l.datum=u,i.mod.push(l))}),e.visit(e.REM,u=>{const s=a(u),l=o.get(s);u===l.datum&&!l.exit&&(i.rem.push(l),l.exit=!0,++o.empty)}),e.changed(e.ADD_MOD)&&i.modifies("datum"),(e.clean()||t.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),i}});function hM(t){S.call(this,null,t)}z(hM,S,{transform(t,e){var n=e.fork(e.ADD_REM),i=t.mod||!1,r=t.encoders,a=e.encode;if(Y(a))if(n.changed()||a.every(c=>r[c]))a=a[0],n.encode=null;else return e.StopPropagation;var o=a==="enter",u=r.update||ni,s=r.enter||ni,l=r.exit||ni,f=(a&&!o?r[a]:u)||ni;if(e.changed(e.ADD)&&(e.visit(e.ADD,c=>{s(c,t),u(c,t)}),n.modifies(s.output),n.modifies(u.output),f!==ni&&f!==u&&(e.visit(e.ADD,c=>{f(c,t)}),n.modifies(f.output))),e.changed(e.REM)&&l!==ni&&(e.visit(e.REM,c=>{l(c,t)}),n.modifies(l.output)),o||f!==ni){const c=e.MOD|(t.modified()?e.REFLOW:0);o?(e.visit(c,h=>{const d=s(h,t)||i;(f(h,t)||d)&&n.mod.push(h)}),n.mod.length&&n.modifies(s.output)):e.visit(c,h=>{(f(h,t)||i)&&n.mod.push(h)}),n.mod.length&&n.modifies(f.output)}return n.changed()?n:e.StopPropagation}});function dM(t){S.call(this,[],t)}z(dM,S,{transform(t,e){if(this.value!=null&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),i=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=this.value,a=t.type||ds,o=t.scale,u=+t.limit,s=zg(o,t.count==null?5:t.count,t.minstep),l=!!t.values||a===ds,f=t.format||V_(n,o,s,a,t.formatSpecifier,t.formatType,l),c=t.values||G_(o,s),h,d,g,m,p;return r&&(i.rem=r),a===ds?(u&&c.length>u?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),r=c.slice(0,u-1),p=!0):r=c,Q(g=t.size)?(!t.values&&o(r[0])===0&&(r=r.slice(1)),m=r.reduce((y,v)=>Math.max(y,g(v,t)),0)):g=ee(m=g||8),r=r.map((y,v)=>ft({index:v,label:f(y,v,r),value:y,offset:m,size:g(y,t)})),p&&(p=c[r.length],r.push(ft({index:r.length,label:"\u2026".concat(c.length-r.length," entries"),value:p,offset:m,size:g(p,t)})))):a===sS?(h=o.domain(),d=I_(o,h[0],it(h)),c.length<3&&!t.values&&h[0]!==it(h)&&(c=[h[0],it(h)]),r=c.map((y,v)=>ft({index:v,label:f(y,v,c),value:y,perc:d(y)}))):(g=c.length-1,d=xS(o),r=c.map((y,v)=>ft({index:v,label:f(y,v,c),value:y,perc:v?d(y):0,perc2:v===g?1:d(c[v+1])}))),i.source=r,i.add=r,this.value=r,i}});const HF=t=>t.source.x,WF=t=>t.source.y,GF=t=>t.target.x,VF=t=>t.target.y;function k1(t){S.call(this,{},t)}k1.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};z(k1,S,{transform(t,e){var n=t.sourceX||HF,i=t.sourceY||WF,r=t.targetX||GF,a=t.targetY||VF,o=t.as||"path",u=t.orient||"vertical",s=t.shape||"line",l=Oy.get(s+"-"+u)||Oy.get(s);return l||R("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,f=>{f[o]=l(n(f),i(f),r(f),a(f))}),e.reflow(t.modified()).modifies(o)}});const gM=(t,e,n,i)=>"M"+t+","+e+"L"+n+","+i,XF=(t,e,n,i)=>gM(e*Math.cos(t),e*Math.sin(t),i*Math.cos(n),i*Math.sin(n)),mM=(t,e,n,i)=>{var r=n-t,a=i-e,o=Math.sqrt(r*r+a*a)/2,u=180*Math.atan2(a,r)/Math.PI;return"M"+t+","+e+"A"+o+","+o+" "+u+" 0 1 "+n+","+i},KF=(t,e,n,i)=>mM(e*Math.cos(t),e*Math.sin(t),i*Math.cos(n),i*Math.sin(n)),pM=(t,e,n,i)=>{const r=n-t,a=i-e,o=.2*(r+a),u=.2*(a-r);return"M"+t+","+e+"C"+(t+o)+","+(e+u)+" "+(n+u)+","+(i-o)+" "+n+","+i},ZF=(t,e,n,i)=>pM(e*Math.cos(t),e*Math.sin(t),i*Math.cos(n),i*Math.sin(n)),JF=(t,e,n,i)=>"M"+t+","+e+"V"+i+"H"+n,QF=(t,e,n,i)=>"M"+t+","+e+"H"+n+"V"+i,t$=(t,e,n,i)=>{const r=Math.cos(t),a=Math.sin(t),o=Math.cos(n),u=Math.sin(n),s=Math.abs(n-t)>Math.PI?n<=t:n>t;return"M"+e*r+","+e*a+"A"+e+","+e+" 0 0,"+(s?1:0)+" "+e*o+","+e*u+"L"+i*o+","+i*u},e$=(t,e,n,i)=>{const r=(t+n)/2;return"M"+t+","+e+"C"+r+","+e+" "+r+","+i+" "+n+","+i},n$=(t,e,n,i)=>{const r=(e+i)/2;return"M"+t+","+e+"C"+t+","+r+" "+n+","+r+" "+n+","+i},i$=(t,e,n,i)=>{const r=Math.cos(t),a=Math.sin(t),o=Math.cos(n),u=Math.sin(n),s=(e+i)/2;return"M"+e*r+","+e*a+"C"+s*r+","+s*a+" "+s*o+","+s*u+" "+i*o+","+i*u},Oy=ca({line:gM,"line-radial":XF,arc:mM,"arc-radial":KF,curve:pM,"curve-radial":ZF,"orthogonal-horizontal":JF,"orthogonal-vertical":QF,"orthogonal-radial":t$,"diagonal-horizontal":e$,"diagonal-vertical":n$,"diagonal-radial":i$});function A1(t){S.call(this,null,t)}A1.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};z(A1,S,{transform(t,e){var n=t.as||["startAngle","endAngle"],i=n[0],r=n[1],a=t.field||fa,o=t.startAngle||0,u=t.endAngle!=null?t.endAngle:2*Math.PI,s=e.source,l=s.map(a),f=l.length,c=o,h=(u-o)/FF(l),d=sM(f),g,m,p;for(t.sort&&d.sort((y,v)=>l[y]-l[v]),g=0;g<f;++g)p=l[d[g]],m=s[d[g]],m[i]=c,m[r]=c+=p*h;return this.value=l,e.reflow(t.modified()).modifies(n)}});const r$=5;function a$(t){const e=t.type;return!t.bins&&(e===Zr||e===su||e===lu)}function yM(t){return Rg(t)&&t!==An}const o$=cn(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function vM(t){S.call(this,null,t),this.modified(!0)}z(vM,S,{transform(t,e){var n=e.dataflow,i=this.value,r=u$(t);(!i||r!==i.type)&&(this.value=i=st(r)());for(r in t)if(!o$[r]){if(r==="padding"&&yM(i.type))continue;Q(i[r])?i[r](t[r]):n.warn("Unsupported scale property: "+r)}return d$(i,t,h$(i,t,l$(i,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function u$(t){var e=t.type,n="",i;return e===An?An+"-"+Zr:(s$(t)&&(i=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(t.domainMid!=null):0,n=i===2?An+"-":i===3?pa+"-":""),(n+e||Zr).toLowerCase())}function s$(t){const e=t.type;return Rg(e)&&e!==Qi&&e!==tr&&(t.scheme||t.range&&t.range.length&&t.range.every(vt))}function l$(t,e,n){const i=f$(t,e.domainRaw,n);if(i>-1)return i;var r=e.domain,a=t.type,o=e.zero||e.zero===void 0&&a$(t),u,s;if(!r)return 0;if(yM(a)&&e.padding&&r[0]!==it(r)&&(r=c$(a,r,e.range,e.padding,e.exponent,e.constant)),(o||e.domainMin!=null||e.domainMax!=null||e.domainMid!=null)&&(u=(r=r.slice()).length-1||1,o&&(r[0]>0&&(r[0]=0),r[u]<0&&(r[u]=0)),e.domainMin!=null&&(r[0]=e.domainMin),e.domainMax!=null&&(r[u]=e.domainMax),e.domainMid!=null)){s=e.domainMid;const l=s>r[u]?u+1:s<r[0]?0:u;l!==u&&n.warn("Scale domainMid exceeds domain min or max.",s),r.splice(l,0,s)}return t.domain(xM(a,r,n)),a===Sg&&t.unknown(e.domainImplicit?Ch:void 0),e.nice&&t.nice&&t.nice(e.nice!==!0&&zg(t,e.nice)||null),r.length}function f$(t,e,n){return e?(t.domain(xM(t.type,e,n)),e.length):-1}function c$(t,e,n,i,r,a){var o=Math.abs(it(n)-n[0]),u=o/(o-2*i),s=t===Vn?e0(e,null,u):t===lu?Ts(e,null,u,.5):t===su?Ts(e,null,u,r||1):t===lf?n0(e,null,u,a||1):t0(e,null,u);return e=e.slice(),e[0]=s[0],e[e.length-1]=s[1],e}function xM(t,e,n){if(O_(t)){var i=Math.abs(e.reduce((r,a)=>r+(a<0?-1:a>0?1:0),0));i!==e.length&&n.warn("Log scale domain includes zero: "+H(e))}return e}function h$(t,e,n){let i=e.bins;if(i&&!Y(i)){const r=t.domain(),a=r[0],o=it(r),u=i.step;let s=i.start==null?a:i.start,l=i.stop==null?o:i.stop;u||R("Scale bins parameter missing step property."),s<a&&(s=u*Math.ceil(a/u)),l>o&&(l=u*Math.floor(o/u)),i=sM(s,l+u/2,u)}return i?t.bins=i:t.bins&&delete t.bins,t.type===Fg&&(i?!e.domain&&!e.domainRaw&&(t.domain(i),n=i.length):t.bins=t.domain()),n}function d$(t,e,n){var i=t.type,r=e.round||!1,a=e.range;if(e.rangeStep!=null)a=g$(i,e,n);else if(e.scheme&&(a=m$(i,e,n),Q(a))){if(t.interpolator)return t.interpolator(a);R("Scale type ".concat(i," does not support interpolating color schemes."))}if(a&&z_(i))return t.interpolator(hf(Zh(a,e.reverse),e.interpolate,e.interpolateGamma));a&&e.interpolate&&t.interpolate?t.interpolate(Ng(e.interpolate,e.interpolateGamma)):Q(t.round)?t.round(r):Q(t.rangeRound)&&t.interpolate(r?qF:M1),a&&t.range(Zh(a,e.reverse))}function g$(t,e,n){t!==$_&&t!==Nh&&R("Only band and point scales support rangeStep.");var i=(e.paddingOuter!=null?e.paddingOuter:e.padding)||0,r=t===Nh?1:(e.paddingInner!=null?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Dg(n,r,i)]}function m$(t,e,n){var i=e.schemeExtent,r,a;return Y(e.scheme)?a=hf(e.scheme,e.interpolate,e.interpolateGamma):(r=e.scheme.toLowerCase(),a=Og(r),a||R("Unrecognized scheme name: ".concat(e.scheme))),n=t===cf?n+1:t===Fg?n-1:t===Jr||t===ff?+e.schemeCount||r$:n,z_(t)?zy(a,i,e.reverse):Q(a)?P_(zy(a,i),n):t===Sg?a:a.slice(0,n)}function zy(t,e,n){return Q(t)&&(e||n)?L_(t,Zh(e||[0,1],n)):t}function Zh(t,e){return e?t.slice().reverse():t}function bM(t){S.call(this,null,t)}z(bM,S,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(fr(t.sort)),this.modified(n),e}});const By="zero",wM="center",_M="normalize",MM=["y0","y1"];function E1(t){S.call(this,null,t)}E1.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:By,values:[By,wM,_M]},{name:"as",type:"string",array:!0,length:2,default:MM}]};z(E1,S,{transform(t,e){var n=t.as||MM,i=n[0],r=n[1],a=fr(t.sort),o=t.field||fa,u=t.offset===wM?p$:t.offset===_M?y$:v$,s,l,f,c;for(s=x$(e.source,t.groupby,a,o),l=0,f=s.length,c=s.max;l<f;++l)u(s[l],c,o,i,r);return e.reflow(t.modified()).modifies(n)}});function p$(t,e,n,i,r){for(var a=(e-t.sum)/2,o=t.length,u=0,s;u<o;++u)s=t[u],s[i]=a,s[r]=a+=Math.abs(n(s))}function y$(t,e,n,i,r){for(var a=1/t.sum,o=0,u=t.length,s=0,l=0,f;s<u;++s)f=t[s],f[i]=o,f[r]=o=a*(l+=Math.abs(n(f)))}function v$(t,e,n,i,r){for(var a=0,o=0,u=t.length,s=0,l,f;s<u;++s)f=t[s],l=+n(f),l<0?(f[i]=o,f[r]=o+=l):(f[i]=a,f[r]=a+=l)}function x$(t,e,n,i){var r=[],a=m=>m(f),o,u,s,l,f,c,h,d,g;if(e==null)r.push(t.slice());else for(o={},u=0,s=t.length;u<s;++u)f=t[u],c=e.map(a),h=o[c],h||(o[c]=h=[],r.push(h)),h.push(f);for(c=0,g=0,l=r.length;c<l;++c){for(h=r[c],u=0,d=0,s=h.length;u<s;++u)d+=Math.abs(i(h[u]));h.sum=d,d>g&&(g=d),n&&h.sort(n)}return r.max=g,r}var b$=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",axisticks:fM,datajoin:cM,encode:hM,legendentries:dM,linkpath:k1,pie:A1,scale:vM,sortitems:bM,stack:E1}),w$=Math.sqrt(50),_$=Math.sqrt(10),M$=Math.sqrt(2);function k$(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=w$?r*=10:a>=_$?r*=5:a>=M$&&(r*=2),e<t?-r:r}function bs(t,e){let n;if(e===void 0)for(const i of t)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);else{let i=-1;for(let r of t)(r=e(r,++i,t))!=null&&(n<r||n===void 0&&r>=r)&&(n=r)}return n}function Vi(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);++i<r;)a[i]=t+i*n;return a}function A$(t,e){let n=0;if(e===void 0)for(let i of t)(i=+i)&&(n+=i);else{let i=-1;for(let r of t)(r=+e(r,++i,t))&&(n+=r)}return n}class er{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const a=n[r],o=e+a,u=Math.abs(e)<Math.abs(a)?e-(o-a):a-(o-e);u&&(n[i++]=u),e=o}return n[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let n=this._n,i,r,a,o=0;if(n>0){for(o=e[--n];n>0&&(i=o,r=e[--n],o=i+r,a=r-(o-i),!a););n>0&&(a<0&&e[n-1]<0||a>0&&e[n-1]>0)&&(r=a*2,i=o+r,r==i-o&&(o=i))}return o}}function*E$(t){for(const e of t)yield*e}function kM(t){return Array.from(E$(t))}var K=1e-6,AM=1e-12,nt=Math.PI,Mt=nt/2,Ly=nt/4,Pe=nt*2,Vt=180/nt,wt=nt/180,dt=Math.abs,va=Math.atan,Xn=Math.atan2,tt=Math.cos,EM=Math.exp,Zs=Math.log,bc=Math.pow,X=Math.sin,Ye=Math.sign||function(t){return t>0?1:t<0?-1:0},Ce=Math.sqrt,C1=Math.tan;function CM(t){return t>1?0:t<-1?nt:Math.acos(t)}function Je(t){return t>1?Mt:t<-1?-Mt:Math.asin(t)}function He(){}function Js(t,e){t&&Iy.hasOwnProperty(t.type)&&Iy[t.type](t,e)}var Py={Feature:function(t,e){Js(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Js(n[i].geometry,e)}},Iy={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Jh(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Jh(n[i],e,0)},Polygon:function(t,e){Uy(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Uy(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Js(n[i],e)}};function Jh(t,e,n){var i=-1,r=t.length-n,a;for(e.lineStart();++i<r;)a=t[i],e.point(a[0],a[1],a[2]);e.lineEnd()}function Uy(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Jh(t[n],e,1);e.polygonEnd()}function Fr(t,e){t&&Py.hasOwnProperty(t.type)?Py[t.type](t,e):Js(t,e)}function Qh(t){return[Xn(t[1],t[0]),Je(t[2])]}function aa(t){var e=t[0],n=t[1],i=tt(n);return[i*tt(e),i*X(e),X(n)]}function Hu(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Qs(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function wc(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Wu(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function td(t){var e=Ce(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function ed(t,e){function n(i,r){return i=t(i,r),e(i[0],i[1])}return t.invert&&e.invert&&(n.invert=function(i,r){return i=e.invert(i,r),i&&t.invert(i[0],i[1])}),n}function nd(t,e){return[dt(t)>nt?t+Math.round(-t/Pe)*Pe:t,e]}nd.invert=nd;function DM(t,e,n){return(t%=Pe)?e||n?ed(jy(t),Yy(e,n)):jy(t):e||n?Yy(e,n):nd}function qy(t){return function(e,n){return e+=t,[e>nt?e-Pe:e<-nt?e+Pe:e,n]}}function jy(t){var e=qy(t);return e.invert=qy(-t),e}function Yy(t,e){var n=tt(t),i=X(t),r=tt(e),a=X(e);function o(u,s){var l=tt(s),f=tt(u)*l,c=X(u)*l,h=X(s),d=h*n+f*i;return[Xn(c*r-d*a,f*n-h*i),Je(d*r+c*a)]}return o.invert=function(u,s){var l=tt(s),f=tt(u)*l,c=X(u)*l,h=X(s),d=h*r-c*a;return[Xn(c*r+h*a,f*n+d*i),Je(d*n-f*i)]},o}function C$(t){t=DM(t[0]*wt,t[1]*wt,t.length>2?t[2]*wt:0);function e(n){return n=t(n[0]*wt,n[1]*wt),n[0]*=Vt,n[1]*=Vt,n}return e.invert=function(n){return n=t.invert(n[0]*wt,n[1]*wt),n[0]*=Vt,n[1]*=Vt,n},e}function D$(t,e,n,i,r,a){if(!!n){var o=tt(e),u=X(e),s=i*n;r==null?(r=e+i*Pe,a=e-s/2):(r=Hy(o,r),a=Hy(o,a),(i>0?r<a:r>a)&&(r+=i*Pe));for(var l,f=r;i>0?f>a:f<a;f-=s)l=Qh([o,-u*tt(f),-u*X(f)]),t.point(l[0],l[1])}}function Hy(t,e){e=aa(e),e[0]-=t,td(e);var n=CM(-e[1]);return((-e[2]<0?-n:n)+Pe-K)%Pe}function SM(){var t=[],e;return{point:function(n,i,r){e.push([n,i,r])},lineStart:function(){t.push(e=[])},lineEnd:He,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function ws(t,e){return dt(t[0]-e[0])<K&&dt(t[1]-e[1])<K}function Gu(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function FM(t,e,n,i,r){var a=[],o=[],u,s;if(t.forEach(function(g){if(!((m=g.length-1)<=0)){var m,p=g[0],y=g[m],v;if(ws(p,y)){if(!p[2]&&!y[2]){for(r.lineStart(),u=0;u<m;++u)r.point((p=g[u])[0],p[1]);r.lineEnd();return}y[0]+=2*K}a.push(v=new Gu(p,g,null,!0)),o.push(v.o=new Gu(p,null,v,!1)),a.push(v=new Gu(y,g,null,!1)),o.push(v.o=new Gu(y,null,v,!0))}}),!!a.length){for(o.sort(e),Wy(a),Wy(o),u=0,s=o.length;u<s;++u)o[u].e=n=!n;for(var l=a[0],f,c;;){for(var h=l,d=!0;h.v;)if((h=h.n)===l)return;f=h.z,r.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(u=0,s=f.length;u<s;++u)r.point((c=f[u])[0],c[1]);else i(h.x,h.n.x,1,r);h=h.n}else{if(d)for(f=h.p.z,u=f.length-1;u>=0;--u)r.point((c=f[u])[0],c[1]);else i(h.x,h.p.x,-1,r);h=h.p}h=h.o,f=h.z,d=!d}while(!h.v);r.lineEnd()}}}function Wy(t){if(!!(e=t.length)){for(var e,n=0,i=t[0],r;++n<e;)i.n=r=t[n],r.p=i,i=r;i.n=r=t[0],r.p=i}}function _c(t){return dt(t[0])<=nt?t[0]:Ye(t[0])*((dt(t[0])+nt)%Pe-nt)}function S$(t,e){var n=_c(e),i=e[1],r=X(i),a=[X(n),-tt(n),0],o=0,u=0,s=new er;r===1?i=Mt+K:r===-1&&(i=-Mt-K);for(var l=0,f=t.length;l<f;++l)if(!!(h=(c=t[l]).length))for(var c,h,d=c[h-1],g=_c(d),m=d[1]/2+Ly,p=X(m),y=tt(m),v=0;v<h;++v,g=b,p=M,y=w,d=x){var x=c[v],b=_c(x),_=x[1]/2+Ly,M=X(_),w=tt(_),k=b-g,C=k>=0?1:-1,A=C*k,E=A>nt,F=p*M;if(s.add(Xn(F*C*X(A),y*w+F*tt(A))),o+=E?k+C*Pe:k,E^g>=n^b>=n){var $=Qs(aa(d),aa(x));td($);var O=Qs(a,$);td(O);var D=(E^k>=0?-1:1)*Je(O[2]);(i>D||i===D&&($[0]||$[1]))&&(u+=E^k>=0?1:-1)}}return(o<-K||o<K&&s<-AM)^u&1}function $M(t,e,n,i){return function(r){var a=e(r),o=SM(),u=e(o),s=!1,l,f,c,h={point:d,lineStart:m,lineEnd:p,polygonStart:function(){h.point=y,h.lineStart=v,h.lineEnd=x,f=[],l=[]},polygonEnd:function(){h.point=d,h.lineStart=m,h.lineEnd=p,f=kM(f);var b=S$(l,i);f.length?(s||(r.polygonStart(),s=!0),FM(f,$$,b,n,r)):b&&(s||(r.polygonStart(),s=!0),r.lineStart(),n(null,null,1,r),r.lineEnd()),s&&(r.polygonEnd(),s=!1),f=l=null},sphere:function(){r.polygonStart(),r.lineStart(),n(null,null,1,r),r.lineEnd(),r.polygonEnd()}};function d(b,_){t(b,_)&&r.point(b,_)}function g(b,_){a.point(b,_)}function m(){h.point=g,a.lineStart()}function p(){h.point=d,a.lineEnd()}function y(b,_){c.push([b,_]),u.point(b,_)}function v(){u.lineStart(),c=[]}function x(){y(c[0][0],c[0][1]),u.lineEnd();var b=u.clean(),_=o.result(),M,w=_.length,k,C,A;if(c.pop(),l.push(c),c=null,!!w){if(b&1){if(C=_[0],(k=C.length-1)>0){for(s||(r.polygonStart(),s=!0),r.lineStart(),M=0;M<k;++M)r.point((A=C[M])[0],A[1]);r.lineEnd()}return}w>1&&b&2&&_.push(_.pop().concat(_.shift())),f.push(_.filter(F$))}}return h}}function F$(t){return t.length>1}function $$(t,e){return((t=t.x)[0]<0?t[1]-Mt-K:Mt-t[1])-((e=e.x)[0]<0?e[1]-Mt-K:Mt-e[1])}var Gy=$M(function(){return!0},T$,N$,[-nt,-Mt]);function T$(t){var e=NaN,n=NaN,i=NaN,r;return{lineStart:function(){t.lineStart(),r=1},point:function(a,o){var u=a>0?nt:-nt,s=dt(a-e);dt(s-nt)<K?(t.point(e,n=(n+o)/2>0?Mt:-Mt),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(u,n),t.point(a,n),r=0):i!==u&&s>=nt&&(dt(e-i)<K&&(e-=i*K),dt(a-u)<K&&(a-=u*K),n=R$(e,n,a,o),t.point(i,n),t.lineEnd(),t.lineStart(),t.point(u,n),r=0),t.point(e=a,n=o),i=u},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-r}}}function R$(t,e,n,i){var r,a,o=X(t-n);return dt(o)>K?va((X(e)*(a=tt(i))*X(n)-X(i)*(r=tt(e))*X(t))/(r*a*o)):(e+i)/2}function N$(t,e,n,i){var r;if(t==null)r=n*Mt,i.point(-nt,r),i.point(0,r),i.point(nt,r),i.point(nt,0),i.point(nt,-r),i.point(0,-r),i.point(-nt,-r),i.point(-nt,0),i.point(-nt,r);else if(dt(t[0]-e[0])>K){var a=t[0]<e[0]?nt:-nt;r=n*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(e[0],e[1])}function O$(t){var e=tt(t),n=6*wt,i=e>0,r=dt(e)>K;function a(f,c,h,d){D$(d,t,n,h,f,c)}function o(f,c){return tt(f)*tt(c)>e}function u(f){var c,h,d,g,m;return{lineStart:function(){g=d=!1,m=1},point:function(p,y){var v=[p,y],x,b=o(p,y),_=i?b?0:l(p,y):b?l(p+(p<0?nt:-nt),y):0;if(!c&&(g=d=b)&&f.lineStart(),b!==d&&(x=s(c,v),(!x||ws(c,x)||ws(v,x))&&(v[2]=1)),b!==d)m=0,b?(f.lineStart(),x=s(v,c),f.point(x[0],x[1])):(x=s(c,v),f.point(x[0],x[1],2),f.lineEnd()),c=x;else if(r&&c&&i^b){var M;!(_&h)&&(M=s(v,c,!0))&&(m=0,i?(f.lineStart(),f.point(M[0][0],M[0][1]),f.point(M[1][0],M[1][1]),f.lineEnd()):(f.point(M[1][0],M[1][1]),f.lineEnd(),f.lineStart(),f.point(M[0][0],M[0][1],3)))}b&&(!c||!ws(c,v))&&f.point(v[0],v[1]),c=v,d=b,h=_},lineEnd:function(){d&&f.lineEnd(),c=null},clean:function(){return m|(g&&d)<<1}}}function s(f,c,h){var d=aa(f),g=aa(c),m=[1,0,0],p=Qs(d,g),y=Hu(p,p),v=p[0],x=y-v*v;if(!x)return!h&&f;var b=e*y/x,_=-e*v/x,M=Qs(m,p),w=Wu(m,b),k=Wu(p,_);wc(w,k);var C=M,A=Hu(w,C),E=Hu(C,C),F=A*A-E*(Hu(w,w)-1);if(!(F<0)){var $=Ce(F),O=Wu(C,(-A-$)/E);if(wc(O,w),O=Qh(O),!h)return O;var D=f[0],N=c[0],L=f[1],U=c[1],W;N<D&&(W=D,D=N,N=W);var lt=N-D,At=dt(lt-nt)<K,ie=At||lt<K;if(!At&&U<L&&(W=L,L=U,U=W),ie?At?L+U>0^O[1]<(dt(O[0]-D)<K?L:U):L<=O[1]&&O[1]<=U:lt>nt^(D<=O[0]&&O[0]<=N)){var re=Wu(C,(-A+$)/E);return wc(re,w),[O,Qh(re)]}}}function l(f,c){var h=i?t:nt-t,d=0;return f<-h?d|=1:f>h&&(d|=2),c<-h?d|=4:c>h&&(d|=8),d}return $M(o,u,a,i?[0,-t]:[-nt,t-nt])}function z$(t,e,n,i,r,a){var o=t[0],u=t[1],s=e[0],l=e[1],f=0,c=1,h=s-o,d=l-u,g;if(g=n-o,!(!h&&g>0)){if(g/=h,h<0){if(g<f)return;g<c&&(c=g)}else if(h>0){if(g>c)return;g>f&&(f=g)}if(g=r-o,!(!h&&g<0)){if(g/=h,h<0){if(g>c)return;g>f&&(f=g)}else if(h>0){if(g<f)return;g<c&&(c=g)}if(g=i-u,!(!d&&g>0)){if(g/=d,d<0){if(g<f)return;g<c&&(c=g)}else if(d>0){if(g>c)return;g>f&&(f=g)}if(g=a-u,!(!d&&g<0)){if(g/=d,d<0){if(g>c)return;g>f&&(f=g)}else if(d>0){if(g<f)return;g<c&&(c=g)}return f>0&&(t[0]=o+f*h,t[1]=u+f*d),c<1&&(e[0]=o+c*h,e[1]=u+c*d),!0}}}}}var to=1e9,Vu=-to;function TM(t,e,n,i){function r(l,f){return t<=l&&l<=n&&e<=f&&f<=i}function a(l,f,c,h){var d=0,g=0;if(l==null||(d=o(l,c))!==(g=o(f,c))||s(l,f)<0^c>0)do h.point(d===0||d===3?t:n,d>1?i:e);while((d=(d+c+4)%4)!==g);else h.point(f[0],f[1])}function o(l,f){return dt(l[0]-t)<K?f>0?0:3:dt(l[0]-n)<K?f>0?2:1:dt(l[1]-e)<K?f>0?1:0:f>0?3:2}function u(l,f){return s(l.x,f.x)}function s(l,f){var c=o(l,1),h=o(f,1);return c!==h?c-h:c===0?f[1]-l[1]:c===1?l[0]-f[0]:c===2?l[1]-f[1]:f[0]-l[0]}return function(l){var f=l,c=SM(),h,d,g,m,p,y,v,x,b,_,M,w={point:k,lineStart:F,lineEnd:$,polygonStart:A,polygonEnd:E};function k(D,N){r(D,N)&&f.point(D,N)}function C(){for(var D=0,N=0,L=d.length;N<L;++N)for(var U=d[N],W=1,lt=U.length,At=U[0],ie,re,jt=At[0],Ue=At[1];W<lt;++W)ie=jt,re=Ue,At=U[W],jt=At[0],Ue=At[1],re<=i?Ue>i&&(jt-ie)*(i-re)>(Ue-re)*(t-ie)&&++D:Ue<=i&&(jt-ie)*(i-re)<(Ue-re)*(t-ie)&&--D;return D}function A(){f=c,h=[],d=[],M=!0}function E(){var D=C(),N=M&&D,L=(h=kM(h)).length;(N||L)&&(l.polygonStart(),N&&(l.lineStart(),a(null,null,1,l),l.lineEnd()),L&&FM(h,u,D,a,l),l.polygonEnd()),f=l,h=d=g=null}function F(){w.point=O,d&&d.push(g=[]),_=!0,b=!1,v=x=NaN}function $(){h&&(O(m,p),y&&b&&c.rejoin(),h.push(c.result())),w.point=k,b&&f.lineEnd()}function O(D,N){var L=r(D,N);if(d&&g.push([D,N]),_)m=D,p=N,y=L,_=!1,L&&(f.lineStart(),f.point(D,N));else if(L&&b)f.point(D,N);else{var U=[v=Math.max(Vu,Math.min(to,v)),x=Math.max(Vu,Math.min(to,x))],W=[D=Math.max(Vu,Math.min(to,D)),N=Math.max(Vu,Math.min(to,N))];z$(U,W,t,e,n,i)?(b||(f.lineStart(),f.point(U[0],U[1])),f.point(W[0],W[1]),L||f.lineEnd(),M=!1):L&&(f.lineStart(),f.point(D,N),M=!1)}v=D,x=N,b=L}return w}}var Uo=t=>t,Mc=new er,id=new er,RM,NM,rd,ad,fi={point:He,lineStart:He,lineEnd:He,polygonStart:function(){fi.lineStart=B$,fi.lineEnd=P$},polygonEnd:function(){fi.lineStart=fi.lineEnd=fi.point=He,Mc.add(dt(id)),id=new er},result:function(){var t=Mc/2;return Mc=new er,t}};function B$(){fi.point=L$}function L$(t,e){fi.point=OM,RM=rd=t,NM=ad=e}function OM(t,e){id.add(ad*t-rd*e),rd=t,ad=e}function P$(){OM(RM,NM)}var Vy=fi,oa=1/0,tl=oa,qo=-oa,el=qo,I$={point:U$,lineStart:He,lineEnd:He,polygonStart:He,polygonEnd:He,result:function(){var t=[[oa,tl],[qo,el]];return qo=el=-(tl=oa=1/0),t}};function U$(t,e){t<oa&&(oa=t),t>qo&&(qo=t),e<tl&&(tl=e),e>el&&(el=e)}var nl=I$,od=0,ud=0,eo=0,il=0,rl=0,Lr=0,sd=0,ld=0,no=0,zM,BM,wn,_n,un={point:nr,lineStart:Xy,lineEnd:Ky,polygonStart:function(){un.lineStart=Y$,un.lineEnd=H$},polygonEnd:function(){un.point=nr,un.lineStart=Xy,un.lineEnd=Ky},result:function(){var t=no?[sd/no,ld/no]:Lr?[il/Lr,rl/Lr]:eo?[od/eo,ud/eo]:[NaN,NaN];return od=ud=eo=il=rl=Lr=sd=ld=no=0,t}};function nr(t,e){od+=t,ud+=e,++eo}function Xy(){un.point=q$}function q$(t,e){un.point=j$,nr(wn=t,_n=e)}function j$(t,e){var n=t-wn,i=e-_n,r=Ce(n*n+i*i);il+=r*(wn+t)/2,rl+=r*(_n+e)/2,Lr+=r,nr(wn=t,_n=e)}function Ky(){un.point=nr}function Y$(){un.point=W$}function H$(){LM(zM,BM)}function W$(t,e){un.point=LM,nr(zM=wn=t,BM=_n=e)}function LM(t,e){var n=t-wn,i=e-_n,r=Ce(n*n+i*i);il+=r*(wn+t)/2,rl+=r*(_n+e)/2,Lr+=r,r=_n*t-wn*e,sd+=r*(wn+t),ld+=r*(_n+e),no+=r*3,nr(wn=t,_n=e)}var Zy=un;function PM(t){this._context=t}PM.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Pe);break}}},result:He};var fd=new er,kc,IM,UM,io,ro,al={point:He,lineStart:function(){al.point=G$},lineEnd:function(){kc&&qM(IM,UM),al.point=He},polygonStart:function(){kc=!0},polygonEnd:function(){kc=null},result:function(){var t=+fd;return fd=new er,t}};function G$(t,e){al.point=qM,IM=io=t,UM=ro=e}function qM(t,e){io-=t,ro-=e,fd.add(Ce(io*io+ro*ro)),io=t,ro=e}var Jy=al;function jM(){this._string=[]}jM.prototype={_radius:4.5,_circle:Qy(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._string.push("M",t,",",e),this._point=1;break}case 1:{this._string.push("L",t,",",e);break}default:{this._circle==null&&(this._circle=Qy(this._radius)),this._string.push("M",t,",",e,this._circle);break}}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}else return null}};function Qy(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function YM(t,e){var n=4.5,i,r;function a(o){return o&&(typeof n=="function"&&r.pointRadius(+n.apply(this,arguments)),Fr(o,i(r))),r.result()}return a.area=function(o){return Fr(o,i(Vy)),Vy.result()},a.measure=function(o){return Fr(o,i(Jy)),Jy.result()},a.bounds=function(o){return Fr(o,i(nl)),nl.result()},a.centroid=function(o){return Fr(o,i(Zy)),Zy.result()},a.projection=function(o){return arguments.length?(i=o==null?(t=null,Uo):(t=o).stream,a):t},a.context=function(o){return arguments.length?(r=o==null?(e=null,new jM):new PM(e=o),typeof n!="function"&&r.pointRadius(n),a):e},a.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(r.pointRadius(+o),+o),a):n},a.projection(t).context(e)}function Af(t){return function(e){var n=new cd;for(var i in t)n[i]=t[i];return n.stream=e,n}}function cd(){}cd.prototype={constructor:cd,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function D1(t,e,n){var i=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),i!=null&&t.clipExtent(null),Fr(n,t.stream(nl)),e(nl.result()),i!=null&&t.clipExtent(i),t}function Ef(t,e,n){return D1(t,function(i){var r=e[1][0]-e[0][0],a=e[1][1]-e[0][1],o=Math.min(r/(i[1][0]-i[0][0]),a/(i[1][1]-i[0][1])),u=+e[0][0]+(r-o*(i[1][0]+i[0][0]))/2,s=+e[0][1]+(a-o*(i[1][1]+i[0][1]))/2;t.scale(150*o).translate([u,s])},n)}function S1(t,e,n){return Ef(t,[[0,0],e],n)}function F1(t,e,n){return D1(t,function(i){var r=+e,a=r/(i[1][0]-i[0][0]),o=(r-a*(i[1][0]+i[0][0]))/2,u=-a*i[0][1];t.scale(150*a).translate([o,u])},n)}function $1(t,e,n){return D1(t,function(i){var r=+e,a=r/(i[1][1]-i[0][1]),o=-a*i[0][0],u=(r-a*(i[1][1]+i[0][1]))/2;t.scale(150*a).translate([o,u])},n)}var t2=16,V$=tt(30*wt);function e2(t,e){return+e?K$(t,e):X$(t)}function X$(t){return Af({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function K$(t,e){function n(i,r,a,o,u,s,l,f,c,h,d,g,m,p){var y=l-i,v=f-r,x=y*y+v*v;if(x>4*e&&m--){var b=o+h,_=u+d,M=s+g,w=Ce(b*b+_*_+M*M),k=Je(M/=w),C=dt(dt(M)-1)<K||dt(a-c)<K?(a+c)/2:Xn(_,b),A=t(C,k),E=A[0],F=A[1],$=E-i,O=F-r,D=v*$-y*O;(D*D/x>e||dt((y*$+v*O)/x-.5)>.3||o*h+u*d+s*g<V$)&&(n(i,r,a,o,u,s,E,F,C,b/=w,_/=w,M,m,p),p.point(E,F),n(E,F,C,b,_,M,l,f,c,h,d,g,m,p))}}return function(i){var r,a,o,u,s,l,f,c,h,d,g,m,p={point:y,lineStart:v,lineEnd:b,polygonStart:function(){i.polygonStart(),p.lineStart=_},polygonEnd:function(){i.polygonEnd(),p.lineStart=v}};function y(k,C){k=t(k,C),i.point(k[0],k[1])}function v(){c=NaN,p.point=x,i.lineStart()}function x(k,C){var A=aa([k,C]),E=t(k,C);n(c,h,f,d,g,m,c=E[0],h=E[1],f=k,d=A[0],g=A[1],m=A[2],t2,i),i.point(c,h)}function b(){p.point=y,i.lineEnd()}function _(){v(),p.point=M,p.lineEnd=w}function M(k,C){x(r=k,C),a=c,o=h,u=d,s=g,l=m,p.point=x}function w(){n(c,h,f,d,g,m,a,o,r,u,s,l,t2,i),p.lineEnd=b,b()}return p}}var Z$=Af({point:function(t,e){this.stream.point(t*wt,e*wt)}});function J$(t){return Af({point:function(e,n){var i=t(e,n);return this.stream.point(i[0],i[1])}})}function Q$(t,e,n,i,r){function a(o,u){return o*=i,u*=r,[e+t*o,n-t*u]}return a.invert=function(o,u){return[(o-e)/t*i,(n-u)/t*r]},a}function n2(t,e,n,i,r,a){if(!a)return Q$(t,e,n,i,r);var o=tt(a),u=X(a),s=o*t,l=u*t,f=o/t,c=u/t,h=(u*n-o*e)/t,d=(u*e+o*n)/t;function g(m,p){return m*=i,p*=r,[s*m-l*p+e,n-l*m-s*p]}return g.invert=function(m,p){return[i*(f*m-c*p+h),r*(d-c*m-f*p)]},g}function Jn(t){return HM(function(){return t})()}function HM(t){var e,n=150,i=480,r=250,a=0,o=0,u=0,s=0,l=0,f,c=0,h=1,d=1,g=null,m=Gy,p=null,y,v,x,b=Uo,_=.5,M,w,k,C,A;function E(D){return k(D[0]*wt,D[1]*wt)}function F(D){return D=k.invert(D[0],D[1]),D&&[D[0]*Vt,D[1]*Vt]}E.stream=function(D){return C&&A===D?C:C=Z$(J$(f)(m(M(b(A=D)))))},E.preclip=function(D){return arguments.length?(m=D,g=void 0,O()):m},E.postclip=function(D){return arguments.length?(b=D,p=y=v=x=null,O()):b},E.clipAngle=function(D){return arguments.length?(m=+D?O$(g=D*wt):(g=null,Gy),O()):g*Vt},E.clipExtent=function(D){return arguments.length?(b=D==null?(p=y=v=x=null,Uo):TM(p=+D[0][0],y=+D[0][1],v=+D[1][0],x=+D[1][1]),O()):p==null?null:[[p,y],[v,x]]},E.scale=function(D){return arguments.length?(n=+D,$()):n},E.translate=function(D){return arguments.length?(i=+D[0],r=+D[1],$()):[i,r]},E.center=function(D){return arguments.length?(a=D[0]%360*wt,o=D[1]%360*wt,$()):[a*Vt,o*Vt]},E.rotate=function(D){return arguments.length?(u=D[0]%360*wt,s=D[1]%360*wt,l=D.length>2?D[2]%360*wt:0,$()):[u*Vt,s*Vt,l*Vt]},E.angle=function(D){return arguments.length?(c=D%360*wt,$()):c*Vt},E.reflectX=function(D){return arguments.length?(h=D?-1:1,$()):h<0},E.reflectY=function(D){return arguments.length?(d=D?-1:1,$()):d<0},E.precision=function(D){return arguments.length?(M=e2(w,_=D*D),O()):Ce(_)},E.fitExtent=function(D,N){return Ef(E,D,N)},E.fitSize=function(D,N){return S1(E,D,N)},E.fitWidth=function(D,N){return F1(E,D,N)},E.fitHeight=function(D,N){return $1(E,D,N)};function $(){var D=n2(n,0,0,h,d,c).apply(null,e(a,o)),N=n2(n,i-D[0],r-D[1],h,d,c);return f=DM(u,s,l),w=ed(e,N),k=ed(f,w),M=e2(w,_),O()}function O(){return C=A=null,E}return function(){return e=t.apply(this,arguments),E.invert=e.invert&&F,$()}}function T1(t){var e=0,n=nt/3,i=HM(t),r=i(e,n);return r.parallels=function(a){return arguments.length?i(e=a[0]*wt,n=a[1]*wt):[e*Vt,n*Vt]},r}function tT(t){var e=tt(t);function n(i,r){return[i*e,X(r)/e]}return n.invert=function(i,r){return[i/e,Je(r*e)]},n}function eT(t,e){var n=X(t),i=(n+X(e))/2;if(dt(i)<K)return tT(t);var r=1+n*(2*i-n),a=Ce(r)/i;function o(u,s){var l=Ce(r-2*i*X(s))/i;return[l*X(u*=i),a-l*tt(u)]}return o.invert=function(u,s){var l=a-s,f=Xn(u,dt(l))*Ye(l);return l*i<0&&(f-=nt*Ye(u)*Ye(l)),[f/i,Je((r-(u*u+l*l)*i*i)/(2*i))]},o}function ol(){return T1(eT).scale(155.424).center([0,33.6442])}function WM(){return ol().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function nT(t){var e=t.length;return{point:function(n,i){for(var r=-1;++r<e;)t[r].point(n,i)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function iT(){var t,e,n=WM(),i,r=ol().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=ol().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,s,l={point:function(h,d){s=[h,d]}};function f(h){var d=h[0],g=h[1];return s=null,i.point(d,g),s||(a.point(d,g),s)||(u.point(d,g),s)}f.invert=function(h){var d=n.scale(),g=n.translate(),m=(h[0]-g[0])/d,p=(h[1]-g[1])/d;return(p>=.12&&p<.234&&m>=-.425&&m<-.214?r:p>=.166&&p<.234&&m>=-.214&&m<-.115?o:n).invert(h)},f.stream=function(h){return t&&e===h?t:t=nT([n.stream(e=h),r.stream(h),o.stream(h)])},f.precision=function(h){return arguments.length?(n.precision(h),r.precision(h),o.precision(h),c()):n.precision()},f.scale=function(h){return arguments.length?(n.scale(h),r.scale(h*.35),o.scale(h),f.translate(n.translate())):n.scale()},f.translate=function(h){if(!arguments.length)return n.translate();var d=n.scale(),g=+h[0],m=+h[1];return i=n.translate(h).clipExtent([[g-.455*d,m-.238*d],[g+.455*d,m+.238*d]]).stream(l),a=r.translate([g-.307*d,m+.201*d]).clipExtent([[g-.425*d+K,m+.12*d+K],[g-.214*d-K,m+.234*d-K]]).stream(l),u=o.translate([g-.205*d,m+.212*d]).clipExtent([[g-.214*d+K,m+.166*d+K],[g-.115*d-K,m+.234*d-K]]).stream(l),c()},f.fitExtent=function(h,d){return Ef(f,h,d)},f.fitSize=function(h,d){return S1(f,h,d)},f.fitWidth=function(h,d){return F1(f,h,d)},f.fitHeight=function(h,d){return $1(f,h,d)};function c(){return t=e=null,f}return f.scale(1070)}function GM(t){return function(e,n){var i=tt(e),r=tt(n),a=t(i*r);return a===1/0?[2,0]:[a*r*X(e),a*X(n)]}}function bu(t){return function(e,n){var i=Ce(e*e+n*n),r=t(i),a=X(r),o=tt(r);return[Xn(e*a,i*o),Je(i&&n*a/i)]}}var VM=GM(function(t){return Ce(2/(1+t))});VM.invert=bu(function(t){return 2*Je(t/2)});function rT(){return Jn(VM).scale(124.75).clipAngle(180-.001)}var XM=GM(function(t){return(t=CM(t))&&t/X(t)});XM.invert=bu(function(t){return t});function aT(){return Jn(XM).scale(79.4188).clipAngle(180-.001)}function Cf(t,e){return[t,Zs(C1((Mt+e)/2))]}Cf.invert=function(t,e){return[t,2*va(EM(e))-Mt]};function oT(){return KM(Cf).scale(961/Pe)}function KM(t){var e=Jn(t),n=e.center,i=e.scale,r=e.translate,a=e.clipExtent,o=null,u,s,l;e.scale=function(c){return arguments.length?(i(c),f()):i()},e.translate=function(c){return arguments.length?(r(c),f()):r()},e.center=function(c){return arguments.length?(n(c),f()):n()},e.clipExtent=function(c){return arguments.length?(c==null?o=u=s=l=null:(o=+c[0][0],u=+c[0][1],s=+c[1][0],l=+c[1][1]),f()):o==null?null:[[o,u],[s,l]]};function f(){var c=nt*i(),h=e(C$(e.rotate()).invert([0,0]));return a(o==null?[[h[0]-c,h[1]-c],[h[0]+c,h[1]+c]]:t===Cf?[[Math.max(h[0]-c,o),u],[Math.min(h[0]+c,s),l]]:[[o,Math.max(h[1]-c,u)],[s,Math.min(h[1]+c,l)]])}return f()}function Xu(t){return C1((Mt+t)/2)}function uT(t,e){var n=tt(t),i=t===e?X(t):Zs(n/tt(e))/Zs(Xu(e)/Xu(t)),r=n*bc(Xu(t),i)/i;if(!i)return Cf;function a(o,u){r>0?u<-Mt+K&&(u=-Mt+K):u>Mt-K&&(u=Mt-K);var s=r/bc(Xu(u),i);return[s*X(i*o),r-s*tt(i*o)]}return a.invert=function(o,u){var s=r-u,l=Ye(i)*Ce(o*o+s*s),f=Xn(o,dt(s))*Ye(s);return s*i<0&&(f-=nt*Ye(o)*Ye(s)),[f/i,2*va(bc(r/l,1/i))-Mt]},a}function sT(){return T1(uT).scale(109.5).parallels([30,30])}function ul(t,e){return[t,e]}ul.invert=ul;function lT(){return Jn(ul).scale(152.63)}function fT(t,e){var n=tt(t),i=t===e?X(t):(n-tt(e))/(e-t),r=n/i+t;if(dt(i)<K)return ul;function a(o,u){var s=r-u,l=i*o;return[s*X(l),r-s*tt(l)]}return a.invert=function(o,u){var s=r-u,l=Xn(o,dt(s))*Ye(s);return s*i<0&&(l-=nt*Ye(o)*Ye(s)),[l/i,r-Ye(i)*Ce(o*o+s*s)]},a}function cT(){return T1(fT).scale(131.154).center([0,13.9389])}var yo=1.340264,vo=-.081106,xo=893e-6,bo=.003796,sl=Ce(3)/2,hT=12;function ZM(t,e){var n=Je(sl*X(e)),i=n*n,r=i*i*i;return[t*tt(n)/(sl*(yo+3*vo*i+r*(7*xo+9*bo*i))),n*(yo+vo*i+r*(xo+bo*i))]}ZM.invert=function(t,e){for(var n=e,i=n*n,r=i*i*i,a=0,o,u,s;a<hT&&(u=n*(yo+vo*i+r*(xo+bo*i))-e,s=yo+3*vo*i+r*(7*xo+9*bo*i),n-=o=u/s,i=n*n,r=i*i*i,!(dt(o)<AM));++a);return[sl*t*(yo+3*vo*i+r*(7*xo+9*bo*i))/tt(n),Je(X(n)/sl)]};function dT(){return Jn(ZM).scale(177.158)}function JM(t,e){var n=tt(e),i=tt(t)*n;return[n*X(t)/i,X(e)/i]}JM.invert=bu(va);function gT(){return Jn(JM).scale(144.049).clipAngle(60)}function mT(){var t=1,e=0,n=0,i=1,r=1,a=0,o,u,s=null,l,f,c,h=1,d=1,g=Af({point:function(b,_){var M=x([b,_]);this.stream.point(M[0],M[1])}}),m=Uo,p,y;function v(){return h=t*i,d=t*r,p=y=null,x}function x(b){var _=b[0]*h,M=b[1]*d;if(a){var w=M*o-_*u;_=_*o+M*u,M=w}return[_+e,M+n]}return x.invert=function(b){var _=b[0]-e,M=b[1]-n;if(a){var w=M*o+_*u;_=_*o-M*u,M=w}return[_/h,M/d]},x.stream=function(b){return p&&y===b?p:p=g(m(y=b))},x.postclip=function(b){return arguments.length?(m=b,s=l=f=c=null,v()):m},x.clipExtent=function(b){return arguments.length?(m=b==null?(s=l=f=c=null,Uo):TM(s=+b[0][0],l=+b[0][1],f=+b[1][0],c=+b[1][1]),v()):s==null?null:[[s,l],[f,c]]},x.scale=function(b){return arguments.length?(t=+b,v()):t},x.translate=function(b){return arguments.length?(e=+b[0],n=+b[1],v()):[e,n]},x.angle=function(b){return arguments.length?(a=b%360*wt,u=X(a),o=tt(a),v()):a*Vt},x.reflectX=function(b){return arguments.length?(i=b?-1:1,v()):i<0},x.reflectY=function(b){return arguments.length?(r=b?-1:1,v()):r<0},x.fitExtent=function(b,_){return Ef(x,b,_)},x.fitSize=function(b,_){return S1(x,b,_)},x.fitWidth=function(b,_){return F1(x,b,_)},x.fitHeight=function(b,_){return $1(x,b,_)},x}function QM(t,e){var n=e*e,i=n*n;return[t*(.8707-.131979*n+i*(-.013791+i*(.003971*n-.001529*i))),e*(1.007226+n*(.015085+i*(-.044475+.028874*n-.005916*i)))]}QM.invert=function(t,e){var n=e,i=25,r;do{var a=n*n,o=a*a;n-=r=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-e)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(dt(r)>K&&--i>0);return[t/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function pT(){return Jn(QM).scale(175.295)}function t5(t,e){return[tt(e)*X(t),X(e)]}t5.invert=bu(Je);function yT(){return Jn(t5).scale(249.5).clipAngle(90+K)}function e5(t,e){var n=tt(e),i=1+tt(t)*n;return[n*X(t)/i,X(e)/i]}e5.invert=bu(function(t){return 2*va(t)});function vT(){return Jn(e5).scale(250).clipAngle(142)}function n5(t,e){return[Zs(C1((Mt+e)/2)),-t]}n5.invert=function(t,e){return[-e,2*va(EM(t))-Mt]};function xT(){var t=KM(n5),e=t.center,n=t.rotate;return t.center=function(i){return arguments.length?e([-i[1],i[0]]):(i=e(),[i[1],-i[0]])},t.rotate=function(i){return arguments.length?n([i[0],i[1],i.length>2?i[2]+90:90]):(i=n(),[i[0],i[1],i[2]-90])},n([0,0,90]).scale(159.155)}var bT=Math.abs,hd=Math.cos,ll=Math.sin,wT=1e-6,i5=Math.PI,dd=i5/2,i2=_T(2);function r2(t){return t>1?dd:t<-1?-dd:Math.asin(t)}function _T(t){return t>0?Math.sqrt(t):0}function MT(t,e){var n=t*ll(e),i=30,r;do e-=r=(e+ll(e)-n)/(1+hd(e));while(bT(r)>wT&&--i>0);return e/2}function kT(t,e,n){function i(r,a){return[t*r*hd(a=MT(n,a)),e*ll(a)]}return i.invert=function(r,a){return a=r2(a/e),[r/(t*hd(a)),r2((2*a+ll(2*a))/n)]},i}var AT=kT(i2/dd,i2,i5);function ET(){return $A(AT).scale(169.529)}const CT=YM(),gd=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function DT(t,e){return function n(){const i=e();return i.type=t,i.path=YM().projection(i),i.copy=i.copy||function(){const r=n();return gd.forEach(a=>{i[a]&&r[a](i[a]())}),r.path.pointRadius(i.path.pointRadius()),r},i}}function R1(t,e){if(!t||typeof t!="string")throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(fl[t]=DT(t,e),this):fl[t]||null}function r5(t){return t&&t.path||CT}const fl={albers:WM,albersusa:iT,azimuthalequalarea:rT,azimuthalequidistant:aT,conicconformal:sT,conicequalarea:ol,conicequidistant:cT,equalEarth:dT,equirectangular:lT,gnomonic:gT,identity:mT,mercator:oT,mollweide:ET,naturalEarth1:pT,orthographic:yT,stereographic:vT,transversemercator:xT};for(const t in fl)R1(t,fl[t]);var oi=1e-6,a2=Math.abs,Ku=Math.ceil;function o2(t,e,n){var i=Vi(t,e-oi,n).concat(e);return function(r){return i.map(function(a){return[r,a]})}}function u2(t,e,n){var i=Vi(t,e-oi,n).concat(e);return function(r){return i.map(function(a){return[a,r]})}}function ST(){var t,e,n,i,r,a,o,u,s=10,l=s,f=90,c=360,h,d,g,m,p=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return Vi(Ku(i/f)*f,n,f).map(g).concat(Vi(Ku(u/c)*c,o,c).map(m)).concat(Vi(Ku(e/s)*s,t,s).filter(function(x){return a2(x%f)>oi}).map(h)).concat(Vi(Ku(a/l)*l,r,l).filter(function(x){return a2(x%c)>oi}).map(d))}return y.lines=function(){return v().map(function(x){return{type:"LineString",coordinates:x}})},y.outline=function(){return{type:"Polygon",coordinates:[g(i).concat(m(o).slice(1),g(n).reverse().slice(1),m(u).reverse().slice(1))]}},y.extent=function(x){return arguments.length?y.extentMajor(x).extentMinor(x):y.extentMinor()},y.extentMajor=function(x){return arguments.length?(i=+x[0][0],n=+x[1][0],u=+x[0][1],o=+x[1][1],i>n&&(x=i,i=n,n=x),u>o&&(x=u,u=o,o=x),y.precision(p)):[[i,u],[n,o]]},y.extentMinor=function(x){return arguments.length?(e=+x[0][0],t=+x[1][0],a=+x[0][1],r=+x[1][1],e>t&&(x=e,e=t,t=x),a>r&&(x=a,a=r,r=x),y.precision(p)):[[e,a],[t,r]]},y.step=function(x){return arguments.length?y.stepMajor(x).stepMinor(x):y.stepMinor()},y.stepMajor=function(x){return arguments.length?(f=+x[0],c=+x[1],y):[f,c]},y.stepMinor=function(x){return arguments.length?(s=+x[0],l=+x[1],y):[s,l]},y.precision=function(x){return arguments.length?(p=+x,h=o2(a,r,90),d=u2(e,t,p),g=o2(u,o,90),m=u2(i,n,p),y):p},y.extentMajor([[-180,-90+oi],[180,90-oi]]).extentMinor([[-180,-80-oi],[180,80+oi]])}function N1(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function a5(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function wu(){}var jo=.7,cl=1/jo,qr="\\s*([+-]?\\d+)\\s*",Yo="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Cn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",FT=/^#([0-9a-f]{3,8})$/,$T=new RegExp("^rgb\\("+[qr,qr,qr]+"\\)$"),TT=new RegExp("^rgb\\("+[Cn,Cn,Cn]+"\\)$"),RT=new RegExp("^rgba\\("+[qr,qr,qr,Yo]+"\\)$"),NT=new RegExp("^rgba\\("+[Cn,Cn,Cn,Yo]+"\\)$"),OT=new RegExp("^hsl\\("+[Yo,Cn,Cn]+"\\)$"),zT=new RegExp("^hsla\\("+[Yo,Cn,Cn,Yo]+"\\)$"),s2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};N1(wu,O1,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:l2,formatHex:l2,formatHsl:BT,formatRgb:f2,toString:f2});function l2(){return this.rgb().formatHex()}function BT(){return o5(this).formatHsl()}function f2(){return this.rgb().formatRgb()}function O1(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=FT.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?c2(e):n===3?new Ne(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Zu(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Zu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=$T.exec(t))?new Ne(e[1],e[2],e[3],1):(e=TT.exec(t))?new Ne(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=RT.exec(t))?Zu(e[1],e[2],e[3],e[4]):(e=NT.exec(t))?Zu(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=OT.exec(t))?g2(e[1],e[2]/100,e[3]/100,1):(e=zT.exec(t))?g2(e[1],e[2]/100,e[3]/100,e[4]):s2.hasOwnProperty(t)?c2(s2[t]):t==="transparent"?new Ne(NaN,NaN,NaN,0):null}function c2(t){return new Ne(t>>16&255,t>>8&255,t&255,1)}function Zu(t,e,n,i){return i<=0&&(t=e=n=NaN),new Ne(t,e,n,i)}function LT(t){return t instanceof wu||(t=O1(t)),t?(t=t.rgb(),new Ne(t.r,t.g,t.b,t.opacity)):new Ne}function md(t,e,n,i){return arguments.length===1?LT(t):new Ne(t,e,n,i==null?1:i)}function Ne(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}N1(Ne,md,a5(wu,{brighter:function(t){return t=t==null?cl:Math.pow(cl,t),new Ne(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?jo:Math.pow(jo,t),new Ne(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:h2,formatHex:h2,formatRgb:d2,toString:d2}));function h2(){return"#"+Ac(this.r)+Ac(this.g)+Ac(this.b)}function d2(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function Ac(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function g2(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Mn(t,e,n,i)}function o5(t){if(t instanceof Mn)return new Mn(t.h,t.s,t.l,t.opacity);if(t instanceof wu||(t=O1(t)),!t)return new Mn;if(t instanceof Mn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,u=a-r,s=(a+r)/2;return u?(e===a?o=(n-i)/u+(n<i)*6:n===a?o=(i-e)/u+2:o=(e-n)/u+4,u/=s<.5?a+r:2-a-r,o*=60):u=s>0&&s<1?0:o,new Mn(o,u,s,t.opacity)}function PT(t,e,n,i){return arguments.length===1?o5(t):new Mn(t,e,n,i==null?1:i)}function Mn(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}N1(Mn,PT,a5(wu,{brighter:function(t){return t=t==null?cl:Math.pow(cl,t),new Mn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?jo:Math.pow(jo,t),new Mn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Ne(Ec(t>=240?t-240:t+120,r,i),Ec(t,r,i),Ec(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function Ec(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function IT(){}const Pn=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function u5(){var t=1,e=1,n=u;function i(s,l){return l.map(f=>r(s,f))}function r(s,l){var f=[],c=[];return a(s,l,h=>{n(h,s,l),UT(h)>0?f.push([h]):c.push(h)}),c.forEach(h=>{for(var d=0,g=f.length,m;d<g;++d)if(qT((m=f[d])[0],h)!==-1){m.push(h);return}}),{type:"MultiPolygon",value:l,coordinates:f}}function a(s,l,f){var c=new Array,h=new Array,d,g,m,p,y,v;for(d=g=-1,p=s[0]>=l,Pn[p<<1].forEach(x);++d<t-1;)m=p,p=s[d+1]>=l,Pn[m|p<<1].forEach(x);for(Pn[p<<0].forEach(x);++g<e-1;){for(d=-1,p=s[g*t+t]>=l,y=s[g*t]>=l,Pn[p<<1|y<<2].forEach(x);++d<t-1;)m=p,p=s[g*t+t+d+1]>=l,v=y,y=s[g*t+d+1]>=l,Pn[m|p<<1|y<<2|v<<3].forEach(x);Pn[p|y<<3].forEach(x)}for(d=-1,y=s[g*t]>=l,Pn[y<<2].forEach(x);++d<t-1;)v=y,y=s[g*t+d+1]>=l,Pn[y<<2|v<<3].forEach(x);Pn[y<<3].forEach(x);function x(b){var _=[b[0][0]+d,b[0][1]+g],M=[b[1][0]+d,b[1][1]+g],w=o(_),k=o(M),C,A;(C=h[w])?(A=c[k])?(delete h[C.end],delete c[A.start],C===A?(C.ring.push(M),f(C.ring)):c[C.start]=h[A.end]={start:C.start,end:A.end,ring:C.ring.concat(A.ring)}):(delete h[C.end],C.ring.push(M),h[C.end=k]=C):(C=c[k])?(A=h[w])?(delete c[C.start],delete h[A.end],C===A?(C.ring.push(M),f(C.ring)):c[A.start]=h[C.end]={start:A.start,end:C.end,ring:A.ring.concat(C.ring)}):(delete c[C.start],C.ring.unshift(_),c[C.start=w]=C):c[w]=h[k]={start:w,end:k,ring:[_,M]}}}function o(s){return s[0]*2+s[1]*(t+1)*4}function u(s,l,f){s.forEach(c=>{var h=c[0],d=c[1],g=h|0,m=d|0,p,y=l[m*t+g];h>0&&h<t&&g===h&&(p=l[m*t+g-1],c[0]=h+(f-p)/(y-p)-.5),d>0&&d<e&&m===d&&(p=l[(m-1)*t+g],c[1]=d+(f-p)/(y-p)-.5)})}return i.contour=r,i.size=function(s){if(!arguments.length)return[t,e];var l=Math.floor(s[0]),f=Math.floor(s[1]);return l>=0&&f>=0||R("invalid size"),t=l,e=f,i},i.smooth=function(s){return arguments.length?(n=s?u:IT,i):n===u},i}function UT(t){for(var e=0,n=t.length,i=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)i+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return i}function qT(t,e){for(var n=-1,i=e.length,r;++n<i;)if(r=jT(t,e[n]))return r;return 0}function jT(t,e){for(var n=e[0],i=e[1],r=-1,a=0,o=t.length,u=o-1;a<o;u=a++){var s=t[a],l=s[0],f=s[1],c=t[u],h=c[0],d=c[1];if(YT(s,c,e))return 0;f>i!=d>i&&n<(h-l)*(i-f)/(d-f)+l&&(r=-r)}return r}function YT(t,e,n){var i;return HT(t,e,n)&&WT(t[i=+(t[0]===e[0])],n[i],e[i])}function HT(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}function WT(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}function s5(t,e,n){return function(i){var r=Fn(i),a=n?Math.min(r[0],0):r[0],o=r[1],u=o-a,s=e?k$(a,o,t):u/(t+1);return Vi(a+s,o,s)}}function z1(t){S.call(this,null,t)}z1.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};z(z1,S,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=e.materialize(e.SOURCE).source,r=t.field||de,a=u5().smooth(t.smooth!==!1),o=t.thresholds||GT(i,r,t),u=t.as===null?null:t.as||"contour",s=[];return i.forEach(l=>{const f=r(l),c=a.size([f.width,f.height])(f.values,Y(o)?o:o(f.values));VT(c,f,l,t),c.forEach(h=>{s.push(Hl(l,ft(u!=null?{[u]:h}:h)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=s,n}});function GT(t,e,n){const i=s5(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?i:i(t.map(r=>bs(e(r).values)))}function VT(t,e,n,i){let r=i.scale||e.scale,a=i.translate||e.translate;if(Q(r)&&(r=r(n,i)),Q(a)&&(a=a(n,i)),(r===1||r==null)&&!a)return;const o=(Mi(r)?r:r[0])||1,u=(Mi(r)?r:r[1])||1,s=a&&a[0]||0,l=a&&a[1]||0;t.forEach(l5(e,o,u,s,l))}function l5(t,e,n,i,r){const a=t.x1||0,o=t.y1||0,u=e*n<0;function s(c){c.forEach(l)}function l(c){u&&c.reverse(),c.forEach(f)}function f(c){c[0]=(c[0]-a)*e+i,c[1]=(c[1]-o)*n+r}return function(c){return c.coordinates.forEach(s),c}}function m2(t,e,n){const i=t>=0?t:k0(e,n);return Math.round((Math.sqrt(4*i*i+1)-1)/2)}function Cc(t){return Q(t)?t:ee(+t)}function f5(){var t=s=>s[0],e=s=>s[1],n=fa,i=[-1,-1],r=960,a=500,o=2;function u(s,l){const f=m2(i[0],s,t)>>o,c=m2(i[1],s,e)>>o,h=f?f+2:0,d=c?c+2:0,g=2*h+(r>>o),m=2*d+(a>>o),p=new Float32Array(g*m),y=new Float32Array(g*m);let v=p;s.forEach(b=>{const _=h+(+t(b)>>o),M=d+(+e(b)>>o);_>=0&&_<g&&M>=0&&M<m&&(p[_+M*g]+=+n(b))}),f>0&&c>0?(Er(g,m,p,y,f),Cr(g,m,y,p,c),Er(g,m,p,y,f),Cr(g,m,y,p,c),Er(g,m,p,y,f),Cr(g,m,y,p,c)):f>0?(Er(g,m,p,y,f),Er(g,m,y,p,f),Er(g,m,p,y,f),v=y):c>0&&(Cr(g,m,p,y,c),Cr(g,m,y,p,c),Cr(g,m,p,y,c),v=y);const x=l?Math.pow(2,-2*o):1/A$(v);for(let b=0,_=g*m;b<_;++b)v[b]*=x;return{values:v,scale:1<<o,width:g,height:m,x1:h,y1:d,x2:h+(r>>o),y2:d+(a>>o)}}return u.x=function(s){return arguments.length?(t=Cc(s),u):t},u.y=function(s){return arguments.length?(e=Cc(s),u):e},u.weight=function(s){return arguments.length?(n=Cc(s),u):n},u.size=function(s){if(!arguments.length)return[r,a];var l=+s[0],f=+s[1];return l>=0&&f>=0||R("invalid size"),r=l,a=f,u},u.cellSize=function(s){return arguments.length?((s=+s)>=1||R("invalid cell size"),o=Math.floor(Math.log(s)/Math.LN2),u):1<<o},u.bandwidth=function(s){return arguments.length?(s=G(s),s.length===1&&(s=[+s[0],+s[0]]),s.length!==2&&R("invalid bandwidth"),i=s,u):i},u}function Er(t,e,n,i,r){const a=(r<<1)+1;for(let o=0;o<e;++o)for(let u=0,s=0;u<t+r;++u)u<t&&(s+=n[u+o*t]),u>=r&&(u>=a&&(s-=n[u-a+o*t]),i[u-r+o*t]=s/Math.min(u+1,t-1+a-u,a))}function Cr(t,e,n,i,r){const a=(r<<1)+1;for(let o=0;o<t;++o)for(let u=0,s=0;u<e+r;++u)u<e&&(s+=n[o+u*t]),u>=r&&(u>=a&&(s-=n[o+(u-a)*t]),i[o+(u-r)*t]=s/Math.min(u+1,e-1+a-u,a))}function B1(t){S.call(this,null,t)}B1.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const XT=["x","y","weight","size","cellSize","bandwidth"];function c5(t,e){return XT.forEach(n=>e[n]!=null?t[n](e[n]):0),t}z(B1,S,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=e.materialize(e.SOURCE).source,r=KT(i,t.groupby),a=(t.groupby||[]).map(kt),o=c5(f5(),t),u=t.as||"grid",s=[];function l(f,c){for(let h=0;h<a.length;++h)f[a[h]]=c[h];return f}return s=r.map(f=>ft(l({[u]:o(f,t.counts)},f.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=s,n}});function KT(t,e){var n=[],i=f=>f(u),r,a,o,u,s,l;if(e==null)n.push(t);else for(r={},a=0,o=t.length;a<o;++a)u=t[a],s=e.map(i),l=r[s],l||(r[s]=l=[],l.dims=s,n.push(l)),l.push(u);return n}function L1(t){S.call(this,null,t)}L1.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};z(L1,S,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=u5().smooth(t.smooth!==!1),r=t.values,a=t.thresholds||s5(t.count||10,t.nice,!!r),o=t.size,u,s;return r||(r=e.materialize(e.SOURCE).source,u=c5(f5(),t)(r,!0),s=l5(u,u.scale||1,u.scale||1,0,0),o=[u.width,u.height],r=u.values),a=Y(a)?a:a(r),r=i.size(o)(r,a),s&&r.forEach(s),this.value&&(n.rem=this.value),this.value=n.source=n.add=(r||[]).map(ft),n}});const pd="Feature",P1="FeatureCollection",ZT="MultiPoint";function I1(t){S.call(this,null,t)}I1.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};z(I1,S,{transform(t,e){var n=this._features,i=this._points,r=t.fields,a=r&&r[0],o=r&&r[1],u=t.geojson||!r&&de,s=e.ADD,l;l=t.modified()||e.changed(e.REM)||e.modified(Zt(u))||a&&e.modified(Zt(a))||o&&e.modified(Zt(o)),(!this.value||l)&&(s=e.SOURCE,this._features=n=[],this._points=i=[]),u&&e.visit(s,f=>n.push(u(f))),a&&o&&(e.visit(s,f=>{var c=a(f),h=o(f);c!=null&&h!=null&&(c=+c)===c&&(h=+h)===h&&i.push([c,h])}),n=n.concat({type:pd,geometry:{type:ZT,coordinates:i}})),this.value={type:P1,features:n}}});function U1(t){S.call(this,null,t)}U1.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};z(U1,S,{transform(t,e){var n=e.fork(e.ALL),i=this.value,r=t.field||de,a=t.as||"path",o=n.SOURCE;!i||t.modified()?(this.value=i=r5(t.projection),n.materialize().reflow()):o=r===de||e.modified(r.fields)?n.ADD_MOD:n.ADD;const u=JT(i,t.pointRadius);return n.visit(o,s=>s[a]=i(r(s))),i.pointRadius(u),n.modifies(a)}});function JT(t,e){const n=t.pointRadius();return t.context(null),e!=null&&t.pointRadius(e),n}function q1(t){S.call(this,null,t)}q1.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};z(q1,S,{transform(t,e){var n=t.projection,i=t.fields[0],r=t.fields[1],a=t.as||["x","y"],o=a[0],u=a[1],s;function l(f){const c=n([i(f),r(f)]);c?(f[o]=c[0],f[u]=c[1]):(f[o]=void 0,f[u]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,l):(s=e.modified(i.fields)||e.modified(r.fields),e.visit(s?e.ADD_MOD:e.ADD,l)),e.modifies(a)}});function j1(t){S.call(this,null,t)}j1.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};z(j1,S,{transform(t,e){var n=e.fork(e.ALL),i=this.value,r=t.as||"shape",a=n.ADD;return(!i||t.modified())&&(this.value=i=QT(r5(t.projection),t.field||ke("datum"),t.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,o=>o[r]=i),n.modifies(r)}});function QT(t,e,n){const i=n==null?r=>t(e(r)):r=>{var a=t.pointRadius(),o=t.pointRadius(n)(e(r));return t.pointRadius(a),o};return i.context=r=>(t.context(r),i),i}function Y1(t){S.call(this,[],t),this.generator=ST()}Y1.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};z(Y1,S,{transform(t,e){var n=this.value,i=this.generator,r;if(!n.length||t.modified())for(const a in t)Q(i[a])&&i[a](t[a]);return r=i(),n.length?e.mod.push(Ab(n[0],r)):e.add.push(ft(r)),n[0]=r,e}});function H1(t){S.call(this,null,t)}H1.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};z(H1,S,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,i=t.resolve==="shared",r=t.field||de,a=eR(t.opacity,t),o=tR(t.color,t),u=t.as||"image",s={$x:0,$y:0,$value:0,$max:i?bs(n.map(l=>bs(r(l).values))):0};return n.forEach(l=>{const f=r(l),c=Z({},l,s);i||(c.$max=bs(f.values||[])),l[u]=nR(f,c,o.dep?o:ee(o(c)),a.dep?a:ee(a(c)))}),e.reflow(!0).modifies(u)}});function tR(t,e){let n;return Q(t)?(n=i=>md(t(i,e)),n.dep=h5(t)):n=ee(md(t||"#888")),n}function eR(t,e){let n;return Q(t)?(n=i=>t(i,e),n.dep=h5(t)):t?n=ee(t):(n=i=>i.$value/i.$max||0,n.dep=!0),n}function h5(t){if(!Q(t))return!1;const e=cn(Zt(t));return e.$x||e.$y||e.$value||e.$max}function nR(t,e,n,i){const r=t.width,a=t.height,o=t.x1||0,u=t.y1||0,s=t.x2||r,l=t.y2||a,f=t.values,c=f?p=>f[p]:li,h=ma(s-o,l-u),d=h.getContext("2d"),g=d.getImageData(0,0,s-o,l-u),m=g.data;for(let p=u,y=0;p<l;++p){e.$y=p-u;for(let v=o,x=p*r;v<s;++v,y+=4){e.$x=v-o,e.$value=c(v+x);const b=n(e);m[y+0]=b.r,m[y+1]=b.g,m[y+2]=b.b,m[y+3]=~~(255*i(e))}}return d.putImageData(g,0,0),h}function d5(t){S.call(this,null,t),this.modified(!0)}z(d5,S,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=rR(t.type),gd.forEach(i=>{t[i]!=null&&p2(n,i,t[i])})):gd.forEach(i=>{t.modified(i)&&p2(n,i,t[i])}),t.pointRadius!=null&&n.path.pointRadius(t.pointRadius),t.fit&&iR(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function iR(t,e){const n=aR(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}function rR(t){const e=R1((t||"mercator").toLowerCase());return e||R("Unrecognized projection type: "+t),e()}function p2(t,e,n){Q(t[e])&&t[e](n)}function aR(t){return t=G(t),t.length===1?t[0]:{type:P1,features:t.reduce((e,n)=>e.concat(oR(n)),[])}}function oR(t){return t.type===P1?t.features:G(t).filter(e=>e!=null).map(e=>e.type===pd?e:{type:pd,geometry:e})}var uR=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",contour:L1,geojson:I1,geopath:U1,geopoint:q1,geoshape:j1,graticule:Y1,heatmap:H1,isocontour:z1,kde2d:B1,projection:d5});function sR(t,e){var n,i=1;t==null&&(t=0),e==null&&(e=0);function r(){var a,o=n.length,u,s=0,l=0;for(a=0;a<o;++a)u=n[a],s+=u.x,l+=u.y;for(s=(s/o-t)*i,l=(l/o-e)*i,a=0;a<o;++a)u=n[a],u.x-=s,u.y-=l}return r.initialize=function(a){n=a},r.x=function(a){return arguments.length?(t=+a,r):t},r.y=function(a){return arguments.length?(e=+a,r):e},r.strength=function(a){return arguments.length?(i=+a,r):i},r}function ce(t){return function(){return t}}function yi(t){return(t()-.5)*1e-6}function lR(t){return t.x+t.vx}function fR(t){return t.y+t.vy}function cR(t){var e,n,i,r=1,a=1;typeof t!="function"&&(t=ce(t==null?1:+t));function o(){for(var l,f=e.length,c,h,d,g,m,p,y=0;y<a;++y)for(c=Vv(e,lR,fR).visitAfter(u),l=0;l<f;++l)h=e[l],m=n[h.index],p=m*m,d=h.x+h.vx,g=h.y+h.vy,c.visit(v);function v(x,b,_,M,w){var k=x.data,C=x.r,A=m+C;if(k){if(k.index>h.index){var E=d-k.x-k.vx,F=g-k.y-k.vy,$=E*E+F*F;$<A*A&&(E===0&&(E=yi(i),$+=E*E),F===0&&(F=yi(i),$+=F*F),$=(A-($=Math.sqrt($)))/$*r,h.vx+=(E*=$)*(A=(C*=C)/(p+C)),h.vy+=(F*=$)*A,k.vx-=E*(A=1-A),k.vy-=F*A)}return}return b>d+A||M<d-A||_>g+A||w<g-A}}function u(l){if(l.data)return l.r=n[l.data.index];for(var f=l.r=0;f<4;++f)l[f]&&l[f].r>l.r&&(l.r=l[f].r)}function s(){if(!!e){var l,f=e.length,c;for(n=new Array(f),l=0;l<f;++l)c=e[l],n[c.index]=+t(c,l,e)}}return o.initialize=function(l,f){e=l,i=f,s()},o.iterations=function(l){return arguments.length?(a=+l,o):a},o.strength=function(l){return arguments.length?(r=+l,o):r},o.radius=function(l){return arguments.length?(t=typeof l=="function"?l:ce(+l),s(),o):t},o}function hR(t){return t.index}function y2(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function dR(t){var e=hR,n=c,i,r=ce(30),a,o,u,s,l,f=1;t==null&&(t=[]);function c(p){return 1/Math.min(u[p.source.index],u[p.target.index])}function h(p){for(var y=0,v=t.length;y<f;++y)for(var x=0,b,_,M,w,k,C,A;x<v;++x)b=t[x],_=b.source,M=b.target,w=M.x+M.vx-_.x-_.vx||yi(l),k=M.y+M.vy-_.y-_.vy||yi(l),C=Math.sqrt(w*w+k*k),C=(C-a[x])/C*p*i[x],w*=C,k*=C,M.vx-=w*(A=s[x]),M.vy-=k*A,_.vx+=w*(A=1-A),_.vy+=k*A}function d(){if(!!o){var p,y=o.length,v=t.length,x=new Map(o.map((_,M)=>[e(_,M,o),_])),b;for(p=0,u=new Array(y);p<v;++p)b=t[p],b.index=p,typeof b.source!="object"&&(b.source=y2(x,b.source)),typeof b.target!="object"&&(b.target=y2(x,b.target)),u[b.source.index]=(u[b.source.index]||0)+1,u[b.target.index]=(u[b.target.index]||0)+1;for(p=0,s=new Array(v);p<v;++p)b=t[p],s[p]=u[b.source.index]/(u[b.source.index]+u[b.target.index]);i=new Array(v),g(),a=new Array(v),m()}}function g(){if(!!o)for(var p=0,y=t.length;p<y;++p)i[p]=+n(t[p],p,t)}function m(){if(!!o)for(var p=0,y=t.length;p<y;++p)a[p]=+r(t[p],p,t)}return h.initialize=function(p,y){o=p,l=y,d()},h.links=function(p){return arguments.length?(t=p,d(),h):t},h.id=function(p){return arguments.length?(e=p,h):e},h.iterations=function(p){return arguments.length?(f=+p,h):f},h.strength=function(p){return arguments.length?(n=typeof p=="function"?p:ce(+p),g(),h):n},h.distance=function(p){return arguments.length?(r=typeof p=="function"?p:ce(+p),m(),h):r},h}const gR=1664525,mR=1013904223,v2=4294967296;function pR(){let t=1;return()=>(t=(gR*t+mR)%v2)/v2}function yR(t){return t.x}function vR(t){return t.y}var xR=10,bR=Math.PI*(3-Math.sqrt(5));function wR(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),a=0,o=.6,u=new Map,s=TA(c),l=RA("tick","end"),f=pR();t==null&&(t=[]);function c(){h(),l.call("tick",e),n<i&&(s.stop(),l.call("end",e))}function h(m){var p,y=t.length,v;m===void 0&&(m=1);for(var x=0;x<m;++x)for(n+=(a-n)*r,u.forEach(function(b){b(n)}),p=0;p<y;++p)v=t[p],v.fx==null?v.x+=v.vx*=o:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=o:(v.y=v.fy,v.vy=0);return e}function d(){for(var m=0,p=t.length,y;m<p;++m){if(y=t[m],y.index=m,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=xR*Math.sqrt(.5+m),x=m*bR;y.x=v*Math.cos(x),y.y=v*Math.sin(x)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(m){return m.initialize&&m.initialize(t,f),m}return d(),e={tick:h,restart:function(){return s.restart(c),e},stop:function(){return s.stop(),e},nodes:function(m){return arguments.length?(t=m,d(),u.forEach(g),e):t},alpha:function(m){return arguments.length?(n=+m,e):n},alphaMin:function(m){return arguments.length?(i=+m,e):i},alphaDecay:function(m){return arguments.length?(r=+m,e):+r},alphaTarget:function(m){return arguments.length?(a=+m,e):a},velocityDecay:function(m){return arguments.length?(o=1-m,e):1-o},randomSource:function(m){return arguments.length?(f=m,u.forEach(g),e):f},force:function(m,p){return arguments.length>1?(p==null?u.delete(m):u.set(m,g(p)),e):u.get(m)},find:function(m,p,y){var v=0,x=t.length,b,_,M,w,k;for(y==null?y=1/0:y*=y,v=0;v<x;++v)w=t[v],b=m-w.x,_=p-w.y,M=b*b+_*_,M<y&&(k=w,y=M);return k},on:function(m,p){return arguments.length>1?(l.on(m,p),e):l.on(m)}}}function _R(){var t,e,n,i,r=ce(-30),a,o=1,u=1/0,s=.81;function l(d){var g,m=t.length,p=Vv(t,yR,vR).visitAfter(c);for(i=d,g=0;g<m;++g)e=t[g],p.visit(h)}function f(){if(!!t){var d,g=t.length,m;for(a=new Array(g),d=0;d<g;++d)m=t[d],a[m.index]=+r(m,d,t)}}function c(d){var g=0,m,p,y=0,v,x,b;if(d.length){for(v=x=b=0;b<4;++b)(m=d[b])&&(p=Math.abs(m.value))&&(g+=m.value,y+=p,v+=p*m.x,x+=p*m.y);d.x=v/y,d.y=x/y}else{m=d,m.x=m.data.x,m.y=m.data.y;do g+=a[m.data.index];while(m=m.next)}d.value=g}function h(d,g,m,p){if(!d.value)return!0;var y=d.x-e.x,v=d.y-e.y,x=p-g,b=y*y+v*v;if(x*x/s<b)return b<u&&(y===0&&(y=yi(n),b+=y*y),v===0&&(v=yi(n),b+=v*v),b<o&&(b=Math.sqrt(o*b)),e.vx+=y*d.value*i/b,e.vy+=v*d.value*i/b),!0;if(d.length||b>=u)return;(d.data!==e||d.next)&&(y===0&&(y=yi(n),b+=y*y),v===0&&(v=yi(n),b+=v*v),b<o&&(b=Math.sqrt(o*b)));do d.data!==e&&(x=a[d.data.index]*i/b,e.vx+=y*x,e.vy+=v*x);while(d=d.next)}return l.initialize=function(d,g){t=d,n=g,f()},l.strength=function(d){return arguments.length?(r=typeof d=="function"?d:ce(+d),f(),l):r},l.distanceMin=function(d){return arguments.length?(o=d*d,l):Math.sqrt(o)},l.distanceMax=function(d){return arguments.length?(u=d*d,l):Math.sqrt(u)},l.theta=function(d){return arguments.length?(s=d*d,l):Math.sqrt(s)},l}function MR(t){var e=ce(.1),n,i,r;typeof t!="function"&&(t=ce(t==null?0:+t));function a(u){for(var s=0,l=n.length,f;s<l;++s)f=n[s],f.vx+=(r[s]-f.x)*i[s]*u}function o(){if(!!n){var u,s=n.length;for(i=new Array(s),r=new Array(s),u=0;u<s;++u)i[u]=isNaN(r[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return a.initialize=function(u){n=u,o()},a.strength=function(u){return arguments.length?(e=typeof u=="function"?u:ce(+u),o(),a):e},a.x=function(u){return arguments.length?(t=typeof u=="function"?u:ce(+u),o(),a):t},a}function kR(t){var e=ce(.1),n,i,r;typeof t!="function"&&(t=ce(t==null?0:+t));function a(u){for(var s=0,l=n.length,f;s<l;++s)f=n[s],f.vy+=(r[s]-f.y)*i[s]*u}function o(){if(!!n){var u,s=n.length;for(i=new Array(s),r=new Array(s),u=0;u<s;++u)i[u]=isNaN(r[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return a.initialize=function(u){n=u,o()},a.strength=function(u){return arguments.length?(e=typeof u=="function"?u:ce(+u),o(),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:ce(+u),o(),a):t},a}const x2={center:sR,collide:cR,nbody:_R,link:dR,x:MR,y:kR},ao="forces",yd=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],AR=["static","iterations"],g5=["x","y","vx","vy"];function W1(t){S.call(this,null,t)}W1.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:g5}]};z(W1,S,{transform(t,e){var n=this.value,i=e.changed(e.ADD_REM),r=t.modified(yd),a=t.iterations||300;if(n?(i&&(e.modifies("index"),n.nodes(e.source)),(r||e.changed(e.MOD))&&m5(n,t,0,e)):(this.value=n=CR(e.source,t),n.on("tick",ER(e.dataflow,this)),t.static||(i=!0,n.tick()),e.modifies("index")),r||i||t.modified(AR)||e.changed()&&t.restart){if(n.alpha(Math.max(n.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a)),t.static)for(n.stop();--a>=0;)n.tick();else if(n.stopped()&&n.restart(),!i)return e.StopPropagation}return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let u=this._argops,s=0,l=u.length,f;s<l;++s)if(f=u[s],!(f.name!==ao||f.op._argval.force!=="link")){for(var i=f.op._argops,r=0,a=i.length,o;r<a;++r)if(i[r].name==="links"&&(o=i[r].op.source)){n.pulse(o,n.changeset().reflow());break}}return e.reflow(t.modified()).modifies(g5)}});function ER(t,e){return()=>t.touch(e).run()}function CR(t,e){const n=wR(t),i=n.stop,r=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,r()),n.stop=()=>(a=!0,i()),m5(n,e,!0).on("end",()=>a=!0)}function m5(t,e,n,i){var r=G(e.forces),a,o,u,s;for(a=0,o=yd.length;a<o;++a)u=yd[a],u!==ao&&e.modified(u)&&t[u](e[u]);for(a=0,o=r.length;a<o;++a)s=ao+a,u=n||e.modified(ao,a)?SR(r[a]):i&&DR(r[a],i)?t.force(s):null,u&&t.force(s,u);for(o=t.numForces||0;a<o;++a)t.force(ao+a,null);return t.numForces=r.length,t}function DR(t,e){var n,i;for(n in t)if(Q(i=t[n])&&e.modified(Zt(i)))return 1;return 0}function SR(t){var e,n;V(x2,t.force)||R("Unrecognized force: "+t.force),e=x2[t.force]();for(n in t)Q(e[n])&&FR(e[n],t[n],t);return e}function FR(t,e,n){t(Q(e)?i=>e(i,n):e)}var $R=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",force:W1});function TR(t,e){return t.parent===e.parent?1:2}function RR(t){return t.reduce(NR,0)/t.length}function NR(t,e){return t+e.x}function OR(t){return 1+t.reduce(zR,0)}function zR(t,e){return Math.max(t,e.y)}function BR(t){for(var e;e=t.children;)t=e[0];return t}function LR(t){for(var e;e=t.children;)t=e[e.length-1];return t}function PR(){var t=TR,e=1,n=1,i=!1;function r(a){var o,u=0;a.eachAfter(function(h){var d=h.children;d?(h.x=RR(d),h.y=OR(d)):(h.x=o?u+=t(h,o):0,h.y=0,o=h)});var s=BR(a),l=LR(a),f=s.x-t(s,l)/2,c=l.x+t(l,s)/2;return a.eachAfter(i?function(h){h.x=(h.x-a.x)*e,h.y=(a.y-h.y)*n}:function(h){h.x=(h.x-f)/(c-f)*e,h.y=(1-(a.y?h.y/a.y:1))*n})}return r.separation=function(a){return arguments.length?(t=a,r):t},r.size=function(a){return arguments.length?(i=!1,e=+a[0],n=+a[1],r):i?null:[e,n]},r.nodeSize=function(a){return arguments.length?(i=!0,e=+a[0],n=+a[1],r):i?[e,n]:null},r}function IR(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else for(;--i>=0;)e+=n[i].value;t.value=e}function UR(){return this.eachAfter(IR)}function qR(t,e){let n=-1;for(const i of this)t.call(e,i,++n,this);return this}function jR(t,e){for(var n=this,i=[n],r,a,o=-1;n=i.pop();)if(t.call(e,n,++o,this),r=n.children)for(a=r.length-1;a>=0;--a)i.push(r[a]);return this}function YR(t,e){for(var n=this,i=[n],r=[],a,o,u,s=-1;n=i.pop();)if(r.push(n),a=n.children)for(o=0,u=a.length;o<u;++o)i.push(a[o]);for(;n=r.pop();)t.call(e,n,++s,this);return this}function HR(t,e){let n=-1;for(const i of this)if(t.call(e,i,++n,this))return i}function WR(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})}function GR(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function VR(t){for(var e=this,n=XR(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i}function XR(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}function KR(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function ZR(){return Array.from(this)}function JR(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function QR(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*tN(){var t=this,e,n=[t],i,r,a;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,i=t.children)for(r=0,a=i.length;r<a;++r)n.push(i[r]);while(n.length)}function G1(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=iN)):e===void 0&&(e=nN);for(var n=new ua(t),i,r=[n],a,o,u,s;i=r.pop();)if((o=e(i.data))&&(s=(o=Array.from(o)).length))for(i.children=o,u=s-1;u>=0;--u)r.push(a=o[u]=new ua(o[u])),a.parent=i,a.depth=i.depth+1;return n.eachBefore(p5)}function eN(){return G1(this).eachBefore(rN)}function nN(t){return t.children}function iN(t){return Array.isArray(t)?t[1]:null}function rN(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function p5(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function ua(t){this.data=t,this.depth=this.height=0,this.parent=null}ua.prototype=G1.prototype={constructor:ua,count:UR,each:qR,eachAfter:YR,eachBefore:jR,find:HR,sum:WR,sort:GR,path:VR,ancestors:KR,descendants:ZR,leaves:JR,links:QR,copy:eN,[Symbol.iterator]:tN};function aN(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function oN(t){for(var e=t.length,n,i;e;)i=Math.random()*e--|0,n=t[e],t[e]=t[i],t[i]=n;return t}function uN(t){for(var e=0,n=(t=oN(Array.from(t))).length,i=[],r,a;e<n;)r=t[e],a&&y5(a,r)?++e:(a=lN(i=sN(i,r)),e=0);return a}function sN(t,e){var n,i;if(Dc(e,t))return[e];for(n=0;n<t.length;++n)if(Ju(e,t[n])&&Dc(oo(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(i=n+1;i<t.length;++i)if(Ju(oo(t[n],t[i]),e)&&Ju(oo(t[n],e),t[i])&&Ju(oo(t[i],e),t[n])&&Dc(v5(t[n],t[i],e),t))return[t[n],t[i],e];throw new Error}function Ju(t,e){var n=t.r-e.r,i=e.x-t.x,r=e.y-t.y;return n<0||n*n<i*i+r*r}function y5(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function Dc(t,e){for(var n=0;n<e.length;++n)if(!y5(t,e[n]))return!1;return!0}function lN(t){switch(t.length){case 1:return fN(t[0]);case 2:return oo(t[0],t[1]);case 3:return v5(t[0],t[1],t[2])}}function fN(t){return{x:t.x,y:t.y,r:t.r}}function oo(t,e){var n=t.x,i=t.y,r=t.r,a=e.x,o=e.y,u=e.r,s=a-n,l=o-i,f=u-r,c=Math.sqrt(s*s+l*l);return{x:(n+a+s/c*f)/2,y:(i+o+l/c*f)/2,r:(c+r+u)/2}}function v5(t,e,n){var i=t.x,r=t.y,a=t.r,o=e.x,u=e.y,s=e.r,l=n.x,f=n.y,c=n.r,h=i-o,d=i-l,g=r-u,m=r-f,p=s-a,y=c-a,v=i*i+r*r-a*a,x=v-o*o-u*u+s*s,b=v-l*l-f*f+c*c,_=d*g-h*m,M=(g*b-m*x)/(_*2)-i,w=(m*p-g*y)/_,k=(d*x-h*b)/(_*2)-r,C=(h*y-d*p)/_,A=w*w+C*C-1,E=2*(a+M*w+k*C),F=M*M+k*k-a*a,$=-(A?(E+Math.sqrt(E*E-4*A*F))/(2*A):F/E);return{x:i+M+w*$,y:r+k+C*$,r:$}}function b2(t,e,n){var i=t.x-e.x,r,a,o=t.y-e.y,u,s,l=i*i+o*o;l?(a=e.r+n.r,a*=a,s=t.r+n.r,s*=s,a>s?(r=(l+s-a)/(2*l),u=Math.sqrt(Math.max(0,s/l-r*r)),n.x=t.x-r*i-u*o,n.y=t.y-r*o+u*i):(r=(l+a-s)/(2*l),u=Math.sqrt(Math.max(0,a/l-r*r)),n.x=e.x+r*i-u*o,n.y=e.y+r*o+u*i)):(n.x=e.x+n.r,n.y=e.y)}function w2(t,e){var n=t.r+e.r-1e-6,i=e.x-t.x,r=e.y-t.y;return n>0&&n*n>i*i+r*r}function _2(t){var e=t._,n=t.next._,i=e.r+n.r,r=(e.x*n.r+n.x*e.r)/i,a=(e.y*n.r+n.y*e.r)/i;return r*r+a*a}function Qu(t){this._=t,this.next=null,this.previous=null}function cN(t){if(!(r=(t=aN(t)).length))return 0;var e,n,i,r,a,o,u,s,l,f,c;if(e=t[0],e.x=0,e.y=0,!(r>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(r>2))return e.r+n.r;b2(n,e,i=t[2]),e=new Qu(e),n=new Qu(n),i=new Qu(i),e.next=i.previous=n,n.next=e.previous=i,i.next=n.previous=e;t:for(u=3;u<r;++u){b2(e._,n._,i=t[u]),i=new Qu(i),s=n.next,l=e.previous,f=n._.r,c=e._.r;do if(f<=c){if(w2(s._,i._)){n=s,e.next=n,n.previous=e,--u;continue t}f+=s._.r,s=s.next}else{if(w2(l._,i._)){e=l,e.next=n,n.previous=e,--u;continue t}c+=l._.r,l=l.previous}while(s!==l.next);for(i.previous=e,i.next=n,e.next=n.previous=n=i,a=_2(e);(i=i.next)!==n;)(o=_2(i))<a&&(e=i,a=o);n=e.next}for(e=[n._],i=n;(i=i.next)!==n;)e.push(i._);for(i=uN(e),u=0;u<r;++u)e=t[u],e.x-=i.x,e.y-=i.y;return i.r}function hN(t){return t==null?null:hl(t)}function hl(t){if(typeof t!="function")throw new Error;return t}function Wi(){return 0}function $r(t){return function(){return t}}function dN(t){return Math.sqrt(t.value)}function gN(){var t=null,e=1,n=1,i=Wi;function r(a){return a.x=e/2,a.y=n/2,t?a.eachBefore(M2(t)).eachAfter(Sc(i,.5)).eachBefore(k2(1)):a.eachBefore(M2(dN)).eachAfter(Sc(Wi,1)).eachAfter(Sc(i,a.r/Math.min(e,n))).eachBefore(k2(Math.min(e,n)/(2*a.r))),a}return r.radius=function(a){return arguments.length?(t=hN(a),r):t},r.size=function(a){return arguments.length?(e=+a[0],n=+a[1],r):[e,n]},r.padding=function(a){return arguments.length?(i=typeof a=="function"?a:$r(+a),r):i},r}function M2(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Sc(t,e){return function(n){if(i=n.children){var i,r,a=i.length,o=t(n)*e||0,u;if(o)for(r=0;r<a;++r)i[r].r+=o;if(u=cN(i),o)for(r=0;r<a;++r)i[r].r-=o;n.r=u+o}}}function k2(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function x5(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function _u(t,e,n,i,r){for(var a=t.children,o,u=-1,s=a.length,l=t.value&&(i-e)/t.value;++u<s;)o=a[u],o.y0=n,o.y1=r,o.x0=e,o.x1=e+=o.value*l}function mN(){var t=1,e=1,n=0,i=!1;function r(o){var u=o.height+1;return o.x0=o.y0=n,o.x1=t,o.y1=e/u,o.eachBefore(a(e,u)),i&&o.eachBefore(x5),o}function a(o,u){return function(s){s.children&&_u(s,s.x0,o*(s.depth+1)/u,s.x1,o*(s.depth+2)/u);var l=s.x0,f=s.y0,c=s.x1-n,h=s.y1-n;c<l&&(l=c=(l+c)/2),h<f&&(f=h=(f+h)/2),s.x0=l,s.y0=f,s.x1=c,s.y1=h}}return r.round=function(o){return arguments.length?(i=!!o,r):i},r.size=function(o){return arguments.length?(t=+o[0],e=+o[1],r):[t,e]},r.padding=function(o){return arguments.length?(n=+o,r):n},r}var pN={depth:-1},A2={};function yN(t){return t.id}function vN(t){return t.parentId}function E2(){var t=yN,e=vN;function n(i){var r=Array.from(i),a=r.length,o,u,s,l,f,c,h,d=new Map;for(u=0;u<a;++u)o=r[u],f=r[u]=new ua(o),(c=t(o,u,i))!=null&&(c+="")&&(h=f.id=c,d.set(h,d.has(h)?A2:f)),(c=e(o,u,i))!=null&&(c+="")&&(f.parent=c);for(u=0;u<a;++u)if(f=r[u],c=f.parent){if(l=d.get(c),!l)throw new Error("missing: "+c);if(l===A2)throw new Error("ambiguous: "+c);l.children?l.children.push(f):l.children=[f],f.parent=l}else{if(s)throw new Error("multiple roots");s=f}if(!s)throw new Error("no root");if(s.parent=pN,s.eachBefore(function(g){g.depth=g.parent.depth+1,--a}).eachBefore(p5),s.parent=null,a>0)throw new Error("cycle");return s}return n.id=function(i){return arguments.length?(t=hl(i),n):t},n.parentId=function(i){return arguments.length?(e=hl(i),n):e},n}function xN(t,e){return t.parent===e.parent?1:2}function Fc(t){var e=t.children;return e?e[0]:t.t}function $c(t){var e=t.children;return e?e[e.length-1]:t.t}function bN(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function wN(t){for(var e=0,n=0,i=t.children,r=i.length,a;--r>=0;)a=i[r],a.z+=e,a.m+=e,e+=a.s+(n+=a.c)}function _N(t,e,n){return t.a.parent===e.parent?t.a:n}function _s(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}_s.prototype=Object.create(ua.prototype);function MN(t){for(var e=new _s(t,0),n,i=[e],r,a,o,u;n=i.pop();)if(a=n._.children)for(n.children=new Array(u=a.length),o=u-1;o>=0;--o)i.push(r=n.children[o]=new _s(a[o],o)),r.parent=n;return(e.parent=new _s(null,0)).children=[e],e}function kN(){var t=xN,e=1,n=1,i=null;function r(l){var f=MN(l);if(f.eachAfter(a),f.parent.m=-f.z,f.eachBefore(o),i)l.eachBefore(s);else{var c=l,h=l,d=l;l.eachBefore(function(v){v.x<c.x&&(c=v),v.x>h.x&&(h=v),v.depth>d.depth&&(d=v)});var g=c===h?1:t(c,h)/2,m=g-c.x,p=e/(h.x+g+m),y=n/(d.depth||1);l.eachBefore(function(v){v.x=(v.x+m)*p,v.y=v.depth*y})}return l}function a(l){var f=l.children,c=l.parent.children,h=l.i?c[l.i-1]:null;if(f){wN(l);var d=(f[0].z+f[f.length-1].z)/2;h?(l.z=h.z+t(l._,h._),l.m=l.z-d):l.z=d}else h&&(l.z=h.z+t(l._,h._));l.parent.A=u(l,h,l.parent.A||c[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function u(l,f,c){if(f){for(var h=l,d=l,g=f,m=h.parent.children[0],p=h.m,y=d.m,v=g.m,x=m.m,b;g=$c(g),h=Fc(h),g&&h;)m=Fc(m),d=$c(d),d.a=l,b=g.z+v-h.z-p+t(g._,h._),b>0&&(bN(_N(g,l,c),l,b),p+=b,y+=b),v+=g.m,p+=h.m,x+=m.m,y+=d.m;g&&!$c(d)&&(d.t=g,d.m+=v-y),h&&!Fc(m)&&(m.t=h,m.m+=p-x,c=l)}return c}function s(l){l.x*=e,l.y=l.depth*n}return r.separation=function(l){return arguments.length?(t=l,r):t},r.size=function(l){return arguments.length?(i=!1,e=+l[0],n=+l[1],r):i?null:[e,n]},r.nodeSize=function(l){return arguments.length?(i=!0,e=+l[0],n=+l[1],r):i?[e,n]:null},r}function Df(t,e,n,i,r){for(var a=t.children,o,u=-1,s=a.length,l=t.value&&(r-n)/t.value;++u<s;)o=a[u],o.x0=e,o.x1=i,o.y0=n,o.y1=n+=o.value*l}var b5=(1+Math.sqrt(5))/2;function w5(t,e,n,i,r,a){for(var o=[],u=e.children,s,l,f=0,c=0,h=u.length,d,g,m=e.value,p,y,v,x,b,_,M;f<h;){d=r-n,g=a-i;do p=u[c++].value;while(!p&&c<h);for(y=v=p,_=Math.max(g/d,d/g)/(m*t),M=p*p*_,b=Math.max(v/M,M/y);c<h;++c){if(p+=l=u[c].value,l<y&&(y=l),l>v&&(v=l),M=p*p*_,x=Math.max(v/M,M/y),x>b){p-=l;break}b=x}o.push(s={value:p,dice:d<g,children:u.slice(f,c)}),s.dice?_u(s,n,i,r,m?i+=g*p/m:a):Df(s,n,i,m?n+=d*p/m:r,a),m-=p,f=c}return o}var _5=function t(e){function n(i,r,a,o,u){w5(e,i,r,a,o,u)}return n.ratio=function(i){return t((i=+i)>1?i:1)},n}(b5);function AN(){var t=_5,e=!1,n=1,i=1,r=[0],a=Wi,o=Wi,u=Wi,s=Wi,l=Wi;function f(h){return h.x0=h.y0=0,h.x1=n,h.y1=i,h.eachBefore(c),r=[0],e&&h.eachBefore(x5),h}function c(h){var d=r[h.depth],g=h.x0+d,m=h.y0+d,p=h.x1-d,y=h.y1-d;p<g&&(g=p=(g+p)/2),y<m&&(m=y=(m+y)/2),h.x0=g,h.y0=m,h.x1=p,h.y1=y,h.children&&(d=r[h.depth+1]=a(h)/2,g+=l(h)-d,m+=o(h)-d,p-=u(h)-d,y-=s(h)-d,p<g&&(g=p=(g+p)/2),y<m&&(m=y=(m+y)/2),t(h,g,m,p,y))}return f.round=function(h){return arguments.length?(e=!!h,f):e},f.size=function(h){return arguments.length?(n=+h[0],i=+h[1],f):[n,i]},f.tile=function(h){return arguments.length?(t=hl(h),f):t},f.padding=function(h){return arguments.length?f.paddingInner(h).paddingOuter(h):f.paddingInner()},f.paddingInner=function(h){return arguments.length?(a=typeof h=="function"?h:$r(+h),f):a},f.paddingOuter=function(h){return arguments.length?f.paddingTop(h).paddingRight(h).paddingBottom(h).paddingLeft(h):f.paddingTop()},f.paddingTop=function(h){return arguments.length?(o=typeof h=="function"?h:$r(+h),f):o},f.paddingRight=function(h){return arguments.length?(u=typeof h=="function"?h:$r(+h),f):u},f.paddingBottom=function(h){return arguments.length?(s=typeof h=="function"?h:$r(+h),f):s},f.paddingLeft=function(h){return arguments.length?(l=typeof h=="function"?h:$r(+h),f):l},f}function EN(t,e,n,i,r){var a=t.children,o,u=a.length,s,l=new Array(u+1);for(l[0]=s=o=0;o<u;++o)l[o+1]=s+=a[o].value;f(0,u,t.value,e,n,i,r);function f(c,h,d,g,m,p,y){if(c>=h-1){var v=a[c];v.x0=g,v.y0=m,v.x1=p,v.y1=y;return}for(var x=l[c],b=d/2+x,_=c+1,M=h-1;_<M;){var w=_+M>>>1;l[w]<b?_=w+1:M=w}b-l[_-1]<l[_]-b&&c+1<_&&--_;var k=l[_]-x,C=d-k;if(p-g>y-m){var A=d?(g*C+p*k)/d:p;f(c,_,k,g,m,A,y),f(_,h,C,A,m,p,y)}else{var E=d?(m*C+y*k)/d:y;f(c,_,k,g,m,p,E),f(_,h,C,g,E,p,y)}}}function CN(t,e,n,i,r){(t.depth&1?Df:_u)(t,e,n,i,r)}var DN=function t(e){function n(i,r,a,o,u){if((s=i._squarify)&&s.ratio===e)for(var s,l,f,c,h=-1,d,g=s.length,m=i.value;++h<g;){for(l=s[h],f=l.children,c=l.value=0,d=f.length;c<d;++c)l.value+=f[c].value;l.dice?_u(l,r,a,o,m?a+=(u-a)*l.value/m:u):Df(l,r,a,m?r+=(o-r)*l.value/m:o,u),m-=l.value}else i._squarify=s=w5(e,i,r,a,o,u),s.ratio=e}return n.ratio=function(i){return t((i=+i)>1?i:1)},n}(b5);function vd(t,e,n){const i={};return t.each(r=>{const a=r.data;n(a)&&(i[e(a)]=r)}),t.lookup=i,t}function V1(t){S.call(this,null,t)}V1.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const SN=t=>t.values;z(V1,S,{transform(t,e){e.source||R("Nest transform requires an upstream data source.");var n=t.generate,i=t.modified(),r=e.clone(),a=this.value;return(!a||i||e.changed())&&(a&&a.each(o=>{o.children&&Yl(o.data)&&r.rem.push(o.data)}),this.value=a=G1({values:G(t.keys).reduce((o,u)=>(o.key(u),o),FN()).entries(r.source)},SN),n&&a.each(o=>{o.children&&(o=ft(o.data),r.add.push(o),r.source.push(o))}),vd(a,j,j)),r.source.root=a,r}});function FN(){const t=[],e={entries:r=>i(n(r,0),0),key:r=>(t.push(r),e)};function n(r,a){if(a>=t.length)return r;const o=r.length,u=t[a++],s={},l={};let f=-1,c,h,d;for(;++f<o;)c=u(h=r[f])+"",(d=s[c])?d.push(h):s[c]=[h];for(c in s)l[c]=n(s[c],a);return l}function i(r,a){if(++a>t.length)return r;const o=[];for(const u in r)o.push({key:u,values:i(r[u],a)});return o}return e}function Qn(t){S.call(this,null,t)}const $N=(t,e)=>t.parent===e.parent?1:2;z(Qn,S,{transform(t,e){(!e.source||!e.source.root)&&R(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),i=this.fields,r=e.source.root,a=t.as||i;t.field?r.sum(t.field):r.count(),t.sort&&r.sort(fr(t.sort,o=>o.data)),TN(n,this.params,t),n.separation&&n.separation(t.separation!==!1?$N:fa);try{this.value=n(r)}catch(o){R(o)}return r.each(o=>RN(o,i,a)),e.reflow(t.modified()).modifies(a).modifies("leaf")}});function TN(t,e,n){for(let i,r=0,a=e.length;r<a;++r)i=e[r],i in n&&t[i](n[i])}function RN(t,e,n){const i=t.data,r=e.length-1;for(let a=0;a<r;++a)i[n[a]]=t[e[a]];i[n[r]]=t.children?t.children.length:0}const xd=["x","y","r","depth","children"];function X1(t){Qn.call(this,t)}X1.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:xd.length,default:xd}]};z(X1,Qn,{layout:gN,params:["radius","size","padding"],fields:xd});const bd=["x0","y0","x1","y1","depth","children"];function K1(t){Qn.call(this,t)}K1.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:bd.length,default:bd}]};z(K1,Qn,{layout:mN,params:["size","round","padding"],fields:bd});function Z1(t){S.call(this,null,t)}Z1.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};z(Z1,S,{transform(t,e){e.source||R("Stratify transform requires an upstream data source.");let n=this.value;const i=t.modified(),r=e.fork(e.ALL).materialize(e.SOURCE),a=!n||i||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return r.source=r.source.slice(),a&&(n=r.source.length?vd(E2().id(t.key).parentId(t.parentKey)(r.source),t.key,Xe):vd(E2()([{}]),t.key,t.key)),r.source.root=this.value=n,r}});const C2={tidy:kN,cluster:PR},wd=["x","y","depth","children"];function J1(t){Qn.call(this,t)}J1.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:wd.length,default:wd}]};z(J1,Qn,{layout(t){const e=t||"tidy";if(V(C2,e))return C2[e]();R("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:wd});function Q1(t){S.call(this,[],t)}Q1.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};z(Q1,S,{transform(t,e){const n=this.value,i=e.source&&e.source.root,r=e.fork(e.NO_SOURCE),a={};return i||R("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(r.rem=n,e.visit(e.SOURCE,o=>a[j(o)]=1),i.each(o=>{const u=o.data,s=o.parent&&o.parent.data;s&&a[j(u)]&&a[j(s)]&&r.add.push(ft({source:s,target:u}))}),this.value=r.add):e.changed(e.MOD)&&(e.visit(e.MOD,o=>a[j(o)]=1),n.forEach(o=>{(a[j(o.source)]||a[j(o.target)])&&r.mod.push(o)})),r}});const D2={binary:EN,dice:_u,slice:Df,slicedice:CN,squarify:_5,resquarify:DN},_d=["x0","y0","x1","y1","depth","children"];function tm(t){Qn.call(this,t)}tm.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:_d.length,default:_d}]};z(tm,Qn,{layout(){const t=AN();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{V(D2,e)?t.tile(D2[e]):R("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:_d});var NN=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",nest:V1,pack:X1,partition:K1,stratify:Z1,tree:J1,treelinks:Q1,treemap:tm});const ON=4278190080,zN=268435456,BN=.0625;function LN(t,e){const n=t.bitmap();return(e||[]).forEach(i=>n.set(t(i.boundary[0]),t(i.boundary[3]))),[n,void 0]}function PN(t,e,n,i){const r=t.width,a=t.height,o=n||i,u=ma(r,a).getContext("2d");e.forEach(p=>M5(u,p,o));const s=new Uint32Array(u.getImageData(0,0,r,a).data.buffer),l=t.bitmap(),f=o&&t.bitmap();let c,h,d,g,m;for(h=0;h<a;++h)for(c=0;c<r;++c)m=s[h*r+c]&ON,m&&(d=t(c),g=t(h),i||l.set(d,g),o&&m^zN&&f.set(d,g));return[l,f]}function M5(t,e,n){if(!e.length)return;const i=e[0].mark.marktype;i==="group"?e.forEach(r=>{r.items.forEach(a=>M5(t,a.items,n))}):Le[i].draw(t,{items:n?e.map(IN):e})}function IN(t){const e=Hl(t,{});return e.stroke&&(e.strokeOpacity=1),e.fill&&(e.fillOpacity=BN,e.stroke="#000",e.strokeOpacity=1,e.strokeWidth=2),e}const In=5,ae=31,Ho=32,ui=new Uint32Array(Ho+1),rn=new Uint32Array(Ho+1);rn[0]=0;ui[0]=~rn[0];for(let t=1;t<=Ho;++t)rn[t]=rn[t-1]<<1|1,ui[t]=~rn[t];function UN(t,e){const n=new Uint32Array(~~((t*e+Ho)/Ho));function i(a,o){n[a]|=o}function r(a,o){n[a]&=o}return{array:n,get:(a,o)=>{const u=o*t+a;return n[u>>>In]&1<<(u&ae)},set:(a,o)=>{const u=o*t+a;i(u>>>In,1<<(u&ae))},clear:(a,o)=>{const u=o*t+a;r(u>>>In,~(1<<(u&ae)))},getRange:(a,o,u,s)=>{let l=s,f,c,h,d;for(;l>=o;--l)if(f=l*t+a,c=l*t+u,h=f>>>In,d=c>>>In,h===d){if(n[h]&ui[f&ae]&rn[(c&ae)+1])return!0}else{if(n[h]&ui[f&ae]||n[d]&rn[(c&ae)+1])return!0;for(let g=h+1;g<d;++g)if(n[g])return!0}return!1},setRange:(a,o,u,s)=>{let l,f,c,h,d;for(;o<=s;++o)if(l=o*t+a,f=o*t+u,c=l>>>In,h=f>>>In,c===h)i(c,ui[l&ae]&rn[(f&ae)+1]);else for(i(c,ui[l&ae]),i(h,rn[(f&ae)+1]),d=c+1;d<h;++d)i(d,4294967295)},clearRange:(a,o,u,s)=>{let l,f,c,h,d;for(;o<=s;++o)if(l=o*t+a,f=o*t+u,c=l>>>In,h=f>>>In,c===h)r(c,rn[l&ae]|ui[(f&ae)+1]);else for(r(c,rn[l&ae]),r(h,ui[(f&ae)+1]),d=c+1;d<h;++d)r(d,0)},outOfBounds:(a,o,u,s)=>a<0||o<0||s>=e||u>=t}}function qN(t,e,n){const i=Math.max(1,Math.sqrt(t*e/1e6)),r=~~((t+2*n+i)/i),a=~~((e+2*n+i)/i),o=u=>~~((u+n)/i);return o.invert=u=>u*i-n,o.bitmap=()=>UN(r,a),o.ratio=i,o.padding=n,o.width=t,o.height=e,o}function jN(t,e,n,i){const r=t.width,a=t.height;return function(o){const u=o.datum.datum.items[i].items,s=u.length,l=o.datum.fontSize,f=En.width(o.datum,o.datum.text);let c=0,h,d,g,m,p,y,v;for(let x=0;x<s;++x)h=u[x].x,g=u[x].y,d=u[x].x2===void 0?h:u[x].x2,m=u[x].y2===void 0?g:u[x].y2,p=(h+d)/2,y=(g+m)/2,v=Math.abs(d-h+m-g),v>=c&&(c=v,o.x=p,o.y=y);return p=f/2,y=l/2,h=o.x-p,d=o.x+p,g=o.y-y,m=o.y+y,o.align="center",h<0&&d<=r?o.align="left":0<=h&&r<d&&(o.align="right"),o.baseline="middle",g<0&&m<=a?o.baseline="top":0<=g&&a<m&&(o.baseline="bottom"),!0}}function dl(t,e,n,i,r,a){let o=n/2;return t-o<0||t+o>r||e-(o=i/2)<0||e+o>a}function vi(t,e,n,i,r,a,o,u){const s=r*a/(i*2),l=t(e-s),f=t(e+s),c=t(n-(a=a/2)),h=t(n+a);return o.outOfBounds(l,c,f,h)||o.getRange(l,c,f,h)||u&&u.getRange(l,c,f,h)}function YN(t,e,n,i){const r=t.width,a=t.height,o=e[0],u=e[1];function s(l,f,c,h,d){const g=t.invert(l),m=t.invert(f);let p=c,y=a,v;if(!dl(g,m,h,d,r,a)&&!vi(t,g,m,d,h,p,o,u)&&!vi(t,g,m,d,h,d,o,null)){for(;y-p>=1;)v=(p+y)/2,vi(t,g,m,d,h,v,o,u)?y=v:p=v;if(p>c)return[g,m,p,!0]}}return function(l){const f=l.datum.datum.items[i].items,c=f.length,h=l.datum.fontSize,d=En.width(l.datum,l.datum.text);let g=n?h:0,m=!1,p=!1,y=0,v,x,b,_,M,w,k,C,A,E,F,$,O,D,N,L,U;for(let W=0;W<c;++W){for(v=f[W].x,b=f[W].y,x=f[W].x2===void 0?v:f[W].x2,_=f[W].y2===void 0?b:f[W].y2,v>x&&(U=v,v=x,x=U),b>_&&(U=b,b=_,_=U),A=t(v),F=t(x),E=~~((A+F)/2),$=t(b),D=t(_),O=~~(($+D)/2),k=E;k>=A;--k)for(C=O;C>=$;--C)L=s(k,C,g,d,h),L&&([l.x,l.y,g,m]=L);for(k=E;k<=F;++k)for(C=O;C<=D;++C)L=s(k,C,g,d,h),L&&([l.x,l.y,g,m]=L);!m&&!n&&(N=Math.abs(x-v+_-b),M=(v+x)/2,w=(b+_)/2,N>=y&&!dl(M,w,d,h,r,a)&&!vi(t,M,w,h,d,h,o,null)&&(y=N,l.x=M,l.y=w,p=!0))}return m||p?(M=d/2,w=h/2,o.setRange(t(l.x-M),t(l.y-w),t(l.x+M),t(l.y+w)),l.align="center",l.baseline="middle",!0):!1}}const HN=[-1,-1,1,1],WN=[-1,1,-1,1];function GN(t,e,n,i){const r=t.width,a=t.height,o=e[0],u=e[1],s=t.bitmap();return function(l){const f=l.datum.datum.items[i].items,c=f.length,h=l.datum.fontSize,d=En.width(l.datum,l.datum.text),g=[];let m=n?h:0,p=!1,y=!1,v=0,x,b,_,M,w,k,C,A,E,F,$,O;for(let D=0;D<c;++D){for(x=f[D].x,_=f[D].y,b=f[D].x2===void 0?x:f[D].x2,M=f[D].y2===void 0?_:f[D].y2,g.push([t((x+b)/2),t((_+M)/2)]);g.length;)if([C,A]=g.pop(),!(o.get(C,A)||u.get(C,A)||s.get(C,A))){s.set(C,A);for(let N=0;N<4;++N)w=C+HN[N],k=A+WN[N],s.outOfBounds(w,k,w,k)||g.push([w,k]);if(w=t.invert(C),k=t.invert(A),E=m,F=a,!dl(w,k,d,h,r,a)&&!vi(t,w,k,h,d,E,o,u)&&!vi(t,w,k,h,d,h,o,null)){for(;F-E>=1;)$=(E+F)/2,vi(t,w,k,h,d,$,o,u)?F=$:E=$;E>m&&(l.x=w,l.y=k,m=E,p=!0)}}!p&&!n&&(O=Math.abs(b-x+M-_),w=(x+b)/2,k=(_+M)/2,O>=v&&!dl(w,k,d,h,r,a)&&!vi(t,w,k,h,d,h,o,null)&&(v=O,l.x=w,l.y=k,y=!0))}return p||y?(w=d/2,k=h/2,o.setRange(t(l.x-w),t(l.y-k),t(l.x+w),t(l.y+k)),l.align="center",l.baseline="middle",!0):!1}}const VN=["right","center","left"],XN=["bottom","middle","top"];function KN(t,e,n,i){const r=t.width,a=t.height,o=e[0],u=e[1],s=i.length;return function(l){const f=l.boundary,c=l.datum.fontSize;if(f[2]<0||f[5]<0||f[0]>r||f[3]>a)return!1;let h=0,d,g,m,p,y,v,x,b,_,M,w,k,C,A,E;for(let F=0;F<s;++F){if(d=(n[F]&3)-1,g=(n[F]>>>2&3)-1,m=d===0&&g===0||i[F]<0,p=d&&g?Math.SQRT1_2:1,y=i[F]<0?-1:1,v=f[1+d]+i[F]*d*p,w=f[4+g]+y*c*g/2+i[F]*g*p,b=w-c/2,_=w+c/2,k=t(v),A=t(b),E=t(_),!h)if(S2(k,k,A,E,o,u,v,v,b,_,f,m))h=En.width(l.datum,l.datum.text);else continue;if(M=v+y*h*d/2,v=M-h/2,x=M+h/2,k=t(v),C=t(x),S2(k,C,A,E,o,u,v,x,b,_,f,m))return l.x=d?d*y<0?x:v:M,l.y=g?g*y<0?_:b:w,l.align=VN[d*y+1],l.baseline=XN[g*y+1],o.setRange(k,A,C,E),!0}return!1}}function S2(t,e,n,i,r,a,o,u,s,l,f,c){return!(r.outOfBounds(t,n,e,i)||(c&&a?a.getRange(t,n,e,i)||!ZN(o,s,u,l,f):r.getRange(t,n,e,i)))}function ZN(t,e,n,i,r){return r[0]<=t&&n<=r[2]&&r[3]<=e&&i<=r[5]}const Tc=0,Rc=4,Nc=8,Oc=0,zc=1,Bc=2,JN={"top-left":Tc+Oc,top:Tc+zc,"top-right":Tc+Bc,left:Rc+Oc,middle:Rc+zc,right:Rc+Bc,"bottom-left":Nc+Oc,bottom:Nc+zc,"bottom-right":Nc+Bc},QN={naive:jN,"reduced-search":YN,floodfill:GN};function tO(t,e,n,i,r,a,o,u,s,l,f){if(!t.length)return t;const c=Math.max(i.length,r.length),h=eO(i,c),d=nO(r,c),g=iO(t[0].datum),m=g==="group"&&t[0].datum.items[s].marktype,p=m==="area",y=rO(g,m,u,s),v=qN(e[0],e[1],l),x=p&&f==="naive",b=t.map(w=>({datum:w,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(w)}));let _;if(!x){n&&b.sort((k,C)=>n(k.datum,C.datum));let w=!1;for(let k=0;k<d.length&&!w;++k)w=d[k]===5||h[k]<0;g&&(o||p)&&(a=[t.map(k=>k.datum)].concat(a)),_=a.length?PN(v,a,w,p):LN(v,o&&b)}const M=p?QN[f](v,_,o,s):KN(v,_,d,h);return b.forEach(w=>w.opacity=+M(w)),b}function eO(t,e){const n=new Float64Array(e),i=t.length;for(let r=0;r<i;++r)n[r]=t[r]||0;for(let r=i;r<e;++r)n[r]=n[i-1];return n}function nO(t,e){const n=new Int8Array(e),i=t.length;for(let r=0;r<i;++r)n[r]|=JN[t[r]];for(let r=i;r<e;++r)n[r]=n[i-1];return n}function iO(t){return t&&t.mark&&t.mark.marktype}function rO(t,e,n,i){const r=a=>[a.x,a.x,a.x,a.y,a.y,a.y];return t?t==="line"||t==="area"?a=>r(a.datum):e==="line"?a=>{const o=a.datum.items[i].items;return r(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:a=>{const o=a.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:r}const Md=["x","y","opacity","align","baseline"],k5=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function em(t){S.call(this,null,t)}em.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:k5},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:Md.length,default:Md}]};z(em,S,{transform(t,e){function n(a){const o=t[a];return Q(o)&&e.modified(o.fields)}const i=t.modified();if(!(i||e.changed(e.ADD_REM)||n("sort")))return;(!t.size||t.size.length!==2)&&R("Size parameter should be specified as a [width, height] array.");const r=t.as||Md;return tO(e.materialize(e.SOURCE).source,t.size,t.sort,G(t.offset||1),G(t.anchor||k5),t.avoidMarks||[],t.avoidBaseMark!==!1,t.lineAnchor||"end",t.markIndex||0,t.padding||0,t.method||"naive").forEach(a=>{const o=a.datum;o[r[0]]=a.x,o[r[1]]=a.y,o[r[2]]=a.opacity,o[r[3]]=a.align,o[r[4]]=a.baseline}),e.reflow(i).modifies(r)}});var aO=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",label:em});function A5(t,e){var n=[],i=function(f){return f(u)},r,a,o,u,s,l;if(e==null)n.push(t);else for(r={},a=0,o=t.length;a<o;++a)u=t[a],s=e.map(i),l=r[s],l||(r[s]=l=[],l.dims=s,n.push(l)),l.push(u);return n}function nm(t){S.call(this,null,t)}nm.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};z(nm,S,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=e.materialize(e.SOURCE).source,r=A5(i,t.groupby),a=(t.groupby||[]).map(kt),o=a.length,u=t.as||[kt(t.x),kt(t.y)],s=[];r.forEach(l=>{Yb(l,t.x,t.y,t.bandwidth||.3).forEach(f=>{const c={};for(let h=0;h<o;++h)c[a[h]]=l.dims[h];c[u[0]]=f[0],c[u[1]]=f[1],s.push(ft(c))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const kd={linear:z0,log:Ib,exp:Ub,pow:qb,quad:B0,poly:jb},oO=(t,e)=>t==="poly"?e:t==="quad"?2:1;function im(t){S.call(this,null,t)}im.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(kd)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};z(im,S,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const i=e.materialize(e.SOURCE).source,r=A5(i,t.groupby),a=(t.groupby||[]).map(kt),o=t.method||"linear",u=t.order||3,s=oO(o,u),l=t.as||[kt(t.x),kt(t.y)],f=kd[o],c=[];let h=t.extent;V(kd,o)||R("Invalid regression method: "+o),h!=null&&o==="log"&&h[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),r.forEach(d=>{if(d.length<=s){e.dataflow.warn("Skipping regression with more parameters than data points.");return}const m=f(d,t.x,t.y,u);if(t.params){c.push(ft({keys:d.dims,coef:m.coef,rSquared:m.rSquared}));return}const p=h||Fn(d,t.x),y=v=>{const x={};for(let b=0;b<a.length;++b)x[a[b]]=d.dims[b];x[l[0]]=v[0],x[l[1]]=v[1],c.push(ft(x))};o==="linear"?p.forEach(v=>y([v,m.predict(v)])):Jl(m.predict,p,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});var uO=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",loess:nm,regression:im});const F2=Math.pow(2,-52),ts=new Uint32Array(512);class gl{static from(e,n=hO,i=dO){const r=e.length,a=new Float64Array(r*2);for(let o=0;o<r;o++){const u=e[o];a[2*o]=n(u),a[2*o+1]=i(u)}return new gl(a)}constructor(e){const n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:e,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:a}=this,o=e.length>>1;let u=1/0,s=1/0,l=-1/0,f=-1/0;for(let A=0;A<o;A++){const E=e[2*A],F=e[2*A+1];E<u&&(u=E),F<s&&(s=F),E>l&&(l=E),F>f&&(f=F),this._ids[A]=A}const c=(u+l)/2,h=(s+f)/2;let d=1/0,g,m,p;for(let A=0;A<o;A++){const E=Lc(c,h,e[2*A],e[2*A+1]);E<d&&(g=A,d=E)}const y=e[2*g],v=e[2*g+1];d=1/0;for(let A=0;A<o;A++){if(A===g)continue;const E=Lc(y,v,e[2*A],e[2*A+1]);E<d&&E>0&&(m=A,d=E)}let x=e[2*m],b=e[2*m+1],_=1/0;for(let A=0;A<o;A++){if(A===g||A===m)continue;const E=fO(y,v,x,b,e[2*A],e[2*A+1]);E<_&&(p=A,_=E)}let M=e[2*p],w=e[2*p+1];if(_===1/0){for(let F=0;F<o;F++)this._dists[F]=e[2*F]-e[0]||e[2*F+1]-e[1];Pr(this._ids,this._dists,0,o-1);const A=new Uint32Array(o);let E=0;for(let F=0,$=-1/0;F<o;F++){const O=this._ids[F];this._dists[O]>$&&(A[E++]=O,$=this._dists[O])}this.hull=A.subarray(0,E),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(es(y,v,x,b,M,w)){const A=m,E=x,F=b;m=p,x=M,b=w,p=A,M=E,w=F}const k=cO(y,v,x,b,M,w);this._cx=k.x,this._cy=k.y;for(let A=0;A<o;A++)this._dists[A]=Lc(e[2*A],e[2*A+1],k.x,k.y);Pr(this._ids,this._dists,0,o-1),this._hullStart=g;let C=3;i[g]=n[p]=m,i[m]=n[g]=p,i[p]=n[m]=g,r[g]=0,r[m]=1,r[p]=2,a.fill(-1),a[this._hashKey(y,v)]=g,a[this._hashKey(x,b)]=m,a[this._hashKey(M,w)]=p,this.trianglesLen=0,this._addTriangle(g,m,p,-1,-1,-1);for(let A=0,E,F;A<this._ids.length;A++){const $=this._ids[A],O=e[2*$],D=e[2*$+1];if(A>0&&Math.abs(O-E)<=F2&&Math.abs(D-F)<=F2||(E=O,F=D,$===g||$===m||$===p))continue;let N=0;for(let At=0,ie=this._hashKey(O,D);At<this._hashSize&&(N=a[(ie+At)%this._hashSize],!(N!==-1&&N!==i[N]));At++);N=n[N];let L=N,U;for(;U=i[L],!es(O,D,e[2*L],e[2*L+1],e[2*U],e[2*U+1]);)if(L=U,L===N){L=-1;break}if(L===-1)continue;let W=this._addTriangle(L,$,i[L],-1,-1,r[L]);r[$]=this._legalize(W+2),r[L]=W,C++;let lt=i[L];for(;U=i[lt],es(O,D,e[2*lt],e[2*lt+1],e[2*U],e[2*U+1]);)W=this._addTriangle(lt,$,U,r[$],-1,r[lt]),r[$]=this._legalize(W+2),i[lt]=lt,C--,lt=U;if(L===N)for(;U=n[L],es(O,D,e[2*U],e[2*U+1],e[2*L],e[2*L+1]);)W=this._addTriangle(U,$,L,-1,r[L],r[U]),this._legalize(W+2),r[U]=W,i[L]=L,C--,L=U;this._hullStart=n[$]=L,i[L]=n[lt]=$,i[$]=lt,a[this._hashKey(O,D)]=$,a[this._hashKey(e[2*L],e[2*L+1])]=L}this.hull=new Uint32Array(C);for(let A=0,E=this._hullStart;A<C;A++)this.hull[A]=E,E=i[E];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor(sO(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:n,_halfedges:i,coords:r}=this;let a=0,o=0;for(;;){const u=i[e],s=e-e%3;if(o=s+(e+2)%3,u===-1){if(a===0)break;e=ts[--a];continue}const l=u-u%3,f=s+(e+1)%3,c=l+(u+2)%3,h=n[o],d=n[e],g=n[f],m=n[c];if(lO(r[2*h],r[2*h+1],r[2*d],r[2*d+1],r[2*g],r[2*g+1],r[2*m],r[2*m+1])){n[e]=m,n[u]=h;const y=i[c];if(y===-1){let x=this._hullStart;do{if(this._hullTri[x]===c){this._hullTri[x]=e;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(e,y),this._link(u,i[o]),this._link(o,c);const v=l+(u+1)%3;a<ts.length&&(ts[a++]=v)}else{if(a===0)break;e=ts[--a]}}return o}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,i,r,a,o){const u=this.trianglesLen;return this._triangles[u]=e,this._triangles[u+1]=n,this._triangles[u+2]=i,this._link(u,r),this._link(u+1,a),this._link(u+2,o),this.trianglesLen+=3,u}}function sO(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}function Lc(t,e,n,i){const r=t-n,a=e-i;return r*r+a*a}function Pc(t,e,n,i,r,a){const o=(i-e)*(r-t),u=(n-t)*(a-e);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function es(t,e,n,i,r,a){return(Pc(r,a,t,e,n,i)||Pc(t,e,n,i,r,a)||Pc(n,i,r,a,t,e))<0}function lO(t,e,n,i,r,a,o,u){const s=t-o,l=e-u,f=n-o,c=i-u,h=r-o,d=a-u,g=s*s+l*l,m=f*f+c*c,p=h*h+d*d;return s*(c*p-m*d)-l*(f*p-m*h)+g*(f*d-c*h)<0}function fO(t,e,n,i,r,a){const o=n-t,u=i-e,s=r-t,l=a-e,f=o*o+u*u,c=s*s+l*l,h=.5/(o*l-u*s),d=(l*f-u*c)*h,g=(o*c-s*f)*h;return d*d+g*g}function cO(t,e,n,i,r,a){const o=n-t,u=i-e,s=r-t,l=a-e,f=o*o+u*u,c=s*s+l*l,h=.5/(o*l-u*s),d=t+(l*f-u*c)*h,g=e+(o*c-s*f)*h;return{x:d,y:g}}function Pr(t,e,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const a=t[r],o=e[a];let u=r-1;for(;u>=n&&e[t[u]]>o;)t[u+1]=t[u--];t[u+1]=a}else{const r=n+i>>1;let a=n+1,o=i;Pa(t,r,a),e[t[n]]>e[t[i]]&&Pa(t,n,i),e[t[a]]>e[t[i]]&&Pa(t,a,i),e[t[n]]>e[t[a]]&&Pa(t,n,a);const u=t[a],s=e[u];for(;;){do a++;while(e[t[a]]<s);do o--;while(e[t[o]]>s);if(o<a)break;Pa(t,a,o)}t[n+1]=t[o],t[o]=u,i-a+1>=o-n?(Pr(t,e,a,i),Pr(t,e,n,o-1)):(Pr(t,e,n,o-1),Pr(t,e,a,i))}}function Pa(t,e,n){const i=t[e];t[e]=t[n],t[n]=i}function hO(t){return t[0]}function dO(t){return t[1]}const $2=1e-6;class Xi{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,n){this._+=`L${this._x1=+e},${this._y1=+n}`}arc(e,n,i){e=+e,n=+n,i=+i;const r=e+i,a=n;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${r},${a}`:(Math.abs(this._x1-r)>$2||Math.abs(this._y1-a)>$2)&&(this._+="L"+r+","+a),!!i&&(this._+=`A${i},${i},0,1,1,${e-i},${n}A${i},${i},0,1,1,${this._x1=r},${this._y1=a}`)}rect(e,n,i,r){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${+i}v${+r}h${-i}Z`}value(){return this._||null}}class Ad{constructor(){this._=[]}moveTo(e,n){this._.push([e,n])}closePath(){this._.push(this._[0].slice())}lineTo(e,n){this._.push([e,n])}value(){return this._.length?this._:null}}class gO{constructor(e,[n,i,r,a]=[0,0,960,500]){if(!((r=+r)>=(n=+n))||!((a=+a)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=r,this.xmin=n,this.ymax=a,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:n,triangles:i},vectors:r}=this,a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let d=0,g=0,m=i.length,p,y;d<m;d+=3,g+=2){const v=i[d]*2,x=i[d+1]*2,b=i[d+2]*2,_=e[v],M=e[v+1],w=e[x],k=e[x+1],C=e[b],A=e[b+1],E=w-_,F=k-M,$=C-_,O=A-M,D=E*E+F*F,N=$*$+O*O,L=(E*O-F*$)*2;if(!L)p=(_+C)/2-1e8*O,y=(M+A)/2+1e8*$;else if(Math.abs(L)<1e-8)p=(_+C)/2,y=(M+A)/2;else{const U=1/L;p=_+(O*D-F*N)*U,y=M+(E*N-$*D)*U}a[g]=p,a[g+1]=y}let o=n[n.length-1],u,s=o*4,l,f=e[2*o],c,h=e[2*o+1];r.fill(0);for(let d=0;d<n.length;++d)o=n[d],u=s,l=f,c=h,s=o*4,f=e[2*o],h=e[2*o+1],r[u+2]=r[s]=c-h,r[u+3]=r[s+1]=f-l}render(e){const n=e==null?e=new Xi:void 0,{delaunay:{halfedges:i,inedges:r,hull:a},circumcenters:o,vectors:u}=this;if(a.length<=1)return null;for(let f=0,c=i.length;f<c;++f){const h=i[f];if(h<f)continue;const d=Math.floor(f/3)*2,g=Math.floor(h/3)*2,m=o[d],p=o[d+1],y=o[g],v=o[g+1];this._renderSegment(m,p,y,v,e)}let s,l=a[a.length-1];for(let f=0;f<a.length;++f){s=l,l=a[f];const c=Math.floor(r[l]/3)*2,h=o[c],d=o[c+1],g=s*4,m=this._project(h,d,u[g+2],u[g+3]);m&&this._renderSegment(h,d,m[0],m[1],e)}return n&&n.value()}renderBounds(e){const n=e==null?e=new Xi:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(e,n){const i=n==null?n=new Xi:void 0,r=this._clip(e);if(r===null||!r.length)return;n.moveTo(r[0],r[1]);let a=r.length;for(;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(let o=2;o<a;o+=2)(r[o]!==r[o-2]||r[o+1]!==r[o-1])&&n.lineTo(r[o],r[o+1]);return n.closePath(),i&&i.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let n=0,i=e.length/2;n<i;++n){const r=this.cellPolygon(n);r&&(r.index=n,yield r)}}cellPolygon(e){const n=new Ad;return this.renderCell(e,n),n.value()}_renderSegment(e,n,i,r,a){let o;const u=this._regioncode(e,n),s=this._regioncode(i,r);u===0&&s===0?(a.moveTo(e,n),a.lineTo(i,r)):(o=this._clipSegment(e,n,i,r,u,s))&&(a.moveTo(o[0],o[1]),a.lineTo(o[2],o[3]))}contains(e,n,i){return n=+n,n!==n||(i=+i,i!==i)?!1:this.delaunay._step(e,n,i)===e}*neighbors(e){const n=this._clip(e);if(n)for(const i of this.delaunay.neighbors(e)){const r=this._clip(i);if(r)t:for(let a=0,o=n.length;a<o;a+=2)for(let u=0,s=r.length;u<s;u+=2)if(n[a]==r[u]&&n[a+1]==r[u+1]&&n[(a+2)%o]==r[(u+s-2)%s]&&n[(a+3)%o]==r[(u+s-1)%s]){yield i;break t}}}_cell(e){const{circumcenters:n,delaunay:{inedges:i,halfedges:r,triangles:a}}=this,o=i[e];if(o===-1)return null;const u=[];let s=o;do{const l=Math.floor(s/3);if(u.push(n[l*2],n[l*2+1]),s=s%3===2?s-2:s+1,a[s]!==e)break;s=r[s]}while(s!==o&&s!==-1);return u}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(e);if(n===null)return null;const{vectors:i}=this,r=e*4;return i[r]||i[r+1]?this._clipInfinite(e,n,i[r],i[r+1],i[r+2],i[r+3]):this._clipFinite(e,n)}_clipFinite(e,n){const i=n.length;let r=null,a,o,u=n[i-2],s=n[i-1],l,f=this._regioncode(u,s),c,h;for(let d=0;d<i;d+=2)if(a=u,o=s,u=n[d],s=n[d+1],l=f,f=this._regioncode(u,s),l===0&&f===0)c=h,h=0,r?r.push(u,s):r=[u,s];else{let g,m,p,y,v;if(l===0){if((g=this._clipSegment(a,o,u,s,l,f))===null)continue;[m,p,y,v]=g}else{if((g=this._clipSegment(u,s,a,o,f,l))===null)continue;[y,v,m,p]=g,c=h,h=this._edgecode(m,p),c&&h&&this._edge(e,c,h,r,r.length),r?r.push(m,p):r=[m,p]}c=h,h=this._edgecode(y,v),c&&h&&this._edge(e,c,h,r,r.length),r?r.push(y,v):r=[y,v]}if(r)c=h,h=this._edgecode(r[0],r[1]),c&&h&&this._edge(e,c,h,r,r.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return r}_clipSegment(e,n,i,r,a,o){for(;;){if(a===0&&o===0)return[e,n,i,r];if(a&o)return null;let u,s,l=a||o;l&8?(u=e+(i-e)*(this.ymax-n)/(r-n),s=this.ymax):l&4?(u=e+(i-e)*(this.ymin-n)/(r-n),s=this.ymin):l&2?(s=n+(r-n)*(this.xmax-e)/(i-e),u=this.xmax):(s=n+(r-n)*(this.xmin-e)/(i-e),u=this.xmin),a?(e=u,n=s,a=this._regioncode(e,n)):(i=u,r=s,o=this._regioncode(i,r))}}_clipInfinite(e,n,i,r,a,o){let u=Array.from(n),s;if((s=this._project(u[0],u[1],i,r))&&u.unshift(s[0],s[1]),(s=this._project(u[u.length-2],u[u.length-1],a,o))&&u.push(s[0],s[1]),u=this._clipFinite(e,u))for(let l=0,f=u.length,c,h=this._edgecode(u[f-2],u[f-1]);l<f;l+=2)c=h,h=this._edgecode(u[l],u[l+1]),c&&h&&(l=this._edge(e,c,h,u,l),f=u.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}_edge(e,n,i,r,a){for(;n!==i;){let o,u;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,u=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,u=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,u=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,u=this.ymin;break}(r[a]!==o||r[a+1]!==u)&&this.contains(e,o,u)&&(r.splice(a,0,o,u),a+=2)}if(r.length>4)for(let o=0;o<r.length;o+=2){const u=(o+2)%r.length,s=(o+4)%r.length;(r[o]===r[u]&&r[u]===r[s]||r[o+1]===r[u+1]&&r[u+1]===r[s+1])&&(r.splice(u,2),o-=2)}return a}_project(e,n,i,r){let a=1/0,o,u,s;if(r<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/r)<a&&(s=this.ymin,u=e+(a=o)*i)}else if(r>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/r)<a&&(s=this.ymax,u=e+(a=o)*i)}if(i>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/i)<a&&(u=this.xmax,s=n+(a=o)*r)}else if(i<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/i)<a&&(u=this.xmin,s=n+(a=o)*r)}return[u,s]}_edgecode(e,n){return(e===this.xmin?1:e===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(e,n){return(e<this.xmin?1:e>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const mO=2*Math.PI,Dr=Math.pow;function pO(t){return t[0]}function yO(t){return t[1]}function vO(t){const{triangles:e,coords:n}=t;for(let i=0;i<e.length;i+=3){const r=2*e[i],a=2*e[i+1],o=2*e[i+2];if((n[o]-n[r])*(n[a+1]-n[r+1])-(n[a]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}function xO(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class rm{static from(e,n=pO,i=yO,r){return new rm("length"in e?bO(e,n,i,r):Float64Array.from(wO(e,n,i,r)))}constructor(e){this._delaunator=new gl(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,n=this.points;if(e.hull&&e.hull.length>2&&vO(e)){this.collinear=Int32Array.from({length:n.length/2},(h,d)=>d).sort((h,d)=>n[2*h]-n[2*d]||n[2*h+1]-n[2*d+1]);const s=this.collinear[0],l=this.collinear[this.collinear.length-1],f=[n[2*s],n[2*s+1],n[2*l],n[2*l+1]],c=1e-8*Math.hypot(f[3]-f[1],f[2]-f[0]);for(let h=0,d=n.length/2;h<d;++h){const g=xO(n[2*h],n[2*h+1],c);n[2*h]=g[0],n[2*h+1]=g[1]}this._delaunator=new gl(n)}else delete this.collinear;const i=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),u=this._hullIndex.fill(-1);for(let s=0,l=i.length;s<l;++s){const f=a[s%3===2?s-2:s+1];(i[s]===-1||o[f]===-1)&&(o[f]=s)}for(let s=0,l=r.length;s<l;++s)u[r[s]]=s;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],this.triangles[1]=r[1],this.triangles[2]=r[1],o[r[0]]=1,r.length===2&&(o[r[1]]=0))}voronoi(e){return new gO(this,e)}*neighbors(e){const{inedges:n,hull:i,_hullIndex:r,halfedges:a,triangles:o,collinear:u}=this;if(u){const c=u.indexOf(e);c>0&&(yield u[c-1]),c<u.length-1&&(yield u[c+1]);return}const s=n[e];if(s===-1)return;let l=s,f=-1;do{if(yield f=o[l],l=l%3===2?l-2:l+1,o[l]!==e)return;if(l=a[l],l===-1){const c=i[(r[e]+1)%i.length];c!==f&&(yield c);return}}while(l!==s)}find(e,n,i=0){if(e=+e,e!==e||(n=+n,n!==n))return-1;const r=i;let a;for(;(a=this._step(i,e,n))>=0&&a!==i&&a!==r;)i=a;return a}_step(e,n,i){const{inedges:r,hull:a,_hullIndex:o,halfedges:u,triangles:s,points:l}=this;if(r[e]===-1||!l.length)return(e+1)%(l.length>>1);let f=e,c=Dr(n-l[e*2],2)+Dr(i-l[e*2+1],2);const h=r[e];let d=h;do{let g=s[d];const m=Dr(n-l[g*2],2)+Dr(i-l[g*2+1],2);if(m<c&&(c=m,f=g),d=d%3===2?d-2:d+1,s[d]!==e)break;if(d=u[d],d===-1){if(d=a[(o[e]+1)%a.length],d!==g&&Dr(n-l[d*2],2)+Dr(i-l[d*2+1],2)<c)return d;break}}while(d!==h);return f}render(e){const n=e==null?e=new Xi:void 0,{points:i,halfedges:r,triangles:a}=this;for(let o=0,u=r.length;o<u;++o){const s=r[o];if(s<o)continue;const l=a[o]*2,f=a[s]*2;e.moveTo(i[l],i[l+1]),e.lineTo(i[f],i[f+1])}return this.renderHull(e),n&&n.value()}renderPoints(e,n=2){const i=e==null?e=new Xi:void 0,{points:r}=this;for(let a=0,o=r.length;a<o;a+=2){const u=r[a],s=r[a+1];e.moveTo(u+n,s),e.arc(u,s,n,0,mO)}return i&&i.value()}renderHull(e){const n=e==null?e=new Xi:void 0,{hull:i,points:r}=this,a=i[0]*2,o=i.length;e.moveTo(r[a],r[a+1]);for(let u=1;u<o;++u){const s=2*i[u];e.lineTo(r[s],r[s+1])}return e.closePath(),n&&n.value()}hullPolygon(){const e=new Ad;return this.renderHull(e),e.value()}renderTriangle(e,n){const i=n==null?n=new Xi:void 0,{points:r,triangles:a}=this,o=a[e*=3]*2,u=a[e+1]*2,s=a[e+2]*2;return n.moveTo(r[o],r[o+1]),n.lineTo(r[u],r[u+1]),n.lineTo(r[s],r[s+1]),n.closePath(),i&&i.value()}*trianglePolygons(){const{triangles:e}=this;for(let n=0,i=e.length/3;n<i;++n)yield this.trianglePolygon(n)}trianglePolygon(e){const n=new Ad;return this.renderTriangle(e,n),n.value()}}function bO(t,e,n,i){const r=t.length,a=new Float64Array(r*2);for(let o=0;o<r;++o){const u=t[o];a[o*2]=e.call(i,u,o,t),a[o*2+1]=n.call(i,u,o,t)}return a}function*wO(t,e,n,i){let r=0;for(const a of t)yield e.call(i,a,r,t),yield n.call(i,a,r,t),++r}function am(t){S.call(this,null,t)}am.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const _O=[-1e5,-1e5,1e5,1e5];z(am,S,{transform(t,e){const n=t.as||"path",i=e.source;if(!i||!i.length)return e;let r=t.size;r=r?[0,0,r[0],r[1]]:(r=t.extent)?[r[0][0],r[0][1],r[1][0],r[1][1]]:_O;const a=this.value=rm.from(i,t.x,t.y).voronoi(r);for(let o=0,u=i.length;o<u;++o){const s=a.cellPolygon(o);i[o][n]=s?MO(s):null}return e.reflow(t.modified()).modifies(n)}});function MO(t){const e=t[0][0],n=t[0][1];let i=t.length-1;for(;t[i][0]===e&&t[i][1]===n;--i);return"M"+t.slice(0,i+1).join("L")+"Z"}var kO=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",voronoi:am}),Ic=Math.PI/180,uo=1<<11>>5,Ms=1<<11;function AO(){var t=[256,256],e,n,i,r,a,o,u,s=E5,l=[],f=Math.random,c={};c.layout=function(){for(var g=h(ma()),m=$O((t[0]>>5)*t[1]),p=null,y=l.length,v=-1,x=[],b=l.map(M=>({text:e(M),font:n(M),style:r(M),weight:a(M),rotate:o(M),size:~~(i(M)+1e-14),padding:u(M),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:M})).sort((M,w)=>w.size-M.size);++v<y;){var _=b[v];_.x=t[0]*(f()+.5)>>1,_.y=t[1]*(f()+.5)>>1,EO(g,_,b,v),_.hasText&&d(m,_,p)&&(x.push(_),p?DO(p,_):p=[{x:_.x+_.x0,y:_.y+_.y0},{x:_.x+_.x1,y:_.y+_.y1}],_.x-=t[0]>>1,_.y-=t[1]>>1)}return x};function h(g){g.width=g.height=1;var m=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=(uo<<5)/m,g.height=Ms/m;var p=g.getContext("2d");return p.fillStyle=p.strokeStyle="red",p.textAlign="center",{context:p,ratio:m}}function d(g,m,p){for(var y=m.x,v=m.y,x=Math.sqrt(t[0]*t[0]+t[1]*t[1]),b=s(t),_=f()<.5?1:-1,M=-_,w,k,C;(w=b(M+=_))&&(k=~~w[0],C=~~w[1],!(Math.min(Math.abs(k),Math.abs(C))>=x));)if(m.x=y+k,m.y=v+C,!(m.x+m.x0<0||m.y+m.y0<0||m.x+m.x1>t[0]||m.y+m.y1>t[1])&&(!p||!CO(m,g,t[0]))&&(!p||SO(m,p))){for(var A=m.sprite,E=m.width>>5,F=t[0]>>5,$=m.x-(E<<4),O=$&127,D=32-O,N=m.y1-m.y0,L=(m.y+m.y0)*F+($>>5),U,W=0;W<N;W++){U=0;for(var lt=0;lt<=E;lt++)g[L+lt]|=U<<D|(lt<E?(U=A[W*E+lt])>>>O:0);L+=F}return m.sprite=null,!0}return!1}return c.words=function(g){return arguments.length?(l=g,c):l},c.size=function(g){return arguments.length?(t=[+g[0],+g[1]],c):t},c.font=function(g){return arguments.length?(n=Li(g),c):n},c.fontStyle=function(g){return arguments.length?(r=Li(g),c):r},c.fontWeight=function(g){return arguments.length?(a=Li(g),c):a},c.rotate=function(g){return arguments.length?(o=Li(g),c):o},c.text=function(g){return arguments.length?(e=Li(g),c):e},c.spiral=function(g){return arguments.length?(s=TO[g]||g,c):s},c.fontSize=function(g){return arguments.length?(i=Li(g),c):i},c.padding=function(g){return arguments.length?(u=Li(g),c):u},c.random=function(g){return arguments.length?(f=g,c):f},c}function EO(t,e,n,i){if(!e.sprite){var r=t.context,a=t.ratio;r.clearRect(0,0,(uo<<5)/a,Ms/a);var o=0,u=0,s=0,l=n.length,f,c,h,d,g;for(--i;++i<l;){if(e=n[i],r.save(),r.font=e.style+" "+e.weight+" "+~~((e.size+1)/a)+"px "+e.font,f=r.measureText(e.text+"m").width*a,h=e.size<<1,e.rotate){var m=Math.sin(e.rotate*Ic),p=Math.cos(e.rotate*Ic),y=f*p,v=f*m,x=h*p,b=h*m;f=Math.max(Math.abs(y+b),Math.abs(y-b))+31>>5<<5,h=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else f=f+31>>5<<5;if(h>s&&(s=h),o+f>=uo<<5&&(o=0,u+=s,s=0),u+h>=Ms)break;r.translate((o+(f>>1))/a,(u+(h>>1))/a),e.rotate&&r.rotate(e.rotate*Ic),r.fillText(e.text,0,0),e.padding&&(r.lineWidth=2*e.padding,r.strokeText(e.text,0,0)),r.restore(),e.width=f,e.height=h,e.xoff=o,e.yoff=u,e.x1=f>>1,e.y1=h>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,o+=f}for(var _=r.getImageData(0,0,(uo<<5)/a,Ms/a).data,M=[];--i>=0;)if(e=n[i],!!e.hasText){for(f=e.width,c=f>>5,h=e.y1-e.y0,d=0;d<h*c;d++)M[d]=0;if(o=e.xoff,o==null)return;u=e.yoff;var w=0,k=-1;for(g=0;g<h;g++){for(d=0;d<f;d++){var C=c*g+(d>>5),A=_[(u+g)*(uo<<5)+(o+d)<<2]?1<<31-d%32:0;M[C]|=A,w|=A}w?k=g:(e.y0++,h--,g--,u++)}e.y1=e.y0+k,e.sprite=M.slice(0,(e.y1-e.y0)*c)}}}function CO(t,e,n){n>>=5;for(var i=t.sprite,r=t.width>>5,a=t.x-(r<<4),o=a&127,u=32-o,s=t.y1-t.y0,l=(t.y+t.y0)*n+(a>>5),f,c=0;c<s;c++){f=0;for(var h=0;h<=r;h++)if((f<<u|(h<r?(f=i[c*r+h])>>>o:0))&e[l+h])return!0;l+=n}return!1}function DO(t,e){var n=t[0],i=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>i.x&&(i.x=e.x+e.x1),e.y+e.y1>i.y&&(i.y=e.y+e.y1)}function SO(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function E5(t){var e=t[0]/t[1];return function(n){return[e*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function FO(t){var e=4,n=e*t[0]/t[1],i=0,r=0;return function(a){var o=a<0?-1:1;switch(Math.sqrt(1+4*o*a)-o&3){case 0:i+=n;break;case 1:r+=e;break;case 2:i-=n;break;default:r-=e;break}return[i,r]}}function $O(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}function Li(t){return typeof t=="function"?t:function(){return t}}var TO={archimedean:E5,rectangular:FO};const C5=["x","y","font","fontSize","fontStyle","fontWeight","angle"],RO=["text","font","rotate","fontSize","fontStyle","fontWeight"];function om(t){S.call(this,AO(),t)}om.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:C5}]};z(om,S,{transform(t,e){t.size&&!(t.size[0]&&t.size[1])&&R("Wordcloud size dimensions must be non-zero.");function n(g){const m=t[g];return Q(m)&&e.modified(m.fields)}const i=t.modified();if(!(i||e.changed(e.ADD_REM)||RO.some(n)))return;const r=e.materialize(e.SOURCE).source,a=this.value,o=t.as||C5;let u=t.fontSize||14,s;if(Q(u)?s=t.fontSizeRange:u=ee(u),s){const g=u,m=st("sqrt")().domain(Fn(r,g)).range(s);u=p=>m(g(p))}r.forEach(g=>{g[o[0]]=NaN,g[o[1]]=NaN,g[o[3]]=0});const l=a.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(u).random(Ze).layout(),f=a.size(),c=f[0]>>1,h=f[1]>>1,d=l.length;for(let g=0,m,p;g<d;++g)m=l[g],p=m.datum,p[o[0]]=m.x+c,p[o[1]]=m.y+h,p[o[2]]=m.font,p[o[3]]=m.size,p[o[4]]=m.style,p[o[5]]=m.weight,p[o[6]]=m.rotate;return e.reflow(i).modifies(o)}});var NO=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",wordcloud:om});function D5(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function S5(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=OO(t));function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=i(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:i,center:a,right:r}}function OO(t){return(e,n)=>D5(t(e),n)}function zO(t){return t===null?NaN:+t}const F5=S5(D5),BO=F5.right,LO=F5.left;S5(zO).center;function PO(t,e){return Array.from(e,n=>t[n])}const IO=t=>new Uint8Array(t),UO=t=>new Uint16Array(t),wo=t=>new Uint32Array(t);function qO(){let t=8,e=[],n=wo(0),i=ns(0,t),r=ns(0,t);return{data:()=>e,seen:()=>n=jO(n,e.length),add(a){for(let o=0,u=e.length,s=a.length,l;o<s;++o)l=a[o],l._index=u++,e.push(l)},remove(a,o){const u=e.length,s=Array(u-a),l=e;let f,c,h;for(c=0;!o[c]&&c<u;++c)s[c]=e[c],l[c]=c;for(h=c;c<u;++c)f=e[c],o[c]?l[c]=-1:(l[c]=h,i[h]=i[c],r[h]=r[c],s[h]=f,f._index=h++),i[c]=0;return e=s,l},size:()=>e.length,curr:()=>i,prev:()=>r,reset:a=>r[a]=i[a],all:()=>t<257?255:t<65537?65535:4294967295,set(a,o){i[a]|=o},clear(a,o){i[a]&=~o},resize(a,o){const u=i.length;(a>u||o>t)&&(t=Math.max(o,t),i=ns(a,t,i),r=ns(a,t))}}}function jO(t,e,n){return t.length>=e?t:(n=n||new t.constructor(e),n.set(t),n)}function ns(t,e,n){const i=(e<257?IO:e<65537?UO:wo)(t);return n&&i.set(n),i}function T2(t,e,n){const i=1<<e;return{one:i,zero:~i,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(r,a){const o=this,u=o.bisect(o.range,r.value),s=r.index,l=u[0],f=u[1],c=s.length;let h;for(h=0;h<l;++h)a[s[h]]|=i;for(h=f;h<c;++h)a[s[h]]|=i;return o}}}function R2(){let t=wo(0),e=[],n=0;function i(u,s,l){if(!s.length)return[];const f=n,c=s.length,h=wo(c);let d=Array(c),g,m,p;for(p=0;p<c;++p)d[p]=u(s[p]),h[p]=p;if(d=YO(d,h),f)g=e,m=t,e=Array(f+c),t=wo(f+c),HO(l,g,m,f,d,h,c,e,t);else{if(l>0)for(p=0;p<c;++p)h[p]+=l;e=d,t=h}return n=f+c,{index:h,value:d}}function r(u,s){const l=n;let f,c,h;for(c=0;!s[t[c]]&&c<l;++c);for(h=c;c<l;++c)s[f=t[c]]||(t[h]=f,e[h]=e[c],++h);n=l-u}function a(u){for(let s=0,l=n;s<l;++s)t[s]=u[t[s]]}function o(u,s){let l;return s?l=s.length:(s=e,l=n),[LO(s,u[0],0,l),BO(s,u[1],0,l)]}return{insert:i,remove:r,bisect:o,reindex:a,index:()=>t,size:()=>n}}function YO(t,e){return t.sort.call(e,(n,i)=>{const r=t[n],a=t[i];return r<a?-1:r>a?1:0}),PO(t,e)}function HO(t,e,n,i,r,a,o,u,s){let l=0,f=0,c;for(c=0;l<i&&f<o;++c)e[l]<r[f]?(u[c]=e[l],s[c]=n[l++]):(u[c]=r[f],s[c]=a[f++]+t);for(;l<i;++l,++c)u[c]=e[l],s[c]=n[l];for(;f<o;++f,++c)u[c]=r[f],s[c]=a[f]+t}function um(t){S.call(this,qO(),t),this._indices=null,this._dims=null}um.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};z(um,S,{transform(t,e){if(this._dims){var n=t.modified("fields")||t.fields.some(i=>e.modified(i.fields));return n?this.reinit(t,e):this.eval(t,e)}else return this.init(t,e)},init(t,e){const n=t.fields,i=t.query,r=this._indices={},a=this._dims=[],o=i.length;let u=0,s,l;for(;u<o;++u)s=n[u].fname,l=r[s]||(r[s]=R2()),a.push(T2(l,u,i[u]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),i=t.fields,r=t.query,a=this._indices,o=this._dims,u=this.value,s=u.curr(),l=u.prev(),f=u.all(),c=n.rem=n.add,h=n.mod,d=r.length,g={};let m,p,y,v,x,b,_,M,w;if(l.set(s),e.rem.length&&(x=this.remove(t,e,n)),e.add.length&&u.add(e.add),e.mod.length)for(b={},v=e.mod,_=0,M=v.length;_<M;++_)b[v[_]._index]=1;for(_=0;_<d;++_)w=i[_],(!o[_]||t.modified("fields",_)||e.modified(w.fields))&&(y=w.fname,(m=g[y])||(a[y]=p=R2(),g[y]=m=p.insert(w,e.source,0)),o[_]=T2(p,_,r[_]).onAdd(m,s));for(_=0,M=u.data().length;_<M;++_)x[_]||(l[_]!==s[_]?c.push(_):b[_]&&s[_]!==f&&h.push(_));return u.mask=(1<<d)-1,n},eval(t,e){const n=e.materialize().fork(),i=this._dims.length;let r=0;return e.rem.length&&(this.remove(t,e,n),r|=(1<<i)-1),t.modified("query")&&!t.modified("fields")&&(r|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),r|=(1<<i)-1),e.mod.length&&(this.modify(e,n),r|=(1<<i)-1),this.value.mask=r,n},insert(t,e,n){const i=e.add,r=this.value,a=this._dims,o=this._indices,u=t.fields,s={},l=n.add,f=r.size()+i.length,c=a.length;let h=r.size(),d,g,m;r.resize(f,c),r.add(i);const p=r.curr(),y=r.prev(),v=r.all();for(d=0;d<c;++d)g=u[d].fname,m=s[g]||(s[g]=o[g].insert(u[d],i,h)),a[d].onAdd(m,p);for(;h<f;++h)y[h]=v,p[h]!==v&&l.push(h)},modify(t,e){const n=e.mod,i=this.value,r=i.curr(),a=i.all(),o=t.mod;let u,s,l;for(u=0,s=o.length;u<s;++u)l=o[u]._index,r[l]!==a&&n.push(l)},remove(t,e,n){const i=this._indices,r=this.value,a=r.curr(),o=r.prev(),u=r.all(),s={},l=n.rem,f=e.rem;let c,h,d,g;for(c=0,h=f.length;c<h;++c)d=f[c]._index,s[d]=1,o[d]=g=a[d],a[d]=u,g!==u&&l.push(d);for(d in i)i[d].remove(h,s);return this.reindex(e,h,s),s},reindex(t,e,n){const i=this._indices,r=this.value;t.runAfter(()=>{const a=r.remove(e,n);for(const o in i)i[o].reindex(a)})},update(t,e,n){const i=this._dims,r=t.query,a=e.stamp,o=i.length;let u=0,s,l;for(n.filters=0,l=0;l<o;++l)t.modified("query",l)&&(s=l,++u);if(u===1)u=i[s].one,this.incrementOne(i[s],r[s],n.add,n.rem);else for(l=0,u=0;l<o;++l)!t.modified("query",l)||(u|=i[l].one,this.incrementAll(i[l],r[l],a,n.add),n.rem=n.add);return u},incrementAll(t,e,n,i){const r=this.value,a=r.seen(),o=r.curr(),u=r.prev(),s=t.index(),l=t.bisect(t.range),f=t.bisect(e),c=f[0],h=f[1],d=l[0],g=l[1],m=t.one;let p,y,v;if(c<d)for(p=c,y=Math.min(d,h);p<y;++p)v=s[p],a[v]!==n&&(u[v]=o[v],a[v]=n,i.push(v)),o[v]^=m;else if(c>d)for(p=d,y=Math.min(c,g);p<y;++p)v=s[p],a[v]!==n&&(u[v]=o[v],a[v]=n,i.push(v)),o[v]^=m;if(h>g)for(p=Math.max(c,g),y=h;p<y;++p)v=s[p],a[v]!==n&&(u[v]=o[v],a[v]=n,i.push(v)),o[v]^=m;else if(h<g)for(p=Math.max(d,h),y=g;p<y;++p)v=s[p],a[v]!==n&&(u[v]=o[v],a[v]=n,i.push(v)),o[v]^=m;t.range=e.slice()},incrementOne(t,e,n,i){const r=this.value,a=r.curr(),o=t.index(),u=t.bisect(t.range),s=t.bisect(e),l=s[0],f=s[1],c=u[0],h=u[1],d=t.one;let g,m,p;if(l<c)for(g=l,m=Math.min(c,f);g<m;++g)p=o[g],a[p]^=d,n.push(p);else if(l>c)for(g=c,m=Math.min(l,h);g<m;++g)p=o[g],a[p]^=d,i.push(p);if(f>h)for(g=Math.max(l,h),m=f;g<m;++g)p=o[g],a[p]^=d,n.push(p);else if(f<h)for(g=Math.max(c,f),m=h;g<m;++g)p=o[g],a[p]^=d,i.push(p);t.range=e.slice()}});function sm(t){S.call(this,null,t)}sm.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};z(sm,S,{transform(t,e){const n=~(t.ignore||0),i=t.filter,r=i.mask;if((r&n)===0)return e.StopPropagation;const a=e.fork(e.ALL),o=i.data(),u=i.curr(),s=i.prev(),l=f=>u[f]&n?null:o[f];return a.filter(a.MOD,l),r&r-1?(a.filter(a.ADD,f=>{const c=u[f]&n;return!c&&c^s[f]&n?o[f]:null}),a.filter(a.REM,f=>{const c=u[f]&n;return c&&!(c^(c^s[f]&n))?o[f]:null})):(a.filter(a.ADD,l),a.filter(a.REM,f=>(u[f]&n)===r?o[f]:null)),a.filter(a.SOURCE,f=>l(f._index))}});var WO=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",crossfilter:um,resolvefilter:sm}),GO=Math.sqrt(50),VO=Math.sqrt(10),XO=Math.sqrt(2);function KO(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),a=i/r;return a>=GO?r*=10:a>=VO?r*=5:a>=XO&&(r*=2),e<t?-r:r}const ZO="RawCode",ir="Literal",JO="Property",QO="Identifier",tz="ArrayExpression",ez="BinaryExpression",$5="CallExpression",nz="ConditionalExpression",iz="LogicalExpression",rz="MemberExpression",az="ObjectExpression",oz="UnaryExpression";function gn(t){this.type=t}gn.prototype.visit=function(t){let e,n,i;if(t(this))return 1;for(e=uz(this),n=0,i=e.length;n<i;++n)if(e[n].visit(t))return 1};function uz(t){switch(t.type){case tz:return t.elements;case ez:case iz:return[t.left,t.right];case $5:return[t.callee].concat(t.arguments);case nz:return[t.test,t.consequent,t.alternate];case rz:return[t.object,t.property];case az:return t.properties;case JO:return[t.key,t.value];case oz:return[t.argument];case QO:case ir:case ZO:default:return[]}}var Bn,I,T,Qt,ht,Sf=1,Mu=2,rr=3,Oi=4,Ff=5,vr=6,ve=7,ku=8,sz=9;Bn={};Bn[Sf]="Boolean";Bn[Mu]="<end>";Bn[rr]="Identifier";Bn[Oi]="Keyword";Bn[Ff]="Null";Bn[vr]="Numeric";Bn[ve]="Punctuator";Bn[ku]="String";Bn[sz]="RegularExpression";var lz="ArrayExpression",fz="BinaryExpression",cz="CallExpression",hz="ConditionalExpression",T5="Identifier",dz="Literal",gz="LogicalExpression",mz="MemberExpression",pz="ObjectExpression",yz="Property",vz="UnaryExpression",Rt="Unexpected token %0",xz="Unexpected number",bz="Unexpected string",wz="Unexpected identifier",_z="Unexpected reserved word",Mz="Unexpected end of input",Ed="Invalid regular expression",Uc="Invalid regular expression: missing /",R5="Octal literals are not allowed in strict mode.",kz="Duplicate data property in object literal not allowed in strict mode",Pt="ILLEGAL",Wo="Disabled.",Az=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),Ez=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function $f(t,e){if(!t)throw new Error("ASSERT: "+e)}function qn(t){return t>=48&&t<=57}function lm(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function _o(t){return"01234567".indexOf(t)>=0}function Cz(t){return t===32||t===9||t===11||t===12||t===160||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function Go(t){return t===10||t===13||t===8232||t===8233}function Au(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t===92||t>=128&&Az.test(String.fromCharCode(t))}function ml(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t===92||t>=128&&Ez.test(String.fromCharCode(t))}const Dz={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function N5(){for(;T<Qt;){const t=I.charCodeAt(T);if(Cz(t)||Go(t))++T;else break}}function Cd(t){var e,n,i,r=0;for(n=t==="u"?4:2,e=0;e<n;++e)T<Qt&&lm(I[T])?(i=I[T++],r=r*16+"0123456789abcdef".indexOf(i.toLowerCase())):ot({},Rt,Pt);return String.fromCharCode(r)}function Sz(){var t,e,n,i;for(t=I[T],e=0,t==="}"&&ot({},Rt,Pt);T<Qt&&(t=I[T++],!!lm(t));)e=e*16+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||t!=="}")&&ot({},Rt,Pt),e<=65535?String.fromCharCode(e):(n=(e-65536>>10)+55296,i=(e-65536&1023)+56320,String.fromCharCode(n,i))}function O5(){var t,e;for(t=I.charCodeAt(T++),e=String.fromCharCode(t),t===92&&(I.charCodeAt(T)!==117&&ot({},Rt,Pt),++T,t=Cd("u"),(!t||t==="\\"||!Au(t.charCodeAt(0)))&&ot({},Rt,Pt),e=t);T<Qt&&(t=I.charCodeAt(T),!!ml(t));)++T,e+=String.fromCharCode(t),t===92&&(e=e.substr(0,e.length-1),I.charCodeAt(T)!==117&&ot({},Rt,Pt),++T,t=Cd("u"),(!t||t==="\\"||!ml(t.charCodeAt(0)))&&ot({},Rt,Pt),e+=t);return e}function Fz(){var t,e;for(t=T++;T<Qt;){if(e=I.charCodeAt(T),e===92)return T=t,O5();if(ml(e))++T;else break}return I.slice(t,T)}function $z(){var t,e,n;return t=T,e=I.charCodeAt(T)===92?O5():Fz(),e.length===1?n=rr:Dz.hasOwnProperty(e)?n=Oi:e==="null"?n=Ff:e==="true"||e==="false"?n=Sf:n=rr,{type:n,value:e,start:t,end:T}}function qc(){var t=T,e=I.charCodeAt(T),n,i=I[T],r,a,o;switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++T,{type:ve,value:String.fromCharCode(e),start:t,end:T};default:if(n=I.charCodeAt(T+1),n===61)switch(e){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return T+=2,{type:ve,value:String.fromCharCode(e)+String.fromCharCode(n),start:t,end:T};case 33:case 61:return T+=2,I.charCodeAt(T)===61&&++T,{type:ve,value:I.slice(t,T),start:t,end:T}}}if(o=I.substr(T,4),o===">>>=")return T+=4,{type:ve,value:o,start:t,end:T};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return T+=3,{type:ve,value:a,start:t,end:T};if(r=a.substr(0,2),i===r[1]&&"+-<>&|".indexOf(i)>=0||r==="=>")return T+=2,{type:ve,value:r,start:t,end:T};if(r==="//"&&ot({},Rt,Pt),"<>=!+-*%&|^/".indexOf(i)>=0)return++T,{type:ve,value:i,start:t,end:T};ot({},Rt,Pt)}function Tz(t){let e="";for(;T<Qt&&lm(I[T]);)e+=I[T++];return e.length===0&&ot({},Rt,Pt),Au(I.charCodeAt(T))&&ot({},Rt,Pt),{type:vr,value:parseInt("0x"+e,16),start:t,end:T}}function Rz(t){let e="0"+I[T++];for(;T<Qt&&_o(I[T]);)e+=I[T++];return(Au(I.charCodeAt(T))||qn(I.charCodeAt(T)))&&ot({},Rt,Pt),{type:vr,value:parseInt(e,8),octal:!0,start:t,end:T}}function N2(){var t,e,n;if(n=I[T],$f(qn(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),e=T,t="",n!=="."){if(t=I[T++],n=I[T],t==="0"){if(n==="x"||n==="X")return++T,Tz(e);if(_o(n))return Rz(e);n&&qn(n.charCodeAt(0))&&ot({},Rt,Pt)}for(;qn(I.charCodeAt(T));)t+=I[T++];n=I[T]}if(n==="."){for(t+=I[T++];qn(I.charCodeAt(T));)t+=I[T++];n=I[T]}if(n==="e"||n==="E")if(t+=I[T++],n=I[T],(n==="+"||n==="-")&&(t+=I[T++]),qn(I.charCodeAt(T)))for(;qn(I.charCodeAt(T));)t+=I[T++];else ot({},Rt,Pt);return Au(I.charCodeAt(T))&&ot({},Rt,Pt),{type:vr,value:parseFloat(t),start:e,end:T}}function Nz(){var t="",e,n,i,r,a=!1;for(e=I[T],$f(e==="'"||e==='"',"String literal must starts with a quote"),n=T,++T;T<Qt;)if(i=I[T++],i===e){e="";break}else if(i==="\\")if(i=I[T++],!i||!Go(i.charCodeAt(0)))switch(i){case"u":case"x":I[T]==="{"?(++T,t+=Sz()):t+=Cd(i);break;case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:_o(i)?(r="01234567".indexOf(i),r!==0&&(a=!0),T<Qt&&_o(I[T])&&(a=!0,r=r*8+"01234567".indexOf(I[T++]),"0123".indexOf(i)>=0&&T<Qt&&_o(I[T])&&(r=r*8+"01234567".indexOf(I[T++]))),t+=String.fromCharCode(r)):t+=i;break}else i==="\r"&&I[T]===`
`&&++T;else{if(Go(i.charCodeAt(0)))break;t+=i}return e!==""&&ot({},Rt,Pt),{type:ku,value:t,octal:a,start:n,end:T}}function Oz(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(i,r)=>{if(parseInt(r,16)<=1114111)return"x";ot({},Ed)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch{ot({},Ed)}try{return new RegExp(t,e)}catch{return null}}function zz(){var t,e,n,i,r;for(t=I[T],$f(t==="/","Regular expression literal must start with a slash"),e=I[T++],n=!1,i=!1;T<Qt;)if(t=I[T++],e+=t,t==="\\")t=I[T++],Go(t.charCodeAt(0))&&ot({},Uc),e+=t;else if(Go(t.charCodeAt(0)))ot({},Uc);else if(n)t==="]"&&(n=!1);else if(t==="/"){i=!0;break}else t==="["&&(n=!0);return i||ot({},Uc),r=e.substr(1,e.length-2),{value:r,literal:e}}function Bz(){var t,e,n;for(e="",n="";T<Qt&&(t=I[T],!!ml(t.charCodeAt(0)));)++T,t==="\\"&&T<Qt?ot({},Rt,Pt):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&ot({},Ed,n),{value:n,literal:e}}function Lz(){var t,e,n,i;return ht=null,N5(),t=T,e=zz(),n=Bz(),i=Oz(e.value,n.value),{literal:e.literal+n.literal,value:i,regex:{pattern:e.value,flags:n.value},start:t,end:T}}function Pz(t){return t.type===rr||t.type===Oi||t.type===Sf||t.type===Ff}function z5(){if(N5(),T>=Qt)return{type:Mu,start:T,end:T};const t=I.charCodeAt(T);return Au(t)?$z():t===40||t===41||t===59?qc():t===39||t===34?Nz():t===46?qn(I.charCodeAt(T+1))?N2():qc():qn(t)?N2():qc()}function we(){const t=ht;return T=t.end,ht=z5(),T=t.end,t}function B5(){const t=T;ht=z5(),T=t}function Iz(t){const e=new gn(lz);return e.elements=t,e}function O2(t,e,n){const i=new gn(t==="||"||t==="&&"?gz:fz);return i.operator=t,i.left=e,i.right=n,i}function Uz(t,e){const n=new gn(cz);return n.callee=t,n.arguments=e,n}function qz(t,e,n){const i=new gn(hz);return i.test=t,i.consequent=e,i.alternate=n,i}function fm(t){const e=new gn(T5);return e.name=t,e}function so(t){const e=new gn(dz);return e.value=t.value,e.raw=I.slice(t.start,t.end),t.regex&&(e.raw==="//"&&(e.raw="/(?:)/"),e.regex=t.regex),e}function z2(t,e,n){const i=new gn(mz);return i.computed=t==="[",i.object=e,i.property=n,i.computed||(n.member=!0),i}function jz(t){const e=new gn(pz);return e.properties=t,e}function B2(t,e,n){const i=new gn(yz);return i.key=e,i.value=n,i.kind=t,i}function Yz(t,e){const n=new gn(vz);return n.operator=t,n.argument=e,n.prefix=!0,n}function ot(t,e){var n,i=Array.prototype.slice.call(arguments,2),r=e.replace(/%(\d)/g,(a,o)=>($f(o<i.length,"Message reference must be in range"),i[o]));throw n=new Error(r),n.index=T,n.description=r,n}function Tf(t){t.type===Mu&&ot(t,Mz),t.type===vr&&ot(t,xz),t.type===ku&&ot(t,bz),t.type===rr&&ot(t,wz),t.type===Oi&&ot(t,_z),ot(t,Rt,t.value)}function te(t){const e=we();(e.type!==ve||e.value!==t)&&Tf(e)}function yt(t){return ht.type===ve&&ht.value===t}function jc(t){return ht.type===Oi&&ht.value===t}function Hz(){const t=[];for(T=ht.start,te("[");!yt("]");)yt(",")?(we(),t.push(null)):(t.push(ar()),yt("]")||te(","));return we(),Iz(t)}function L2(){T=ht.start;const t=we();return t.type===ku||t.type===vr?(t.octal&&ot(t,R5),so(t)):fm(t.value)}function Wz(){var t,e,n,i;if(T=ht.start,t=ht,t.type===rr)return n=L2(),te(":"),i=ar(),B2("init",n,i);if(t.type===Mu||t.type===ve)Tf(t);else return e=L2(),te(":"),i=ar(),B2("init",e,i)}function Gz(){var t=[],e,n,i,r={},a=String;for(T=ht.start,te("{");!yt("}");)e=Wz(),e.key.type===T5?n=e.key.name:n=a(e.key.value),i="$"+n,Object.prototype.hasOwnProperty.call(r,i)?ot({},kz):r[i]=!0,t.push(e),yt("}")||te(",");return te("}"),jz(t)}function Vz(){te("(");const t=cm();return te(")"),t}const Xz={if:1};function Kz(){var t,e,n;if(yt("("))return Vz();if(yt("["))return Hz();if(yt("{"))return Gz();if(t=ht.type,T=ht.start,t===rr||Xz[ht.value])n=fm(we().value);else if(t===ku||t===vr)ht.octal&&ot(ht,R5),n=so(we());else{if(t===Oi)throw new Error(Wo);t===Sf?(e=we(),e.value=e.value==="true",n=so(e)):t===Ff?(e=we(),e.value=null,n=so(e)):yt("/")||yt("/=")?(n=so(Lz()),B5()):Tf(we())}return n}function Zz(){const t=[];if(te("("),!yt(")"))for(;T<Qt&&(t.push(ar()),!yt(")"));)te(",");return te(")"),t}function Jz(){T=ht.start;const t=we();return Pz(t)||Tf(t),fm(t.value)}function Qz(){return te("."),Jz()}function tB(){te("[");const t=cm();return te("]"),t}function eB(){var t,e,n;for(t=Kz();;)if(yt("."))n=Qz(),t=z2(".",t,n);else if(yt("("))e=Zz(),t=Uz(t,e);else if(yt("["))n=tB(),t=z2("[",t,n);else break;return t}function P2(){const t=eB();if(ht.type===ve&&(yt("++")||yt("--")))throw new Error(Wo);return t}function ks(){var t,e;if(ht.type!==ve&&ht.type!==Oi)e=P2();else{if(yt("++")||yt("--"))throw new Error(Wo);if(yt("+")||yt("-")||yt("~")||yt("!"))t=we(),e=ks(),e=Yz(t.value,e);else{if(jc("delete")||jc("void")||jc("typeof"))throw new Error(Wo);e=P2()}}return e}function I2(t){let e=0;if(t.type!==ve&&t.type!==Oi)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11;break}return e}function nB(){var t,e,n,i,r,a,o,u,s,l;if(t=ht,s=ks(),i=ht,r=I2(i),r===0)return s;for(i.prec=r,we(),e=[t,ht],o=ks(),a=[s,i,o];(r=I2(ht))>0;){for(;a.length>2&&r<=a[a.length-2].prec;)o=a.pop(),u=a.pop().value,s=a.pop(),e.pop(),n=O2(u,s,o),a.push(n);i=we(),i.prec=r,a.push(i),e.push(ht),n=ks(),a.push(n)}for(l=a.length-1,n=a[l],e.pop();l>1;)e.pop(),n=O2(a[l-1].value,a[l-2],n),l-=2;return n}function ar(){var t,e,n;return t=nB(),yt("?")&&(we(),e=ar(),te(":"),n=ar(),t=qz(t,e,n)),t}function cm(){const t=ar();if(yt(","))throw new Error(Wo);return t}function L5(t){I=t,T=0,Qt=I.length,ht=null,B5();const e=cm();if(ht.type!==Mu)throw new Error("Unexpect token after expression.");return e}var P5={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function I5(t){function e(o,u,s,l){let f=t(u[0]);return s&&(f=s+"("+f+")",s.lastIndexOf("new ",0)===0&&(f="("+f+")")),f+"."+o+(l<0?"":l===0?"()":"("+u.slice(1).map(t).join(",")+")")}function n(o,u,s){return l=>e(o,l,u,s)}const i="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&R("Missing arguments to clamp function."),o.length>3&&R("Too many arguments to clamp function.");const u=o.map(t);return"Math.max("+u[1]+", Math.min("+u[2]+","+u[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:i,date:n("getDate",i,0),day:n("getDay",i,0),year:n("getFullYear",i,0),month:n("getMonth",i,0),hours:n("getHours",i,0),minutes:n("getMinutes",i,0),seconds:n("getSeconds",i,0),milliseconds:n("getMilliseconds",i,0),time:n("getTime",i,0),timezoneoffset:n("getTimezoneOffset",i,0),utcdate:n("getUTCDate",i,0),utcday:n("getUTCDay",i,0),utcyear:n("getUTCFullYear",i,0),utcmonth:n("getUTCMonth",i,0),utchours:n("getUTCHours",i,0),utcminutes:n("getUTCMinutes",i,0),utcseconds:n("getUTCSeconds",i,0),utcmilliseconds:n("getUTCMilliseconds",i,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",r,0),lower:n("toLowerCase",r,0),substring:n("substring",r),split:n("split",r),trim:n("trim",r,0),regexp:a,test:n("test",a),if:function(o){o.length<3&&R("Missing arguments to if function."),o.length>3&&R("Too many arguments to if function.");const u=o.map(t);return"("+u[0]+"?"+u[1]+":"+u[2]+")"}}}function iB(t){const e=t&&t.length-1;return e&&(t[0]==='"'&&t[e]==='"'||t[0]==="'"&&t[e]==="'")?t.slice(1,-1):t}function U5(t){t=t||{};const e=t.allowed?cn(t.allowed):{},n=t.forbidden?cn(t.forbidden):{},i=t.constants||P5,r=(t.functions||I5)(c),a=t.globalvar,o=t.fieldvar,u=Q(a)?a:g=>"".concat(a,'["').concat(g,'"]');let s={},l={},f=0;function c(g){if(vt(g))return g;const m=h[g.type];return m==null&&R("Unsupported type: "+g.type),m(g)}const h={Literal:g=>g.raw,Identifier:g=>{const m=g.name;return f>0?m:V(n,m)?R("Illegal identifier: "+m):V(i,m)?i[m]:V(e,m)?m:(s[m]=1,u(m))},MemberExpression:g=>{const m=!g.computed,p=c(g.object);m&&(f+=1);const y=c(g.property);return p===o&&(l[iB(y)]=1),m&&(f-=1),p+(m?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&R("Illegal callee type: "+g.callee.type);const m=g.callee.name,p=g.arguments,y=V(r,m)&&r[m];return y||R("Unrecognized function: "+m),Q(y)?y(p):y+"("+p.map(c).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(c).join(",")+"]",BinaryExpression:g=>"("+c(g.left)+" "+g.operator+" "+c(g.right)+")",UnaryExpression:g=>"("+g.operator+c(g.argument)+")",ConditionalExpression:g=>"("+c(g.test)+"?"+c(g.consequent)+":"+c(g.alternate)+")",LogicalExpression:g=>"("+c(g.left)+g.operator+c(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(c).join(",")+"}",Property:g=>{f+=1;const m=c(g.key);return f-=1,m+":"+c(g.value)}};function d(g){const m={code:c(g),globals:Object.keys(s),fields:Object.keys(l)};return s={},l={},m}return d.functions=r,d.constants=i,d}class _i{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const a=n[r],o=e+a,u=Math.abs(e)<Math.abs(a)?e-(o-a):a-(o-e);u&&(n[i++]=u),e=o}return n[i]=e,this._n=i+1,this}valueOf(){const e=this._partials;let n=this._n,i,r,a,o=0;if(n>0){for(o=e[--n];n>0&&(i=o,r=e[--n],o=i+r,a=r-(o-i),!a););n>0&&(a<0&&e[n-1]<0||a>0&&e[n-1]>0)&&(r=a*2,i=o+r,r==i-o&&(o=i))}return o}}function rB(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);++i<r;)a[i]=t+i*n;return a}var pl=1e-6,U2=1e-12,Eu=Math.PI,q2=Eu/2,q5=Eu/4,j2=Eu*2,Mo=180/Eu,ne=Eu/180,hm=Math.abs,Rf=Math.atan2,ge=Math.cos,Dd=Math.hypot,me=Math.sin,j5=Math.sqrt;function dm(t){return t>1?q2:t<-1?-q2:Math.asin(t)}function lo(){}function yl(t,e){t&&H2.hasOwnProperty(t.type)&&H2[t.type](t,e)}var Y2={Feature:function(t,e){yl(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)yl(n[i].geometry,e)}},H2={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Sd(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Sd(n[i],e,0)},Polygon:function(t,e){W2(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)W2(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)yl(n[i],e)}};function Sd(t,e,n){var i=-1,r=t.length-n,a;for(e.lineStart();++i<r;)a=t[i],e.point(a[0],a[1],a[2]);e.lineEnd()}function W2(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Sd(t[n],e,1);e.polygonEnd()}function gm(t,e){t&&Y2.hasOwnProperty(t.type)?Y2[t.type](t,e):yl(t,e)}var vl=new _i,xl=new _i,Y5,H5,Fd,$d,Td,Tn={point:lo,lineStart:lo,lineEnd:lo,polygonStart:function(){vl=new _i,Tn.lineStart=aB,Tn.lineEnd=oB},polygonEnd:function(){var t=+vl;xl.add(t<0?j2+t:t),this.lineStart=this.lineEnd=this.point=lo},sphere:function(){xl.add(j2)}};function aB(){Tn.point=uB}function oB(){W5(Y5,H5)}function uB(t,e){Tn.point=W5,Y5=t,H5=e,t*=ne,e*=ne,Fd=t,$d=ge(e=e/2+q5),Td=me(e)}function W5(t,e){t*=ne,e*=ne,e=e/2+q5;var n=t-Fd,i=n>=0?1:-1,r=i*n,a=ge(e),o=me(e),u=Td*o,s=$d*a+u*ge(r),l=u*i*me(r);vl.add(Rf(l,s)),Fd=t,$d=a,Td=o}function sB(t){return xl=new _i,gm(t,Tn),xl*2}function lB(t){return[Rf(t[1],t[0]),dm(t[2])]}function fB(t){var e=t[0],n=t[1],i=ge(n);return[i*ge(e),i*me(e),me(n)]}function G2(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function cB(t){var e=j5(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var bt,xe,_t,Re,Ui,G5,V5,jr,ko,si,Kn,jn={point:Rd,lineStart:V2,lineEnd:X2,polygonStart:function(){jn.point=K5,jn.lineStart=hB,jn.lineEnd=dB,ko=new _i,Tn.polygonStart()},polygonEnd:function(){Tn.polygonEnd(),jn.point=Rd,jn.lineStart=V2,jn.lineEnd=X2,vl<0?(bt=-(_t=180),xe=-(Re=90)):ko>pl?Re=90:ko<-pl&&(xe=-90),Kn[0]=bt,Kn[1]=_t},sphere:function(){bt=-(_t=180),xe=-(Re=90)}};function Rd(t,e){si.push(Kn=[bt=t,_t=t]),e<xe&&(xe=e),e>Re&&(Re=e)}function X5(t,e){var n=fB([t*ne,e*ne]);if(jr){var i=G2(jr,n),r=[i[1],-i[0],0],a=G2(r,i);cB(a),a=lB(a);var o=t-Ui,u=o>0?1:-1,s=a[0]*Mo*u,l,f=hm(o)>180;f^(u*Ui<s&&s<u*t)?(l=a[1]*Mo,l>Re&&(Re=l)):(s=(s+360)%360-180,f^(u*Ui<s&&s<u*t)?(l=-a[1]*Mo,l<xe&&(xe=l)):(e<xe&&(xe=e),e>Re&&(Re=e))),f?t<Ui?Te(bt,t)>Te(bt,_t)&&(_t=t):Te(t,_t)>Te(bt,_t)&&(bt=t):_t>=bt?(t<bt&&(bt=t),t>_t&&(_t=t)):t>Ui?Te(bt,t)>Te(bt,_t)&&(_t=t):Te(t,_t)>Te(bt,_t)&&(bt=t)}else si.push(Kn=[bt=t,_t=t]);e<xe&&(xe=e),e>Re&&(Re=e),jr=n,Ui=t}function V2(){jn.point=X5}function X2(){Kn[0]=bt,Kn[1]=_t,jn.point=Rd,jr=null}function K5(t,e){if(jr){var n=t-Ui;ko.add(hm(n)>180?n+(n>0?360:-360):n)}else G5=t,V5=e;Tn.point(t,e),X5(t,e)}function hB(){Tn.lineStart()}function dB(){K5(G5,V5),Tn.lineEnd(),hm(ko)>pl&&(bt=-(_t=180)),Kn[0]=bt,Kn[1]=_t,jr=null}function Te(t,e){return(e-=t)<0?e+360:e}function gB(t,e){return t[0]-e[0]}function K2(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function mB(t){var e,n,i,r,a,o,u;if(Re=_t=-(bt=xe=1/0),si=[],gm(t,jn),n=si.length){for(si.sort(gB),e=1,i=si[0],a=[i];e<n;++e)r=si[e],K2(i,r[0])||K2(i,r[1])?(Te(i[0],r[1])>Te(i[0],i[1])&&(i[1]=r[1]),Te(r[0],i[1])>Te(i[0],i[1])&&(i[0]=r[0])):a.push(i=r);for(o=-1/0,n=a.length-1,e=0,i=a[n];e<=n;i=r,++e)r=a[e],(u=Te(i[1],r[0]))>o&&(o=u,bt=r[0],_t=i[1])}return si=Kn=null,bt===1/0||xe===1/0?[[NaN,NaN],[NaN,NaN]]:[[bt,xe],[_t,Re]]}var fo,bl,wl,_l,Ml,kl,Al,El,Nd,Od,zd,Z5,J5,se,le,fe,ln={sphere:lo,point:mm,lineStart:Z2,lineEnd:J2,polygonStart:function(){ln.lineStart=vB,ln.lineEnd=xB},polygonEnd:function(){ln.lineStart=Z2,ln.lineEnd=J2}};function mm(t,e){t*=ne,e*=ne;var n=ge(e);Cu(n*ge(t),n*me(t),me(e))}function Cu(t,e,n){++fo,wl+=(t-wl)/fo,_l+=(e-_l)/fo,Ml+=(n-Ml)/fo}function Z2(){ln.point=pB}function pB(t,e){t*=ne,e*=ne;var n=ge(e);se=n*ge(t),le=n*me(t),fe=me(e),ln.point=yB,Cu(se,le,fe)}function yB(t,e){t*=ne,e*=ne;var n=ge(e),i=n*ge(t),r=n*me(t),a=me(e),o=Rf(j5((o=le*a-fe*r)*o+(o=fe*i-se*a)*o+(o=se*r-le*i)*o),se*i+le*r+fe*a);bl+=o,kl+=o*(se+(se=i)),Al+=o*(le+(le=r)),El+=o*(fe+(fe=a)),Cu(se,le,fe)}function J2(){ln.point=mm}function vB(){ln.point=bB}function xB(){Q5(Z5,J5),ln.point=mm}function bB(t,e){Z5=t,J5=e,t*=ne,e*=ne,ln.point=Q5;var n=ge(e);se=n*ge(t),le=n*me(t),fe=me(e),Cu(se,le,fe)}function Q5(t,e){t*=ne,e*=ne;var n=ge(e),i=n*ge(t),r=n*me(t),a=me(e),o=le*a-fe*r,u=fe*i-se*a,s=se*r-le*i,l=Dd(o,u,s),f=dm(l),c=l&&-f/l;Nd.add(c*o),Od.add(c*u),zd.add(c*s),bl+=f,kl+=f*(se+(se=i)),Al+=f*(le+(le=r)),El+=f*(fe+(fe=a)),Cu(se,le,fe)}function wB(t){fo=bl=wl=_l=Ml=kl=Al=El=0,Nd=new _i,Od=new _i,zd=new _i,gm(t,ln);var e=+Nd,n=+Od,i=+zd,r=Dd(e,n,i);return r<U2&&(e=kl,n=Al,i=El,bl<pl&&(e=wl,n=_l,i=Ml),r=Dd(e,n,i),r<U2)?[NaN,NaN]:[Rf(n,e)*Mo,dm(i/r)*Mo]}function Du(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Nf(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function xr(){}var Vo=.7,Cl=1/Vo,Yr="\\s*([+-]?\\d+)\\s*",Xo="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Dn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_B=/^#([0-9a-f]{3,8})$/,MB=new RegExp("^rgb\\("+[Yr,Yr,Yr]+"\\)$"),kB=new RegExp("^rgb\\("+[Dn,Dn,Dn]+"\\)$"),AB=new RegExp("^rgba\\("+[Yr,Yr,Yr,Xo]+"\\)$"),EB=new RegExp("^rgba\\("+[Dn,Dn,Dn,Xo]+"\\)$"),CB=new RegExp("^hsl\\("+[Xo,Dn,Dn]+"\\)$"),DB=new RegExp("^hsla\\("+[Xo,Dn,Dn,Xo]+"\\)$"),Q2={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Du(xr,pm,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:tv,formatHex:tv,formatHsl:SB,formatRgb:ev,toString:ev});function tv(){return this.rgb().formatHex()}function SB(){return ek(this).formatHsl()}function ev(){return this.rgb().formatRgb()}function pm(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=_B.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?nv(e):n===3?new he(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?is(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?is(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=MB.exec(t))?new he(e[1],e[2],e[3],1):(e=kB.exec(t))?new he(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=AB.exec(t))?is(e[1],e[2],e[3],e[4]):(e=EB.exec(t))?is(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=CB.exec(t))?av(e[1],e[2]/100,e[3]/100,1):(e=DB.exec(t))?av(e[1],e[2]/100,e[3]/100,e[4]):Q2.hasOwnProperty(t)?nv(Q2[t]):t==="transparent"?new he(NaN,NaN,NaN,0):null}function nv(t){return new he(t>>16&255,t>>8&255,t&255,1)}function is(t,e,n,i){return i<=0&&(t=e=n=NaN),new he(t,e,n,i)}function tk(t){return t instanceof xr||(t=pm(t)),t?(t=t.rgb(),new he(t.r,t.g,t.b,t.opacity)):new he}function ym(t,e,n,i){return arguments.length===1?tk(t):new he(t,e,n,i==null?1:i)}function he(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}Du(he,ym,Nf(xr,{brighter:function(t){return t=t==null?Cl:Math.pow(Cl,t),new he(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?Vo:Math.pow(Vo,t),new he(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:iv,formatHex:iv,formatRgb:rv,toString:rv}));function iv(){return"#"+Yc(this.r)+Yc(this.g)+Yc(this.b)}function rv(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function Yc(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function av(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new kn(t,e,n,i)}function ek(t){if(t instanceof kn)return new kn(t.h,t.s,t.l,t.opacity);if(t instanceof xr||(t=pm(t)),!t)return new kn;if(t instanceof kn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,u=a-r,s=(a+r)/2;return u?(e===a?o=(n-i)/u+(n<i)*6:n===a?o=(i-e)/u+2:o=(e-n)/u+4,u/=s<.5?a+r:2-a-r,o*=60):u=s>0&&s<1?0:o,new kn(o,u,s,t.opacity)}function nk(t,e,n,i){return arguments.length===1?ek(t):new kn(t,e,n,i==null?1:i)}function kn(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}Du(kn,nk,Nf(xr,{brighter:function(t){return t=t==null?Cl:Math.pow(Cl,t),new kn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?Vo:Math.pow(Vo,t),new kn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new he(Hc(t>=240?t-240:t+120,r,i),Hc(t,r,i),Hc(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function Hc(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const FB=Math.PI/180,$B=180/Math.PI,Dl=18,ik=.96422,rk=1,ak=.82521,ok=4/29,Hr=6/29,uk=3*Hr*Hr,TB=Hr*Hr*Hr;function sk(t){if(t instanceof Sn)return new Sn(t.l,t.a,t.b,t.opacity);if(t instanceof Gn)return ck(t);t instanceof he||(t=tk(t));var e=Xc(t.r),n=Xc(t.g),i=Xc(t.b),r=Wc((.2225045*e+.7168786*n+.0606169*i)/rk),a,o;return e===n&&n===i?a=o=r:(a=Wc((.4360747*e+.3850649*n+.1430804*i)/ik),o=Wc((.0139322*e+.0971045*n+.7141733*i)/ak)),new Sn(116*r-16,500*(a-r),200*(r-o),t.opacity)}function lk(t,e,n,i){return arguments.length===1?sk(t):new Sn(t,e,n,i==null?1:i)}function Sn(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}Du(Sn,lk,Nf(xr,{brighter:function(t){return new Sn(this.l+Dl*(t==null?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Sn(this.l-Dl*(t==null?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=ik*Gc(e),t=rk*Gc(t),n=ak*Gc(n),new he(Vc(3.1338561*e-1.6168667*t-.4906146*n),Vc(-.9787684*e+1.9161415*t+.033454*n),Vc(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function Wc(t){return t>TB?Math.pow(t,1/3):t/uk+ok}function Gc(t){return t>Hr?t*t*t:uk*(t-ok)}function Vc(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Xc(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function RB(t){if(t instanceof Gn)return new Gn(t.h,t.c,t.l,t.opacity);if(t instanceof Sn||(t=sk(t)),t.a===0&&t.b===0)return new Gn(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*$B;return new Gn(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function fk(t,e,n,i){return arguments.length===1?RB(t):new Gn(t,e,n,i==null?1:i)}function Gn(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}function ck(t){if(isNaN(t.h))return new Sn(t.l,0,0,t.opacity);var e=t.h*FB;return new Sn(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Du(Gn,fk,Nf(xr,{brighter:function(t){return new Gn(this.h,this.c,this.l+Dl*(t==null?1:t),this.opacity)},darker:function(t){return new Gn(this.h,this.c,this.l-Dl*(t==null?1:t),this.opacity)},rgb:function(){return ck(this).rgb()}}));function NB(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function OB(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=zB(t));function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=i(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:i,center:a,right:r}}function zB(t){return(e,n)=>NB(t(e),n)}const vm="intersect",ov="union",BB="vlMulti",LB="vlPoint",uv="or",PB="and",IB="_vgsid_",UB="E",qB="R",jB="R-E",YB="R-LE",HB="R-RE",Sl="index:unit";function sv(t,e){for(var n=e.fields,i=e.values,r=n.length,a=0,o,u;a<r;++a)if(u=n[a],u.getter=ke.getter||ke(u.field),o=u.getter(t),xi(o)&&(o=Kt(o)),xi(i[a])&&(i[a]=Kt(i[a])),xi(i[a][0])&&(i[a]=i[a].map(Kt)),u.type===UB){if(Y(i[a])?i[a].indexOf(o)<0:o!==i[a])return!1}else if(u.type===qB){if(!Rr(o,i[a]))return!1}else if(u.type===HB){if(!Rr(o,i[a],!0,!1))return!1}else if(u.type===jB){if(!Rr(o,i[a],!1,!1))return!1}else if(u.type===YB&&!Rr(o,i[a],!1,!0))return!1;return!0}function WB(t,e,n){for(var i=this.context.data[t],r=i?i.values.value:[],a=i?i[Sl]&&i[Sl].value:void 0,o=n===vm,u=r.length,s=0,l,f,c,h,d;s<u;++s)if(l=r[s],a&&o){if(f=f||{},c=f[h=l.unit]||0,c===-1)continue;if(d=sv(e,l),f[h]=d?-1:++c,d&&a.size===1)return!0;if(!d&&c===a.get(h).count)return!1}else if(d=sv(e,l),o^d)return d;return u&&o}const Bd=ke(IB),hk=OB(Bd),GB=hk.left,VB=hk.right;function XB(t,e,n){const i=this.context.data[t],r=i?i.values.value:[],a=i?i[Sl]&&i[Sl].value:void 0,o=n===vm,u=Bd(e),s=GB(r,u);if(s===r.length||Bd(r[s])!==u)return!1;if(a&&o){if(a.size===1)return!0;if(VB(r,u)-s<a.size)return!1}return!0}function KB(t,e){return t.map(n=>Z({values:e.fields.map(i=>(i.getter||(i.getter=ke(i.field)))(n.datum))},e))}function ZB(t,e,n,i){for(var r=this.context.data[t],a=r?r.values.value:[],o={},u={},s={},l,f,c,h,d,g,m,p,y,v=a.length,x=0,b,_;x<v;++x){for(l=a[x],h=l.unit,f=l.fields,c=l.values,b=0,_=f.length;b<_;++b)d=f[b],g=o[d.field]||(o[d.field]={}),m=g[h]||(g[h]=[]),s[d.field]=p=d.type.charAt(0),y=lv[p+"_union"],g[h]=y(m,G(c[b]));n&&(m=u[h]||(u[h]=[]),m.push(G(c).reduce((M,w,k)=>(M[f[k].field]=w,M),{})))}if(e=e||ov,Object.keys(o).forEach(M=>{o[M]=Object.keys(o[M]).map(w=>o[M][w]).reduce((w,k)=>w===void 0?k:lv[s[M]+"_"+e](w,k))}),a=Object.keys(u),n&&a.length){const M=i?LB:BB;o[M]=e===ov?{[uv]:a.reduce((w,k)=>(w.push(...u[k]),w),[])}:{[PB]:a.map(w=>({[uv]:u[w]}))}}return o}var lv={E_union:function(t,e){if(!t.length)return e;for(var n=0,i=e.length;n<i;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter(n=>e.indexOf(n)>=0):e},R_union:function(t,e){var n=Kt(e[0]),i=Kt(e[1]);return n>i&&(n=e[1],i=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<i&&(t[1]=i),t):[n,i]},R_intersect:function(t,e){var n=Kt(e[0]),i=Kt(e[1]);return n>i&&(n=e[1],i=e[0]),t.length?i<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>i&&(t[1]=i),t):[n,i]}};const JB=":",QB="@";function xm(t,e,n,i){e[0].type!==ir&&R("First argument to selection functions must be a string literal.");const r=e[0].value,a=e.length>=2&&it(e).value,o="unit",u=QB+o,s=JB+r;a===vm&&!V(i,u)&&(i[u]=n.getData(r).indataRef(n,o)),V(i,s)||(i[s]=n.getData(r).tuplesRef())}function dk(t){const e=this.context.data[t];return e?e.values.value:[]}function tL(t,e,n){const i=this.context.data[t]["index:"+e],r=i?i.value.get(n):void 0;return r&&r.count}function eL(t,e){const n=this.context.dataflow,i=this.context.data[t],r=i.input;return n.pulse(r,n.changeset().remove(Xe).insert(e)),1}function nL(t,e,n){if(t){const i=this.context.dataflow,r=t.mark.source;i.pulse(r,i.changeset().encode(t,e))}return n!==void 0?n:t}const Su=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},iL=Su("format"),gk=Su("timeFormat"),rL=Su("utcFormat"),aL=Su("timeParse"),oL=Su("utcParse"),rs=new Date(2e3,0,1);function Of(t,e,n){return!Number.isInteger(t)||!Number.isInteger(e)?"":(rs.setYear(2e3),rs.setMonth(t),rs.setDate(e),gk.call(this,rs,n))}function uL(t){return Of.call(this,t,1,"%B")}function sL(t){return Of.call(this,t,1,"%b")}function lL(t){return Of.call(this,0,2+t,"%A")}function fL(t){return Of.call(this,0,2+t,"%a")}const cL=":",hL="@",Ld="%",mk="$";function bm(t,e,n,i){e[0].type!==ir&&R("First argument to data functions must be a string literal.");const r=e[0].value,a=cL+r;if(!V(a,i))try{i[a]=n.getData(r).tuplesRef()}catch{}}function dL(t,e,n,i){e[0].type!==ir&&R("First argument to indata must be a string literal."),e[1].type!==ir&&R("Second argument to indata must be a string literal.");const r=e[0].value,a=e[1].value,o=hL+a;V(o,i)||(i[o]=n.getData(r).indataRef(n,a))}function Me(t,e,n,i){if(e[0].type===ir)fv(n,i,e[0].value);else for(t in n.scales)fv(n,i,t)}function fv(t,e,n){const i=Ld+n;if(!V(e,i))try{e[i]=t.scaleRef(n)}catch{}}function ti(t,e){let n;return Q(t)?t:vt(t)?(n=e.scales[t])&&n.value:void 0}function gL(t,e,n){e.__bandwidth=r=>r&&r.bandwidth?r.bandwidth():0,n._bandwidth=Me,n._range=Me,n._scale=Me;const i=r=>"_["+(r.type===ir?H(Ld+r.value):H(Ld)+"+"+t(r))+"]";return{_bandwidth:r=>"this.__bandwidth(".concat(i(r[0]),")"),_range:r=>"".concat(i(r[0]),".range()"),_scale:r=>"".concat(i(r[0]),"(").concat(t(r[1]),")")}}function wm(t,e){return function(n,i,r){if(n){const a=ti(n,(r||this).context);return a&&a.path[t](i)}else return e(i)}}const mL=wm("area",sB),pL=wm("bounds",mB),yL=wm("centroid",wB);function vL(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n}function _m(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(i){t.warn(i)}return n[n.length-1]}function xL(){return _m(this.context.dataflow,"warn",arguments)}function bL(){return _m(this.context.dataflow,"info",arguments)}function wL(){return _m(this.context.dataflow,"debug",arguments)}function Kc(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Pd(t){const e=ym(t),n=Kc(e.r),i=Kc(e.g),r=Kc(e.b);return .2126*n+.7152*i+.0722*r}function _L(t,e){const n=Pd(t),i=Pd(e),r=Math.max(n,i),a=Math.min(n,i);return(r+.05)/(a+.05)}function ML(){const t=[].slice.call(arguments);return t.unshift({}),Z(...t)}function pk(t,e){return t===e||t!==t&&e!==e?!0:Y(t)?Y(e)&&t.length===e.length?kL(t,e):!1:J(t)&&J(e)?yk(t,e):!1}function kL(t,e){for(let n=0,i=t.length;n<i;++n)if(!pk(t[n],e[n]))return!1;return!0}function yk(t,e){for(const n in t)if(!pk(t[n],e[n]))return!1;return!0}function cv(t){return e=>yk(t,e)}function AL(t,e,n,i,r,a){const o=this.context.dataflow,u=this.context.data[t],s=u.input,l=o.stamp();let f=u.changes,c,h;if(o._trigger===!1||!(s.value.length||e||i))return 0;if((!f||f.stamp<l)&&(u.changes=f=o.changeset(),f.stamp=l,o.runAfter(()=>{u.modified=!0,o.pulse(s,f).run()},!0,1)),n&&(c=n===!0?Xe:Y(n)||Yl(n)?n:cv(n),f.remove(c)),e&&f.insert(e),i&&(c=cv(i),s.value.some(c)?f.remove(c):f.insert(i)),r)for(h in a)f.modify(r,h,a[h]);return 1}function EL(t){const e=t.touches,n=e[0].clientX-e[1].clientX,i=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+i*i)}function CL(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)}const hv={};function DL(t,e){const n=hv[e]||(hv[e]=ke(e));return Y(t)?t.map(n):n(t)}function Mm(t){return Y(t)||ArrayBuffer.isView(t)?t:null}function km(t){return Mm(t)||(vt(t)?t:null)}function SL(t,...e){return Mm(t).join(...e)}function FL(t,...e){return km(t).indexOf(...e)}function $L(t,...e){return km(t).lastIndexOf(...e)}function TL(t,...e){return km(t).slice(...e)}function RL(t,e,n){return Q(n)&&R("Function argument passed to replace."),String(t).replace(e,n)}function NL(t){return Mm(t).slice().reverse()}function OL(t,e,n){return Dg(t||0,e||0,n||0)}function zL(t,e){const n=ti(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}function BL(t,e){const n=ti(t,(e||this).context);return n?n.copy():void 0}function LL(t,e){const n=ti(t,(e||this).context);return n?n.domain():[]}function PL(t,e,n){const i=ti(t,(n||this).context);return i?Y(e)?(i.invertRange||i.invert)(e):(i.invert||i.invertExtent)(e):void 0}function IL(t,e){const n=ti(t,(e||this).context);return n&&n.range?n.range():[]}function UL(t,e,n){const i=ti(t,(n||this).context);return i?i(e):void 0}function qL(t,e,n,i,r){t=ti(t,(r||this).context);const a=J_(e,n);let o=t.domain(),u=o[0],s=it(o),l=de;return s-u?l=I_(t,u,s):t=(t.interpolator?st("sequential")().interpolator(t.interpolator()):st("linear")().interpolate(t.interpolate()).range(t.range())).domain([u=0,s=1]),t.ticks&&(o=t.ticks(+i||15),u!==o[0]&&o.unshift(u),s!==it(o)&&o.push(s)),o.forEach(f=>a.stop(l(f),t(f))),a}function jL(t,e,n){const i=ti(t,(n||this).context);return function(r){return i?i.path.context(r)(e):""}}function YL(t){let e=null;return function(n){return n?Bo(n,e=e||ta(t)):t}}const vk=t=>t.data;function xk(t,e){const n=dk.call(e,t);return n.root&&n.root.lookup||{}}function HL(t,e,n){const i=xk(t,this),r=i[e],a=i[n];return r&&a?r.path(a).map(vk):void 0}function WL(t,e){const n=xk(t,this)[e];return n?n.ancestors().map(vk):void 0}const bk=()=>typeof window!="undefined"&&window||null;function GL(){const t=bk();return t?t.screen:{}}function VL(){const t=bk();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]}function XL(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]}function KL(t,e,n){if(!t)return[];const[i,r]=t,a=new Ft().set(i[0],i[1],r[0],r[1]),o=n||this.context.dataflow.scenegraph().root;return q3(o,a,ZL(e))}function ZL(t){let e=null;if(t){const n=G(t.marktype),i=G(t.markname);e=r=>(!n.length||n.some(a=>r.marktype===a))&&(!i.length||i.some(a=>r.name===a))}return e}const Ko={random(){return Ze()},cumulativeNormal:Xl,cumulativeLogNormal:F0,cumulativeUniform:N0,densityNormal:A0,densityLogNormal:S0,densityUniform:R0,quantileNormal:Kl,quantileLogNormal:$0,quantileUniform:O0,sampleNormal:Vl,sampleLogNormal:D0,sampleUniform:T0,isArray:Y,isBoolean:mx,isDate:xi,isDefined(t){return t!==void 0},isNumber:Mi,isObject:J,isRegExp:yx,isString:vt,isTuple:Yl,isValid(t){return t!=null&&t===t},toBoolean:o0,toDate:u0,toNumber:Kt,toString:s0,indexof:FL,join:SL,lastindexof:$L,replace:RL,reverse:NL,slice:TL,flush:gx,lerp:vx,merge:ML,pad:wx,peek:it,pluck:DL,span:nu,inrange:Rr,truncate:_x,rgb:ym,lab:lk,hcl:fk,hsl:nk,luminance:Pd,contrast:_L,sequence:rB,format:iL,utcFormat:rL,utcParse:oL,utcOffset:Qx,utcSequence:nb,timeFormat:gk,timeParse:aL,timeOffset:Jx,timeSequence:eb,timeUnitSpecifier:Ux,monthFormat:uL,monthAbbrevFormat:sL,dayFormat:lL,dayAbbrevFormat:fL,quarter:fx,utcquarter:cx,week:jx,utcweek:Wx,dayofyear:qx,utcdayofyear:Hx,warn:xL,info:bL,debug:wL,extent:Fn,inScope:vL,intersect:KL,clampRange:hx,pinchDistance:EL,pinchAngle:CL,screen:GL,containerSize:XL,windowSize:VL,bandspace:OL,setdata:eL,pathShape:YL,panLinear:ox,panLog:ux,panPow:sx,panSymlog:lx,zoomLinear:t0,zoomLog:e0,zoomPow:Ts,zoomSymlog:n0,encode:nL,modify:AL},JL=["view","item","group","xy","x","y"],QL="event.vega.",wk="this.",Am={},_k={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(H(mk+t),"]"),functions:tP,constants:P5,visitors:Am},Id=U5(_k);function tP(t){const e=I5(t);JL.forEach(n=>e[n]=QL+n);for(const n in Ko)e[n]=wk+n;return Z(e,gL(t,Ko,Am)),e}function Et(t,e,n){return arguments.length===1?Ko[t]:(Ko[t]=e,n&&(Am[t]=n),Id&&(Id.functions[t]=wk+t),this)}Et("bandwidth",zL,Me);Et("copy",BL,Me);Et("domain",LL,Me);Et("range",IL,Me);Et("invert",PL,Me);Et("scale",UL,Me);Et("gradient",qL,Me);Et("geoArea",mL,Me);Et("geoBounds",pL,Me);Et("geoCentroid",yL,Me);Et("geoShape",jL,Me);Et("indata",tL,dL);Et("data",dk,bm);Et("treePath",HL,bm);Et("treeAncestors",WL,bm);Et("vlSelectionTest",WB,xm);Et("vlSelectionIdTest",XB,xm);Et("vlSelectionResolve",ZB,xm);Et("vlSelectionTuples",KB);function Rn(t,e){const n={};let i;try{t=vt(t)?t:H(t)+"",i=L5(t)}catch{R("Expression parse error: "+t)}i.visit(a=>{if(a.type!==$5)return;const o=a.callee.name,u=_k.visitors[o];u&&u(o,a.arguments,e,n)});const r=Id(i);return r.globals.forEach(a=>{const o=mk+a;!V(n,o)&&e.getSignal(a)&&(n[o]=e.signalRef(a))}),{$expr:Z({code:r.code},e.options.ast?{ast:i}:null),$fields:r.fields,$params:n}}function eP(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach(i=>e.parseOperator(i)),n.forEach(i=>e.parseOperatorParameters(i)),(t.streams||[]).forEach(i=>e.parseStream(i)),(t.updates||[]).forEach(i=>e.parseUpdate(i)),e.resolve()}const nP=cn(["rule"]),dv=cn(["group","image","rect"]);function iP(t,e){let n="";return nP[e]||(t.x2&&(t.x?(dv[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(dv[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function Em(t){return(t+"").toLowerCase()}function rP(t){return Em(t)==="operator"}function aP(t){return Em(t)==="collect"}function Ia(t,e,n){n[n.length-1]!==";"&&(n="return("+n+");");const i=Function(...e.concat(n));return t&&t.functions?i.bind(t.functions):i}function oP(t,e,n,i){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(i,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(i," : ")}var uP={operator:(t,e)=>Ia(t,["_"],e.code),parameter:(t,e)=>Ia(t,["datum","_"],e.code),event:(t,e)=>Ia(t,["event"],e.code),handler:(t,e)=>{const n="var datum=event.item&&event.item.datum;return ".concat(e.code,";");return Ia(t,["_","event"],n)},encode:(t,e)=>{const{marktype:n,channels:i}=e;let r="var o=item,datum=o.datum,m=0,$;";for(const a in i){const o="o["+H(a)+"]";r+="$=".concat(i[a].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return r+=iP(i,n),r+="return m;",Ia(t,["item","_"],r)},codegen:{get(t){const e="[".concat(t.map(H).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const i=(a,o)=>{const u=e[o];let s,l;return a.path?(s="a".concat(a.path),l="b".concat(a.path)):((n=n||{})["f"+o]=a,s="this.f".concat(o,"(a)"),l="this.f".concat(o,"(b)")),oP(s,l,-u,u)},r=Function("a","b","var u, v; return "+t.map(i).join("")+"0;");return n?r.bind(n):r}}};function sP(t){const e=this;rP(t.type)||!t.type?e.operator(t,t.update?e.operatorExpression(t.update):null):e.transform(t,t.type)}function lP(t){const e=this;if(t.params){const n=e.get(t.id);n||R("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}}function fP(t,e){e=e||{};const n=this;for(const i in t){const r=t[i];e[i]=Y(r)?r.map(a=>gv(a,n,e)):gv(r,n,e)}return e}function gv(t,e,n){if(!t||!J(t))return t;for(let i=0,r=mv.length,a;i<r;++i)if(a=mv[i],V(t,a.key))return a.parse(t,e,n);return t}var mv=[{key:"$ref",parse:cP},{key:"$key",parse:dP},{key:"$expr",parse:hP},{key:"$field",parse:gP},{key:"$encode",parse:pP},{key:"$compare",parse:mP},{key:"$context",parse:yP},{key:"$subflow",parse:vP},{key:"$tupleid",parse:xP}];function cP(t,e){return e.get(t.$ref)||R("Operator not defined: "+t.$ref)}function hP(t,e,n){t.$params&&e.parseParameters(t.$params,n);const i="e:"+t.$expr.code+"_"+t.$name;return e.fn[i]||(e.fn[i]=De(e.parameterExpression(t.$expr),t.$fields,t.$name))}function dP(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=a0(t.$key,t.$flat,e.expr.codegen))}function gP(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=ke(t.$field,t.$name,e.expr.codegen))}function mP(t,e){const n="c:"+t.$compare+"_"+t.$order,i=G(t.$compare).map(r=>r&&r.$tupleid?j:r);return e.fn[n]||(e.fn[n]=i0(i,t.$order,e.expr.codegen))}function pP(t,e){const n=t.$encode,i={};for(const r in n){const a=n[r];i[r]=De(e.encodeExpression(a.$expr),a.$fields),i[r].output=a.$output}return i}function yP(t,e){return e}function vP(t,e){const n=t.$subflow;return function(i,r,a){const o=e.fork().parse(n),u=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(a),u.detachSubflow=()=>e.detach(o),u}}function xP(){return j}function bP(t){var e=this,n=t.filter!=null?e.eventExpression(t.filter):void 0,i=t.stream!=null?e.get(t.stream):void 0,r;t.source?i=e.events(t.source,t.type,n):t.merge&&(r=t.merge.map(a=>e.get(a)),i=r[0].merge.apply(r[0],r.slice(1))),t.between&&(r=t.between.map(a=>e.get(a)),i=i.between(r[0],r[1])),t.filter&&(i=i.filter(n)),t.throttle!=null&&(i=i.throttle(+t.throttle)),t.debounce!=null&&(i=i.debounce(+t.debounce)),i==null&&R("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),e.stream(t,i)}function wP(t){var e=this,n=J(n=t.source)?n.$ref:n,i=e.get(n),r=null,a=t.update,o=void 0;i||R("Source not defined: "+t.source),r=t.target&&t.target.$expr?e.eventExpression(t.target.$expr):e.get(t.target),a&&a.$expr&&(a.$params&&(o=e.parseParameters(a.$params)),a=e.handlerExpression(a.$expr)),e.update(t,i,r,a,o)}const _P={skip:!0};function MP(t){var e=this,n={};if(t.signals){var i=n.signals={};Object.keys(e.signals).forEach(a=>{const o=e.signals[a];t.signals(a,o)&&(i[a]=o.value)})}if(t.data){var r=n.data={};Object.keys(e.data).forEach(a=>{const o=e.data[a];t.data(a,o)&&(r[a]=o.input.value)})}return e.subcontext&&t.recurse!==!1&&(n.subcontext=e.subcontext.map(a=>a.getState(t))),n}function kP(t){var e=this,n=e.dataflow,i=t.data,r=t.signals;Object.keys(r||{}).forEach(a=>{n.update(e.signals[a],r[a],_P)}),Object.keys(i||{}).forEach(a=>{n.pulse(e.data[a].input,n.changeset().remove(Xe).insert(i[a]))}),(t.subcontext||[]).forEach((a,o)=>{const u=e.subcontext[o];u&&u.setState(a)})}function Mk(t,e,n,i){return new kk(t,e,n,i)}function kk(t,e,n,i){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=i||uP,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function pv(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}kk.prototype=pv.prototype={fork(){const t=new pv(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter(n=>n!==t);const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,i=n.dataflow,r=t.value;if(n.set(t.id,e),aP(t.type)&&r&&(r.$ingest?i.ingest(e,r.$ingest,r.$format):r.$request?i.preload(e,r.$request,r.$format):i.pulse(e,i.changeset().insert(r))),t.root&&(n.root=e),t.parent){let a=n.get(t.parent.$ref);a?(i.connect(a,[e]),e.targets().add(a)):(n.unresolved=n.unresolved||[]).push(()=>{a=n.get(t.parent.$ref),i.connect(a,[e]),e.targets().add(a)})}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const a in t.data){const o=n.data[a]||(n.data[a]={});t.data[a].forEach(u=>o[u]=e)}},resolve(){return(this.unresolved||[]).forEach(t=>t()),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[Em(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,i,r){this.dataflow.on(e,n,i,r,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:eP,parseOperator:sP,parseOperatorParameters:lP,parseParameters:fP,parseStream:bP,parseUpdate:wP,getState:MP,setState:kP};var sa=0,co=0,Ua=0,Ak=1e3,Fl,ho,$l=0,or=0,zf=0,Zo=typeof performance=="object"&&performance.now?performance:Date,Ek=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Cm(){return or||(Ek(AP),or=Zo.now()+zf)}function AP(){or=0}function Ud(){this._call=this._time=this._next=null}Ud.prototype={constructor:Ud,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Cm():+n)+(e==null?0:+e),!this._next&&ho!==this&&(ho?ho._next=this:Fl=this,ho=this),this._call=t,this._time=n,qd()},stop:function(){this._call&&(this._call=null,this._time=1/0,qd())}};function EP(){Cm(),++sa;for(var t=Fl,e;t;)(e=or-t._time)>=0&&t._call.call(null,e),t=t._next;--sa}function yv(){or=($l=Zo.now())+zf,sa=co=0;try{EP()}finally{sa=0,DP(),or=0}}function CP(){var t=Zo.now(),e=t-$l;e>Ak&&(zf-=e,$l=t)}function DP(){for(var t,e=Fl,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Fl=n);ho=t,qd(i)}function qd(t){if(!sa){co&&(co=clearTimeout(co));var e=t-or;e>24?(t<1/0&&(co=setTimeout(yv,t-Zo.now()-zf)),Ua&&(Ua=clearInterval(Ua))):(Ua||($l=Zo.now(),Ua=setInterval(CP,Ak)),sa=1,Ek(yv))}}function SP(t,e,n){var i=new Ud,r=e;return e==null?(i.restart(t,e,n),i):(i._restart=i.restart,i.restart=function(a,o,u){o=+o,u=u==null?Cm():+u,i._restart(function s(l){l+=r,i._restart(s,r+=o,u),a(l)},o,u)},i.restart(t,e,n),i)}function FP(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),Ck(e,t.description()))}function Ck(t,e){t&&(e==null?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}function $P(t){t.add(null,e=>(t._background=e.bg,t._resize=1,e.bg),{bg:t._signals.background})}const Zc="default";function TP(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:Zc,item:null}));t.on(t.events("view","mousemove"),e,(n,i)=>{const r=e.value,a=r?vt(r)?r:r.user:Zc,o=i.item&&i.item.cursor||null;return r&&a===r.user&&o==r.item?r:{user:a,item:o}}),t.add(null,function(n){let i=n.cursor,r=this.value;return vt(i)||(r=i.item,i=i.user),jd(t,i&&i!==Zc?i:r||i),r},{cursor:e})}function jd(t,e){const n=t.globalCursor()?typeof document!="undefined"&&document.body:t.container();if(n)return e==null?n.style.removeProperty("cursor"):n.style.cursor=e}function Tl(t,e){var n=t._runtime.data;return V(n,e)||R("Unrecognized data set: "+e),n[e]}function RP(t,e){return arguments.length<2?Tl(this,t).values.value:Bf.call(this,t,cr().remove(Xe).insert(e))}function Bf(t,e){Eb(e)||R("Second argument to changes must be a changeset.");const n=Tl(this,t);return n.modified=!0,this.pulse(n.input,e)}function NP(t,e){return Bf.call(this,t,cr().insert(e))}function OP(t,e){return Bf.call(this,t,cr().remove(e))}function Dk(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function Sk(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function Lf(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function zP(t){var e=Lf(t),n=Dk(t),i=Sk(t);t._renderer.background(t.background()),t._renderer.resize(n,i,e),t._handler.origin(e),t._resizeListeners.forEach(r=>{try{r(n,i)}catch(a){t.error(a)}})}function BP(t,e,n){var i=t._renderer,r=i&&i.canvas(),a,o,u;return r&&(u=Lf(t),o=e.changedTouches?e.changedTouches[0]:e,a=_f(o,r),a[0]-=u[0],a[1]-=u[1]),e.dataflow=t,e.item=n,e.vega=LP(t,n,a),e}function LP(t,e,n){const i=e?e.mark.marktype==="group"?e:e.mark.group:null;function r(o){var u=i,s;if(o){for(s=e;s;s=s.mark.group)if(s.mark.name===o){u=s;break}}return u&&u.mark&&u.mark.interactive?u:{}}function a(o){if(!o)return n;vt(o)&&(o=r(o));const u=n.slice();for(;o;)u[0]-=o.x||0,u[1]-=o.y||0,o=o.mark&&o.mark.group;return u}return{view:ee(t),item:ee(e||{}),group:r,xy:a,x:o=>a(o)[0],y:o=>a(o)[1]}}const vv="view",PP="timer",IP="window",UP={trap:!1};function qP(t){const e=Z({defaults:{}},t),n=(i,r)=>{r.forEach(a=>{Y(i[a])&&(i[a]=cn(i[a]))})};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}function Fk(t,e,n,i){t._eventListeners.push({type:n,sources:G(e),handler:i})}function jP(t,e){var n=t._eventConfig.defaults,i=n.prevent,r=n.allow;return i===!1||r===!0?!1:i===!0||r===!1?!0:i?i[e]:r?!r[e]:t.preventDefault()}function as(t,e,n){const i=t._eventConfig&&t._eventConfig[e];return i===!1||J(i)&&!i[n]?(t.warn(`Blocked ${e} ${n} event listener.`),!1):!0}function YP(t,e,n){var i=this,r=new Gl(n),a=function(l,f){i.runAsync(null,()=>{t===vv&&jP(i,e)&&l.preventDefault(),r.receive(BP(i,l,f))})},o;if(t===PP)as(i,"timer",e)&&i.timer(a,e);else if(t===vv)as(i,"view",e)&&i.addEventListener(e,a,UP);else if(t===IP?as(i,"window",e)&&typeof window!="undefined"&&(o=[window]):typeof document!="undefined"&&as(i,"selector",e)&&(o=document.querySelectorAll(t)),!o)i.warn("Can not resolve event source: "+t);else{for(var u=0,s=o.length;u<s;++u)o[u].addEventListener(e,a);Fk(i,o,e,a)}return r}function xv(t){return t.item}function bv(t){return t.item.mark.source}function wv(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function HP(t,e){return t=[t||"hover"],e=[e||"update",t[0]],this.on(this.events("view","mouseover",xv),bv,wv(t)),this.on(this.events("view","mouseout",xv),bv,wv(e)),this}function WP(){var t=this._tooltip,e=this._timers,n=this._eventListeners,i,r,a;for(i=e.length;--i>=0;)e[i].stop();for(i=n.length;--i>=0;)for(a=n[i],r=a.sources.length;--r>=0;)a.sources[r].removeEventListener(a.type,a.handler);return t&&t.call(this,this._handler,null,null,null),this}function Oe(t,e,n){const i=document.createElement(t);for(const r in e)i.setAttribute(r,e[r]);return n!=null&&(i.textContent=n),i}const GP="vega-bind",VP="vega-bind-name",XP="vega-bind-radio";function KP(t,e,n){if(!e)return;const i=n.param;let r=n.state;return r||(r=n.state={elements:null,active:!1,set:null,update:o=>{o!=t.signal(i.signal)&&t.runAsync(null,()=>{r.source=!0,t.signal(i.signal,o)})}},i.debounce&&(r.update=r0(i.debounce,r.update))),(i.input==null&&i.element?ZP:QP)(r,e,i,t),r.active||(t.on(t._signals[i.signal],null,()=>{r.source?r.source=!1:r.set(t.signal(i.signal))}),r.active=!0),r}function ZP(t,e,n,i){const r=n.event||"input",a=()=>t.update(e.value);i.signal(n.signal,e.value),e.addEventListener(r,a),Fk(i,e,r,a),t.set=o=>{e.value=o,e.dispatchEvent(JP(r))}}function JP(t){return typeof Event!="undefined"?new Event(t):{type:t}}function QP(t,e,n,i){const r=i.signal(n.signal),a=Oe("div",{class:GP}),o=n.input==="radio"?a:a.appendChild(Oe("label"));o.appendChild(Oe("span",{class:VP},n.name||n.signal)),e.appendChild(a);let u=tI;switch(n.input){case"checkbox":u=eI;break;case"select":u=nI;break;case"radio":u=iI;break;case"range":u=rI;break}u(t,o,n,r)}function tI(t,e,n,i){const r=Oe("input");for(const a in n)a!=="signal"&&a!=="element"&&r.setAttribute(a==="input"?"type":a,n[a]);r.setAttribute("name",n.signal),r.value=i,e.appendChild(r),r.addEventListener("input",()=>t.update(r.value)),t.elements=[r],t.set=a=>r.value=a}function eI(t,e,n,i){const r={type:"checkbox",name:n.signal};i&&(r.checked=!0);const a=Oe("input",r);e.appendChild(a),a.addEventListener("change",()=>t.update(a.checked)),t.elements=[a],t.set=o=>a.checked=!!o||null}function nI(t,e,n,i){const r=Oe("select",{name:n.signal}),a=n.labels||[];n.options.forEach((o,u)=>{const s={value:o};Rl(o,i)&&(s.selected=!0),r.appendChild(Oe("option",s,(a[u]||o)+""))}),e.appendChild(r),r.addEventListener("change",()=>{t.update(n.options[r.selectedIndex])}),t.elements=[r],t.set=o=>{for(let u=0,s=n.options.length;u<s;++u)if(Rl(n.options[u],o)){r.selectedIndex=u;return}}}function iI(t,e,n,i){const r=Oe("span",{class:XP}),a=n.labels||[];e.appendChild(r),t.elements=n.options.map((o,u)=>{const s={type:"radio",name:n.signal,value:o};Rl(o,i)&&(s.checked=!0);const l=Oe("input",s);l.addEventListener("change",()=>t.update(o));const f=Oe("label",{},(a[u]||o)+"");return f.prepend(l),r.appendChild(f),l}),t.set=o=>{const u=t.elements,s=u.length;for(let l=0;l<s;++l)Rl(u[l].value,o)&&(u[l].checked=!0)}}function rI(t,e,n,i){i=i!==void 0?i:(+n.max+ +n.min)/2;const r=n.max!=null?n.max:Math.max(100,+i)||100,a=n.min||Math.min(0,r,+i)||0,o=n.step||KO(a,r,100),u=Oe("input",{type:"range",name:n.signal,min:a,max:r,step:o});u.value=i;const s=Oe("span",{},+i);e.appendChild(u),e.appendChild(s);const l=()=>{s.textContent=u.value,t.update(+u.value)};u.addEventListener("input",l),u.addEventListener("change",l),t.elements=[u],t.set=f=>{u.value=f,s.textContent=f}}function Rl(t,e){return t===e||t+""==e+""}function $k(t,e,n,i,r,a){return e=e||new i(t.loader()),e.initialize(n,Dk(t),Sk(t),Lf(t),r,a).background(t.background())}function Dm(t,e){return e?function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}:null}function aI(t,e,n,i){const r=new i(t.loader(),Dm(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,Lf(t),t);return e&&e.handlers().forEach(a=>{r.on(a.type,a.handler)}),r}function oI(t,e){const n=this,i=n._renderType,r=n._eventConfig.bind,a=Mf(i);t=n._el=t?Jc(n,t,!0):null,FP(n),a||n.error("Unrecognized renderer type: "+i);const o=a.handler||xu,u=t?a.renderer:a.headless;return n._renderer=u?$k(n,n._renderer,t,u):null,n._handler=aI(n,n._handler,t,o),n._redraw=!0,t&&r!=="none"&&(e=e?n._elBind=Jc(n,e,!0):t.appendChild(Oe("form",{class:"vega-bindings"})),n._bind.forEach(s=>{s.param.element&&r!=="container"&&(s.element=Jc(n,s.param.element,!!s.param.input))}),n._bind.forEach(s=>{KP(n,s.element||e,s)})),n}function Jc(t,e,n){if(typeof e=="string")if(typeof document!="undefined"){if(e=document.querySelector(e),!e)return t.error("Signal bind element not found: "+e),null}else return t.error("DOM document instance not found."),null;if(e&&n)try{e.innerHTML=""}catch(i){e=null,t.error(i)}return e}const qa=t=>+t||0,uI=t=>({top:t,bottom:t,left:t,right:t});function _v(t){return J(t)?{top:qa(t.top),bottom:qa(t.bottom),left:qa(t.left),right:qa(t.right)}:uI(qa(t))}async function Sm(t,e,n,i){const r=Mf(e),a=r&&r.headless;return a||R("Unrecognized renderer type: "+e),await t.runAsync(),$k(t,null,null,a,n,i).renderAsync(t._scenegraph.root)}async function sI(t,e){t!==gi.Canvas&&t!==gi.SVG&&t!==gi.PNG&&R("Unrecognized image type: "+t);const n=await Sm(this,t,e);return t===gi.SVG?lI(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function lI(t,e){const n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}async function fI(t,e){return(await Sm(this,gi.Canvas,t,e)).canvas()}async function cI(t){return(await Sm(this,gi.SVG,t)).svg()}function hI(t,e,n){return Mk(t,Xr,Ko,n).parse(e)}function dI(t){var e=this._runtime.scales;return V(e,t)||R("Unrecognized scale or projection: "+t),e[t].value}var Tk="width",Rk="height",Fm="padding",Mv={skip:!0};function Nk(t,e){var n=t.autosize(),i=t.padding();return e-(n&&n.contains===Fm?i.left+i.right:0)}function Ok(t,e){var n=t.autosize(),i=t.padding();return e-(n&&n.contains===Fm?i.top+i.bottom:0)}function gI(t){var e=t._signals,n=e[Tk],i=e[Rk],r=e[Fm];function a(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,u=>{t._width=u.size,t._viewWidth=Nk(t,u.size),a()},{size:n}),t._resizeHeight=t.add(null,u=>{t._height=u.size,t._viewHeight=Ok(t,u.size),a()},{size:i});const o=t.add(null,a,{pad:r});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=i.rank+1,o.rank=r.rank+1}function mI(t,e,n,i,r,a){this.runAfter(o=>{let u=0;o._autosize=0,o.width()!==n&&(u=1,o.signal(Tk,n,Mv),o._resizeWidth.skip(!0)),o.height()!==i&&(u=1,o.signal(Rk,i,Mv),o._resizeHeight.skip(!0)),o._viewWidth!==t&&(o._resize=1,o._viewWidth=t),o._viewHeight!==e&&(o._resize=1,o._viewHeight=e),(o._origin[0]!==r[0]||o._origin[1]!==r[1])&&(o._resize=1,o._origin=r),u&&o.run("enter"),a&&o.runAfter(s=>s.resize())},!1,1)}function pI(t){return this._runtime.getState(t||{data:yI,signals:vI,recurse:!0})}function yI(t,e){return e.modified&&Y(e.input.value)&&t.indexOf("_:vega:_")}function vI(t,e){return!(t==="parent"||e instanceof Xr.proxy)}function xI(t){return this.runAsync(null,e=>{e._trigger=!1,e._runtime.setState(t)},e=>{e._trigger=!0}),this}function bI(t,e){function n(i){t({timestamp:Date.now(),elapsed:i})}this._timers.push(SP(n,e))}function wI(t,e,n,i){const r=t.element();r&&r.setAttribute("title",_I(i))}function _I(t){return t==null?"":Y(t)?zk(t):J(t)&&!xi(t)?MI(t):t+""}function MI(t){return Object.keys(t).map(e=>{const n=t[e];return e+": "+(Y(n)?zk(n):Bk(n))}).join(`
`)}function zk(t){return"["+t.map(Bk).join(", ")+"]"}function Bk(t){return Y(t)?"[\u2026]":J(t)&&!xi(t)?"{\u2026}":t}function Lk(t,e){const n=this;if(e=e||{},Ur.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),e.logLevel!=null&&n.logLevel(e.logLevel),e.locale||t.locale){const a=Z({},t.locale,e.locale);n.locale(wb(a.number,a.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||gi.Canvas,n._scenegraph=new r1;const i=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||wI,n._redraw=!0,n._handler=new xu().scene(i),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=qP(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const r=hI(n,t,e.expr);n._runtime=r,n._signals=r.signals,n._bind=(t.bindings||[]).map(a=>({state:null,param:Z({},a)})),r.root&&r.root.set(i),i.source=r.data.root.input,n.pulse(r.data.root.input,n.changeset().insert(i.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=Nk(n,n._width),n._viewHeight=Ok(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,gI(n),$P(n),TP(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function os(t,e){return V(t._signals,e)?t._signals[e]:R("Unrecognized signal name: "+H(e))}function Pk(t,e){const n=(t._targets||[]).filter(i=>i._update&&i._update.handler===e);return n.length?n[0]:null}function kv(t,e,n,i){let r=Pk(n,i);return r||(r=Dm(t,()=>i(e,n.value)),r.handler=i,t.on(n,null,r)),t}function Av(t,e,n){const i=Pk(e,n);return i&&e._targets.remove(i),t}z(Lk,Ur,{async evaluate(t,e,n){if(await Ur.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,zP(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(i){this.error(i)}return n&&cs(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=t!=null?t+"":null;return e!==this._desc&&Ck(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const i=os(this,t);return arguments.length===1?i.value:this.update(i,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",_v(t)):_v(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(Mf(t)||R("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(Ur.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(os(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:mI,addEventListener(t,e,n){let i=e;return n&&n.trap===!1||(i=Dm(this,e),i.raw=e),this._handler.on(t,i),this},removeEventListener(t,e){for(var n=this._handler.handlers(t),i=n.length,r,a;--i>=0;)if(a=n[i].type,r=n[i].handler,t===a&&(e===r||e===r.raw)){this._handler.off(a,r);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return kv(this,t,os(this,t),e)},removeSignalListener(t,e){return Av(this,os(this,t),e)},addDataListener(t,e){return kv(this,t,Tl(this,t).values,e)},removeDataListener(t,e){return Av(this,Tl(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=jd(this,null);this._globalCursor=!!t,e&&jd(this,e)}return this}else return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:bI,events:YP,finalize:WP,hover:HP,data:RP,change:Bf,insert:NP,remove:OP,scale:dI,initialize:oI,toImageURL:sI,toCanvas:fI,toSVG:cI,getState:pI,setState:xI});const kI="view",Nl="[",Ol="]",Ik="{",Uk="}",AI=":",qk=",",EI="@",CI=">",DI=/[[\]{}]/,SI={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let jk,Yk;function Hk(t,e,n){return jk=e||kI,Yk=n||SI,Wk(t.trim()).map(Yd)}function FI(t){return Yk[t]}function Ao(t,e,n,i,r){const a=t.length;let o=0,u;for(;e<a;++e){if(u=t[e],!o&&u===n)return e;r&&r.indexOf(u)>=0?--o:i&&i.indexOf(u)>=0&&++o}return e}function Wk(t){const e=[],n=t.length;let i=0,r=0;for(;r<n;)r=Ao(t,r,qk,Nl+Ik,Ol+Uk),e.push(t.substring(i,r).trim()),i=++r;if(e.length===0)throw"Empty event selector: "+t;return e}function Yd(t){return t[0]==="["?$I(t):TI(t)}function $I(t){const e=t.length;let n=1,i;if(n=Ao(t,n,Ol,Nl,Ol),n===e)throw"Empty between selector: "+t;if(i=Wk(t.substring(1,n)),i.length!==2)throw"Between selector must have two elements: "+t;if(t=t.slice(n+1).trim(),t[0]!==CI)throw"Expected '>' after between selector: "+t;i=i.map(Yd);const r=Yd(t.slice(1).trim());return r.between?{between:i,stream:r}:(r.between=i,r)}function TI(t){const e={source:jk},n=[];let i=[0,0],r=0,a=0,o=t.length,u=0,s,l;if(t[o-1]===Uk){if(u=t.lastIndexOf(Ik),u>=0){try{i=RI(t.substring(u+1,o-1))}catch{throw"Invalid throttle specification: "+t}t=t.slice(0,u).trim(),o=t.length}else throw"Unmatched right brace: "+t;u=0}if(!o)throw t;if(t[0]===EI&&(r=++u),s=Ao(t,u,AI),s<o&&(n.push(t.substring(a,s).trim()),a=u=++s),u=Ao(t,u,Nl),u===o)n.push(t.substring(a,o).trim());else if(n.push(t.substring(a,u).trim()),l=[],a=++u,a===o)throw"Unmatched left bracket: "+t;for(;u<o;){if(u=Ao(t,u,Ol),u===o)throw"Unmatched left bracket: "+t;if(l.push(t.substring(a,u).trim()),u<o-1&&t[++u]!==Nl)throw"Expected left bracket: "+t;a=++u}if(!(o=n.length)||DI.test(n[o-1]))throw"Invalid event selector: "+t;return o>1?(e.type=n[1],r?e.markname=n[0].slice(1):FI(n[0])?e.marktype=n[0]:e.source=n[0]):e.type=n[0],e.type.slice(-1)==="!"&&(e.consume=!0,e.type=e.type.slice(0,-1)),l!=null&&(e.filter=l),i[0]&&(e.throttle=i[0]),i[1]&&(e.debounce=i[1]),e}function RI(t){const e=t.split(qk);if(!t.length||e.length>2)throw t;return e.map(n=>{const i=+n;if(i!==i)throw t;return i})}function NI(t){return J(t)?t:{type:t||"pad"}}const ja=t=>+t||0,OI=t=>({top:t,bottom:t,left:t,right:t});function zI(t){return J(t)?t.signal?t:{top:ja(t.top),bottom:ja(t.bottom),left:ja(t.left),right:ja(t.right)}:OI(ja(t))}const Nt=t=>J(t)&&!Y(t)?Z({},t):{value:t};function Ev(t,e,n,i){return n!=null?(J(n)&&!Y(n)||Y(n)&&n.length&&J(n[0])?t.update[e]=n:t[i||"enter"][e]={value:n},1):0}function Ut(t,e,n){for(const i in e)Ev(t,i,e[i]);for(const i in n)Ev(t,i,n[i],"update")}function xa(t,e,n){for(const i in e)n&&V(n,i)||(t[i]=Z(t[i]||{},e[i]));return t}function Tr(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const $m="mark",Tm="frame",Rm="scope",BI="axis",LI="axis-domain",PI="axis-grid",II="axis-label",UI="axis-tick",qI="axis-title",jI="legend",YI="legend-band",HI="legend-entry",WI="legend-gradient",Gk="legend-label",GI="legend-symbol",VI="legend-title",XI="title",KI="title-text",ZI="title-subtitle";function JI(t,e,n,i,r){const a={},o={};let u,s,l,f;s="lineBreak",e==="text"&&r[s]!=null&&!Tr(s,t)&&Qc(a,s,r[s]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),f=n===Tm?r.group:n===$m?Z({},r.mark,r[e]):null;for(s in f)l=Tr(s,t)||(s==="fill"||s==="stroke")&&(Tr("fill",t)||Tr("stroke",t)),l||Qc(a,s,f[s]);G(i).forEach(c=>{const h=r.style&&r.style[c];for(const d in h)Tr(d,t)||Qc(a,d,h[d])}),t=Z({},t);for(s in a)f=a[s],f.signal?(u=u||{})[s]=f:o[s]=f;return t.enter=Z(o,t.enter),u&&(t.update=Z(u,t.update)),t}function Qc(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const Vk=t=>vt(t)?H(t):t.signal?"(".concat(t.signal,")"):Xk(t);function Pf(t){if(t.gradient!=null)return tU(t);let e=t.signal?"(".concat(t.signal,")"):t.color?QI(t.color):t.field!=null?Xk(t.field):t.value!==void 0?H(t.value):void 0;return t.scale!=null&&(e=eU(t,e)),e===void 0&&(e=null),t.exponent!=null&&(e="pow(".concat(e,",").concat(As(t.exponent),")")),t.mult!=null&&(e+="*".concat(As(t.mult))),t.offset!=null&&(e+="+".concat(As(t.offset))),t.round&&(e="round(".concat(e,")")),e}const us=(t,e,n,i)=>"(".concat(t,"(").concat([e,n,i].map(Pf).join(","),")+'')");function QI(t){return t.c?us("hcl",t.h,t.c,t.l):t.h||t.s?us("hsl",t.h,t.s,t.l):t.l||t.a?us("lab",t.l,t.a,t.b):t.r||t.g||t.b?us("rgb",t.r,t.g,t.b):null}function tU(t){const e=[t.start,t.stop,t.count].map(n=>n==null?null:H(n));for(;e.length&&it(e)==null;)e.pop();return e.unshift(Vk(t.gradient)),"gradient(".concat(e.join(","),")")}function As(t){return J(t)?"("+Pf(t)+")":t}function Xk(t){return Kk(J(t)?t:{datum:t})}function Kk(t){let e,n,i;if(t.signal)e="datum",i=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(i=t.parent,e+=".datum"):i=t.group}else t.datum?(e="datum",i=t.datum):R("Invalid field reference: "+H(t));return t.signal||(i=vt(i)?Bl(i).map(H).join("]["):Kk(i)),e+"["+i+"]"}function eU(t,e){const n=Vk(t.scale);return t.range!=null?e="lerp(_range(".concat(n,"), ").concat(+t.range,")"):(e!==void 0&&(e="_scale(".concat(n,", ").concat(e,")")),t.band&&(e=(e?e+"+":"")+"_bandwidth(".concat(n,")")+(+t.band==1?"":"*"+As(t.band)),t.extra&&(e="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(e,")"))),e==null&&(e="0")),e}function nU(t){let e="";return t.forEach(n=>{const i=Pf(n);e+=n.test?"(".concat(n.test,")?").concat(i,":"):i}),it(e)===":"&&(e+="null"),e}function Zk(t,e,n,i,r,a){const o={};a=a||{},a.encoders={$encode:o},t=JI(t,e,n,i,r.config);for(const u in t)o[u]=iU(t[u],e,a,r);return a}function iU(t,e,n,i){const r={},a={};for(const o in t)t[o]!=null&&(r[o]=aU(rU(t[o]),i,n,a));return{$expr:{marktype:e,channels:r},$fields:Object.keys(a),$output:Object.keys(t)}}function rU(t){return Y(t)?nU(t):Pf(t)}function aU(t,e,n,i){const r=Rn(t,e);return r.$fields.forEach(a=>i[a]=1),Z(n,r.$params),r.$expr}const oU="outer",uU=["value","update","init","react","bind"];function Cv(t,e){R(t+' for "outer" push: '+H(e))}function Jk(t,e){const n=t.name;if(t.push===oU)e.signals[n]||Cv("No prior signal definition",n),uU.forEach(i=>{t[i]!==void 0&&Cv("Invalid property ",i)});else{const i=e.addSignal(n,t.value);t.react===!1&&(i.react=!1),t.bind&&e.addBinding(n,t.bind)}}function Hd(t,e,n,i){this.id=-1,this.type=t,this.value=e,this.params=n,i&&(this.parent=i)}function If(t,e,n,i){return new Hd(t,e,n,i)}function zl(t,e){return If("operator",t,e)}function q(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function Jo(t,e){return e?{$field:t,$name:e}:{$field:t}}const Wd=Jo("key");function Dv(t,e){return{$compare:t,$order:e}}function sU(t,e){const n={$key:t};return e&&(n.$flat=!0),n}const lU="ascending",fU="descending";function cU(t){return J(t)?(t.order===fU?"-":"+")+Uf(t.op,t.field):""}function Uf(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const Nm="scope",Gd="view";function St(t){return t&&t.signal}function hU(t){return t&&t.expr}function Es(t){if(St(t))return!0;if(J(t)){for(const e in t)if(Es(t[e]))return!0}return!1}function en(t,e){return t!=null?t:e}function Zi(t){return t&&t.signal||t}const Sv="timer";function Qo(t,e){return(t.merge?gU:t.stream?mU:t.type?pU:R("Invalid stream specification: "+H(t)))(t,e)}function dU(t){return t===Nm?Gd:t||Gd}function gU(t,e){const n=t.merge.map(r=>Qo(r,e)),i=Om({merge:n},t,e);return e.addStream(i).id}function mU(t,e){const n=Qo(t.stream,e),i=Om({stream:n},t,e);return e.addStream(i).id}function pU(t,e){let n;t.type===Sv?(n=e.event(Sv,t.throttle),t={between:t.between,filter:t.filter}):n=e.event(dU(t.source),t.type);const i=Om({stream:n},t,e);return Object.keys(i).length===1?n:e.addStream(i).id}function Om(t,e,n){let i=e.between;return i&&(i.length!==2&&R('Stream "between" parameter must have 2 entries: '+H(e)),t.between=[Qo(i[0],n),Qo(i[1],n)]),i=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&i.push(yU(e.marktype,e.markname,e.markrole)),e.source===Nm&&i.push("inScope(event.item)"),i.length&&(t.filter=Rn("("+i.join(")&&(")+")",n).$expr),(i=e.throttle)!=null&&(t.throttle=+i),(i=e.debounce)!=null&&(t.debounce=+i),e.consume&&(t.consume=!0),t}function yU(t,e,n){const i="event.item";return i+(t&&t!=="*"?"&&"+i+".mark.marktype==='"+t+"'":"")+(n?"&&"+i+".mark.role==='"+n+"'":"")+(e?"&&"+i+".mark.name==='"+e+"'":"")}const vU={code:"_.$value",ast:{type:"Identifier",value:"value"}};function xU(t,e,n){const i=t.encode,r={target:n};let a=t.events,o=t.update,u=[];a||R("Signal update missing events specification."),vt(a)&&(a=Hk(a,e.isSubscope()?Nm:Gd)),a=G(a).filter(s=>s.signal||s.scale?(u.push(s),0):1),u.length>1&&(u=[wU(u)]),a.length&&u.push(a.length>1?{merge:a}:a[0]),i!=null&&(o&&R("Signal encode and update are mutually exclusive."),o="encode(item(),"+H(i)+")"),r.update=vt(o)?Rn(o,e):o.expr!=null?Rn(o.expr,e):o.value!=null?o.value:o.signal!=null?{$expr:vU,$params:{$value:e.signalRef(o.signal)}}:R("Invalid signal update specification."),t.force&&(r.options={force:!0}),u.forEach(s=>e.addUpdate(Z(bU(s,e),r)))}function bU(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):Qo(t,e)}}function wU(t){return{signal:"["+t.map(e=>e.scale?'scale("'+e.scale+'")':e.signal)+"]"}}function _U(t,e){const n=e.getSignal(t.name);let i=t.update;t.init&&(i?R("Signals can not include both init and update expressions."):(i=t.init,n.initonly=!0)),i&&(i=Rn(i,e),n.update=i.$expr,n.params=i.$params),t.on&&t.on.forEach(r=>xU(r,e,n.id))}const gt=t=>(e,n,i)=>If(t,n,e||void 0,i),Qk=gt("aggregate"),MU=gt("axisticks"),tA=gt("bound"),mn=gt("collect"),Fv=gt("compare"),kU=gt("datajoin"),eA=gt("encode"),AU=gt("expression"),EU=gt("facet"),CU=gt("field"),DU=gt("key"),SU=gt("legendentries"),FU=gt("load"),$U=gt("mark"),TU=gt("multiextent"),RU=gt("multivalues"),NU=gt("overlap"),OU=gt("params"),nA=gt("prefacet"),zU=gt("projection"),BU=gt("proxy"),LU=gt("relay"),iA=gt("render"),PU=gt("scale"),br=gt("sieve"),IU=gt("sortitems"),rA=gt("viewlayout"),UU=gt("values");let qU=0;const aA={min:"min",max:"max",count:"sum"};function jU(t,e){const n=t.type||"linear";N_(n)||R("Unrecognized scale type: "+H(n)),e.addScale(t.name,{type:n,domain:void 0})}function YU(t,e){const n=e.getScale(t.name).params;let i;n.domain=oA(t.domain,t,e),t.range!=null&&(n.range=sA(t,e,n)),t.interpolate!=null&&tq(t.interpolate,n),t.nice!=null&&(n.nice=QU(t.nice)),t.bins!=null&&(n.bins=JU(t.bins,e));for(i in t)V(n,i)||i==="name"||(n[i]=We(t[i],e))}function We(t,e){return J(t)?t.signal?e.signalRef(t.signal):R("Unsupported object: "+H(t)):t}function Cs(t,e){return t.signal?e.signalRef(t.signal):t.map(n=>We(n,e))}function qf(t){R("Can not find data set: "+H(t))}function oA(t,e,n){if(!t){(e.domainMin!=null||e.domainMax!=null)&&R("No scale domain defined for domainMin/domainMax to override.");return}return t.signal?n.signalRef(t.signal):(Y(t)?HU:t.fields?GU:WU)(t,e,n)}function HU(t,e,n){return t.map(i=>We(i,n))}function WU(t,e,n){const i=n.getData(t.data);return i||qf(t.data),Qr(e.type)?i.valuesRef(n,t.field,uA(t.sort,!1)):B_(e.type)?i.domainRef(n,t.field):i.extentRef(n,t.field)}function GU(t,e,n){const i=t.data,r=t.fields.reduce((a,o)=>(o=vt(o)?{data:i,field:o}:Y(o)||o.signal?VU(o,n):o,a.push(o),a),[]);return(Qr(e.type)?XU:B_(e.type)?KU:ZU)(t,n,r)}function VU(t,e){const n="_:vega:_"+qU++,i=mn({});if(Y(t))i.value={$ingest:t};else if(t.signal){const r="setdata("+H(n)+","+t.signal+")";i.params.input=e.signalRef(r)}return e.addDataPipeline(n,[i,br({})]),{data:n,field:"data"}}function XU(t,e,n){const i=uA(t.sort,!0);let r,a;const o=n.map(l=>{const f=e.getData(l.data);return f||qf(l.data),f.countsRef(e,l.field,i)}),u={groupby:Wd,pulse:o};i&&(r=i.op||"count",a=i.field?Uf(r,i.field):"count",u.ops=[aA[r]],u.fields=[e.fieldRef(a)],u.as=[a]),r=e.add(Qk(u));const s=e.add(mn({pulse:q(r)}));return a=e.add(UU({field:Wd,sort:e.sortRef(i),pulse:q(s)})),q(a)}function uA(t,e){return t&&(!t.field&&!t.op?J(t)?t.field="key":t={field:"key"}:!t.field&&t.op!=="count"?R("No field provided for sort aggregate op: "+t.op):e&&t.field&&t.op&&!aA[t.op]&&R("Multiple domain scales can not be sorted using "+t.op)),t}function KU(t,e,n){const i=n.map(r=>{const a=e.getData(r.data);return a||qf(r.data),a.domainRef(e,r.field)});return q(e.add(RU({values:i})))}function ZU(t,e,n){const i=n.map(r=>{const a=e.getData(r.data);return a||qf(r.data),a.extentRef(e,r.field)});return q(e.add(TU({extents:i})))}function JU(t,e){return t.signal||Y(t)?Cs(t,e):e.objectProperty(t)}function QU(t){return J(t)?{interval:We(t.interval),step:We(t.step)}:We(t)}function tq(t,e){e.interpolate=We(t.type||t),t.gamma!=null&&(e.interpolateGamma=We(t.gamma))}function sA(t,e,n){const i=e.config.range;let r=t.range;if(r.signal)return e.signalRef(r.signal);if(vt(r)){if(i&&V(i,r))return t=Z({},t,{range:i[r]}),sA(t,e,n);r==="width"?r=[0,{signal:"width"}]:r==="height"?r=Qr(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:R("Unrecognized scale range value: "+H(r))}else if(r.scheme){n.scheme=Y(r.scheme)?Cs(r.scheme,e):We(r.scheme,e),r.extent&&(n.schemeExtent=Cs(r.extent,e)),r.count&&(n.schemeCount=We(r.count,e));return}else if(r.step){n.rangeStep=We(r.step,e);return}else{if(Qr(t.type)&&!Y(r))return oA(r,t,e);Y(r)||R("Unsupported range type: "+H(r))}return r.map(a=>(Y(a)?Cs:We)(a,e))}function eq(t,e){const n=e.config.projection||{},i={};for(const r in t)r!=="name"&&(i[r]=Vd(t[r],r,e));for(const r in n)i[r]==null&&(i[r]=Vd(n[r],r,e));e.addProjection(t.name,i)}function Vd(t,e,n){return Y(t)?t.map(i=>Vd(i,e,n)):J(t)?t.signal?n.signalRef(t.signal):e==="fit"?t:R("Unsupported parameter object: "+H(t)):t}const pn="top",ba="left",wa="right",Ti="bottom",lA="center",nq="vertical",iq="start",rq="middle",aq="end",Xd="index",zm="label",oq="offset",la="perc",uq="perc2",Ge="value",Fu="guide-label",Bm="guide-title",sq="group-title",lq="group-subtitle",$v="symbol",Ds="gradient",Kd="discrete",Zd="size",fq="shape",cq="fill",hq="stroke",dq="strokeWidth",gq="strokeDash",mq="opacity",Lm=[Zd,fq,cq,hq,dq,gq,mq],$u={name:1,style:1,interactive:1},rt={value:0},Ve={value:1},jf="group",fA="rect",Pm="rule",pq="symbol",wr="text";function tu(t){return t.type=jf,t.interactive=t.interactive||!1,t}function Se(t,e){const n=(i,r)=>en(t[i],en(e[i],r));return n.isVertical=i=>nq===en(t.direction,e.direction||(i?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>en(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>en(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>en(t.columns,en(e.columns,+n.isVertical(!0))),n}function cA(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function yq(t,e,n){const i=e.config.style[n];return i&&i[t]}function Yf(t,e,n){return"item.anchor === '".concat(iq,"' ? ").concat(t," : item.anchor === '").concat(aq,"' ? ").concat(e," : ").concat(n)}const Im=Yf(H(ba),H(wa),H(lA));function vq(t){const e=t("tickBand");let n=t("tickOffset"),i,r;return e?e.signal?(i={signal:"(".concat(e.signal,") === 'extent' ? 1 : 0.5")},r={signal:"(".concat(e.signal,") === 'extent'")},J(n)||(n={signal:"(".concat(e.signal,") === 'extent' ? 0 : ").concat(n)})):e==="extent"?(i=1,r=!0,n=0):(i=.5,r=!1):(i=t("bandPosition"),r=t("tickExtra")),{extra:r,band:i,offset:n}}function hA(t,e){return e?t?J(t)?Object.assign({},t,{offset:hA(t.offset,e)}):{value:t,offset:e}:e:t}function Ie(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=xa(t.encode,e,$u)):t.interactive=!1,t}function xq(t,e,n,i){const r=Se(t,n),a=r.isVertical(),o=r.gradientThickness(),u=r.gradientLength();let s,l,f,c,h;a?(l=[0,1],f=[0,0],c=o,h=u):(l=[0,0],f=[1,0],c=u,h=o);const d={enter:s={opacity:rt,x:rt,y:rt,width:Nt(c),height:Nt(h)},update:Z({},s,{opacity:Ve,fill:{gradient:e,start:l,stop:f}}),exit:{opacity:rt}};return Ut(d,{stroke:r("gradientStrokeColor"),strokeWidth:r("gradientStrokeWidth")},{opacity:r("gradientOpacity")}),Ie({type:fA,role:WI,encode:d},i)}function bq(t,e,n,i,r){const a=Se(t,n),o=a.isVertical(),u=a.gradientThickness(),s=a.gradientLength();let l,f,c,h,d="";o?(l="y",c="y2",f="x",h="width",d="1-"):(l="x",c="x2",f="y",h="height");const g={opacity:rt,fill:{scale:e,field:Ge}};g[l]={signal:d+"datum."+la,mult:s},g[f]=rt,g[c]={signal:d+"datum."+uq,mult:s},g[h]=Nt(u);const m={enter:g,update:Z({},g,{opacity:Ve}),exit:{opacity:rt}};return Ut(m,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),Ie({type:fA,role:YI,key:Ge,from:r,encode:m},i)}const wq="datum.".concat(la,'<=0?"').concat(ba,'":datum.').concat(la,'>=1?"').concat(wa,'":"').concat(lA,'"'),_q="datum.".concat(la,'<=0?"').concat(Ti,'":datum.').concat(la,'>=1?"').concat(pn,'":"').concat(rq,'"');function Tv(t,e,n,i){const r=Se(t,e),a=r.isVertical(),o=Nt(r.gradientThickness()),u=r.gradientLength();let s=r("labelOverlap"),l,f,c,h,d="";const g={enter:l={opacity:rt},update:f={opacity:Ve,text:{field:zm}},exit:{opacity:rt}};return Ut(g,{fill:r("labelColor"),fillOpacity:r("labelOpacity"),font:r("labelFont"),fontSize:r("labelFontSize"),fontStyle:r("labelFontStyle"),fontWeight:r("labelFontWeight"),limit:en(t.labelLimit,e.gradientLabelLimit)}),a?(l.align={value:"left"},l.baseline=f.baseline={signal:_q},c="y",h="x",d="1-"):(l.align=f.align={signal:wq},l.baseline={value:"top"},c="x",h="y"),l[c]=f[c]={signal:d+"datum."+la,mult:u},l[h]=f[h]=o,o.offset=en(t.labelOffset,e.gradientLabelOffset)||0,s=s?{separation:r("labelSeparation"),method:s,order:"datum."+Xd}:void 0,Ie({type:wr,role:Gk,style:Fu,key:Ge,from:i,encode:g,overlap:s},n)}function Mq(t,e,n,i,r){const a=Se(t,e),o=n.entries,u=!!(o&&o.interactive),s=o?o.name:void 0,l=a("clipHeight"),f=a("symbolOffset"),c={data:"value"},h="(".concat(r,") ? datum.").concat(oq," : datum.").concat(Zd),d=l?Nt(l):{field:Zd},g="datum.".concat(Xd),m="max(1, ".concat(r,")");let p,y,v,x,b;d.mult=.5,p={enter:y={opacity:rt,x:{signal:h,mult:.5,offset:f},y:d},update:v={opacity:Ve,x:y.x,y:y.y},exit:{opacity:rt}};let _=null,M=null;t.fill||(_=e.symbolBaseFillColor,M=e.symbolBaseStrokeColor),Ut(p,{fill:a("symbolFillColor",_),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",M),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),Lm.forEach(A=>{t[A]&&(v[A]=y[A]={scale:t[A],field:Ge})});const w=Ie({type:pq,role:GI,key:Ge,from:c,clip:l?!0:void 0,encode:p},n.symbols),k=Nt(f);k.offset=a("labelOffset"),p={enter:y={opacity:rt,x:{signal:h,offset:k},y:d},update:v={opacity:Ve,text:{field:zm},x:y.x,y:y.y},exit:{opacity:rt}},Ut(p,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const C=Ie({type:wr,role:Gk,style:Fu,key:Ge,from:c,encode:p},n.labels);return p={enter:{noBound:{value:!l},width:rt,height:l?Nt(l):rt,opacity:rt},exit:{opacity:rt},update:v={opacity:Ve,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(x="ceil(item.mark.items.length / ".concat(m,")"),v.row.signal="".concat(g,"%").concat(x),v.column.signal="floor(".concat(g," / ").concat(x,")"),b={field:["row",g]}):(v.row.signal="floor(".concat(g," / ").concat(m,")"),v.column.signal="".concat(g," % ").concat(m),b={field:g}),v.column.signal="(".concat(r,")?").concat(v.column.signal,":").concat(g),i={facet:{data:i,name:"value",groupby:Xd}},tu({role:Rm,from:i,encode:xa(p,o,$u),marks:[w,C],name:s,interactive:u,sort:b})}function kq(t,e){const n=Se(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const Um='item.orient === "left"',qm='item.orient === "right"',Hf="(".concat(Um," || ").concat(qm,")"),Aq="datum.vgrad && ".concat(Hf),Eq=Yf('"top"','"bottom"','"middle"'),Cq=Yf('"right"','"left"','"center"'),Dq="datum.vgrad && ".concat(qm," ? (").concat(Cq,") : (").concat(Hf," && !(datum.vgrad && ").concat(Um,')) ? "left" : ').concat(Im),Sq="item._anchor || (".concat(Hf,' ? "middle" : "start")'),Fq="".concat(Aq," ? (").concat(Um," ? -90 : 90) : 0"),$q="".concat(Hf," ? (datum.vgrad ? (").concat(qm,' ? "bottom" : "top") : ').concat(Eq,') : "top"');function Tq(t,e,n,i){const r=Se(t,e),a={enter:{opacity:rt},update:{opacity:Ve,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:rt}};return Ut(a,{orient:r("titleOrient"),_anchor:r("titleAnchor"),anchor:{signal:Sq},angle:{signal:Fq},align:{signal:Dq},baseline:{signal:$q},text:t.title,fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),baseline:r("titleBaseline")}),Ie({type:wr,role:VI,style:Bm,from:i,encode:a},n)}function Rq(t,e){let n;return J(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+Rv(t.path)+")":t.sphere&&(n="geoShape("+Rv(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function Rv(t){return J(t)&&t.signal?t.signal:H(t)}function dA(t){const e=t.role||"";return!e.indexOf("axis")||!e.indexOf("legend")||!e.indexOf("title")?e:t.type===jf?Rm:e||$m}function Nq(t){return{marktype:t.type,name:t.name||void 0,role:t.role||dA(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function Oq(t,e){return t&&t.signal?e.signalRef(t.signal):t!==!1}function jm(t,e){const n=Sb(t.type);n||R("Unrecognized transform type: "+H(t.type));const i=If(n.type.toLowerCase(),null,gA(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(i)),i.metadata=n.metadata||{},i}function gA(t,e,n){const i={},r=t.params.length;for(let a=0;a<r;++a){const o=t.params[a];i[o.name]=zq(o,e,n)}return i}function zq(t,e,n){const i=t.type,r=e[t.name];if(i==="index")return Bq(t,e,n);if(r===void 0){t.required&&R("Missing required "+H(e.type)+" parameter: "+H(t.name));return}else{if(i==="param")return Lq(t,e,n);if(i==="projection")return n.projectionRef(e[t.name])}return t.array&&!St(r)?r.map(a=>Nv(t,a,n)):Nv(t,r,n)}function Nv(t,e,n){const i=t.type;if(St(e))return zv(i)?R("Expression references can not be signals."):th(i)?n.fieldRef(e):Bv(i)?n.compareRef(e):n.signalRef(e.signal);{const r=t.expr||th(i);return r&&Pq(e)?n.exprRef(e.expr,e.as):r&&Iq(e)?Jo(e.field,e.as):zv(i)?Rn(e,n):Uq(i)?q(n.getData(e).values):th(i)?Jo(e):Bv(i)?n.compareRef(e):e}}function Bq(t,e,n){return vt(e.from)||R('Lookup "from" parameter must be a string literal.'),n.getData(e.from).lookupRef(n,e.key)}function Lq(t,e,n){const i=e[t.name];return t.array?(Y(i)||R("Expected an array of sub-parameters. Instead: "+H(i)),i.map(r=>Ov(t,r,n))):Ov(t,i,n)}function Ov(t,e,n){const i=t.params.length;let r;for(let o=0;o<i;++o){r=t.params[o];for(const u in r.key)if(r.key[u]!==e[u]){r=null;break}if(r)break}r||R("Unsupported parameter: "+H(e));const a=Z(gA(r,e,n),r.key);return q(n.add(OU(a)))}const Pq=t=>t&&t.expr,Iq=t=>t&&t.field,Uq=t=>t==="data",zv=t=>t==="expr",th=t=>t==="field",Bv=t=>t==="compare";function qq(t,e,n){let i,r,a,o,u;return t?(i=t.facet)&&(e||R("Only group marks can be faceted."),i.field!=null?o=u=Ss(i,n):(t.data?u=q(n.getData(t.data).aggregate):(a=jm(Z({type:"aggregate",groupby:G(i.groupby)},i.aggregate),n),a.params.key=n.keyRef(i.groupby),a.params.pulse=Ss(i,n),o=u=q(n.add(a))),r=n.keyRef(i.groupby,!0))):o=q(n.add(mn(null,[{}]))),o||(o=Ss(t,n)),{key:r,pulse:o,parent:u}}function Ss(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:q(e.getData(t.data).output)}function ur(t,e,n,i,r){this.scope=t,this.input=e,this.output=n,this.values=i,this.aggregate=r,this.index={}}ur.fromEntries=function(t,e){const n=e.length,i=e[n-1],r=e[n-2];let a=e[0],o=null,u=1;for(a&&a.type==="load"&&(a=e[1]),t.add(e[0]);u<n;++u)e[u].params.pulse=q(e[u-1]),t.add(e[u]),e[u].type==="aggregate"&&(o=e[u]);return new ur(t,a,r,i,o)};function mA(t){return vt(t)?t:null}function Lv(t,e,n){const i=Uf(n.op,n.field);let r;if(e.ops){for(let a=0,o=e.as.length;a<o;++a)if(e.as[a]===i)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((r=n.op.signal)?t.signalRef(r):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(i))}function Ya(t,e,n,i,r,a,o){const u=e[n]||(e[n]={}),s=cU(a);let l=mA(r),f,c;if(l!=null&&(t=e.scope,l=l+(s?"|"+s:""),f=u[l]),!f){const h=a?{field:Wd,pulse:e.countsRef(t,r,a)}:{field:t.fieldRef(r),pulse:q(e.output)};s&&(h.sort=t.sortRef(a)),c=t.add(If(i,void 0,h)),o&&(e.index[r]=c),f=q(c),l!=null&&(u[l]=f)}return f}ur.prototype={countsRef(t,e,n){const i=this,r=i.counts||(i.counts={}),a=mA(e);let o,u,s;return a!=null&&(t=i.scope,o=r[a]),o?n&&n.field&&Lv(t,o.agg.params,n):(s={groupby:t.fieldRef(e,"key"),pulse:q(i.output)},n&&n.field&&Lv(t,s,n),u=t.add(Qk(s)),o=t.add(mn({pulse:q(u)})),o={agg:u,ref:q(o)},a!=null&&(r[a]=o)),o.ref},tuplesRef(){return q(this.values)},extentRef(t,e){return Ya(t,this,"extent","extent",e,!1)},domainRef(t,e){return Ya(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return Ya(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return Ya(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return Ya(t,this,"indata","tupleindex",e,!0,!0)}};function jq(t,e,n){const i=t.from.facet,r=i.name,a=Ss(i,e);let o;i.name||R("Facet must have a name: "+H(i)),i.data||R("Facet must reference a data set: "+H(i)),i.field?o=e.add(nA({field:e.fieldRef(i.field),pulse:a})):i.groupby?o=e.add(EU({key:e.keyRef(i.groupby),group:q(e.proxy(n.parent)),pulse:a})):R("Facet must specify groupby or field: "+H(i));const u=e.fork(),s=u.add(mn()),l=u.add(br({pulse:q(s)}));u.addData(r,new ur(u,s,s,l)),u.addSignal("parent",null),o.params.subflow={$subflow:u.parse(t).toRuntime()}}function Yq(t,e,n){const i=e.add(nA({pulse:n.pulse})),r=e.fork();r.add(br()),r.addSignal("parent",null),i.params.subflow={$subflow:r.parse(t).toRuntime()}}function pA(t,e,n){const i=t.remove,r=t.insert,a=t.toggle,o=t.modify,u=t.values,s=e.add(zl()),l="if("+t.trigger+',modify("'+n+'",'+[r,i,a,o,u].map(c=>c==null?"null":c).join(",")+"),0)",f=Rn(l,e);s.update=f.$expr,s.params=f.$params}function Wf(t,e){const n=dA(t),i=t.type===jf,r=t.from&&t.from.facet,a=t.overlap;let o=t.layout||n===Rm||n===Tm,u,s,l,f,c,h,d;const g=n===$m||o||r,m=qq(t.from,i,e);s=e.add(kU({key:m.key||(t.key?Jo(t.key):void 0),pulse:m.pulse,clean:!i}));const p=q(s);s=l=e.add(mn({pulse:p})),s=e.add($U({markdef:Nq(t),interactive:Oq(t.interactive,e),clip:Rq(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:q(s)}));const y=q(s);s=f=e.add(eA(Zk(t.encode,t.type,n,t.style,e,{mod:!1,pulse:y}))),s.params.parent=e.encode(),t.transform&&t.transform.forEach(M=>{const w=jm(M,e),k=w.metadata;(k.generates||k.changes)&&R("Mark transforms should not generate new data."),k.nomod||(f.params.mod=!0),w.params.pulse=q(s),e.add(s=w)}),t.sort&&(s=e.add(IU({sort:e.compareRef(t.sort),pulse:q(s)})));const v=q(s);(r||o)&&(o=e.add(rA({layout:e.objectProperty(t.layout),legends:e.legends,mark:y,pulse:v})),h=q(o));const x=e.add(tA({mark:y,pulse:h||v}));d=q(x),i&&(g&&(u=e.operators,u.pop(),o&&u.pop()),e.pushState(v,h||d,p),r?jq(t,e,m):g?Yq(t,e,m):e.parse(t),e.popState(),g&&(o&&u.push(o),u.push(x))),a&&(d=Hq(a,d,e));const b=e.add(iA({pulse:d})),_=e.add(br({pulse:q(b)},void 0,e.parent()));t.name!=null&&(c=t.name,e.addData(c,new ur(e,l,b,_)),t.on&&t.on.forEach(M=>{(M.insert||M.remove||M.toggle)&&R("Marks only support modify triggers."),pA(M,e,c)}))}function Hq(t,e,n){const i=t.method,r=t.bound,a=t.separation,o={separation:St(a)?n.signalRef(a.signal):a,method:St(i)?n.signalRef(i.signal):i,pulse:e};if(t.order&&(o.sort=n.compareRef({field:t.order})),r){const u=r.tolerance;o.boundTolerance=St(u)?n.signalRef(u.signal):+u,o.boundScale=n.scaleRef(r.scale),o.boundOrient=r.orient}return q(n.add(NU(o)))}function Wq(t,e){const n=e.config.legend,i=t.encode||{},r=Se(t,n),a=i.legend||{},o=a.name||void 0,u=a.interactive,s=a.style,l={};let f=0,c,h,d;Lm.forEach(x=>t[x]?(l[x]=t[x],f=f||t[x]):0),f||R("Missing valid scale for legend.");const g=Gq(t,e.scaleType(f)),m={title:t.title!=null,scales:l,type:g,vgrad:g!=="symbol"&&r.isVertical()},p=q(e.add(mn(null,[m]))),y={enter:{x:{value:0},y:{value:0}}},v=q(e.add(SU(h={type:g,scale:e.scaleRef(f),count:e.objectProperty(r("tickCount")),limit:e.property(r("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return g===Ds?(d=[xq(t,f,n,i.gradient),Tv(t,n,i.labels,v)],h.count=h.count||e.signalRef("max(2,2*floor((".concat(Zi(r.gradientLength()),")/100))"))):g===Kd?d=[bq(t,f,n,i.gradient,v),Tv(t,n,i.labels,v)]:(c=kq(t,n),d=[Mq(t,n,i,v,Zi(c.columns))],h.size=Kq(t,e,d[0].marks)),d=[tu({role:HI,from:p,encode:y,marks:d,layout:c,interactive:u})],m.title&&d.push(Tq(t,n,i.title,p)),Wf(tu({role:jI,from:p,encode:xa(Xq(r,t,n),a,$u),marks:d,aria:r("aria"),description:r("description"),zindex:r("zindex"),name:o,interactive:u,style:s}),e)}function Gq(t,e){let n=t.type||$v;return!t.type&&Vq(t)===1&&(t.fill||t.stroke)&&(n=Rg(e)?Ds:Oh(e)?Kd:$v),n!==Ds?n:Oh(e)?Kd:Ds}function Vq(t){return Lm.reduce((e,n)=>e+(t[n]?1:0),0)}function Xq(t,e,n){const i={enter:{},update:{}};return Ut(i,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),i}function Kq(t,e,n){const i=Zi(Pv("size",t,n)),r=Zi(Pv("strokeWidth",t,n)),a=Zi(Zq(n[1].encode,e,Fu));return Rn("max(ceil(sqrt(".concat(i,")+").concat(r,"),").concat(a,")"),e)}function Pv(t,e,n){return e[t]?'scale("'.concat(e[t],'",datum)'):cA(t,n[0].encode)}function Zq(t,e,n){return cA("fontSize",t)||yq("fontSize",e,n)}const Jq='item.orient==="'.concat(ba,'"?-90:item.orient==="').concat(wa,'"?90:0');function Qq(t,e){t=vt(t)?{text:t}:t;const n=Se(t,e.config.title),i=t.encode||{},r=i.group||{},a=r.name||void 0,o=r.interactive,u=r.style,s=[],l={},f=q(e.add(mn(null,[l])));return s.push(nj(t,n,tj(t),f)),t.subtitle&&s.push(ij(t,n,i.subtitle,f)),Wf(tu({role:XI,from:f,encode:ej(n,r),marks:s,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:u}),e)}function tj(t){const e=t.encode;return e&&e.title||Z({name:t.name,interactive:t.interactive,style:t.style},e)}function ej(t,e){const n={enter:{},update:{}};return Ut(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:Im},angle:{signal:Jq},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),xa(n,e,$u)}function nj(t,e,n,i){const r={value:0},a=t.text,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Ut(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),Ie({type:wr,role:KI,style:sq,from:i,encode:o},n)}function ij(t,e,n,i){const r={value:0},a=t.subtitle,o={enter:{opacity:r},update:{opacity:{value:1}},exit:{opacity:r}};return Ut(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),Ie({type:wr,role:ZI,style:lq,from:i,encode:o},n)}function rj(t,e){const n=[];t.transform&&t.transform.forEach(i=>{n.push(jm(i,e))}),t.on&&t.on.forEach(i=>{pA(i,e,t.name)}),e.addDataPipeline(t.name,aj(t,e,n))}function aj(t,e,n){const i=[];let r=null,a=!1,o=!1,u,s,l,f,c;for(t.values?St(t.values)||Es(t.format)?(i.push(Iv(e,t)),i.push(r=Pi())):i.push(r=Pi({$ingest:t.values,$format:t.format})):t.url?Es(t.url)||Es(t.format)?(i.push(Iv(e,t)),i.push(r=Pi())):i.push(r=Pi({$request:t.url,$format:t.format})):t.source&&(r=u=G(t.source).map(h=>q(e.getData(h).output)),i.push(null)),s=0,l=n.length;s<l;++s)f=n[s],c=f.metadata,!r&&!c.source&&i.push(r=Pi()),i.push(f),c.generates&&(o=!0),c.modifies&&!o&&(a=!0),c.source?r=f:c.changes&&(r=null);return u&&(l=u.length-1,i[0]=LU({derive:a,pulse:l?u:u[0]}),(a||l)&&i.splice(1,0,Pi())),r||i.push(Pi()),i.push(br({})),i}function Pi(t){const e=mn({},t);return e.metadata={source:!0},e}function Iv(t,e){return FU({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const yA=t=>t===Ti||t===pn,Gf=(t,e,n)=>St(t)?lj(t.signal,e,n):t===ba||t===pn?e:n,Ot=(t,e,n)=>St(t)?uj(t.signal,e,n):yA(t)?e:n,fn=(t,e,n)=>St(t)?sj(t.signal,e,n):yA(t)?n:e,vA=(t,e,n)=>St(t)?fj(t.signal,e,n):t===pn?{value:e}:{value:n},oj=(t,e,n)=>St(t)?cj(t.signal,e,n):t===wa?{value:e}:{value:n},uj=(t,e,n)=>xA("".concat(t," === '").concat(pn,"' || ").concat(t," === '").concat(Ti,"'"),e,n),sj=(t,e,n)=>xA("".concat(t," !== '").concat(pn,"' && ").concat(t," !== '").concat(Ti,"'"),e,n),lj=(t,e,n)=>Ym("".concat(t," === '").concat(ba,"' || ").concat(t," === '").concat(pn,"'"),e,n),fj=(t,e,n)=>Ym("".concat(t," === '").concat(pn,"'"),e,n),cj=(t,e,n)=>Ym("".concat(t," === '").concat(wa,"'"),e,n),xA=(t,e,n)=>(e=e!=null?Nt(e):e,n=n!=null?Nt(n):n,Uv(e)&&Uv(n)?(e=e?e.signal||H(e.value):null,n=n?n.signal||H(n.value):null,{signal:"".concat(t," ? (").concat(e,") : (").concat(n,")")}):[Z({test:t},e)].concat(n||[])),Uv=t=>t==null||Object.keys(t).length===1,Ym=(t,e,n)=>({signal:"".concat(t," ? (").concat(Ir(e),") : (").concat(Ir(n),")")}),hj=(t,e,n,i,r)=>({signal:(i!=null?"".concat(t," === '").concat(ba,"' ? (").concat(Ir(i),") : "):"")+(n!=null?"".concat(t," === '").concat(Ti,"' ? (").concat(Ir(n),") : "):"")+(r!=null?"".concat(t," === '").concat(wa,"' ? (").concat(Ir(r),") : "):"")+(e!=null?"".concat(t," === '").concat(pn,"' ? (").concat(Ir(e),") : "):"")+"(null)"}),Ir=t=>St(t)?t.signal:t==null?null:H(t),dj=(t,e)=>e===0?0:St(t)?{signal:"(".concat(t.signal,") * ").concat(e)}:{value:t*e},Wr=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function Sr(t,e,n,i){let r;if(e&&V(e,t))return e[t];if(V(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":r="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":r=t[5].toLowerCase()+t.slice(6)}return i[Bm][r]}else if(t.startsWith("label")){switch(t){case"labelColor":r="fill";break;case"labelFont":case"labelFontSize":r=t[5].toLowerCase()+t.slice(6)}return i[Fu][r]}return null}function qv(t){const e={};for(const n of t)if(!!n)for(const i in n)e[i]=1;return Object.keys(e)}function gj(t,e){var n=e.config,i=n.style,r=n.axis,a=e.scaleType(t.scale)==="band"&&n.axisBand,o=t.orient,u,s,l;if(St(o)){const c=qv([n.axisX,n.axisY]),h=qv([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);u={};for(l of c)u[l]=Ot(o,Sr(l,n.axisX,r,i),Sr(l,n.axisY,r,i));s={};for(l of h)s[l]=hj(o.signal,Sr(l,n.axisTop,r,i),Sr(l,n.axisBottom,r,i),Sr(l,n.axisLeft,r,i),Sr(l,n.axisRight,r,i))}else u=o===pn||o===Ti?n.axisX:n.axisY,s=n["axis"+o[0].toUpperCase()+o.slice(1)];return u||s||a?Z({},r,u,s,a):r}function mj(t,e,n,i){const r=Se(t,e),a=t.orient;let o,u;const s={enter:o={opacity:rt},update:u={opacity:Ve},exit:{opacity:rt}};Ut(s,{stroke:r("domainColor"),strokeCap:r("domainCap"),strokeDash:r("domainDash"),strokeDashOffset:r("domainDashOffset"),strokeWidth:r("domainWidth"),strokeOpacity:r("domainOpacity")});const l=jv(t,0),f=jv(t,1);return o.x=u.x=Ot(a,l,rt),o.x2=u.x2=Ot(a,f),o.y=u.y=fn(a,l,rt),o.y2=u.y2=fn(a,f),Ie({type:Pm,role:LI,from:i,encode:s},n)}function jv(t,e){return{scale:t.scale,range:e}}function pj(t,e,n,i,r){const a=Se(t,e),o=t.orient,u=t.gridScale,s=Gf(o,1,-1),l=yj(t.offset,s);let f,c,h;const d={enter:f={opacity:rt},update:h={opacity:Ve},exit:c={opacity:rt}};Ut(d,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const g={scale:t.scale,field:Ge,band:r.band,extra:r.extra,offset:r.offset,round:a("tickRound")},m=Ot(o,{signal:"height"},{signal:"width"}),p=u?{scale:u,range:0,mult:s,offset:l}:{value:0,offset:l},y=u?{scale:u,range:1,mult:s,offset:l}:Z(m,{mult:s,offset:l});return f.x=h.x=Ot(o,g,p),f.y=h.y=fn(o,g,p),f.x2=h.x2=fn(o,y),f.y2=h.y2=Ot(o,y),c.x=Ot(o,g),c.y=fn(o,g),Ie({type:Pm,role:PI,key:Ge,from:i,encode:d},n)}function yj(t,e){if(e!==1)if(!J(t))t=St(e)?{signal:"(".concat(e.signal,") * (").concat(t||0,")")}:e*(t||0);else{let n=t=Z({},t);for(;n.mult!=null;)if(J(n.mult))n=n.mult=Z({},n.mult);else return n.mult=St(e)?{signal:"(".concat(n.mult,") * (").concat(e.signal,")")}:n.mult*e,t;n.mult=e}return t}function vj(t,e,n,i,r,a){const o=Se(t,e),u=t.orient,s=Gf(u,-1,1);let l,f,c;const h={enter:l={opacity:rt},update:c={opacity:Ve},exit:f={opacity:rt}};Ut(h,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const d=Nt(r);d.mult=s;const g={scale:t.scale,field:Ge,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return c.y=l.y=Ot(u,rt,g),c.y2=l.y2=Ot(u,d),f.x=Ot(u,g),c.x=l.x=fn(u,rt,g),c.x2=l.x2=fn(u,d),f.y=fn(u,g),Ie({type:Pm,role:UI,key:Ge,from:i,encode:h},n)}function eh(t,e,n,i,r){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+i+","+r+")"}}function xj(t,e,n,i,r,a){const o=Se(t,e),u=t.orient,s=t.scale,l=Gf(u,-1,1),f=Zi(o("labelFlush")),c=Zi(o("labelFlushOffset")),h=o("labelAlign"),d=o("labelBaseline");let g=f===0||!!f,m;const p=Nt(r);p.mult=l,p.offset=Nt(o("labelPadding")||0),p.offset.mult=l;const y={scale:s,field:Ge,band:.5,offset:hA(a.offset,o("labelOffset"))},v=Ot(u,g?eh(s,f,'"left"','"right"','"center"'):{value:"center"},oj(u,"left","right")),x=Ot(u,vA(u,"bottom","top"),g?eh(s,f,'"top"','"bottom"','"middle"'):{value:"middle"}),b=eh(s,f,"-(".concat(c,")"),c,0);g=g&&c;const _={opacity:rt,x:Ot(u,y,p),y:fn(u,y,p)},M={enter:_,update:m={opacity:Ve,text:{field:zm},x:_.x,y:_.y,align:v,baseline:x},exit:{opacity:rt,x:_.x,y:_.y}};Ut(M,{dx:!h&&g?Ot(u,b):null,dy:!d&&g?fn(u,b):null}),Ut(M,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:h,baseline:d});const w=o("labelBound");let k=o("labelOverlap");return k=k||w?{separation:o("labelSeparation"),method:k,order:"datum.index",bound:w?{scale:s,orient:u,tolerance:w}:null}:void 0,m.align!==v&&(m.align=Wr(m.align,v)),m.baseline!==x&&(m.baseline=Wr(m.baseline,x)),Ie({type:wr,role:II,style:Fu,key:Ge,from:i,encode:M,overlap:k},n)}function bj(t,e,n,i){const r=Se(t,e),a=t.orient,o=Gf(a,-1,1);let u,s;const l={enter:u={opacity:rt,anchor:Nt(r("titleAnchor",null)),align:{signal:Im}},update:s=Z({},u,{opacity:Ve,text:Nt(t.title)}),exit:{opacity:rt}},f={signal:'lerp(range("'.concat(t.scale,'"), ').concat(Yf(0,1,.5),")")};return s.x=Ot(a,f),s.y=fn(a,f),u.angle=Ot(a,rt,dj(o,90)),u.baseline=Ot(a,vA(a,Ti,pn),{value:Ti}),s.angle=u.angle,s.baseline=u.baseline,Ut(l,{fill:r("titleColor"),fillOpacity:r("titleOpacity"),font:r("titleFont"),fontSize:r("titleFontSize"),fontStyle:r("titleFontStyle"),fontWeight:r("titleFontWeight"),limit:r("titleLimit"),lineHeight:r("titleLineHeight")},{align:r("titleAlign"),angle:r("titleAngle"),baseline:r("titleBaseline")}),wj(r,a,l,n),l.update.align=Wr(l.update.align,u.align),l.update.angle=Wr(l.update.angle,u.angle),l.update.baseline=Wr(l.update.baseline,u.baseline),Ie({type:wr,role:qI,style:Bm,from:i,encode:l},n)}function wj(t,e,n,i){const r=(u,s)=>u!=null?(n.update[s]=Wr(Nt(u),n.update[s]),!1):!Tr(s,i),a=r(t("titleX"),"x"),o=r(t("titleY"),"y");n.enter.auto=o===a?Nt(o):Ot(e,Nt(o),Nt(a))}function _j(t,e){const n=gj(t,e),i=t.encode||{},r=i.axis||{},a=r.name||void 0,o=r.interactive,u=r.style,s=Se(t,n),l=vq(s),f={scale:t.scale,ticks:!!s("ticks"),labels:!!s("labels"),grid:!!s("grid"),domain:!!s("domain"),title:t.title!=null},c=q(e.add(mn({},[f]))),h=q(e.add(MU({scale:e.scaleRef(t.scale),extra:e.property(l.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),d=[];let g;return f.grid&&d.push(pj(t,n,i.grid,h,l)),f.ticks&&(g=s("tickSize"),d.push(vj(t,n,i.ticks,h,g,l))),f.labels&&(g=f.ticks?g:0,d.push(xj(t,n,i.labels,h,g,l))),f.domain&&d.push(mj(t,n,i.domain,c)),f.title&&d.push(bj(t,n,i.title,c)),Wf(tu({role:BI,from:c,encode:xa(Mj(s,t),r,$u),marks:d,aria:s("aria"),description:s("description"),zindex:s("zindex"),name:a,interactive:o,style:u}),e)}function Mj(t,e){const n={enter:{},update:{}};return Ut(n,{orient:t("orient"),offset:t("offset")||0,position:en(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:'abs(span(range("'.concat(e.scale,'")))')},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function bA(t,e,n){const i=G(t.signals),r=G(t.scales);return n||i.forEach(a=>Jk(a,e)),G(t.projections).forEach(a=>eq(a,e)),r.forEach(a=>jU(a,e)),G(t.data).forEach(a=>rj(a,e)),r.forEach(a=>YU(a,e)),(n||i).forEach(a=>_U(a,e)),G(t.axes).forEach(a=>_j(a,e)),G(t.marks).forEach(a=>Wf(a,e)),G(t.legends).forEach(a=>Wq(a,e)),t.title&&Qq(t.title,e),e.parseLambdas(),e}const kj=t=>xa({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function Aj(t,e){const n=e.config,i=q(e.root=e.add(zl())),r=Ej(t,n);r.forEach(l=>Jk(l,e)),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const a=e.add(mn()),o=e.add(eA(Zk(kj(t.encode),jf,Tm,t.style,e,{pulse:q(a)}))),u=e.add(rA({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:i,pulse:q(o)}));e.operators.pop(),e.pushState(q(o),q(u),null),bA(t,e,r),e.operators.push(u);let s=e.add(tA({mark:i,pulse:q(u)}));return s=e.add(iA({pulse:q(s)})),s=e.add(br({pulse:q(s)})),e.addData("root",new ur(e,a,a,s)),e}function Ha(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function Ej(t,e){const n=o=>en(t[o],e[o]),i=[Ha("background",n("background")),Ha("autosize",NI(n("autosize"))),Ha("padding",zI(n("padding"))),Ha("width",n("width")||0),Ha("height",n("height")||0)],r=i.reduce((o,u)=>(o[u.name]=u,o),{}),a={};return G(t.signals).forEach(o=>{V(r,o.name)?o=Z(r[o.name],o):i.push(o),a[o.name]=o}),G(e.signals).forEach(o=>{!V(a,o.name)&&!V(r,o.name)&&i.push(o)}),i}function wA(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Yv(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}wA.prototype=Yv.prototype={parse(t){return bA(t,this)},fork(){return new Yv(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach(e=>{e.$ref=t.id}),t.refs=null),t},proxy(t){const e=t instanceof Hd?q(t):t;return this.add(BU({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;this.root&&(this.root.root=!0);for(t in this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(i,r,a){let o,u;i&&(o=i.data||(i.data={}),u=o[r]||(o[r]=[]),u.push(a))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const i in e.index)n(e.index[i],t,"index:"+i)}return this},pushState(t,e,n){this._encode.push(q(this.add(br({pulse:t})))),this._parent.push(e),this._lookup.push(n?q(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return it(this._parent)},encode(){return it(this._encode)},lookup(){return it(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(vt(t))return Jo(t,e);t.signal||R("Unsupported field reference: "+H(t));const n=t.signal;let i=this.field[n];if(!i){const r={name:this.signalRef(n)};e&&(r.as=e),this.field[n]=i=q(this.add(CU(r)))}return i},compareRef(t){let e=!1;const n=a=>St(a)?(e=!0,this.signalRef(a.signal)):hU(a)?(e=!0,this.exprRef(a.expr)):a,i=G(t.field).map(n),r=G(t.order).map(n);return e?q(this.add(Fv({fields:i,orders:r}))):Dv(i,r)},keyRef(t,e){let n=!1;const i=a=>St(a)?(n=!0,q(r[a.signal])):a,r=this.signals;return t=G(t).map(i),n?q(this.add(DU({fields:t,flat:e}))):sU(t,e)},sortRef(t){if(!t)return t;const e=Uf(t.op,t.field),n=t.order||lU;return n.signal?q(this.add(Fv({fields:e,orders:this.signalRef(n.signal)}))):Dv(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const i=this.id();this.streams.push({id:i,source:t,type:e}),this.events[n]=i}return this.events[n]},hasOwnSignal(t){return V(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&R("Duplicate signal name: "+H(t));const n=e instanceof Hd?e:this.add(zl(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||R("Unrecognized signal name: "+H(t)),this.signals[t]},signalRef(t){return this.signals[t]?q(this.signals[t]):(V(this.lambdas,t)||(this.lambdas[t]=this.add(zl(null))),q(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const i=t[e],r=Rn(i,this),a=this.lambdas[i];a.params=r.$params,a.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return!t||!J(t)?t:this.signalRef(t.signal||Hm(t))},exprRef(t,e){const n={expr:Rn(t,this)};return e&&(n.expr.$name=e),q(this.add(AU(n)))},addBinding(t,e){this.bindings||R("Nested signals do not support binding: "+H(t)),this.bindings.push(Z({signal:t},e))},addScaleProj(t,e){V(this.scales,t)&&R("Duplicate scale or projection name: "+H(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,PU(e))},addProjection(t,e){this.addScaleProj(t,zU(e))},getScale(t){return this.scales[t]||R("Unrecognized scale name: "+H(t)),this.scales[t]},scaleRef(t){return q(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return V(this.data,t)&&R("Duplicate data set name: "+H(t)),this.data[t]=e},getData(t){return this.data[t]||R("Undefined data set name: "+H(t)),this.data[t]},addDataPipeline(t,e){return V(this.data,t)&&R("Duplicate data set name: "+H(t)),this.addData(t,ur.fromEntries(this,e))}};function Hm(t){return(Y(t)?Cj:Dj)(t)}function Cj(t){const e=t.length;let n="[";for(let i=0;i<e;++i){const r=t[i];n+=(i>0?",":"")+(J(r)?r.signal||Hm(r):H(r))}return n+"]"}function Dj(t){let e="{",n=0,i,r;for(i in t)r=t[i],e+=(++n>1?",":"")+H(i)+":"+(J(r)?r.signal||Hm(r):H(r));return e+"}"}function Sj(){const t="sans-serif",i="#4c78a8",r="#000",a="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:r},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:r,font:t,fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:r,font:t,fontSize:10},"guide-title":{fill:r,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:r,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:r,font:t,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:a,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:a,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function Fj(t,e,n){return J(t)||R("Input Vega specification must be an object."),e=ex(Sj(),e,t.config),Aj(t,new wA(e,n)).toRuntime()}var $j="vega",Tj="5.20.2",Rj="The Vega visualization grammar.",Nj=["vega","visualization","interaction","dataflow","library","data","d3"],Oj="BSD-3-Clause",zj="UW Interactive Data Lab (http://idl.cs.washington.edu)",Bj="build/vega-node.js",Lj="build/vega.module.js",Pj="build/vega.min.js",Ij="build/vega.min.js",Uj="index.d.ts",qj="vega/vega",jj={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},Yj={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.21.0","vega-util":"~1.16.1","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},Hj={"vega-schema":"*"},Wj="e251dbc61ab6645689d9f349e7dd9d15ddb85bce",Gj={name:$j,version:Tj,description:Rj,keywords:Nj,license:Oj,author:zj,main:Bj,module:Lj,unpkg:Pj,jsdelivr:Ij,types:Uj,repository:qj,scripts:jj,dependencies:Yj,devDependencies:Hj,gitHead:Wj};Z(Xr,l8,SF,b$,uR,$R,aO,NN,uO,kO,NO,WO);const Vj=Gj.version;var Kj=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",version:Vj,Dataflow:Ur,EventStream:Gl,MultiPulse:x0,Operator:mt,Parameters:Wl,Pulse:bi,Transform:S,changeset:cr,definition:Sb,ingest:ft,isTuple:Yl,transform:Fb,transforms:Xr,tupleid:j,interpolate:Ng,interpolateColors:hf,interpolateRange:L_,quantizeInterpolator:P_,scale:st,scheme:Og,projection:R1,View:Lk,defaultLocale:y0,formatLocale:Ns,locale:wb,resetDefaultLocale:pC,timeFormatLocale:No,expressionFunction:Et,parse:Fj,runtimeContext:Mk,codegenExpression:U5,parseExpression:L5,parseSelector:Hk,Debug:Qv,Error:Jd,Info:Jv,None:Kv,Warn:Zv,accessor:De,accessorFields:Zt,accessorName:kt,array:G,ascending:Il,clampRange:hx,compare:i0,constant:ee,debounce:r0,error:R,extend:Z,extent:Fn,extentIndex:dx,falsy:ni,fastmap:ca,field:ke,flush:gx,hasOwnProperty:V,id:eu,identity:de,inherits:z,inrange:Rr,isArray:Y,isBoolean:mx,isDate:xi,isFunction:Q,isIterable:px,isNumber:Mi,isObject:J,isRegExp:yx,isString:vt,key:a0,lerp:vx,logger:tx,lruCache:xx,merge:bx,mergeConfig:ex,one:fa,pad:wx,panLinear:ox,panLog:ux,panPow:sx,panSymlog:lx,peek:it,quarter:fx,repeat:Wa,span:nu,splitAccessPath:Bl,stringValue:H,toBoolean:o0,toDate:u0,toNumber:Kt,toSet:cn,toString:s0,truncate:_x,truthy:Xe,utcquarter:cx,visitArray:ri,writeConfig:Qd,zero:li,zoomLinear:t0,zoomLog:e0,zoomPow:Ts,zoomSymlog:n0,bandwidthNRD:k0,bin:Rb,bootstrapCI:Nb,cumulativeLogNormal:F0,cumulativeNormal:Xl,cumulativeUniform:N0,densityLogNormal:S0,densityNormal:A0,densityUniform:R0,dotbin:Ob,quantileLogNormal:$0,quantileNormal:Kl,quantileUniform:O0,quantiles:_0,quartiles:M0,get random(){return Ze},randomInteger:s4,randomKDE:C0,randomLCG:u4,randomLogNormal:Bb,randomMixture:Lb,randomNormal:E0,randomUniform:Pb,regressionExp:Ub,regressionLinear:z0,regressionLoess:Yb,regressionLog:Ib,regressionPoly:jb,regressionPow:qb,regressionQuad:B0,sampleCurve:Jl,sampleLogNormal:D0,sampleNormal:Vl,sampleUniform:T0,setRandom:a4,DATE:Ee,DAY:Xt,DAYOFYEAR:$n,HOURS:ze,MILLISECONDS:hn,MINUTES:Be,MONTH:Jt,QUARTER:Ae,SECONDS:Ke,TIME_UNITS:g0,WEEK:Dt,YEAR:It,dayofyear:qx,timeBin:ab,timeFloor:Xx,timeInterval:ha,timeOffset:Jx,timeSequence:eb,timeUnitSpecifier:Ux,timeUnits:m0,utcFloor:Kx,utcInterval:da,utcOffset:Qx,utcSequence:nb,utcdayofyear:Hx,utcweek:Wx,week:jx,read:_b,inferType:kx,inferTypes:Ax,typeParsers:rh,format:ss,formats:c0,responseType:Sx,loader:ql,Bounds:Ft,CanvasHandler:xu,CanvasRenderer:Xs,Gradient:J_,GroupItem:mf,Handler:Fi,Item:gf,Marks:Le,RenderType:gi,Renderer:zn,ResourceLoader:qg,SVGHandler:o1,SVGRenderer:h1,SVGStringRenderer:d1,Scenegraph:r1,boundClip:W3,boundContext:mu,boundItem:qh,boundMark:y3,boundStroke:Zn,domChild:be,domClear:an,domCreate:hi,domFind:a1,font:bf,fontFamily:vu,fontSize:On,intersect:q3,intersectBoxLine:zr,intersectPath:jg,intersectPoint:Yg,intersectRule:o3,lineHeight:Di,markup:c1,multiLineOffset:e1,pathCurves:Pg,pathEqual:G3,pathParse:ta,pathRectangle:e3,pathRender:Bo,pathSymbols:t3,pathTrail:n3,point:_f,renderModule:Mf,resetSVGClipId:r3,resetSVGDefIds:H9,sceneEqual:g1,sceneFromJSON:x3,scenePickVisit:js,sceneToJSON:v3,sceneVisit:dn,sceneZOrder:Hg,serializeXML:N3,textMetrics:En});export{H as $,Zv as W,vt as a,J as b,mx as c,Y as d,Q as e,G as f,Hk as g,V as h,Mi as i,de as j,tx as l,ex as m,Bl as s,cn as t,Kj as v,Qd as w};
