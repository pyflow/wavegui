import{R as Rf,r as nw,j as gg,k as pg,C as mg,l as Dy,m as $y,n as uu,o as yl,p as Fy,q as g6,s as p6,u as m6,v as y6,w as v6,x as rw,t as x6,y as b6}from"./index-fe0329c3.js";function iw(t){for(var e=t.length,n,r=-1,i=0,a,o;++r<e;)i+=t[r].length;for(a=new Array(i);--e>=0;)for(o=t[e],n=o.length;--n>=0;)a[--i]=o[n];return a}var aw=Math.PI/180,ow=180/Math.PI,vl=18,uw=.96422,sw=1,lw=.82521,fw=4/29,ma=6/29,cw=3*ma*ma,w6=ma*ma*ma;function hw(t){if(t instanceof Un)return new Un(t.l,t.a,t.b,t.opacity);if(t instanceof lr)return dw(t);t instanceof Rf||(t=nw(t));var e=Kc(t.r),n=Kc(t.g),r=Kc(t.b),i=Vc((.2225045*e+.7168786*n+.0606169*r)/sw),a,o;return e===n&&n===r?a=o=i:(a=Vc((.4360747*e+.3850649*n+.1430804*r)/uw),o=Vc((.0139322*e+.0971045*n+.7141733*r)/lw)),new Un(116*i-16,500*(a-i),200*(i-o),t.opacity)}function d0(t,e,n,r){return arguments.length===1?hw(t):new Un(t,e,n,r==null?1:r)}function Un(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}gg(Un,d0,pg(mg,{brighter:function(t){return new Un(this.l+vl*(t==null?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Un(this.l-vl*(t==null?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=uw*Xc(e),t=sw*Xc(t),n=lw*Xc(n),new Rf(Zc(3.1338561*e-1.6168667*t-.4906146*n),Zc(-.9787684*e+1.9161415*t+.033454*n),Zc(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function Vc(t){return t>w6?Math.pow(t,1/3):t/cw+fw}function Xc(t){return t>ma?t*t*t:cw*(t-fw)}function Zc(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Kc(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function _6(t){if(t instanceof lr)return new lr(t.h,t.c,t.l,t.opacity);if(t instanceof Un||(t=hw(t)),t.a===0&&t.b===0)return new lr(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*ow;return new lr(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function g0(t,e,n,r){return arguments.length===1?_6(t):new lr(t,e,n,r==null?1:r)}function lr(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function dw(t){if(isNaN(t.h))return new Un(t.l,0,0,t.opacity);var e=t.h*aw;return new Un(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}gg(lr,g0,pg(mg,{brighter:function(t){return new lr(this.h,this.c,this.l+vl*(t==null?1:t),this.opacity)},darker:function(t){return new lr(this.h,this.c,this.l-vl*(t==null?1:t),this.opacity)},rgb:function(){return dw(this).rgb()}}));var gw=-.14861,yg=1.78277,vg=-.29227,Nf=-.90649,su=1.97294,Ty=su*Nf,Ry=su*yg,Ny=yg*vg-Nf*gw;function M6(t){if(t instanceof xi)return new xi(t.h,t.s,t.l,t.opacity);t instanceof Rf||(t=nw(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Ny*r+Ty*e-Ry*n)/(Ny+Ty-Ry),a=r-i,o=(su*(n-i)-vg*a)/Nf,u=Math.sqrt(o*o+a*a)/(su*i*(1-i)),s=u?Math.atan2(o,a)*ow-120:NaN;return new xi(s<0?s+360:s,u,i,t.opacity)}function p0(t,e,n,r){return arguments.length===1?M6(t):new xi(t,e,n,r==null?1:r)}function xi(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}gg(xi,p0,pg(mg,{brighter:function(t){return t=t==null?Dy:Math.pow(Dy,t),new xi(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?$y:Math.pow($y,t),new xi(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*aw,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Rf(255*(e+n*(gw*r+yg*i)),255*(e+n*(vg*r+Nf*i)),255*(e+n*(su*r)),this.opacity)}}));function k6(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return pw(this.cover(e,n),e,n,t)}function pw(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a=t._root,o={data:r},u=t._x0,s=t._y0,l=t._x1,f=t._y1,c,h,d,g,p,m,y,v;if(!a)return t._root=o,t;for(;a.length;)if((p=e>=(c=(u+l)/2))?u=c:l=c,(m=n>=(h=(s+f)/2))?s=h:f=h,i=a,!(a=a[y=m<<1|p]))return i[y]=o,t;if(d=+t._x.call(null,a.data),g=+t._y.call(null,a.data),e===d&&n===g)return o.next=a,i?i[y]=o:t._root=o,t;do i=i?i[y]=new Array(4):t._root=new Array(4),(p=e>=(c=(u+l)/2))?u=c:l=c,(m=n>=(h=(s+f)/2))?s=h:f=h;while((y=m<<1|p)===(v=(g>=h)<<1|d>=c));return i[v]=a,i[y]=o,t}function A6(t){var e,n,r=t.length,i,a,o=new Array(r),u=new Array(r),s=1/0,l=1/0,f=-1/0,c=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(o[n]=i,u[n]=a,i<s&&(s=i),i>f&&(f=i),a<l&&(l=a),a>c&&(c=a));if(s>f||l>c)return this;for(this.cover(s,l).cover(f,c),n=0;n<r;++n)pw(this,o[n],u[n],t[n]);return this}function E6(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o=i-n,u=this._root,s,l;n>t||t>=i||r>e||e>=a;)switch(l=(e<r)<<1|t<n,s=new Array(4),s[l]=u,u=s,o*=2,l){case 0:i=n+o,a=r+o;break;case 1:n=i-o,a=r+o;break;case 2:i=n+o,r=a-o;break;case 3:n=i-o,r=a-o;break}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this}function C6(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function S6(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Me(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function D6(t,e,n){var r,i=this._x0,a=this._y0,o,u,s,l,f=this._x1,c=this._y1,h=[],d=this._root,g,p;for(d&&h.push(new Me(d,i,a,f,c)),n==null?n=1/0:(i=t-n,a=e-n,f=t+n,c=e+n,n*=n);g=h.pop();)if(!(!(d=g.node)||(o=g.x0)>f||(u=g.y0)>c||(s=g.x1)<i||(l=g.y1)<a))if(d.length){var m=(o+s)/2,y=(u+l)/2;h.push(new Me(d[3],m,y,s,l),new Me(d[2],o,y,m,l),new Me(d[1],m,u,s,y),new Me(d[0],o,u,m,y)),(p=(e>=y)<<1|t>=m)&&(g=h[h.length-1],h[h.length-1]=h[h.length-1-p],h[h.length-1-p]=g)}else{var v=t-+this._x.call(null,d.data),x=e-+this._y.call(null,d.data),b=v*v+x*x;if(b<n){var _=Math.sqrt(n=b);i=t-_,a=e-_,f=t+_,c=e+_,r=d.data}}return r}function $6(t){if(isNaN(f=+this._x.call(null,t))||isNaN(c=+this._y.call(null,t)))return this;var e,n=this._root,r,i,a,o=this._x0,u=this._y0,s=this._x1,l=this._y1,f,c,h,d,g,p,m,y;if(!n)return this;if(n.length)for(;;){if((g=f>=(h=(o+s)/2))?o=h:s=h,(p=c>=(d=(u+l)/2))?u=d:l=d,e=n,!(n=n[m=p<<1|g]))return this;if(!n.length)break;(e[m+1&3]||e[m+2&3]||e[m+3&3])&&(r=e,y=m)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(a=n.next)&&delete n.next,i?(a?i.next=a:delete i.next,this):e?(a?e[m]=a:delete e[m],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[y]=n:this._root=n),this):(this._root=a,this)}function F6(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function T6(){return this._root}function R6(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function N6(t){var e=[],n,r=this._root,i,a,o,u,s;for(r&&e.push(new Me(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,a=n.x0,o=n.y0,u=n.x1,s=n.y1)&&r.length){var l=(a+u)/2,f=(o+s)/2;(i=r[3])&&e.push(new Me(i,l,f,u,s)),(i=r[2])&&e.push(new Me(i,a,f,l,s)),(i=r[1])&&e.push(new Me(i,l,o,u,f)),(i=r[0])&&e.push(new Me(i,a,o,l,f))}return this}function O6(t){var e=[],n=[],r;for(this._root&&e.push(new Me(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var a,o=r.x0,u=r.y0,s=r.x1,l=r.y1,f=(o+s)/2,c=(u+l)/2;(a=i[0])&&e.push(new Me(a,o,u,f,c)),(a=i[1])&&e.push(new Me(a,f,u,s,c)),(a=i[2])&&e.push(new Me(a,o,c,f,l)),(a=i[3])&&e.push(new Me(a,f,c,s,l))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function z6(t){return t[0]}function L6(t){return arguments.length?(this._x=t,this):this._x}function B6(t){return t[1]}function P6(t){return arguments.length?(this._y=t,this):this._y}function xg(t,e,n){var r=new bg(e==null?z6:e,n==null?B6:n,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function bg(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function Oy(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var De=xg.prototype=bg.prototype;De.copy=function(){var t=new bg(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=Oy(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=Oy(r));return t};De.add=k6;De.addAll=A6;De.cover=E6;De.data=C6;De.extent=S6;De.find=D6;De.remove=$6;De.removeAll=F6;De.root=T6;De.size=R6;De.visit=N6;De.visitAfter=O6;De.x=L6;De.y=P6;function U6(){return new xl}function xl(){this.reset()}xl.prototype={constructor:xl,reset:function(){this.s=this.t=0},add:function(t){zy(ds,t,this.t),zy(this,ds.s,this.s),this.s?this.t+=ds.t:this.s=ds.t},valueOf:function(){return this.s}};var ds=new xl;function zy(t,e,n){var r=t.s=e+n,i=r-e,a=r-i;t.t=e-a+(n-i)}var Mt=1e-6,ut=Math.PI,tn=ut/2,Ly=ut/4,Mn=ut*2,nr=180/ut,je=ut/180,Bt=Math.abs,I6=Math.atan,lu=Math.atan2,zt=Math.cos,Lt=Math.sin,q6=Math.sign||function(t){return t>0?1:t<0?-1:0},Of=Math.sqrt;function j6(t){return t>1?0:t<-1?ut:Math.acos(t)}function fu(t){return t>1?tn:t<-1?-tn:Math.asin(t)}function Eo(){}function bl(t,e){t&&Py.hasOwnProperty(t.type)&&Py[t.type](t,e)}var By={Feature:function(t,e){bl(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)bl(n[r].geometry,e)}},Py={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){m0(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)m0(n[r],e,0)},Polygon:function(t,e){Uy(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Uy(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)bl(n[r],e)}};function m0(t,e,n){var r=-1,i=t.length-n,a;for(e.lineStart();++r<i;)a=t[r],e.point(a[0],a[1],a[2]);e.lineEnd()}function Uy(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)m0(t[n],e,1);e.polygonEnd()}function Y6(t,e){t&&By.hasOwnProperty(t.type)?By[t.type](t,e):bl(t,e)}function y0(t){return[lu(t[1],t[0]),fu(t[2])]}function Ma(t){var e=t[0],n=t[1],r=zt(n);return[r*zt(e),r*Lt(e),Lt(n)]}function gs(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function wl(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Qc(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function ps(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function v0(t){var e=Of(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function x0(t,e){function n(r,i){return r=t(r,i),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,i){return r=e.invert(r,i),r&&t.invert(r[0],r[1])}),n}function b0(t,e){return[Bt(t)>ut?t+Math.round(-t/Mn)*Mn:t,e]}b0.invert=b0;function W6(t,e,n){return(t%=Mn)?e||n?x0(qy(t),jy(e,n)):qy(t):e||n?jy(e,n):b0}function Iy(t){return function(e,n){return e+=t,[e>ut?e-Mn:e<-ut?e+Mn:e,n]}}function qy(t){var e=Iy(t);return e.invert=Iy(-t),e}function jy(t,e){var n=zt(t),r=Lt(t),i=zt(e),a=Lt(e);function o(u,s){var l=zt(s),f=zt(u)*l,c=Lt(u)*l,h=Lt(s),d=h*n+f*r;return[lu(c*i-d*a,f*n-h*r),fu(d*i+c*a)]}return o.invert=function(u,s){var l=zt(s),f=zt(u)*l,c=Lt(u)*l,h=Lt(s),d=h*i-c*a;return[lu(c*i+h*a,f*n+d*r),fu(d*n-f*r)]},o}function H6(t,e,n,r,i,a){if(n){var o=zt(e),u=Lt(e),s=r*n;i==null?(i=e+r*Mn,a=e-s/2):(i=Yy(o,i),a=Yy(o,a),(r>0?i<a:i>a)&&(i+=r*Mn));for(var l,f=i;r>0?f>a:f<a;f-=s)l=y0([o,-u*zt(f),-u*Lt(f)]),t.point(l[0],l[1])}}function Yy(t,e){e=Ma(e),e[0]-=t,v0(e);var n=j6(-e[1]);return((-e[2]<0?-n:n)+Mn-Mt)%Mn}function mw(){var t=[],e;return{point:function(n,r,i){e.push([n,r,i])},lineStart:function(){t.push(e=[])},lineEnd:Eo,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function Vs(t,e){return Bt(t[0]-e[0])<Mt&&Bt(t[1]-e[1])<Mt}function ms(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function yw(t,e,n,r,i){var a=[],o=[],u,s;if(t.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(Vs(m,y)){if(!m[2]&&!y[2]){for(i.lineStart(),u=0;u<p;++u)i.point((m=g[u])[0],m[1]);i.lineEnd();return}y[0]+=2*Mt}a.push(v=new ms(m,g,null,!0)),o.push(v.o=new ms(m,null,v,!1)),a.push(v=new ms(y,g,null,!1)),o.push(v.o=new ms(y,null,v,!0))}}),!!a.length){for(o.sort(e),Wy(a),Wy(o),u=0,s=o.length;u<s;++u)o[u].e=n=!n;for(var l=a[0],f,c;;){for(var h=l,d=!0;h.v;)if((h=h.n)===l)return;f=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(u=0,s=f.length;u<s;++u)i.point((c=f[u])[0],c[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(f=h.p.z,u=f.length-1;u>=0;--u)i.point((c=f[u])[0],c[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,f=h.z,d=!d}while(!h.v);i.lineEnd()}}}function Wy(t){if(e=t.length){for(var e,n=0,r=t[0],i;++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}var Jc=U6();function th(t){return Bt(t[0])<=ut?t[0]:q6(t[0])*((Bt(t[0])+ut)%Mn-ut)}function G6(t,e){var n=th(e),r=e[1],i=Lt(r),a=[Lt(n),-zt(n),0],o=0,u=0;Jc.reset(),i===1?r=tn+Mt:i===-1&&(r=-tn-Mt);for(var s=0,l=t.length;s<l;++s)if(c=(f=t[s]).length)for(var f,c,h=f[c-1],d=th(h),g=h[1]/2+Ly,p=Lt(g),m=zt(g),y=0;y<c;++y,d=x,p=_,m=M,h=v){var v=f[y],x=th(v),b=v[1]/2+Ly,_=Lt(b),M=zt(b),w=x-d,A=w>=0?1:-1,S=A*w,C=S>ut,E=p*_;if(Jc.add(lu(E*A*Lt(S),m*M+E*zt(S))),o+=C?w+A*Mn:w,C^d>=n^x>=n){var $=wl(Ma(h),Ma(v));v0($);var F=wl(a,$);v0(F);var L=(C^w>=0?-1:1)*fu(F[2]);(r>L||r===L&&($[0]||$[1]))&&(u+=C^w>=0?1:-1)}}return(o<-Mt||o<Mt&&Jc<-Mt)^u&1}function vw(t,e,n,r){return function(i){var a=e(i),o=mw(),u=e(o),s=!1,l,f,c,h={point:d,lineStart:p,lineEnd:m,polygonStart:function(){h.point=y,h.lineStart=v,h.lineEnd=x,f=[],l=[]},polygonEnd:function(){h.point=d,h.lineStart=p,h.lineEnd=m,f=iw(f);var b=G6(l,r);f.length?(s||(i.polygonStart(),s=!0),yw(f,X6,b,n,i)):b&&(s||(i.polygonStart(),s=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),s&&(i.polygonEnd(),s=!1),f=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(b,_){t(b,_)&&i.point(b,_)}function g(b,_){a.point(b,_)}function p(){h.point=g,a.lineStart()}function m(){h.point=d,a.lineEnd()}function y(b,_){c.push([b,_]),u.point(b,_)}function v(){u.lineStart(),c=[]}function x(){y(c[0][0],c[0][1]),u.lineEnd();var b=u.clean(),_=o.result(),M,w=_.length,A,S,C;if(c.pop(),l.push(c),c=null,!!w){if(b&1){if(S=_[0],(A=S.length-1)>0){for(s||(i.polygonStart(),s=!0),i.lineStart(),M=0;M<A;++M)i.point((C=S[M])[0],C[1]);i.lineEnd()}return}w>1&&b&2&&_.push(_.pop().concat(_.shift())),f.push(_.filter(V6))}}return h}}function V6(t){return t.length>1}function X6(t,e){return((t=t.x)[0]<0?t[1]-tn-Mt:tn-t[1])-((e=e.x)[0]<0?e[1]-tn-Mt:tn-e[1])}const Hy=vw(function(){return!0},Z6,Q6,[-ut,-tn]);function Z6(t){var e=NaN,n=NaN,r=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(a,o){var u=a>0?ut:-ut,s=Bt(a-e);Bt(s-ut)<Mt?(t.point(e,n=(n+o)/2>0?tn:-tn),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),t.point(a,n),i=0):r!==u&&s>=ut&&(Bt(e-r)<Mt&&(e-=r*Mt),Bt(a-u)<Mt&&(a-=u*Mt),n=K6(e,n,a,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),i=0),t.point(e=a,n=o),r=u},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-i}}}function K6(t,e,n,r){var i,a,o=Lt(t-n);return Bt(o)>Mt?I6((Lt(e)*(a=zt(r))*Lt(n)-Lt(r)*(i=zt(e))*Lt(t))/(i*a*o)):(e+r)/2}function Q6(t,e,n,r){var i;if(t==null)i=n*tn,r.point(-ut,i),r.point(0,i),r.point(ut,i),r.point(ut,0),r.point(ut,-i),r.point(0,-i),r.point(-ut,-i),r.point(-ut,0),r.point(-ut,i);else if(Bt(t[0]-e[0])>Mt){var a=t[0]<e[0]?ut:-ut;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}function J6(t){var e=zt(t),n=6*je,r=e>0,i=Bt(e)>Mt;function a(f,c,h,d){H6(d,t,n,h,f,c)}function o(f,c){return zt(f)*zt(c)>e}function u(f){var c,h,d,g,p;return{lineStart:function(){g=d=!1,p=1},point:function(m,y){var v=[m,y],x,b=o(m,y),_=r?b?0:l(m,y):b?l(m+(m<0?ut:-ut),y):0;if(!c&&(g=d=b)&&f.lineStart(),b!==d&&(x=s(c,v),(!x||Vs(c,x)||Vs(v,x))&&(v[2]=1)),b!==d)p=0,b?(f.lineStart(),x=s(v,c),f.point(x[0],x[1])):(x=s(c,v),f.point(x[0],x[1],2),f.lineEnd()),c=x;else if(i&&c&&r^b){var M;!(_&h)&&(M=s(v,c,!0))&&(p=0,r?(f.lineStart(),f.point(M[0][0],M[0][1]),f.point(M[1][0],M[1][1]),f.lineEnd()):(f.point(M[1][0],M[1][1]),f.lineEnd(),f.lineStart(),f.point(M[0][0],M[0][1],3)))}b&&(!c||!Vs(c,v))&&f.point(v[0],v[1]),c=v,d=b,h=_},lineEnd:function(){d&&f.lineEnd(),c=null},clean:function(){return p|(g&&d)<<1}}}function s(f,c,h){var d=Ma(f),g=Ma(c),p=[1,0,0],m=wl(d,g),y=gs(m,m),v=m[0],x=y-v*v;if(!x)return!h&&f;var b=e*y/x,_=-e*v/x,M=wl(p,m),w=ps(p,b),A=ps(m,_);Qc(w,A);var S=M,C=gs(w,S),E=gs(S,S),$=C*C-E*(gs(w,w)-1);if(!($<0)){var F=Of($),L=ps(S,(-C-F)/E);if(Qc(L,w),L=y0(L),!h)return L;var k=f[0],T=c[0],B=f[1],U=c[1],q;T<k&&(q=k,k=T,T=q);var it=T-k,lt=Bt(it-ut)<Mt,At=lt||it<Mt;if(!lt&&U<B&&(q=B,B=U,U=q),At?lt?B+U>0^L[1]<(Bt(L[0]-k)<Mt?B:U):B<=L[1]&&L[1]<=U:it>ut^(k<=L[0]&&L[0]<=T)){var bt=ps(S,(-C+F)/E);return Qc(bt,w),[L,y0(bt)]}}}function l(f,c){var h=r?t:ut-t,d=0;return f<-h?d|=1:f>h&&(d|=2),c<-h?d|=4:c>h&&(d|=8),d}return vw(o,u,a,r?[0,-t]:[-ut,t-ut])}function t4(t,e,n,r,i,a){var o=t[0],u=t[1],s=e[0],l=e[1],f=0,c=1,h=s-o,d=l-u,g;if(g=n-o,!(!h&&g>0)){if(g/=h,h<0){if(g<f)return;g<c&&(c=g)}else if(h>0){if(g>c)return;g>f&&(f=g)}if(g=i-o,!(!h&&g<0)){if(g/=h,h<0){if(g>c)return;g>f&&(f=g)}else if(h>0){if(g<f)return;g<c&&(c=g)}if(g=r-u,!(!d&&g>0)){if(g/=d,d<0){if(g<f)return;g<c&&(c=g)}else if(d>0){if(g>c)return;g>f&&(f=g)}if(g=a-u,!(!d&&g<0)){if(g/=d,d<0){if(g>c)return;g>f&&(f=g)}else if(d>0){if(g<f)return;g<c&&(c=g)}return f>0&&(t[0]=o+f*h,t[1]=u+f*d),c<1&&(e[0]=o+c*h,e[1]=u+c*d),!0}}}}}var Co=1e9,ys=-Co;function e4(t,e,n,r){function i(l,f){return t<=l&&l<=n&&e<=f&&f<=r}function a(l,f,c,h){var d=0,g=0;if(l==null||(d=o(l,c))!==(g=o(f,c))||s(l,f)<0^c>0)do h.point(d===0||d===3?t:n,d>1?r:e);while((d=(d+c+4)%4)!==g);else h.point(f[0],f[1])}function o(l,f){return Bt(l[0]-t)<Mt?f>0?0:3:Bt(l[0]-n)<Mt?f>0?2:1:Bt(l[1]-e)<Mt?f>0?1:0:f>0?3:2}function u(l,f){return s(l.x,f.x)}function s(l,f){var c=o(l,1),h=o(f,1);return c!==h?c-h:c===0?f[1]-l[1]:c===1?l[0]-f[0]:c===2?l[1]-f[1]:f[0]-l[0]}return function(l){var f=l,c=mw(),h,d,g,p,m,y,v,x,b,_,M,w={point:A,lineStart:$,lineEnd:F,polygonStart:C,polygonEnd:E};function A(k,T){i(k,T)&&f.point(k,T)}function S(){for(var k=0,T=0,B=d.length;T<B;++T)for(var U=d[T],q=1,it=U.length,lt=U[0],At,bt,Dt=lt[0],Ot=lt[1];q<it;++q)At=Dt,bt=Ot,lt=U[q],Dt=lt[0],Ot=lt[1],bt<=r?Ot>r&&(Dt-At)*(r-bt)>(Ot-bt)*(t-At)&&++k:Ot<=r&&(Dt-At)*(r-bt)<(Ot-bt)*(t-At)&&--k;return k}function C(){f=c,h=[],d=[],M=!0}function E(){var k=S(),T=M&&k,B=(h=iw(h)).length;(T||B)&&(l.polygonStart(),T&&(l.lineStart(),a(null,null,1,l),l.lineEnd()),B&&yw(h,u,k,a,l),l.polygonEnd()),f=l,h=d=g=null}function $(){w.point=L,d&&d.push(g=[]),_=!0,b=!1,v=x=NaN}function F(){h&&(L(p,m),y&&b&&c.rejoin(),h.push(c.result())),w.point=A,b&&f.lineEnd()}function L(k,T){var B=i(k,T);if(d&&g.push([k,T]),_)p=k,m=T,y=B,_=!1,B&&(f.lineStart(),f.point(k,T));else if(B&&b)f.point(k,T);else{var U=[v=Math.max(ys,Math.min(Co,v)),x=Math.max(ys,Math.min(Co,x))],q=[k=Math.max(ys,Math.min(Co,k)),T=Math.max(ys,Math.min(Co,T))];t4(U,q,t,e,n,r)?(b||(f.lineStart(),f.point(U[0],U[1])),f.point(q[0],q[1]),B||f.lineEnd(),M=!1):B&&(f.lineStart(),f.point(k,T),M=!1)}v=k,x=T,b=B}return w}}function Gy(t){return t}var ka=1/0,_l=ka,cu=-ka,Ml=cu,n4={point:r4,lineStart:Eo,lineEnd:Eo,polygonStart:Eo,polygonEnd:Eo,result:function(){var t=[[ka,_l],[cu,Ml]];return cu=Ml=-(_l=ka=1/0),t}};function r4(t,e){t<ka&&(ka=t),t>cu&&(cu=t),e<_l&&(_l=e),e>Ml&&(Ml=e)}const Vy=n4;function wg(t){return function(e){var n=new w0;for(var r in t)n[r]=t[r];return n.stream=e,n}}function w0(){}w0.prototype={constructor:w0,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function _g(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),Y6(n,t.stream(Vy)),e(Vy.result()),r!=null&&t.clipExtent(r),t}function xw(t,e,n){return _g(t,function(r){var i=e[1][0]-e[0][0],a=e[1][1]-e[0][1],o=Math.min(i/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),u=+e[0][0]+(i-o*(r[1][0]+r[0][0]))/2,s=+e[0][1]+(a-o*(r[1][1]+r[0][1]))/2;t.scale(150*o).translate([u,s])},n)}function i4(t,e,n){return xw(t,[[0,0],e],n)}function a4(t,e,n){return _g(t,function(r){var i=+e,a=i/(r[1][0]-r[0][0]),o=(i-a*(r[1][0]+r[0][0]))/2,u=-a*r[0][1];t.scale(150*a).translate([o,u])},n)}function o4(t,e,n){return _g(t,function(r){var i=+e,a=i/(r[1][1]-r[0][1]),o=-a*r[0][0],u=(i-a*(r[1][1]+r[0][1]))/2;t.scale(150*a).translate([o,u])},n)}var Xy=16,u4=zt(30*je);function Zy(t,e){return+e?l4(t,e):s4(t)}function s4(t){return wg({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function l4(t,e){function n(r,i,a,o,u,s,l,f,c,h,d,g,p,m){var y=l-r,v=f-i,x=y*y+v*v;if(x>4*e&&p--){var b=o+h,_=u+d,M=s+g,w=Of(b*b+_*_+M*M),A=fu(M/=w),S=Bt(Bt(M)-1)<Mt||Bt(a-c)<Mt?(a+c)/2:lu(_,b),C=t(S,A),E=C[0],$=C[1],F=E-r,L=$-i,k=v*F-y*L;(k*k/x>e||Bt((y*F+v*L)/x-.5)>.3||o*h+u*d+s*g<u4)&&(n(r,i,a,o,u,s,E,$,S,b/=w,_/=w,M,p,m),m.point(E,$),n(E,$,S,b,_,M,l,f,c,h,d,g,p,m))}}return function(r){var i,a,o,u,s,l,f,c,h,d,g,p,m={point:y,lineStart:v,lineEnd:b,polygonStart:function(){r.polygonStart(),m.lineStart=_},polygonEnd:function(){r.polygonEnd(),m.lineStart=v}};function y(A,S){A=t(A,S),r.point(A[0],A[1])}function v(){c=NaN,m.point=x,r.lineStart()}function x(A,S){var C=Ma([A,S]),E=t(A,S);n(c,h,f,d,g,p,c=E[0],h=E[1],f=A,d=C[0],g=C[1],p=C[2],Xy,r),r.point(c,h)}function b(){m.point=y,r.lineEnd()}function _(){v(),m.point=M,m.lineEnd=w}function M(A,S){x(i=A,S),a=c,o=h,u=d,s=g,l=p,m.point=x}function w(){n(c,h,f,d,g,p,a,o,i,u,s,l,Xy,r),m.lineEnd=b,b()}return m}}var f4=wg({point:function(t,e){this.stream.point(t*je,e*je)}});function c4(t){return wg({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function h4(t,e,n,r,i){function a(o,u){return o*=r,u*=i,[e+t*o,n-t*u]}return a.invert=function(o,u){return[(o-e)/t*r,(n-u)/t*i]},a}function Ky(t,e,n,r,i,a){var o=zt(a),u=Lt(a),s=o*t,l=u*t,f=o/t,c=u/t,h=(u*n-o*e)/t,d=(u*e+o*n)/t;function g(p,m){return p*=r,m*=i,[s*p-l*m+e,n-l*p-s*m]}return g.invert=function(p,m){return[r*(f*p-c*m+h),i*(d-c*p-f*m)]},g}function d4(t){return g4(function(){return t})()}function g4(t){var e,n=150,r=480,i=250,a=0,o=0,u=0,s=0,l=0,f,c=0,h=1,d=1,g=null,p=Hy,m=null,y,v,x,b=Gy,_=.5,M,w,A,S,C;function E(k){return A(k[0]*je,k[1]*je)}function $(k){return k=A.invert(k[0],k[1]),k&&[k[0]*nr,k[1]*nr]}E.stream=function(k){return S&&C===k?S:S=f4(c4(f)(p(M(b(C=k)))))},E.preclip=function(k){return arguments.length?(p=k,g=void 0,L()):p},E.postclip=function(k){return arguments.length?(b=k,m=y=v=x=null,L()):b},E.clipAngle=function(k){return arguments.length?(p=+k?J6(g=k*je):(g=null,Hy),L()):g*nr},E.clipExtent=function(k){return arguments.length?(b=k==null?(m=y=v=x=null,Gy):e4(m=+k[0][0],y=+k[0][1],v=+k[1][0],x=+k[1][1]),L()):m==null?null:[[m,y],[v,x]]},E.scale=function(k){return arguments.length?(n=+k,F()):n},E.translate=function(k){return arguments.length?(r=+k[0],i=+k[1],F()):[r,i]},E.center=function(k){return arguments.length?(a=k[0]%360*je,o=k[1]%360*je,F()):[a*nr,o*nr]},E.rotate=function(k){return arguments.length?(u=k[0]%360*je,s=k[1]%360*je,l=k.length>2?k[2]%360*je:0,F()):[u*nr,s*nr,l*nr]},E.angle=function(k){return arguments.length?(c=k%360*je,F()):c*nr},E.reflectX=function(k){return arguments.length?(h=k?-1:1,F()):h<0},E.reflectY=function(k){return arguments.length?(d=k?-1:1,F()):d<0},E.precision=function(k){return arguments.length?(M=Zy(w,_=k*k),L()):Of(_)},E.fitExtent=function(k,T){return xw(E,k,T)},E.fitSize=function(k,T){return i4(E,k,T)},E.fitWidth=function(k,T){return a4(E,k,T)},E.fitHeight=function(k,T){return o4(E,k,T)};function F(){var k=Ky(n,0,0,h,d,c).apply(null,e(a,o)),T=(c?Ky:h4)(n,r-k[0],i-k[1],h,d,c);return f=W6(u,s,l),w=x0(e,T),A=x0(f,w),M=Zy(w,_),L()}function L(){return S=C=null,E}return function(){return e=t.apply(this,arguments),E.invert=e.invert&&$,F()}}var eh=new Date,nh=new Date;function yr(t,e,n,r){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return t(a=new Date(+a)),a},i.ceil=function(a){return t(a=new Date(a-1)),e(a,1),t(a),a},i.round=function(a){var o=i(a),u=i.ceil(a);return a-o<u-a?o:u},i.offset=function(a,o){return e(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,u){var s=[],l;if(a=i.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return s;do s.push(l=new Date(+a)),e(a,u),t(a);while(l<a&&a<o);return s},i.filter=function(a){return yr(function(o){if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},function(o,u){if(o>=o)if(u<0)for(;++u<=0;)for(;e(o,-1),!a(o););else for(;--u>=0;)for(;e(o,1),!a(o););})},n&&(i.count=function(a,o){return eh.setTime(+a),nh.setTime(+o),t(eh),t(nh),Math.floor(n(eh,nh))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?function(o){return r(o)%a===0}:function(o){return i.count(0,o)%a===0}):i}),i}var bw=6e4,ww=864e5,_w=6048e5,Mw=yr(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*bw)/ww},function(t){return t.getDate()-1});const zf=Mw;Mw.range;function Ni(t){return yr(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n*7)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*bw)/_w})}var Mg=Ni(0),_i=Ni(1),p4=Ni(2),m4=Ni(3),kn=Ni(4),y4=Ni(5),v4=Ni(6);Mg.range;_i.range;p4.range;m4.range;kn.range;y4.range;v4.range;var kg=yr(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});kg.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:yr(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)})};const Hn=kg;kg.range;var kw=yr(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/ww},function(t){return t.getUTCDate()-1});const Lf=kw;kw.range;function Oi(t){return yr(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n*7)},function(e,n){return(n-e)/_w})}var Ag=Oi(0),Mi=Oi(1),x4=Oi(2),b4=Oi(3),An=Oi(4),w4=Oi(5),_4=Oi(6);Ag.range;Mi.range;x4.range;b4.range;An.range;w4.range;_4.range;var Eg=yr(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Eg.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:yr(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})};const Gn=Eg;Eg.range;function rh(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function ih(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function eo(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function M4(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,u=t.months,s=t.shortMonths,l=no(i),f=ro(i),c=no(a),h=ro(a),d=no(o),g=ro(o),p=no(u),m=ro(u),y=no(s),v=ro(s),x={a:B,A:U,b:q,B:it,c:null,d:r2,e:r2,f:H4,g:nS,G:iS,H:j4,I:Y4,j:W4,L:Aw,m:G4,M:V4,p:lt,q:At,Q:o2,s:u2,S:X4,u:Z4,U:K4,V:Q4,w:J4,W:tS,x:null,X:null,y:eS,Y:rS,Z:aS,"%":a2},b={a:bt,A:Dt,b:Ot,B:ri,c:null,d:i2,e:i2,f:lS,g:xS,G:wS,H:oS,I:uS,j:sS,L:Cw,m:fS,M:cS,p:ii,q:ai,Q:o2,s:u2,S:hS,u:dS,U:gS,V:pS,w:mS,W:yS,x:null,X:null,y:vS,Y:bS,Z:_S,"%":a2},_={a:C,A:E,b:$,B:F,c:L,d:e2,e:e2,f:P4,g:t2,G:Jy,H:n2,I:n2,j:O4,L:B4,m:N4,M:z4,p:S,q:R4,Q:I4,s:q4,S:L4,u:S4,U:D4,V:$4,w:C4,W:F4,x:k,X:T,y:t2,Y:Jy,Z:T4,"%":U4};x.x=M(n,x),x.X=M(r,x),x.c=M(e,x),b.x=M(n,b),b.X=M(r,b),b.c=M(e,b);function M(N,I){return function(j){var D=[],mt=-1,X=0,wt=N.length,_t,me,to;for(j instanceof Date||(j=new Date(+j));++mt<wt;)N.charCodeAt(mt)===37&&(D.push(N.slice(X,mt)),(me=Qy[_t=N.charAt(++mt)])!=null?_t=N.charAt(++mt):me=_t==="e"?" ":"0",(to=I[_t])&&(_t=to(j,me)),D.push(_t),X=mt+1);return D.push(N.slice(X,mt)),D.join("")}}function w(N,I){return function(j){var D=eo(1900,void 0,1),mt=A(D,N,j+="",0),X,wt;if(mt!=j.length)return null;if("Q"in D)return new Date(D.Q);if("s"in D)return new Date(D.s*1e3+("L"in D?D.L:0));if(I&&!("Z"in D)&&(D.Z=0),"p"in D&&(D.H=D.H%12+D.p*12),D.m===void 0&&(D.m="q"in D?D.q:0),"V"in D){if(D.V<1||D.V>53)return null;"w"in D||(D.w=1),"Z"in D?(X=ih(eo(D.y,0,1)),wt=X.getUTCDay(),X=wt>4||wt===0?Mi.ceil(X):Mi(X),X=Lf.offset(X,(D.V-1)*7),D.y=X.getUTCFullYear(),D.m=X.getUTCMonth(),D.d=X.getUTCDate()+(D.w+6)%7):(X=rh(eo(D.y,0,1)),wt=X.getDay(),X=wt>4||wt===0?_i.ceil(X):_i(X),X=zf.offset(X,(D.V-1)*7),D.y=X.getFullYear(),D.m=X.getMonth(),D.d=X.getDate()+(D.w+6)%7)}else("W"in D||"U"in D)&&("w"in D||(D.w="u"in D?D.u%7:"W"in D?1:0),wt="Z"in D?ih(eo(D.y,0,1)).getUTCDay():rh(eo(D.y,0,1)).getDay(),D.m=0,D.d="W"in D?(D.w+6)%7+D.W*7-(wt+5)%7:D.w+D.U*7-(wt+6)%7);return"Z"in D?(D.H+=D.Z/100|0,D.M+=D.Z%100,ih(D)):rh(D)}}function A(N,I,j,D){for(var mt=0,X=I.length,wt=j.length,_t,me;mt<X;){if(D>=wt)return-1;if(_t=I.charCodeAt(mt++),_t===37){if(_t=I.charAt(mt++),me=_[_t in Qy?I.charAt(mt++):_t],!me||(D=me(N,j,D))<0)return-1}else if(_t!=j.charCodeAt(D++))return-1}return D}function S(N,I,j){var D=l.exec(I.slice(j));return D?(N.p=f[D[0].toLowerCase()],j+D[0].length):-1}function C(N,I,j){var D=d.exec(I.slice(j));return D?(N.w=g[D[0].toLowerCase()],j+D[0].length):-1}function E(N,I,j){var D=c.exec(I.slice(j));return D?(N.w=h[D[0].toLowerCase()],j+D[0].length):-1}function $(N,I,j){var D=y.exec(I.slice(j));return D?(N.m=v[D[0].toLowerCase()],j+D[0].length):-1}function F(N,I,j){var D=p.exec(I.slice(j));return D?(N.m=m[D[0].toLowerCase()],j+D[0].length):-1}function L(N,I,j){return A(N,e,I,j)}function k(N,I,j){return A(N,n,I,j)}function T(N,I,j){return A(N,r,I,j)}function B(N){return o[N.getDay()]}function U(N){return a[N.getDay()]}function q(N){return s[N.getMonth()]}function it(N){return u[N.getMonth()]}function lt(N){return i[+(N.getHours()>=12)]}function At(N){return 1+~~(N.getMonth()/3)}function bt(N){return o[N.getUTCDay()]}function Dt(N){return a[N.getUTCDay()]}function Ot(N){return s[N.getUTCMonth()]}function ri(N){return u[N.getUTCMonth()]}function ii(N){return i[+(N.getUTCHours()>=12)]}function ai(N){return 1+~~(N.getUTCMonth()/3)}return{format:function(N){var I=M(N+="",x);return I.toString=function(){return N},I},parse:function(N){var I=w(N+="",!1);return I.toString=function(){return N},I},utcFormat:function(N){var I=M(N+="",b);return I.toString=function(){return N},I},utcParse:function(N){var I=w(N+="",!0);return I.toString=function(){return N},I}}}var Qy={"-":"",_:" ",0:"0"},Xt=/^\s*\d+/,k4=/^%/,A4=/[\\^$*+?|[\]().{}]/g;function ct(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function E4(t){return t.replace(A4,"\\$&")}function no(t){return new RegExp("^(?:"+t.map(E4).join("|")+")","i")}function ro(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function C4(t,e,n){var r=Xt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function S4(t,e,n){var r=Xt.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function D4(t,e,n){var r=Xt.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function $4(t,e,n){var r=Xt.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function F4(t,e,n){var r=Xt.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Jy(t,e,n){var r=Xt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function t2(t,e,n){var r=Xt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function T4(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function R4(t,e,n){var r=Xt.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function N4(t,e,n){var r=Xt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function e2(t,e,n){var r=Xt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function O4(t,e,n){var r=Xt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function n2(t,e,n){var r=Xt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function z4(t,e,n){var r=Xt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function L4(t,e,n){var r=Xt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function B4(t,e,n){var r=Xt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function P4(t,e,n){var r=Xt.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function U4(t,e,n){var r=k4.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function I4(t,e,n){var r=Xt.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function q4(t,e,n){var r=Xt.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function r2(t,e){return ct(t.getDate(),e,2)}function j4(t,e){return ct(t.getHours(),e,2)}function Y4(t,e){return ct(t.getHours()%12||12,e,2)}function W4(t,e){return ct(1+zf.count(Hn(t),t),e,3)}function Aw(t,e){return ct(t.getMilliseconds(),e,3)}function H4(t,e){return Aw(t,e)+"000"}function G4(t,e){return ct(t.getMonth()+1,e,2)}function V4(t,e){return ct(t.getMinutes(),e,2)}function X4(t,e){return ct(t.getSeconds(),e,2)}function Z4(t){var e=t.getDay();return e===0?7:e}function K4(t,e){return ct(Mg.count(Hn(t)-1,t),e,2)}function Ew(t){var e=t.getDay();return e>=4||e===0?kn(t):kn.ceil(t)}function Q4(t,e){return t=Ew(t),ct(kn.count(Hn(t),t)+(Hn(t).getDay()===4),e,2)}function J4(t){return t.getDay()}function tS(t,e){return ct(_i.count(Hn(t)-1,t),e,2)}function eS(t,e){return ct(t.getFullYear()%100,e,2)}function nS(t,e){return t=Ew(t),ct(t.getFullYear()%100,e,2)}function rS(t,e){return ct(t.getFullYear()%1e4,e,4)}function iS(t,e){var n=t.getDay();return t=n>=4||n===0?kn(t):kn.ceil(t),ct(t.getFullYear()%1e4,e,4)}function aS(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ct(e/60|0,"0",2)+ct(e%60,"0",2)}function i2(t,e){return ct(t.getUTCDate(),e,2)}function oS(t,e){return ct(t.getUTCHours(),e,2)}function uS(t,e){return ct(t.getUTCHours()%12||12,e,2)}function sS(t,e){return ct(1+Lf.count(Gn(t),t),e,3)}function Cw(t,e){return ct(t.getUTCMilliseconds(),e,3)}function lS(t,e){return Cw(t,e)+"000"}function fS(t,e){return ct(t.getUTCMonth()+1,e,2)}function cS(t,e){return ct(t.getUTCMinutes(),e,2)}function hS(t,e){return ct(t.getUTCSeconds(),e,2)}function dS(t){var e=t.getUTCDay();return e===0?7:e}function gS(t,e){return ct(Ag.count(Gn(t)-1,t),e,2)}function Sw(t){var e=t.getUTCDay();return e>=4||e===0?An(t):An.ceil(t)}function pS(t,e){return t=Sw(t),ct(An.count(Gn(t),t)+(Gn(t).getUTCDay()===4),e,2)}function mS(t){return t.getUTCDay()}function yS(t,e){return ct(Mi.count(Gn(t)-1,t),e,2)}function vS(t,e){return ct(t.getUTCFullYear()%100,e,2)}function xS(t,e){return t=Sw(t),ct(t.getUTCFullYear()%100,e,2)}function bS(t,e){return ct(t.getUTCFullYear()%1e4,e,4)}function wS(t,e){var n=t.getUTCDay();return t=n>=4||n===0?An(t):An.ceil(t),ct(t.getUTCFullYear()%1e4,e,4)}function _S(){return"+0000"}function a2(){return"%"}function o2(t){return+t}function u2(t){return Math.floor(+t/1e3)}var Zi,Dw,$w;MS({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function MS(t){return Zi=M4(t),Dw=Zi.format,Zi.parse,$w=Zi.utcFormat,Zi.utcParse,Zi}function Ie(t,e,n){return t.fields=e||[],t.fname=n,t}function Nt(t){return t==null?null:t.fname}function fe(t){return t==null?null:t.fields}function Fw(t){return t.length===1?kS(t[0]):AS(t)}const kS=t=>function(e){return e[t]},AS=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function z(t){throw Error(t)}function Bf(t){const e=[],n=t.length;let r=null,i=0,a="",o,u,s;t=t+"";function l(){e.push(a+t.substring(o,u)),a="",o=u+1}for(o=u=0;u<n;++u)if(s=t[u],s==="\\")a+=t.substring(o,u),a+=t.substring(++u,++u),o=u;else if(s===r)l(),r=null,i=-1;else{if(r)continue;o===i&&s==='"'||o===i&&s==="'"?(o=u+1,r=s):s==="."&&!i?u>o?l():o=u+1:s==="["?(u>o&&l(),i=o=u+1):s==="]"&&(i||z("Access path missing open bracket: "+t),i>0&&l(),i=0,o=u+1)}return i&&z("Access path missing closing bracket: "+t),r&&z("Access path missing closing quote: "+t),u>o&&(u++,l()),e}function Le(t,e,n){const r=Bf(t);return t=r.length===1?r[0]:t,Ie((n&&n.get||Fw)(r),[t],e||t)}const zu=Le("id"),Ee=Ie(t=>t,[],"identity"),$r=Ie(()=>0,[],"zero"),qa=Ie(()=>1,[],"one"),sn=Ie(()=>!0,[],"true"),Mr=Ie(()=>!1,[],"false");function vs(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const Tw=0,Cg=1,Rw=2,Nw=3,Ow=4;function zw(t,e){let n=t||Tw;return{level(r){return arguments.length?(n=+r,this):n},error(){return n>=Cg&&vs(e||"error","ERROR",arguments),this},warn(){return n>=Rw&&vs(e||"warn","WARN",arguments),this},info(){return n>=Nw&&vs(e||"log","INFO",arguments),this},debug(){return n>=Ow&&vs(e||"log","DEBUG",arguments),this}}}var G=Array.isArray;function et(t){return t===Object(t)}const s2=t=>t!=="__proto__";function Lw(...t){return t.reduce((e,n)=>{for(const r in n)if(r==="signals")e.signals=ES(e.signals,n.signals);else{const i=r==="legend"?{layout:1}:r==="style"?!0:null;Sg(e,r,n[r],i)}return e},{})}function Sg(t,e,n,r){if(!s2(e))return;let i,a;if(et(n)&&!G(n)){a=et(t[e])?t[e]:t[e]={};for(i in n)r&&(r===!0||r[i])?Sg(a,i,n[i]):s2(i)&&(a[i]=n[i])}else t[e]=n}function ES(t,e){if(t==null)return e;const n={},r=[];function i(a){n[a.name]||(n[a.name]=1,r.push(a))}return e.forEach(i),t.forEach(i),r}function ot(t){return t[t.length-1]}function le(t){return t==null||t===""?null:+t}const Bw=t=>e=>t*Math.exp(e),Pw=t=>e=>Math.log(t*e),Uw=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),Iw=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,kl=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function Pf(t,e,n,r){const i=n(t[0]),a=n(ot(t)),o=(a-i)*e;return[r(i-o),r(a-o)]}function qw(t,e){return Pf(t,e,le,Ee)}function jw(t,e){var n=Math.sign(t[0]);return Pf(t,e,Pw(n),Bw(n))}function Yw(t,e,n){return Pf(t,e,kl(n),kl(1/n))}function Ww(t,e,n){return Pf(t,e,Uw(n),Iw(n))}function Uf(t,e,n,r,i){const a=r(t[0]),o=r(ot(t)),u=e!=null?r(e):(a+o)/2;return[i(u+(a-u)*n),i(u+(o-u)*n)]}function Dg(t,e,n){return Uf(t,e,n,le,Ee)}function $g(t,e,n){const r=Math.sign(t[0]);return Uf(t,e,n,Pw(r),Bw(r))}function Al(t,e,n,r){return Uf(t,e,n,kl(r),kl(1/r))}function Fg(t,e,n,r){return Uf(t,e,n,Uw(r),Iw(r))}function Hw(t){return 1+~~(new Date(t).getMonth()/3)}function Gw(t){return 1+~~(new Date(t).getUTCMonth()/3)}function Z(t){return t!=null?G(t)?t:[t]:[]}function Vw(t,e,n){let r=t[0],i=t[1],a;return i<r&&(a=i,i=r,r=a),a=i-r,a>=n-e?[e,n]:[r=Math.min(Math.max(r,e),n-a),r+a]}function nt(t){return typeof t=="function"}const CS="descending";function Tg(t,e,n){n=n||{},e=Z(e)||[];const r=[],i=[],a={},o=n.comparator||SS;return Z(t).forEach((u,s)=>{u!=null&&(r.push(e[s]===CS?-1:1),i.push(u=nt(u)?u:Le(u,null,n)),(fe(u)||[]).forEach(l=>a[l]=1))}),i.length===0?null:Ie(o(i,r),Object.keys(a))}const If=(t,e)=>(t<e||t==null)&&e!=null?-1:(t>e||e==null)&&t!=null?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e===e?-1:e!==e&&t===t?1:0),SS=(t,e)=>t.length===1?DS(t[0],e[0]):$S(t,e,t.length),DS=(t,e)=>function(n,r){return If(t(n),t(r))*e},$S=(t,e,n)=>(e.push(0),function(r,i){let a,o=0,u=-1;for(;o===0&&++u<n;)a=t[u],o=If(a(r),a(i));return o*e[u]});function ge(t){return nt(t)?t:()=>t}function Rg(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout(()=>(e(r),n=null),t)}}function tt(t){for(let e,n,r=1,i=arguments.length;r<i;++r){e=arguments[r];for(n in e)t[n]=e[n]}return t}function Vn(t,e){let n=0,r,i,a,o;if(t&&(r=t.length))if(e==null){for(i=t[n];n<r&&(i==null||i!==i);i=t[++n]);for(a=o=i;n<r;++n)i=t[n],i!=null&&(i<a&&(a=i),i>o&&(o=i))}else{for(i=e(t[n]);n<r&&(i==null||i!==i);i=e(t[++n]));for(a=o=i;n<r;++n)i=e(t[n]),i!=null&&(i<a&&(a=i),i>o&&(o=i))}return[a,o]}function Xw(t,e){const n=t.length;let r=-1,i,a,o,u,s;if(e==null){for(;++r<n;)if(a=t[r],a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(u=s=r;++r<n;)a=t[r],a!=null&&(i>a&&(i=a,u=r),o<a&&(o=a,s=r))}else{for(;++r<n;)if(a=e(t[r],r,t),a!=null&&a>=a){i=o=a;break}if(r===n)return[-1,-1];for(u=s=r;++r<n;)a=e(t[r],r,t),a!=null&&(i>a&&(i=a,u=r),o<a&&(o=a,s=r))}return[u,s]}const FS=Object.prototype.hasOwnProperty;function K(t,e){return FS.call(t,e)}const xs={};function ja(t){let e={},n;function r(a){return K(e,a)&&e[a]!==xs}const i={size:0,empty:0,object:e,has:r,get(a){return r(a)?e[a]:void 0},set(a,o){return r(a)||(++i.size,e[a]===xs&&--i.empty),e[a]=o,this},delete(a){return r(a)&&(--i.size,++i.empty,e[a]=xs),this},clear(){i.size=i.empty=0,i.object=e={}},test(a){return arguments.length?(n=a,i):n},clean(){const a={};let o=0;for(const u in e){const s=e[u];s!==xs&&(!n||!n(s))&&(a[u]=s,++o)}i.size=o,i.empty=0,i.object=e=a}};return t&&Object.keys(t).forEach(a=>{i.set(a,t[a])}),i}function Zw(t,e,n,r,i,a){if(!n&&n!==0)return a;const o=+n;let u=t[0],s=ot(t),l;s<u&&(l=u,u=s,s=l),l=Math.abs(e-u);const f=Math.abs(s-e);return l<f&&l<=o?r:f<=o?i:a}function P(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),tt(r,n)}function sa(t,e,n,r){let i=e[0],a=e[e.length-1],o;return i>a&&(o=i,i=a,a=o),n=n===void 0||n,r=r===void 0||r,(n?i<=t:i<t)&&(r?t<=a:t<a)}function Kw(t){return typeof t=="boolean"}function Ur(t){return Object.prototype.toString.call(t)==="[object Date]"}function Qw(t){return t&&nt(t[Symbol.iterator])}function Yr(t){return typeof t=="number"}function Jw(t){return Object.prototype.toString.call(t)==="[object RegExp]"}function Ct(t){return typeof t=="string"}function Ng(t,e,n){t&&(t=e?Z(t).map(u=>u.replace(/\\(.)/g,"$1")):Z(t));const r=t&&t.length,i=n&&n.get||Fw,a=u=>i(e?[u]:Bf(u));let o;if(!r)o=function(){return""};else if(r===1){const u=a(t[0]);o=function(s){return""+u(s)}}else{const u=t.map(a);o=function(s){let l=""+u[0](s),f=0;for(;++f<r;)l+="|"+u[f](s);return l}}return Ie(o,t,"key")}function t_(t,e){const n=t[0],r=ot(t),i=+e;return i?i===1?r:n+i*(r-n):n}const TS=1e4;function e_(t){t=+t||TS;let e,n,r;const i=()=>{e={},n={},r=0},a=(o,u)=>(++r>t&&(n=e,e={},r=1),e[o]=u);return i(),{clear:i,has:o=>K(e,o)||K(n,o),get:o=>K(e,o)?e[o]:K(n,o)?a(o,n[o]):void 0,set:(o,u)=>K(e,o)?e[o]=u:a(o,u)}}function n_(t,e,n,r){const i=e.length,a=n.length;if(!a)return e;if(!i)return n;const o=r||new e.constructor(i+a);let u=0,s=0,l=0;for(;u<i&&s<a;++l)o[l]=t(e[u],n[s])>0?n[s++]:e[u++];for(;u<i;++u,++l)o[l]=e[u];for(;s<a;++s,++l)o[l]=n[s];return o}function So(t,e){let n="";for(;--e>=0;)n+=t;return n}function r_(t,e,n,r){const i=n||" ",a=t+"",o=e-a.length;return o<=0?a:r==="left"?So(i,o)+a:r==="center"?So(i,~~(o/2))+a+So(i,Math.ceil(o/2)):a+So(i,o)}function Lu(t){return t&&ot(t)-t[0]||0}function V(t){return G(t)?"["+t.map(V)+"]":et(t)||Ct(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function Og(t){return t==null||t===""?null:!t||t==="false"||t==="0"?!1:!!t}const RS=t=>Yr(t)||Ur(t)?t:Date.parse(t);function zg(t,e){return e=e||RS,t==null||t===""?null:e(t)}function Lg(t){return t==null||t===""?null:t+""}function En(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function i_(t,e,n,r){const i=r!=null?r:"…",a=t+"",o=a.length,u=Math.max(0,e-i.length);return o<=e?a:n==="left"?i+a.slice(o-u):n==="center"?a.slice(0,Math.ceil(u/2))+i+a.slice(o-~~(u/2)):a.slice(0,u)+i}function Ar(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const a=e(t[i]);a&&n(a,i,t)}}else t.forEach(n)}const NS=/^([A-Za-z]+:)?\/\//,OS=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,zS=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,l2="file://";function LS(t,e){return n=>({options:n||{},sanitize:PS,load:BS,fileAccess:!!e,file:US(e),http:qS(t)})}async function BS(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function PS(t,e){e=tt({},this.options,e);const n=this.fileAccess,r={href:null};let i,a,o;const u=OS.test(t.replace(zS,""));(t==null||typeof t!="string"||!u)&&z("Sanitize failure, invalid URI: "+V(t));const s=NS.test(t);return(o=e.baseURL)&&!s&&(!t.startsWith("/")&&o[o.length-1]!=="/"&&(t="/"+t),t=o+t),a=(i=t.startsWith(l2))||e.mode==="file"||e.mode!=="http"&&!s&&n,i?t=t.slice(l2.length):t.startsWith("//")&&(e.defaultProtocol==="file"?(t=t.slice(2),a=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!a}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),e.context==="image"&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function US(t){return t?e=>new Promise((n,r)=>{t.readFile(e,(i,a)=>{i?r(i):n(a)})}):IS}async function IS(){z("No file system access.")}function qS(t){return t?async function(e,n){const r=tt({},this.options.http,n),i=n&&n.response,a=await t(e,r);return a.ok?nt(a[i])?a[i]():a.text():z(a.status+""+a.statusText)}:jS}async function jS(){z("No HTTP fetch method available.")}const YS=t=>t!=null&&t===t,WS=t=>t==="true"||t==="false"||t===!0||t===!1,HS=t=>!Number.isNaN(Date.parse(t)),a_=t=>!Number.isNaN(+t)&&!(t instanceof Date),GS=t=>a_(t)&&Number.isInteger(+t),_0={boolean:Og,integer:le,number:le,date:zg,string:Lg,unknown:Ee},bs=[WS,GS,a_,HS],VS=["boolean","integer","number","date"];function o_(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=bs.length,i=bs.map((a,o)=>o+1);for(let a=0,o=0,u,s;a<n;++a)for(s=e?t[a][e]:t[a],u=0;u<r;++u)if(i[u]&&YS(s)&&!bs[u](s)&&(i[u]=0,++o,o===bs.length))return"string";return VS[i.reduce((a,o)=>a===0?o:a,0)-1]}function u_(t,e){return e.reduce((n,r)=>(n[r]=o_(t,r),n),{})}var f2={},ah={},oh=34,io=10,uh=13;function s_(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function XS(t,e){var n=s_(t);return function(r,i){return e(n(r),i,t)}}function c2(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var i in r)i in e||n.push(e[i]=i)}),n}function $e(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function ZS(t){return t<0?"-"+$e(-t,6):t>9999?"+"+$e(t,6):$e(t,4)}function KS(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":ZS(t.getUTCFullYear())+"-"+$e(t.getUTCMonth()+1,2)+"-"+$e(t.getUTCDate(),2)+(i?"T"+$e(e,2)+":"+$e(n,2)+":"+$e(r,2)+"."+$e(i,3)+"Z":r?"T"+$e(e,2)+":"+$e(n,2)+":"+$e(r,2)+"Z":n||e?"T"+$e(e,2)+":"+$e(n,2)+"Z":"")}function QS(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(c,h){var d,g,p=i(c,function(m,y){if(d)return d(m,y-1);g=m,d=h?XS(m,h):s_(m)});return p.columns=g||[],p}function i(c,h){var d=[],g=c.length,p=0,m=0,y,v=g<=0,x=!1;c.charCodeAt(g-1)===io&&--g,c.charCodeAt(g-1)===uh&&--g;function b(){if(v)return ah;if(x)return x=!1,f2;var M,w=p,A;if(c.charCodeAt(w)===oh){for(;p++<g&&c.charCodeAt(p)!==oh||c.charCodeAt(++p)===oh;);return(M=p)>=g?v=!0:(A=c.charCodeAt(p++))===io?x=!0:A===uh&&(x=!0,c.charCodeAt(p)===io&&++p),c.slice(w+1,M-1).replace(/""/g,'"')}for(;p<g;){if((A=c.charCodeAt(M=p++))===io)x=!0;else if(A===uh)x=!0,c.charCodeAt(p)===io&&++p;else if(A!==n)continue;return c.slice(w,M)}return v=!0,c.slice(w,g)}for(;(y=b())!==ah;){for(var _=[];y!==f2&&y!==ah;)_.push(y),y=b();h&&(_=h(_,m++))==null||d.push(_)}return d}function a(c,h){return c.map(function(d){return h.map(function(g){return f(d[g])}).join(t)})}function o(c,h){return h==null&&(h=c2(c)),[h.map(f).join(t)].concat(a(c,h)).join(`
`)}function u(c,h){return h==null&&(h=c2(c)),a(c,h).join(`
`)}function s(c){return c.map(l).join(`
`)}function l(c){return c.map(f).join(t)}function f(c){return c==null?"":c instanceof Date?KS(c):e.test(c+="")?'"'+c.replace(/"/g,'""')+'"':c}return{parse:r,parseRows:i,format:o,formatBody:u,formatRows:s,formatRow:l,formatValue:f}}function h2(t){const e=function(n,r){const i={delimiter:t};return Bg(n,r?tt(r,i):i)};return e.responseType="text",e}function Bg(t,e){return e.header&&(t=e.header.map(V).join(e.delimiter)+`
`+t),QS(e.delimiter).parse(t+"")}Bg.responseType="text";function JS(t){return typeof Buffer=="function"&&nt(Buffer.isBuffer)?Buffer.isBuffer(t):!1}function Pg(t,e){const n=e&&e.property?Le(e.property):Ee;return et(t)&&!JS(t)?tD(n(t),e):n(JSON.parse(t))}Pg.responseType="json";function tD(t,e){return!G(t)&&Qw(t)&&(t=[...t]),e&&e.copy?JSON.parse(JSON.stringify(t)):t}function eD(t){return t}function nD(t){if(t==null)return eD;var e,n,r=t.scale[0],i=t.scale[1],a=t.translate[0],o=t.translate[1];return function(u,s){s||(e=n=0);var l=2,f=u.length,c=new Array(f);for(c[0]=(e+=u[0])*r+a,c[1]=(n+=u[1])*i+o;l<f;)c[l]=u[l],++l;return c}}function rD(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}function iD(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(n){return d2(t,n)})}:d2(t,e)}function d2(t,e){var n=e.id,r=e.bbox,i=e.properties==null?{}:e.properties,a=l_(t,e);return n==null&&r==null?{type:"Feature",properties:i,geometry:a}:r==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:r,properties:i,geometry:a}}function l_(t,e){var n=nD(t.transform),r=t.arcs;function i(f,c){c.length&&c.pop();for(var h=r[f<0?~f:f],d=0,g=h.length;d<g;++d)c.push(n(h[d],d));f<0&&rD(c,g)}function a(f){return n(f)}function o(f){for(var c=[],h=0,d=f.length;h<d;++h)i(f[h],c);return c.length<2&&c.push(c[0]),c}function u(f){for(var c=o(f);c.length<4;)c.push(c[0]);return c}function s(f){return f.map(u)}function l(f){var c=f.type,h;switch(c){case"GeometryCollection":return{type:c,geometries:f.geometries.map(l)};case"Point":h=a(f.coordinates);break;case"MultiPoint":h=f.coordinates.map(a);break;case"LineString":h=o(f.arcs);break;case"MultiLineString":h=f.arcs.map(o);break;case"Polygon":h=s(f.arcs);break;case"MultiPolygon":h=f.arcs.map(s);break;default:return null}return{type:c,coordinates:h}}return l(e)}function aD(t,e){var n={},r={},i={},a=[],o=-1;e.forEach(function(l,f){var c=t.arcs[l<0?~l:l],h;c.length<3&&!c[1][0]&&!c[1][1]&&(h=e[++o],e[o]=l,e[f]=h)}),e.forEach(function(l){var f=u(l),c=f[0],h=f[1],d,g;if(d=i[c])if(delete i[d.end],d.push(l),d.end=h,g=r[h]){delete r[g.start];var p=g===d?d:d.concat(g);r[p.start=d.start]=i[p.end=g.end]=p}else r[d.start]=i[d.end]=d;else if(d=r[h])if(delete r[d.start],d.unshift(l),d.start=c,g=i[c]){delete i[g.end];var m=g===d?d:g.concat(d);r[m.start=g.start]=i[m.end=d.end]=m}else r[d.start]=i[d.end]=d;else d=[l],r[d.start=c]=i[d.end=h]=d});function u(l){var f=t.arcs[l<0?~l:l],c=f[0],h;return t.transform?(h=[0,0],f.forEach(function(d){h[0]+=d[0],h[1]+=d[1]})):h=f[f.length-1],l<0?[h,c]:[c,h]}function s(l,f){for(var c in l){var h=l[c];delete f[h.start],delete h.start,delete h.end,h.forEach(function(d){n[d<0?~d:d]=1}),a.push(h)}}return s(i,r),s(r,i),e.forEach(function(l){n[l<0?~l:l]||a.push([l])}),a}function oD(t){return l_(t,uD.apply(this,arguments))}function uD(t,e,n){var r,i,a;if(arguments.length>1)r=sD(t,e,n);else for(i=0,r=new Array(a=t.arcs.length);i<a;++i)r[i]=i;return{type:"MultiLineString",arcs:aD(t,r)}}function sD(t,e,n){var r=[],i=[],a;function o(c){var h=c<0?~c:c;(i[h]||(i[h]=[])).push({i:c,g:a})}function u(c){c.forEach(o)}function s(c){c.forEach(u)}function l(c){c.forEach(s)}function f(c){switch(a=c,c.type){case"GeometryCollection":c.geometries.forEach(f);break;case"LineString":u(c.arcs);break;case"MultiLineString":case"Polygon":s(c.arcs);break;case"MultiPolygon":l(c.arcs);break}}return f(e),i.forEach(n==null?function(c){r.push(c[0].i)}:function(c){n(c[0].g,c[c.length-1].g)&&r.push(c[0].i)}),r}const lD={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function f_(t,e){let n,r,i,a;return t=Pg(t,e),e&&e.feature?(n=iD,i=e.feature):e&&e.mesh?(n=oD,i=e.mesh,a=lD[e.filter]):z("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,a):z("Invalid TopoJSON object: "+i),r&&r.features||[r]}f_.responseType="json";const Xs={dsv:Bg,csv:h2(","),tsv:h2("	"),json:Pg,topojson:f_};function Ug(t,e){return arguments.length>1?(Xs[t]=e,this):K(Xs,t)?Xs[t]:null}function c_(t){const e=Ug(t);return e&&e.responseType||"text"}var fD=Math.sqrt(50),cD=Math.sqrt(10),hD=Math.sqrt(2);function dD(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=fD?i*=10:a>=cD?i*=5:a>=hD&&(i*=2),e<t?-i:i}function gD(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function El(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Aa(t){return t=El(Math.abs(t)),t?t[1]:NaN}function pD(t,e){return function(n,r){for(var i=n.length,a=[],o=0,u=t[0],s=0;i>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),a.push(n.substring(i-=u,i+u)),!((s+=u+1)>r));)u=t[o=(o+1)%t.length];return a.reverse().join(e)}}function mD(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var yD=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hu(t){if(!(e=yD.exec(t)))throw new Error("invalid format: "+t);var e;return new Ig({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}hu.prototype=Ig.prototype;function Ig(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ig.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function vD(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var h_;function xD(t,e){var n=El(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(h_=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+El(t,Math.max(0,e+a-1))[0]}function g2(t,e){var n=El(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const p2={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:gD,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>g2(t*100,e),r:g2,s:xD,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function m2(t){return t}var y2=Array.prototype.map,v2=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function d_(t){var e=t.grouping===void 0||t.thousands===void 0?m2:pD(y2.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?m2:mD(y2.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"−":t.minus+"",s=t.nan===void 0?"NaN":t.nan+"";function l(c){c=hu(c);var h=c.fill,d=c.align,g=c.sign,p=c.symbol,m=c.zero,y=c.width,v=c.comma,x=c.precision,b=c.trim,_=c.type;_==="n"?(v=!0,_="g"):p2[_]||(x===void 0&&(x=12),b=!0,_="g"),(m||h==="0"&&d==="=")&&(m=!0,h="0",d="=");var M=p==="$"?n:p==="#"&&/[boxX]/.test(_)?"0"+_.toLowerCase():"",w=p==="$"?r:/[%p]/.test(_)?o:"",A=p2[_],S=/[defgprs%]/.test(_);x=x===void 0?6:/[gprs]/.test(_)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x));function C(E){var $=M,F=w,L,k,T;if(_==="c")F=A(E)+F,E="";else{E=+E;var B=E<0||1/E<0;if(E=isNaN(E)?s:A(Math.abs(E),x),b&&(E=vD(E)),B&&+E==0&&g!=="+"&&(B=!1),$=(B?g==="("?g:u:g==="-"||g==="("?"":g)+$,F=(_==="s"?v2[8+h_/3]:"")+F+(B&&g==="("?")":""),S){for(L=-1,k=E.length;++L<k;)if(T=E.charCodeAt(L),48>T||T>57){F=(T===46?i+E.slice(L+1):E.slice(L))+F,E=E.slice(0,L);break}}}v&&!m&&(E=e(E,1/0));var U=$.length+E.length+F.length,q=U<y?new Array(y-U+1).join(h):"";switch(v&&m&&(E=e(q+E,q.length?y-F.length:1/0),q=""),d){case"<":E=$+E+F+q;break;case"=":E=$+q+E+F;break;case"^":E=q.slice(0,U=q.length>>1)+$+E+F+q.slice(U);break;default:E=q+$+E+F;break}return a(E)}return C.toString=function(){return c+""},C}function f(c,h){var d=l((c=hu(c),c.type="f",c)),g=Math.max(-8,Math.min(8,Math.floor(Aa(h)/3)))*3,p=Math.pow(10,-g),m=v2[8+g/3];return function(y){return d(p*y)+m}}return{format:l,formatPrefix:f}}var ws,g_,p_;bD({thousands:",",grouping:[3],currency:["$",""]});function bD(t){return ws=d_(t),g_=ws.format,p_=ws.formatPrefix,ws}function wD(t){return Math.max(0,-Aa(Math.abs(t)))}function _D(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Aa(e)/3)))*3-Aa(Math.abs(t)))}function MD(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Aa(e)-Aa(t))+1}var sh=new Date,lh=new Date;function Zt(t,e,n,r){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return t(a=new Date(+a)),a},i.ceil=function(a){return t(a=new Date(a-1)),e(a,1),t(a),a},i.round=function(a){var o=i(a),u=i.ceil(a);return a-o<u-a?o:u},i.offset=function(a,o){return e(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,u){var s=[],l;if(a=i.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return s;do s.push(l=new Date(+a)),e(a,u),t(a);while(l<a&&a<o);return s},i.filter=function(a){return Zt(function(o){if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},function(o,u){if(o>=o)if(u<0)for(;++u<=0;)for(;e(o,-1),!a(o););else for(;--u>=0;)for(;e(o,1),!a(o););})},n&&(i.count=function(a,o){return sh.setTime(+a),lh.setTime(+o),t(sh),t(lh),Math.floor(n(sh,lh))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?function(o){return r(o)%a===0}:function(o){return i.count(0,o)%a===0}):i}),i}var Cl=Zt(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Cl.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Zt(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Cl};const m_=Cl;Cl.range;const du=1e3,Wr=du*60,gu=Wr*60,qg=gu*24,y_=qg*7;var v_=Zt(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*du)},function(t,e){return(e-t)/du},function(t){return t.getUTCSeconds()});const x_=v_;v_.range;var b_=Zt(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*du)},function(t,e){t.setTime(+t+e*Wr)},function(t,e){return(e-t)/Wr},function(t){return t.getMinutes()});const kD=b_;b_.range;var w_=Zt(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*du-t.getMinutes()*Wr)},function(t,e){t.setTime(+t+e*gu)},function(t,e){return(e-t)/gu},function(t){return t.getHours()});const AD=w_;w_.range;var __=Zt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Wr)/qg,t=>t.getDate()-1);const Zs=__;__.range;function zi(t){return Zt(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n*7)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Wr)/y_})}var jg=zi(0),ED=zi(1),CD=zi(2),SD=zi(3),DD=zi(4),$D=zi(5),FD=zi(6);jg.range;ED.range;CD.range;SD.range;DD.range;$D.range;FD.range;var M_=Zt(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()});const x2=M_;M_.range;var Yg=Zt(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Yg.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Zt(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)})};const TD=Yg;Yg.range;var k_=Zt(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*Wr)},function(t,e){return(e-t)/Wr},function(t){return t.getUTCMinutes()});const RD=k_;k_.range;var A_=Zt(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*gu)},function(t,e){return(e-t)/gu},function(t){return t.getUTCHours()});const ND=A_;A_.range;var E_=Zt(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/qg},function(t){return t.getUTCDate()-1});const Ks=E_;E_.range;function Li(t){return Zt(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n*7)},function(e,n){return(n-e)/y_})}var Wg=Li(0),OD=Li(1),zD=Li(2),LD=Li(3),BD=Li(4),PD=Li(5),UD=Li(6);Wg.range;OD.range;zD.range;LD.range;BD.range;PD.range;UD.range;var C_=Zt(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()});const b2=C_;C_.range;var Hg=Zt(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Hg.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Zt(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})};const ID=Hg;Hg.range;function qD(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function jD(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=YD(t));function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=r(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:r,center:a,right:i}}function YD(t){return(e,n)=>qD(t(e),n)}var WD=Math.sqrt(50),HD=Math.sqrt(10),GD=Math.sqrt(2);function w2(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=WD?i*=10:a>=HD?i*=5:a>=GD&&(i*=2),e<t?-i:i}const te="year",Be="quarter",ce="month",It="week",Pe="date",se="day",Xn="dayofyear",Ve="hours",Xe="minutes",ln="seconds",Cn="milliseconds",Gg=[te,Be,ce,It,Pe,se,Xn,Ve,Xe,ln,Cn],fh=Gg.reduce((t,e,n)=>(t[e]=1+n,t),{});function Vg(t){const e=Z(t).slice(),n={};return e.length||z("Missing time unit."),e.forEach(i=>{K(fh,i)?n[i]=1:z("Invalid time unit: ".concat(i,"."))}),(n[It]||n[se]?1:0)+(n[Be]||n[ce]||n[Pe]?1:0)+(n[Xn]?1:0)>1&&z("Incompatible time units: ".concat(t)),e.sort((i,a)=>fh[i]-fh[a]),e}const VD={[te]:"%Y ",[Be]:"Q%q ",[ce]:"%b ",[Pe]:"%d ",[It]:"W%U ",[se]:"%a ",[Xn]:"%j ",[Ve]:"%H:00",[Xe]:"00:%M",[ln]:":%S",[Cn]:".%L",["".concat(te,"-").concat(ce)]:"%Y-%m ",["".concat(te,"-").concat(ce,"-").concat(Pe)]:"%Y-%m-%d ",["".concat(Ve,"-").concat(Xe)]:"%H:%M"};function S_(t,e){const n=tt({},VD,e),r=Vg(t),i=r.length;let a="",o=0,u,s;for(o=0;o<i;)for(u=r.length;u>o;--u)if(s=r.slice(o,u).join("-"),n[s]!=null){a+=n[s],o=u;break}return a.trim()}const ci=new Date;function Xg(t){return ci.setFullYear(t),ci.setMonth(0),ci.setDate(1),ci.setHours(0,0,0,0),ci}function D_(t){return F_(new Date(t))}function $_(t){return M0(new Date(t))}function F_(t){return Zs.count(Xg(t.getFullYear())-1,t)}function M0(t){return jg.count(Xg(t.getFullYear())-1,t)}function k0(t){return Xg(t).getDay()}function XD(t,e,n,r,i,a,o){if(0<=t&&t<100){const u=new Date(-1,e,n,r,i,a,o);return u.setFullYear(t),u}return new Date(t,e,n,r,i,a,o)}function T_(t){return N_(new Date(t))}function R_(t){return A0(new Date(t))}function N_(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Ks.count(e-1,t)}function A0(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return Wg.count(e-1,t)}function E0(t){return ci.setTime(Date.UTC(t,0,1)),ci.getUTCDay()}function ZD(t,e,n,r,i,a,o){if(0<=t&&t<100){const u=new Date(Date.UTC(-1,e,n,r,i,a,o));return u.setUTCFullYear(n.y),u}return new Date(Date.UTC(t,e,n,r,i,a,o))}function O_(t,e,n,r,i){const a=e||1,o=ot(t),u=(y,v,x)=>(x=x||y,KD(n[x],r[x],y===o&&a,v)),s=new Date,l=En(t),f=l[te]?u(te):ge(2012),c=l[ce]?u(ce):l[Be]?u(Be):$r,h=l[It]&&l[se]?u(se,1,It+se):l[It]?u(It,1):l[se]?u(se,1):l[Pe]?u(Pe,1):l[Xn]?u(Xn,1):qa,d=l[Ve]?u(Ve):$r,g=l[Xe]?u(Xe):$r,p=l[ln]?u(ln):$r,m=l[Cn]?u(Cn):$r;return function(y){s.setTime(+y);const v=f(s);return i(v,c(s),h(s,v),d(s),g(s),p(s),m(s))}}function KD(t,e,n,r){const i=n<=1?t:r?(a,o)=>r+n*Math.floor((t(a,o)-r)/n):(a,o)=>n*Math.floor(t(a,o)/n);return e?(a,o)=>e(i(a,o),o):i}function Ea(t,e,n){return e+t*7-(n+6)%7}const QD={[te]:t=>t.getFullYear(),[Be]:t=>Math.floor(t.getMonth()/3),[ce]:t=>t.getMonth(),[Pe]:t=>t.getDate(),[Ve]:t=>t.getHours(),[Xe]:t=>t.getMinutes(),[ln]:t=>t.getSeconds(),[Cn]:t=>t.getMilliseconds(),[Xn]:t=>F_(t),[It]:t=>M0(t),[It+se]:(t,e)=>Ea(M0(t),t.getDay(),k0(e)),[se]:(t,e)=>Ea(1,t.getDay(),k0(e))},JD={[Be]:t=>3*t,[It]:(t,e)=>Ea(t,0,k0(e))};function z_(t,e){return O_(t,e||1,QD,JD,XD)}const t8={[te]:t=>t.getUTCFullYear(),[Be]:t=>Math.floor(t.getUTCMonth()/3),[ce]:t=>t.getUTCMonth(),[Pe]:t=>t.getUTCDate(),[Ve]:t=>t.getUTCHours(),[Xe]:t=>t.getUTCMinutes(),[ln]:t=>t.getUTCSeconds(),[Cn]:t=>t.getUTCMilliseconds(),[Xn]:t=>N_(t),[It]:t=>A0(t),[se]:(t,e)=>Ea(1,t.getUTCDay(),E0(e)),[It+se]:(t,e)=>Ea(A0(t),t.getUTCDay(),E0(e))},e8={[Be]:t=>3*t,[It]:(t,e)=>Ea(t,0,E0(e))};function L_(t,e){return O_(t,e||1,t8,e8,ZD)}const n8={[te]:TD,[Be]:x2.every(3),[ce]:x2,[It]:jg,[Pe]:Zs,[se]:Zs,[Xn]:Zs,[Ve]:AD,[Xe]:kD,[ln]:x_,[Cn]:m_},r8={[te]:ID,[Be]:b2.every(3),[ce]:b2,[It]:Wg,[Pe]:Ks,[se]:Ks,[Xn]:Ks,[Ve]:ND,[Xe]:RD,[ln]:x_,[Cn]:m_};function Ya(t){return n8[t]}function Wa(t){return r8[t]}function B_(t,e,n){return t?t.offset(e,n):void 0}function P_(t,e,n){return B_(Ya(t),e,n)}function U_(t,e,n){return B_(Wa(t),e,n)}function I_(t,e,n,r){return t?t.range(e,n,r):void 0}function q_(t,e,n,r){return I_(Ya(t),e,n,r)}function j_(t,e,n,r){return I_(Wa(t),e,n,r)}const Do=1e3,$o=Do*60,Fo=$o*60,qf=Fo*24,i8=qf*7,_2=qf*30,C0=qf*365,Y_=[te,ce,Pe,Ve,Xe,ln,Cn],To=Y_.slice(0,-1),Ro=To.slice(0,-1),No=Ro.slice(0,-1),a8=No.slice(0,-1),o8=[te,It],M2=[te,ce],W_=[te],ao=[[To,1,Do],[To,5,5*Do],[To,15,15*Do],[To,30,30*Do],[Ro,1,$o],[Ro,5,5*$o],[Ro,15,15*$o],[Ro,30,30*$o],[No,1,Fo],[No,3,3*Fo],[No,6,6*Fo],[No,12,12*Fo],[a8,1,qf],[o8,1,i8],[M2,1,_2],[M2,3,3*_2],[W_,1,C0]];function H_(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(Lu(e))/n;let i=jD(u=>u[2]).right(ao,r),a,o;return i===ao.length?(a=W_,o=w2(e[0]/C0,e[1]/C0,n)):i?(i=ao[r/ao[i-1][2]<ao[i][2]/r?i-1:i],a=i[0],o=i[1]):(a=Y_,o=Math.max(w2(e[0],e[1],n),1)),{units:a,step:o}}function ch(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function hh(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function oo(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function G_(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,u=t.months,s=t.shortMonths,l=uo(i),f=so(i),c=uo(a),h=so(a),d=uo(o),g=so(o),p=uo(u),m=so(u),y=uo(s),v=so(s),x={a:B,A:U,b:q,B:it,c:null,d:D2,e:D2,f:D8,g:P8,G:I8,H:E8,I:C8,j:S8,L:V_,m:$8,M:F8,p:lt,q:At,Q:T2,s:R2,S:T8,u:R8,U:N8,V:O8,w:z8,W:L8,x:null,X:null,y:B8,Y:U8,Z:q8,"%":F2},b={a:bt,A:Dt,b:Ot,B:ri,c:null,d:$2,e:$2,f:H8,g:n$,G:i$,H:j8,I:Y8,j:W8,L:Z_,m:G8,M:V8,p:ii,q:ai,Q:T2,s:R2,S:X8,u:Z8,U:K8,V:Q8,w:J8,W:t$,x:null,X:null,y:e$,Y:r$,Z:a$,"%":F2},_={a:C,A:E,b:$,B:F,c:L,d:C2,e:C2,f:_8,g:E2,G:A2,H:S2,I:S2,j:v8,L:w8,m:y8,M:x8,p:S,q:m8,Q:k8,s:A8,S:b8,u:c8,U:h8,V:d8,w:f8,W:g8,x:k,X:T,y:E2,Y:A2,Z:p8,"%":M8};x.x=M(n,x),x.X=M(r,x),x.c=M(e,x),b.x=M(n,b),b.X=M(r,b),b.c=M(e,b);function M(N,I){return function(j){var D=[],mt=-1,X=0,wt=N.length,_t,me,to;for(j instanceof Date||(j=new Date(+j));++mt<wt;)N.charCodeAt(mt)===37&&(D.push(N.slice(X,mt)),(me=k2[_t=N.charAt(++mt)])!=null?_t=N.charAt(++mt):me=_t==="e"?" ":"0",(to=I[_t])&&(_t=to(j,me)),D.push(_t),X=mt+1);return D.push(N.slice(X,mt)),D.join("")}}function w(N,I){return function(j){var D=oo(1900,void 0,1),mt=A(D,N,j+="",0),X,wt;if(mt!=j.length)return null;if("Q"in D)return new Date(D.Q);if("s"in D)return new Date(D.s*1e3+("L"in D?D.L:0));if(I&&!("Z"in D)&&(D.Z=0),"p"in D&&(D.H=D.H%12+D.p*12),D.m===void 0&&(D.m="q"in D?D.q:0),"V"in D){if(D.V<1||D.V>53)return null;"w"in D||(D.w=1),"Z"in D?(X=hh(oo(D.y,0,1)),wt=X.getUTCDay(),X=wt>4||wt===0?Mi.ceil(X):Mi(X),X=Lf.offset(X,(D.V-1)*7),D.y=X.getUTCFullYear(),D.m=X.getUTCMonth(),D.d=X.getUTCDate()+(D.w+6)%7):(X=ch(oo(D.y,0,1)),wt=X.getDay(),X=wt>4||wt===0?_i.ceil(X):_i(X),X=zf.offset(X,(D.V-1)*7),D.y=X.getFullYear(),D.m=X.getMonth(),D.d=X.getDate()+(D.w+6)%7)}else("W"in D||"U"in D)&&("w"in D||(D.w="u"in D?D.u%7:"W"in D?1:0),wt="Z"in D?hh(oo(D.y,0,1)).getUTCDay():ch(oo(D.y,0,1)).getDay(),D.m=0,D.d="W"in D?(D.w+6)%7+D.W*7-(wt+5)%7:D.w+D.U*7-(wt+6)%7);return"Z"in D?(D.H+=D.Z/100|0,D.M+=D.Z%100,hh(D)):ch(D)}}function A(N,I,j,D){for(var mt=0,X=I.length,wt=j.length,_t,me;mt<X;){if(D>=wt)return-1;if(_t=I.charCodeAt(mt++),_t===37){if(_t=I.charAt(mt++),me=_[_t in k2?I.charAt(mt++):_t],!me||(D=me(N,j,D))<0)return-1}else if(_t!=j.charCodeAt(D++))return-1}return D}function S(N,I,j){var D=l.exec(I.slice(j));return D?(N.p=f.get(D[0].toLowerCase()),j+D[0].length):-1}function C(N,I,j){var D=d.exec(I.slice(j));return D?(N.w=g.get(D[0].toLowerCase()),j+D[0].length):-1}function E(N,I,j){var D=c.exec(I.slice(j));return D?(N.w=h.get(D[0].toLowerCase()),j+D[0].length):-1}function $(N,I,j){var D=y.exec(I.slice(j));return D?(N.m=v.get(D[0].toLowerCase()),j+D[0].length):-1}function F(N,I,j){var D=p.exec(I.slice(j));return D?(N.m=m.get(D[0].toLowerCase()),j+D[0].length):-1}function L(N,I,j){return A(N,e,I,j)}function k(N,I,j){return A(N,n,I,j)}function T(N,I,j){return A(N,r,I,j)}function B(N){return o[N.getDay()]}function U(N){return a[N.getDay()]}function q(N){return s[N.getMonth()]}function it(N){return u[N.getMonth()]}function lt(N){return i[+(N.getHours()>=12)]}function At(N){return 1+~~(N.getMonth()/3)}function bt(N){return o[N.getUTCDay()]}function Dt(N){return a[N.getUTCDay()]}function Ot(N){return s[N.getUTCMonth()]}function ri(N){return u[N.getUTCMonth()]}function ii(N){return i[+(N.getUTCHours()>=12)]}function ai(N){return 1+~~(N.getUTCMonth()/3)}return{format:function(N){var I=M(N+="",x);return I.toString=function(){return N},I},parse:function(N){var I=w(N+="",!1);return I.toString=function(){return N},I},utcFormat:function(N){var I=M(N+="",b);return I.toString=function(){return N},I},utcParse:function(N){var I=w(N+="",!0);return I.toString=function(){return N},I}}}var k2={"-":"",_:" ",0:"0"},Kt=/^\s*\d+/,u8=/^%/,s8=/[\\^$*+?|[\]().{}]/g;function ht(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function l8(t){return t.replace(s8,"\\$&")}function uo(t){return new RegExp("^(?:"+t.map(l8).join("|")+")","i")}function so(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function f8(t,e,n){var r=Kt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function c8(t,e,n){var r=Kt.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function h8(t,e,n){var r=Kt.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function d8(t,e,n){var r=Kt.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function g8(t,e,n){var r=Kt.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function A2(t,e,n){var r=Kt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function E2(t,e,n){var r=Kt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function p8(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function m8(t,e,n){var r=Kt.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function y8(t,e,n){var r=Kt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function C2(t,e,n){var r=Kt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function v8(t,e,n){var r=Kt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function S2(t,e,n){var r=Kt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function x8(t,e,n){var r=Kt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function b8(t,e,n){var r=Kt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function w8(t,e,n){var r=Kt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function _8(t,e,n){var r=Kt.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function M8(t,e,n){var r=u8.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function k8(t,e,n){var r=Kt.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function A8(t,e,n){var r=Kt.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function D2(t,e){return ht(t.getDate(),e,2)}function E8(t,e){return ht(t.getHours(),e,2)}function C8(t,e){return ht(t.getHours()%12||12,e,2)}function S8(t,e){return ht(1+zf.count(Hn(t),t),e,3)}function V_(t,e){return ht(t.getMilliseconds(),e,3)}function D8(t,e){return V_(t,e)+"000"}function $8(t,e){return ht(t.getMonth()+1,e,2)}function F8(t,e){return ht(t.getMinutes(),e,2)}function T8(t,e){return ht(t.getSeconds(),e,2)}function R8(t){var e=t.getDay();return e===0?7:e}function N8(t,e){return ht(Mg.count(Hn(t)-1,t),e,2)}function X_(t){var e=t.getDay();return e>=4||e===0?kn(t):kn.ceil(t)}function O8(t,e){return t=X_(t),ht(kn.count(Hn(t),t)+(Hn(t).getDay()===4),e,2)}function z8(t){return t.getDay()}function L8(t,e){return ht(_i.count(Hn(t)-1,t),e,2)}function B8(t,e){return ht(t.getFullYear()%100,e,2)}function P8(t,e){return t=X_(t),ht(t.getFullYear()%100,e,2)}function U8(t,e){return ht(t.getFullYear()%1e4,e,4)}function I8(t,e){var n=t.getDay();return t=n>=4||n===0?kn(t):kn.ceil(t),ht(t.getFullYear()%1e4,e,4)}function q8(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+ht(e/60|0,"0",2)+ht(e%60,"0",2)}function $2(t,e){return ht(t.getUTCDate(),e,2)}function j8(t,e){return ht(t.getUTCHours(),e,2)}function Y8(t,e){return ht(t.getUTCHours()%12||12,e,2)}function W8(t,e){return ht(1+Lf.count(Gn(t),t),e,3)}function Z_(t,e){return ht(t.getUTCMilliseconds(),e,3)}function H8(t,e){return Z_(t,e)+"000"}function G8(t,e){return ht(t.getUTCMonth()+1,e,2)}function V8(t,e){return ht(t.getUTCMinutes(),e,2)}function X8(t,e){return ht(t.getUTCSeconds(),e,2)}function Z8(t){var e=t.getUTCDay();return e===0?7:e}function K8(t,e){return ht(Ag.count(Gn(t)-1,t),e,2)}function K_(t){var e=t.getUTCDay();return e>=4||e===0?An(t):An.ceil(t)}function Q8(t,e){return t=K_(t),ht(An.count(Gn(t),t)+(Gn(t).getUTCDay()===4),e,2)}function J8(t){return t.getUTCDay()}function t$(t,e){return ht(Mi.count(Gn(t)-1,t),e,2)}function e$(t,e){return ht(t.getUTCFullYear()%100,e,2)}function n$(t,e){return t=K_(t),ht(t.getUTCFullYear()%100,e,2)}function r$(t,e){return ht(t.getUTCFullYear()%1e4,e,4)}function i$(t,e){var n=t.getUTCDay();return t=n>=4||n===0?An(t):An.ceil(t),ht(t.getUTCFullYear()%1e4,e,4)}function a$(){return"+0000"}function F2(){return"%"}function T2(t){return+t}function R2(t){return Math.floor(+t/1e3)}var Ki,Q_,J_,t3,e3;o$({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function o$(t){return Ki=G_(t),Q_=Ki.format,J_=Ki.parse,t3=Ki.utcFormat,e3=Ki.utcParse,Ki}function Oo(t){const e={};return n=>e[n]||(e[n]=t(n))}function u$(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let a=s$(r,i);const o=a<r.length?r.slice(a):"";for(;--a>i;)if(r[a]!=="0"){++a;break}return r.slice(0,a)+o}}function s$(t,e){let n=t.lastIndexOf("e"),r;if(n>0)return n;for(n=t.length;--n>e;)if(r=t.charCodeAt(n),r>=48&&r<=57)return n+1}function n3(t){const e=Oo(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(r){const i=hu(r||",");if(i.precision==null){switch(i.precision=12,i.type){case"%":i.precision-=2;break;case"e":i.precision-=1;break}return u$(e(i),e(".1f")(1)[1])}else return e(i)},formatSpan(r,i,a,o){o=hu(o==null?",f":o);const u=dD(r,i,a),s=Math.max(Math.abs(r),Math.abs(i));let l;if(o.precision==null)switch(o.type){case"s":return isNaN(l=_D(u,s))||(o.precision=l),n(o,s);case"":case"e":case"g":case"p":case"r":{isNaN(l=MD(u,s))||(o.precision=l-(o.type==="e"));break}case"f":case"%":{isNaN(l=wD(u))||(o.precision=l-(o.type==="%")*2);break}}return e(o)}}}let S0;r3();function r3(){return S0=n3({format:g_,formatPrefix:p_})}function i3(t){return n3(d_(t))}function Sl(t){return arguments.length?S0=i3(t):S0}function N2(t,e,n){n=n||{},et(n)||z("Invalid time multi-format specifier: ".concat(n));const r=e(ln),i=e(Xe),a=e(Ve),o=e(Pe),u=e(It),s=e(ce),l=e(Be),f=e(te),c=t(n[Cn]||".%L"),h=t(n[ln]||":%S"),d=t(n[Xe]||"%I:%M"),g=t(n[Ve]||"%I %p"),p=t(n[Pe]||n[se]||"%a %d"),m=t(n[It]||"%b %d"),y=t(n[ce]||"%B"),v=t(n[Be]||"%B"),x=t(n[te]||"%Y");return b=>(r(b)<b?c:i(b)<b?h:a(b)<b?d:o(b)<b?g:s(b)<b?u(b)<b?p:m:f(b)<b?l(b)<b?y:v:x)(b)}function a3(t){const e=Oo(t.format),n=Oo(t.utcFormat);return{timeFormat:r=>Ct(r)?e(r):N2(e,Ya,r),utcFormat:r=>Ct(r)?n(r):N2(n,Wa,r),timeParse:Oo(t.parse),utcParse:Oo(t.utcParse)}}let D0;o3();function o3(){return D0=a3({format:Q_,parse:J_,utcFormat:t3,utcParse:e3})}function u3(t){return a3(G_(t))}function pu(t){return arguments.length?D0=u3(t):D0}const $0=(t,e)=>tt({},t,e);function s3(t,e){const n=t?i3(t):Sl(),r=e?u3(e):pu();return $0(n,r)}function Zg(t,e){const n=arguments.length;return n&&n!==2&&z("defaultLocale expects either zero or two arguments."),n?$0(Sl(t),pu(e)):$0(Sl(),pu())}function l$(){return r3(),o3(),Zg()}function l3(t,e,n,r){e=e||{};const i=Ug(e.type||"json");return i||z("Unknown data format type: "+e.type),t=i(t,e),e.parse&&f$(t,e.parse,n,r),K(t,"columns")&&delete t.columns,t}function f$(t,e,n,r){if(!t.length)return;const i=pu();n=n||i.timeParse,r=r||i.utcParse;let a=t.columns||Object.keys(t[0]),o,u,s,l,f,c;e==="auto"&&(e=u_(t,a)),a=Object.keys(e);const h=a.map(d=>{const g=e[d];let p,m;if(g&&(g.startsWith("date:")||g.startsWith("utc:")))return p=g.split(/:(.+)?/,2),m=p[1],(m[0]==="'"&&m[m.length-1]==="'"||m[0]==='"'&&m[m.length-1]==='"')&&(m=m.slice(1,-1)),(p[0]==="utc"?r:n)(m);if(!_0[g])throw Error("Illegal format pattern: "+d+":"+g);return _0[g]});for(s=0,f=t.length,c=a.length;s<f;++s)for(o=t[s],l=0;l<c;++l)u=a[l],o[u]=h[l](o[u])}const jf=LS(typeof fetch<"u"&&fetch,null);function Yf(t){const e=t||Ee,n=[],r={};return n.add=i=>{const a=e(i);return r[a]||(r[a]=1,n.push(i)),n},n.remove=i=>{const a=e(i);if(r[a]){r[a]=0;const o=n.indexOf(i);o>=0&&n.splice(o,1)}return n},n}async function Qs(t,e){try{await e(t)}catch(n){t.error(n)}}const f3=Symbol("vega_id");let c$=1;function Wf(t){return!!(t&&H(t))}function H(t){return t[f3]}function c3(t,e){return t[f3]=e,t}function gt(t){const e=t===Object(t)?t:{data:t};return H(e)?e:c3(e,c$++)}function Kg(t){return Hf(t,gt({}))}function Hf(t,e){for(const n in t)e[n]=t[n];return e}function h3(t,e){return c3(e,H(t))}function Bi(t,e){return t?e?(n,r)=>t(n,r)||H(e(n))-H(e(r)):(n,r)=>t(n,r)||H(n)-H(r):null}function d3(t){return t&&t.constructor===Pi}function Pi(){const t=[],e=[],n=[],r=[],i=[];let a=null,o=!1;return{constructor:Pi,insert(u){const s=Z(u),l=s.length;for(let f=0;f<l;++f)t.push(s[f]);return this},remove(u){const s=nt(u)?r:e,l=Z(u),f=l.length;for(let c=0;c<f;++c)s.push(l[c]);return this},modify(u,s,l){const f={field:s,value:ge(l)};return nt(u)?(f.filter=u,i.push(f)):(f.tuple=u,n.push(f)),this},encode(u,s){return nt(u)?i.push({filter:u,field:s}):n.push({tuple:u,field:s}),this},clean(u){return a=u,this},reflow(){return o=!0,this},pulse(u,s){const l={},f={};let c,h,d,g,p,m;for(c=0,h=s.length;c<h;++c)l[H(s[c])]=1;for(c=0,h=e.length;c<h;++c)p=e[c],l[H(p)]=-1;for(c=0,h=r.length;c<h;++c)g=r[c],s.forEach(v=>{g(v)&&(l[H(v)]=-1)});for(c=0,h=t.length;c<h;++c)p=t[c],m=H(p),l[m]?l[m]=1:u.add.push(gt(t[c]));for(c=0,h=s.length;c<h;++c)p=s[c],l[H(p)]<0&&u.rem.push(p);function y(v,x,b){b?v[x]=b(v):u.encode=x,o||(f[H(v)]=v)}for(c=0,h=n.length;c<h;++c)d=n[c],p=d.tuple,g=d.field,m=l[H(p)],m>0&&(y(p,g,d.value),u.modifies(g));for(c=0,h=i.length;c<h;++c)d=i[c],g=d.filter,s.forEach(v=>{g(v)&&l[H(v)]>0&&y(v,d.field,d.value)}),u.modifies(d.field);if(o)u.mod=e.length||r.length?s.filter(v=>l[H(v)]>0):s.slice();else for(m in f)u.mod.push(f[m]);return(a||a==null&&(e.length||r.length))&&u.clean(!0),u}}}const Js="_:mod:_";function Gf(){Object.defineProperty(this,Js,{writable:!0,value:{}})}Gf.prototype={set(t,e,n,r){const i=this,a=i[t],o=i[Js];return e!=null&&e>=0?(a[e]!==n||r)&&(a[e]=n,o[e+":"+t]=-1,o[t]=-1):(a!==n||r)&&(i[t]=n,o[t]=G(n)?1+n.length:-1),i},modified(t,e){const n=this[Js];if(arguments.length){if(G(t)){for(let r=0;r<t.length;++r)if(n[t[r]])return!0;return!1}}else{for(const r in n)if(n[r])return!0;return!1}return e!=null&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[Js]={},this}};let h$=0;const d$="pulse",g$=new Gf,p$=1,m$=2;function kt(t,e,n,r){this.id=++h$,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function O2(t){return function(e){const n=this.flags;return arguments.length===0?!!(n&t):(this.flags=e?n|t:n&~t,this)}}kt.prototype={targets(){return this._targets||(this._targets=Yf(zu))},set(t){return this.value!==t?(this.value=t,1):0},skip:O2(p$),modified:O2(m$),parameters(t,e,n){e=e!==!1;const r=this._argval=this._argval||new Gf,i=this._argops=this._argops||[],a=[];let o,u,s,l;const f=(c,h,d)=>{d instanceof kt?(d!==this&&(e&&d.targets().add(this),a.push(d)),i.push({op:d,name:c,index:h})):r.set(c,h,d)};for(o in t)if(u=t[o],o===d$)Z(u).forEach(c=>{c instanceof kt?c!==this&&(c.targets().add(this),a.push(c)):z("Pulse parameters must be operator instances.")}),this.source=u;else if(G(u))for(r.set(o,-1,Array(s=u.length)),l=0;l<s;++l)f(o,l,u[l]);else f(o,-1,u);return this.marshall().clear(),n&&(i.initonly=!0),a},marshall(t){const e=this._argval||g$,n=this._argops;let r,i,a,o;if(n){const u=n.length;for(i=0;i<u;++i)r=n[i],a=r.op,o=a.modified()&&a.stamp===t,e.set(r.name,r.index,a.value,o);if(n.initonly){for(i=0;i<u;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};function y$(t,e,n,r){let i=1,a;return t instanceof kt?a=t:t&&t.prototype instanceof kt?a=new t:nt(t)?a=new kt(null,t):(i=0,a=new kt(t,e)),this.rank(a),i&&(r=n,n=e),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a}function v$(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank){this.rerank(t);return}}let x$=0;function Vf(t,e,n){this.id=++x$,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function kr(t,e,n){return new Vf(t,e,n)}Vf.prototype={_filter:sn,_apply:Ee,targets(){return this._targets||(this._targets=Yf(zu))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let i=0;i<r;++i)n[i].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=kr(t);return this.targets().add(e),e},apply(t){const e=kr(null,t);return this.targets().add(e),e},merge(){const t=kr();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter(()=>{const n=Date.now();return n-e>t?(e=n,1):0})},debounce(t){const e=kr();return this.targets().add(kr(null,null,Rg(t,n=>{const r=n.dataflow;e.receive(n),r&&r.run&&r.run()}))),e},between(t,e){let n=!1;return t.targets().add(kr(null,null,()=>n=!0)),e.targets().add(kr(null,null,()=>n=!1)),this.filter(()=>n)},detach(){this._filter=sn,this._targets=null}};function b$(t,e,n,r){const i=this,a=kr(n,r),o=function(l){l.dataflow=i;try{a.receive(l)}catch(f){i.error(f)}finally{i.run()}};let u;typeof t=="string"&&typeof document<"u"?u=document.querySelectorAll(t):u=Z(t);const s=u.length;for(let l=0;l<s;++l)u[l].addEventListener(e,o);return a}function w$(t,e){const n=this.locale();return l3(t,e,n.timeParse,n.utcParse)}function _$(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))}async function M$(t,e){const n=this;let r=0,i;try{i=await n.loader().load(t,{context:"dataflow",response:c_(e&&e.type)});try{i=n.parse(i,e)}catch(a){r=-2,n.warn("Data ingestion failed",t,a)}}catch(a){r=-1,n.warn("Loading failed",t,a)}return{data:i,status:r}}async function k$(t,e,n){const r=this,i=r._pending||A$(r);i.requests+=1;const a=await r.request(e,n);return r.pulse(t,r.changeset().remove(sn).insert(a.data||[])),i.done(),a}function A$(t){let e;const n=new Promise(r=>e=r);return n.requests=0,n.done=()=>{--n.requests===0&&(t._pending=null,e(t))},t._pending=n}const E$={skip:!0};function C$(t,e,n,r,i){return(t instanceof kt?D$:S$)(this,t,e,n,r,i),this}function S$(t,e,n,r,i,a){const o=tt({},a,E$);let u,s;nt(n)||(n=ge(n)),r===void 0?u=l=>t.touch(n(l)):nt(r)?(s=new kt(null,r,i,!1),u=l=>{s.evaluate(l);const f=n(l),c=s.value;d3(c)?t.pulse(f,c,a):t.update(f,c,o)}):u=l=>t.update(n(l),r,o),e.apply(u)}function D$(t,e,n,r,i,a){if(r===void 0)e.targets().add(n);else{const o=a||{},u=new kt(null,$$(n,r),i,!1);u.modified(o.force),u.rank=e.rank,e.targets().add(u),n&&(u.skip(!0),u.value=n.value,u.targets().add(n),t.connect(n,[u]))}}function $$(t,e){return e=nt(e)?e:ge(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}function F$(t){t.rank=++this._rank}function T$(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&z("Cycle detected in dataflow graph.")}const Dl={},Nn=1<<0,Er=1<<1,or=1<<2,R$=Nn|Er,z2=Nn|or,Qi=Nn|Er|or,L2=1<<3,lo=1<<4,B2=1<<5,P2=1<<6;function Ir(t,e,n){this.dataflow=t,this.stamp=e==null?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function dh(t,e){const n=[];return Ar(t,e,r=>n.push(r)),n}function U2(t,e){const n={};return t.visit(e,r=>{n[H(r)]=1}),r=>n[H(r)]?null:r}function _s(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}Ir.prototype={StopPropagation:Dl,ADD:Nn,REM:Er,MOD:or,ADD_REM:R$,ADD_MOD:z2,ALL:Qi,REFLOW:L2,SOURCE:lo,NO_SOURCE:B2,NO_FIELDS:P2,fork(t){return new Ir(this.dataflow).init(this,t)},clone(){const t=this.fork(Qi);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(Qi|lo)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new Ir(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,t.fields&&!(e&P2)&&(n.fields=t.fields),e&Nn?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),e&Er?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),e&or?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),e&B2?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||Qi;return e&Nn&&this.add.length||e&Er&&this.rem.length||e&or&&this.mod.length},reflow(t){if(t)return this.fork(Qi).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(or,U2(this,Nn))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return G(t)?t.forEach(n=>e[n]=!0):e[t]=!0,this},modified(t,e){const n=this.fields;return(e||this.mod.length)&&n?arguments.length?G(t)?t.some(r=>n[r]):n[t]:!!n:!1},filter(t,e){const n=this;return t&Nn&&(n.addF=_s(n.addF,e)),t&Er&&(n.remF=_s(n.remF,e)),t&or&&(n.modF=_s(n.modF,e)),t&lo&&(n.srcF=_s(n.srcF,e)),n},materialize(t){t=t||Qi;const e=this;return t&Nn&&e.addF&&(e.add=dh(e.add,e.addF),e.addF=null),t&Er&&e.remF&&(e.rem=dh(e.rem,e.remF),e.remF=null),t&or&&e.modF&&(e.mod=dh(e.mod,e.modF),e.modF=null),t&lo&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(t&lo)return Ar(n.source,n.srcF,r),n;t&Nn&&Ar(n.add,n.addF,r),t&Er&&Ar(n.rem,n.remF,r),t&or&&Ar(n.mod,n.modF,r);const i=n.source;if(t&L2&&i){const a=n.add.length+n.mod.length;a===i.length||(a?Ar(i,U2(n,z2),r):Ar(i,n.srcF,r))}return n}};function Qg(t,e,n,r){const i=this,a=n.length;let o=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(let u=0;u<a;++u){const s=n[u];if(s.stamp===e){if(s.fields){const l=i.fields||(i.fields={});for(const f in s.fields)l[f]=1}s.changed(i.ADD)&&(o|=i.ADD),s.changed(i.REM)&&(o|=i.REM),s.changed(i.MOD)&&(o|=i.MOD)}}this.changes=o}P(Qg,Ir,{fork(t){const e=new Ir(this.dataflow).init(this,t&this.NO_FIELDS);return t!==void 0&&(t&e.ADD&&this.visit(e.ADD,n=>e.add.push(n)),t&e.REM&&this.visit(e.REM,n=>e.rem.push(n)),t&e.MOD&&this.visit(e.MOD,n=>e.mod.push(n))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?G(t)?t.some(r=>n[r]):n[t]:0},filter(){z("MultiPulse does not support filtering.")},materialize(){z("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let a=0;if(t&n.SOURCE)for(;a<i;++a)r[a].visit(t,e);else for(;a<i;++a)r[a].stamp===n.stamp&&r[a].visit(t,e);return n}});async function N$(t,e,n){const r=this,i=[];if(r._pulse)return g3(r);if(r._pending&&await r._pending,e&&await Qs(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const a=++r._clock;r._pulse=new Ir(r,a,t),r._touched.forEach(f=>r._enqueue(f,!0)),r._touched=Yf(zu);let o=0,u,s,l;try{for(;r._heap.size()>0;){if(u=r._heap.pop(),u.rank!==u.qrank){r._enqueue(u,!0);continue}s=u.run(r._getPulse(u,t)),s.then?s=await s:s.async&&(i.push(s.async),s=Dl),s!==Dl&&u._targets&&u._targets.forEach(f=>r._enqueue(f)),++o}}catch(f){r._heap.clear(),l=f}if(r._input={},r._pulse=null,r.debug(`Pulse ${a}: ${o} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const f=r._postrun.sort((c,h)=>h.priority-c.priority);r._postrun=[];for(let c=0;c<f.length;++c)await Qs(r,f[c].callback)}return n&&await Qs(r,n),i.length&&Promise.all(i).then(f=>r.runAsync(null,()=>{f.forEach(c=>{try{c(r)}catch(h){r.error(h)}})})),r}async function O$(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running}function z$(t,e,n){return this._pulse?g3(this):(this.evaluate(t,e,n),this)}function L$(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(r){this.error(r)}}function g3(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}function B$(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))}function P$(t,e){const n=t.source,r=this._clock;return n&&G(n)?new Qg(this,r,n.map(i=>i.pulse),e):this._input[t.id]||U$(this._pulse,n&&n.pulse)}function U$(t,e){return e&&e.stamp===t.stamp?e:(t=t.fork(),e&&e!==Dl&&(t.source=e.source),t)}const Jg={skip:!1,force:!1};function I$(t,e){const n=e||Jg;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this}function q$(t,e,n){const r=n||Jg;return(t.set(e)||r.force)&&this.touch(t,r),this}function j$(t,e,n){this.touch(t,n||Jg);const r=new Ir(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this}function Y$(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),p3(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,W$(e,0,t)):r=n,r}}}function p3(t,e,n,r){let i,a;const o=t[n];for(;n>e;){if(a=n-1>>1,i=t[a],r(o,i)<0){t[n]=i,n=a;continue}break}return t[n]=o}function W$(t,e,n){const r=e,i=t.length,a=t[e];let o=(e<<1)+1,u;for(;o<i;)u=o+1,u<i&&n(t[o],t[u])>=0&&(o=u),t[e]=t[o],e=o,o=(e<<1)+1;return t[e]=a,p3(t,r,e,n)}function ya(){this.logger(zw()),this.logLevel(Cg),this._clock=0,this._rank=0,this._locale=Zg();try{this._loader=jf()}catch(t){}this._touched=Yf(zu),this._input={},this._pulse=null,this._heap=Y$((t,e)=>t.qrank-e.qrank),this._postrun=[]}function fo(t){return function(){return this._log[t].apply(this,arguments)}}ya.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:fo("error"),warn:fo("warn"),info:fo("info"),debug:fo("debug"),logLevel:fo("level"),cleanThreshold:1e4,add:y$,connect:v$,rank:F$,rerank:T$,pulse:j$,touch:I$,update:q$,changeset:Pi,ingest:_$,parse:w$,preload:k$,request:M$,events:b$,on:C$,evaluate:N$,run:z$,runAsync:O$,runAfter:L$,_enqueue:B$,_getPulse:P$};function R(t,e){kt.call(this,t,null,e)}P(R,kt,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then(n=>this.pulse=n):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const Ca={};function m3(t){const e=y3(t);return e&&e.Definition||null}function y3(t){return t=t&&t.toLowerCase(),K(Ca,t)?Ca[t]:null}function t1(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function H$(t){return t===null?NaN:+t}function*G$(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)(r=e(r,++n,t))!=null&&(r=+r)>=r&&(yield r)}}function V$(t,e){let n=0,r,i=0,a=0;if(e===void 0)for(let o of t)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,a+=r*(o-i));else{let o=-1;for(let u of t)(u=e(u,++o,t))!=null&&(u=+u)>=u&&(r=u-i,i+=r/++n,a+=r*(u-i))}if(n>1)return a/(n-1)}function X$(t,e){const n=V$(t,e);return n&&Math.sqrt(n)}function I2(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function q2(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function v3(t,e,n=0,r=t.length-1,i=t1){for(;r>n;){if(r-n>600){const s=r-n+1,l=e-n+1,f=Math.log(s),c=.5*Math.exp(2*f/3),h=.5*Math.sqrt(f*c*(s-c)/s)*(l-s/2<0?-1:1),d=Math.max(n,Math.floor(e-l*c/s+h)),g=Math.min(r,Math.floor(e+(s-l)*c/s+h));v3(t,e,d,g,i)}const a=t[e];let o=n,u=r;for(co(t,n,e),i(t[r],a)>0&&co(t,n,r);o<u;){for(co(t,o,u),++o,--u;i(t[o],a)<0;)++o;for(;i(t[u],a)>0;)--u}i(t[n],a)===0?co(t,n,u):(++u,co(t,u,r)),u<=e&&(n=u+1),e<=u&&(r=u-1)}return t}function co(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function F0(t,e,n){if(t=Float64Array.from(G$(t,n)),!!(r=t.length)){if((e=+e)<=0||r<2)return q2(t);if(e>=1)return I2(t);var r,i=(r-1)*e,a=Math.floor(i),o=I2(v3(t,a).subarray(0,a+1)),u=q2(t.subarray(a+1));return o+(u-o)*(i-a)}}function Z$(t,e,n=H$){if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t),u=+n(t[a+1],a+1,t);return o+(u-o)*(i-a)}}function K$(t,e){return F0(t,.5,e)}function*x3(t,e){if(e==null)for(let n of t)n!=null&&n!==""&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)r=e(r,++n,t),r!=null&&r!==""&&(r=+r)>=r&&(yield r)}}function e1(t,e,n){const r=Float64Array.from(x3(t,n));return r.sort(t1),e.map(i=>Z$(r,i))}function n1(t,e){return e1(t,[.25,.5,.75],e)}function r1(t,e){const n=t.length,r=X$(t,e),i=n1(t,e),a=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,a)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function b3(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let a=t.extent[0],o=t.extent[1],u,s,l,f,c,h;const d=t.span||o-a||Math.abs(a)||1;if(t.step)u=t.step;else if(t.steps){for(f=d/e,c=0,h=t.steps.length;c<h&&t.steps[c]<f;++c);u=t.steps[Math.max(0,c-1)]}else{for(s=Math.ceil(Math.log(e)/r),l=t.minstep||0,u=Math.max(l,Math.pow(n,Math.round(Math.log(d)/r)-s));Math.ceil(d/u)>e;)u*=n;for(c=0,h=i.length;c<h;++c)f=u/i[c],f>=l&&d/f<=e&&(u=f)}f=Math.log(u);const g=f>=0?0:~~(-f/r)+1,p=Math.pow(n,-g-1);return(t.nice||t.nice===void 0)&&(f=Math.floor(a/u+p)*u,a=a<f?f-u:f,o=Math.ceil(o/u)*u),{start:a,stop:o===a?a+u:o,step:u}}var fn=Math.random;function Q$(t){fn=t}function w3(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(x3(t,r)),a=i.length,o=e;let u,s,l,f;for(l=0,f=Array(o);l<o;++l){for(u=0,s=0;s<a;++s)u+=i[~~(fn()*a)];f[l]=u/a}return f.sort(t1),[F0(f,n/2),F0(f,1-n/2)]}function _3(t,e,n,r){r=r||(h=>h);const i=t.length,a=new Float64Array(i);let o=0,u=1,s=r(t[0]),l=s,f=s+e,c;for(;u<i;++u){if(c=r(t[u]),c>=f){for(l=(s+l)/2;o<u;++o)a[o]=l;f=c+e,s=c}l=c}for(l=(s+l)/2;o<u;++o)a[o]=l;return n?J$(a,e+e/4):a}function J$(t,e){const n=t.length;let r=0,i=1,a,o;for(;t[r]===t[i];)++i;for(;i<n;){for(a=i+1;t[i]===t[a];)++a;if(t[i]-t[i-1]<e){for(o=i+(r+a-i-i>>1);o<i;)t[o++]=t[i];for(;o>i;)t[o--]=t[r]}r=i,i=a}return t}function t7(t){return function(){return t=(1103515245*t+12345)%2147483647,t/2147483647}}function e7(t,e){e==null&&(e=t,t=0);let n,r,i;const a={min(o){return arguments.length?(n=o||0,i=r-n,a):n},max(o){return arguments.length?(r=o||0,i=r-n,a):r},sample(){return n+Math.floor(i*fn())},pdf(o){return o===Math.floor(o)&&o>=n&&o<r?1/i:0},cdf(o){const u=Math.floor(o);return u<n?0:u>=r?1:(u-n+1)/i},icdf(o){return o>=0&&o<=1?n-1+Math.floor(o*i):NaN}};return a.min(t).max(e)}const M3=Math.sqrt(2*Math.PI),n7=Math.SQRT2;let ho=NaN;function Xf(t,e){t=t||0,e=e==null?1:e;let n=0,r=0,i,a;if(ho===ho)n=ho,ho=NaN;else{do n=fn()*2-1,r=fn()*2-1,i=n*n+r*r;while(i===0||i>1);a=Math.sqrt(-2*Math.log(i)/i),n*=a,ho=r*a}return t+n*e}function i1(t,e,n){n=n==null?1:n;const r=(t-(e||0))/n;return Math.exp(-.5*r*r)/(n*M3)}function Zf(t,e,n){e=e||0,n=n==null?1:n;const r=(t-e)/n,i=Math.abs(r);let a;if(i>37)a=0;else{const o=Math.exp(-i*i/2);let u;i<7.07106781186547?(u=.0352624965998911*i+.700383064443688,u=u*i+6.37396220353165,u=u*i+33.912866078383,u=u*i+112.079291497871,u=u*i+221.213596169931,u=u*i+220.206867912376,a=o*u,u=.0883883476483184*i+1.75566716318264,u=u*i+16.064177579207,u=u*i+86.7807322029461,u=u*i+296.564248779674,u=u*i+637.333633378831,u=u*i+793.826512519948,u=u*i+440.413735824752,a=a/u):(u=i+.65,u=i+4/u,u=i+3/u,u=i+2/u,u=i+1/u,a=o/u/2.506628274631)}return r>0?1-a:a}function Kf(t,e,n){return t<0||t>1?NaN:(e||0)+(n==null?1:n)*n7*r7(2*t-1)}function r7(t){let e=-Math.log((1-t)*(1+t)),n;return e<6.25?(e-=3.125,n=-364441206401782e-35,n=-16850591381820166e-35+n*e,n=128584807152564e-32+n*e,n=11157877678025181e-33+n*e,n=-1333171662854621e-31+n*e,n=20972767875968562e-33+n*e,n=6637638134358324e-30+n*e,n=-4054566272975207e-29+n*e,n=-8151934197605472e-29+n*e,n=26335093153082323e-28+n*e,n=-12975133253453532e-27+n*e,n=-5415412054294628e-26+n*e,n=10512122733215323e-25+n*e,n=-4112633980346984e-24+n*e,n=-29070369957882005e-24+n*e,n=42347877827932404e-23+n*e,n=-13654692000834679e-22+n*e,n=-13882523362786469e-21+n*e,n=.00018673420803405714+n*e,n=-.000740702534166267+n*e,n=-.006033670871430149+n*e,n=.24015818242558962+n*e,n=1.6536545626831027+n*e):e<16?(e=Math.sqrt(e)-3.25,n=22137376921775787e-25,n=9075656193888539e-23+n*e,n=-27517406297064545e-23+n*e,n=18239629214389228e-24+n*e,n=15027403968909828e-22+n*e,n=-4013867526981546e-21+n*e,n=29234449089955446e-22+n*e,n=12475304481671779e-21+n*e,n=-47318229009055734e-21+n*e,n=6828485145957318e-20+n*e,n=24031110387097894e-21+n*e,n=-.0003550375203628475+n*e,n=.0009532893797373805+n*e,n=-.0016882755560235047+n*e,n=.002491442096107851+n*e,n=-.003751208507569241+n*e,n=.005370914553590064+n*e,n=1.0052589676941592+n*e,n=3.0838856104922208+n*e):Number.isFinite(e)?(e=Math.sqrt(e)-5,n=-27109920616438573e-27,n=-2555641816996525e-25+n*e,n=15076572693500548e-25+n*e,n=-3789465440126737e-24+n*e,n=761570120807834e-23+n*e,n=-1496002662714924e-23+n*e,n=2914795345090108e-23+n*e,n=-6771199775845234e-23+n*e,n=22900482228026655e-23+n*e,n=-99298272942317e-20+n*e,n=4526062597223154e-21+n*e,n=-1968177810553167e-20+n*e,n=7599527703001776e-20+n*e,n=-.00021503011930044477+n*e,n=-.00013871931833623122+n*e,n=1.0103004648645344+n*e,n=4.849906401408584+n*e):n=1/0,n*t}function a1(t,e){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a==null?1:a,i):r},sample:()=>Xf(n,r),pdf:a=>i1(a,n,r),cdf:a=>Zf(a,n,r),icdf:a=>Kf(a,n,r)};return i.mean(t).stdev(e)}function o1(t,e){const n=a1();let r=0;const i={data(a){return arguments.length?(t=a,r=a?a.length:0,i.bandwidth(e)):t},bandwidth(a){return arguments.length?(e=a,!e&&t&&(e=r1(t)),i):e},sample(){return t[~~(fn()*r)]+e*n.sample()},pdf(a){let o=0,u=0;for(;u<r;++u)o+=n.pdf((a-t[u])/e);return o/e/r},cdf(a){let o=0,u=0;for(;u<r;++u)o+=n.cdf((a-t[u])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function u1(t,e){return t=t||0,e=e==null?1:e,Math.exp(t+Xf()*e)}function s1(t,e,n){if(t<=0)return 0;e=e||0,n=n==null?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*M3*t)}function l1(t,e,n){return Zf(Math.log(t),e,n)}function f1(t,e,n){return Math.exp(Kf(t,e,n))}function k3(t,e){let n,r;const i={mean(a){return arguments.length?(n=a||0,i):n},stdev(a){return arguments.length?(r=a==null?1:a,i):r},sample:()=>u1(n,r),pdf:a=>s1(a,n,r),cdf:a=>l1(a,n,r),icdf:a=>f1(a,n,r)};return i.mean(t).stdev(e)}function A3(t,e){let n=0,r;function i(o){const u=[];let s=0,l;for(l=0;l<n;++l)s+=u[l]=o[l]==null?1:+o[l];for(l=0;l<n;++l)u[l]/=s;return u}const a={weights(o){return arguments.length?(r=i(e=o||[]),a):e},distributions(o){return arguments.length?(o?(n=o.length,t=o):(n=0,t=[]),a.weights(e)):t},sample(){const o=fn();let u=t[n-1],s=r[0],l=0;for(;l<n-1;s+=r[++l])if(o<s){u=t[l];break}return u.sample()},pdf(o){let u=0,s=0;for(;s<n;++s)u+=r[s]*t[s].pdf(o);return u},cdf(o){let u=0,s=0;for(;s<n;++s)u+=r[s]*t[s].cdf(o);return u},icdf(){throw Error("Mixture icdf not supported.")}};return a.distributions(t).weights(e)}function c1(t,e){return e==null&&(e=t==null?1:t,t=0),t+(e-t)*fn()}function h1(t,e,n){return n==null&&(n=e==null?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function d1(t,e,n){return n==null&&(n=e==null?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function g1(t,e,n){return n==null&&(n=e==null?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function E3(t,e){let n,r;const i={min(a){return arguments.length?(n=a||0,i):n},max(a){return arguments.length?(r=a==null?1:a,i):r},sample:()=>c1(n,r),pdf:a=>h1(a,n,r),cdf:a=>d1(a,n,r),icdf:a=>g1(a,n,r)};return e==null&&(e=t==null?1:t,t=0),i.min(t).max(e)}function Bu(t,e,n,r){const i=r-t*t,a=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-a*t,a]}function Qf(t,e,n,r){t=t.filter(d=>{let g=e(d),p=n(d);return g!=null&&(g=+g)>=g&&p!=null&&(p=+p)>=p}),r&&t.sort((d,g)=>e(d)-e(g));const i=t.length,a=new Float64Array(i),o=new Float64Array(i);let u=0,s=0,l=0,f,c,h;for(h of t)a[u]=f=+e(h),o[u]=c=+n(h),++u,s+=(f-s)/u,l+=(c-l)/u;for(u=0;u<i;++u)a[u]-=s,o[u]-=l;return[a,o,s,l]}function Pu(t,e,n,r){let i=-1,a,o;for(const u of t)a=e(u),o=n(u),a!=null&&(a=+a)>=a&&o!=null&&(o=+o)>=o&&r(a,o,++i)}function Ha(t,e,n,r,i){let a=0,o=0;return Pu(t,e,n,(u,s)=>{const l=s-i(u),f=s-r;a+=l*l,o+=f*f}),1-a/o}function p1(t,e,n){let r=0,i=0,a=0,o=0,u=0;Pu(t,e,n,(f,c)=>{++u,r+=(f-r)/u,i+=(c-i)/u,a+=(f*c-a)/u,o+=(f*f-o)/u});const s=Bu(r,i,a,o),l=f=>s[0]+s[1]*f;return{coef:s,predict:l,rSquared:Ha(t,e,n,i,l)}}function C3(t,e,n){let r=0,i=0,a=0,o=0,u=0;Pu(t,e,n,(f,c)=>{++u,f=Math.log(f),r+=(f-r)/u,i+=(c-i)/u,a+=(f*c-a)/u,o+=(f*f-o)/u});const s=Bu(r,i,a,o),l=f=>s[0]+s[1]*Math.log(f);return{coef:s,predict:l,rSquared:Ha(t,e,n,i,l)}}function S3(t,e,n){const[r,i,a,o]=Qf(t,e,n);let u=0,s=0,l=0,f=0,c=0,h,d,g;Pu(t,e,n,(v,x)=>{h=r[c++],d=Math.log(x),g=h*x,u+=(x*d-u)/c,s+=(g-s)/c,l+=(g*d-l)/c,f+=(h*g-f)/c});const[p,m]=Bu(s/o,u/o,l/o,f/o),y=v=>Math.exp(p+m*(v-a));return{coef:[Math.exp(p-m*a),m],predict:y,rSquared:Ha(t,e,n,o,y)}}function D3(t,e,n){let r=0,i=0,a=0,o=0,u=0,s=0;Pu(t,e,n,(c,h)=>{const d=Math.log(c),g=Math.log(h);++s,r+=(d-r)/s,i+=(g-i)/s,a+=(d*g-a)/s,o+=(d*d-o)/s,u+=(h-u)/s});const l=Bu(r,i,a,o),f=c=>l[0]*Math.pow(c,l[1]);return l[0]=Math.exp(l[0]),{coef:l,predict:f,rSquared:Ha(t,e,n,u,f)}}function m1(t,e,n){const[r,i,a,o]=Qf(t,e,n),u=r.length;let s=0,l=0,f=0,c=0,h=0,d,g,p,m;for(d=0;d<u;)g=r[d],p=i[d++],m=g*g,s+=(m-s)/d,l+=(m*g-l)/d,f+=(m*m-f)/d,c+=(g*p-c)/d,h+=(m*p-h)/d;const y=f-s*s,v=s*y-l*l,x=(h*s-c*l)/v,b=(c*y-h*l)/v,_=-x*s,M=w=>(w=w-a,x*w*w+b*w+_+o);return{coef:[_-b*a+x*a*a+o,b-2*x*a,x],predict:M,rSquared:Ha(t,e,n,o,M)}}function $3(t,e,n,r){if(r===1)return p1(t,e,n);if(r===2)return m1(t,e,n);const[i,a,o,u]=Qf(t,e,n),s=i.length,l=[],f=[],c=r+1;let h,d,g,p,m;for(h=0;h<c;++h){for(g=0,p=0;g<s;++g)p+=Math.pow(i[g],h)*a[g];for(l.push(p),m=new Float64Array(c),d=0;d<c;++d){for(g=0,p=0;g<s;++g)p+=Math.pow(i[g],h+d);m[d]=p}f.push(m)}f.push(l);const y=a7(f),v=x=>{x-=o;let b=u+y[0]+y[1]*x+y[2]*x*x;for(h=3;h<c;++h)b+=y[h]*Math.pow(x,h);return b};return{coef:i7(c,y,-o,u),predict:v,rSquared:Ha(t,e,n,u,v)}}function i7(t,e,n,r){const i=Array(t);let a,o,u,s;for(a=0;a<t;++a)i[a]=0;for(a=t-1;a>=0;--a)for(u=e[a],s=1,i[a]+=u,o=1;o<=a;++o)s*=(a+1-o)/o,i[a-o]+=u*Math.pow(n,o)*s;return i[0]+=r,i}function a7(t){const e=t.length-1,n=[];let r,i,a,o,u;for(r=0;r<e;++r){for(o=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][o])&&(o=i);for(a=r;a<e+1;++a)u=t[a][r],t[a][r]=t[a][o],t[a][o]=u;for(i=r+1;i<e;++i)for(a=e;a>=r;a--)t[a][i]-=t[a][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(u=0,a=i+1;a<e;++a)u+=t[a][i]*n[a];n[i]=(t[e][i]-u)/t[i][i]}return n}const j2=2,Y2=1e-12;function F3(t,e,n,r){const[i,a,o,u]=Qf(t,e,n,!0),s=i.length,l=Math.max(2,~~(r*s)),f=new Float64Array(s),c=new Float64Array(s),h=new Float64Array(s).fill(1);for(let d=-1;++d<=j2;){const g=[0,l-1];for(let m=0;m<s;++m){const y=i[m],v=g[0],x=g[1],b=y-i[v]>i[x]-y?v:x;let _=0,M=0,w=0,A=0,S=0;const C=1/Math.abs(i[b]-y||1);for(let F=v;F<=x;++F){const L=i[F],k=a[F],T=o7(Math.abs(y-L)*C)*h[F],B=L*T;_+=T,M+=B,w+=k*T,A+=k*B,S+=L*B}const[E,$]=Bu(M/_,w/_,A/_,S/_);f[m]=E+$*y,c[m]=Math.abs(a[m]-f[m]),u7(i,m+1,g)}if(d===j2)break;const p=K$(c);if(Math.abs(p)<Y2)break;for(let m=0,y,v;m<s;++m)y=c[m]/(6*p),h[m]=y>=1?Y2:(v=1-y*y)*v}return s7(i,f,o,u)}function o7(t){return(t=1-t*t*t)*t*t}function u7(t,e,n){const r=t[e];let i=n[0],a=n[1]+1;if(!(a>=t.length))for(;e>i&&t[a]-r<=r-t[i];)n[0]=++i,n[1]=a,++a}function s7(t,e,n,r){const i=t.length,a=[];let o=0,u=0,s=[],l;for(;o<i;++o)l=t[o]+n,s[0]===l?s[1]+=(e[o]-s[1])/++u:(u=0,s[1]+=r,s=[l,e[o]],a.push(s));return s[1]+=r,a}const l7=.1*Math.PI/180;function Jf(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=d=>[d,t(d)],a=e[0],o=e[1],u=o-a,s=u/r,l=[i(a)],f=[];if(n===r){for(let d=1;d<r;++d)l.push(i(a+d/n*u));return l.push(i(o)),l}else{f.push(i(o));for(let d=n;--d>0;)f.push(i(a+d/n*u))}let c=l[0],h=f[f.length-1];for(;h;){const d=i((c[0]+h[0])/2);d[0]-c[0]>=s&&f7(c,d,h)>l7?f.push(d):(c=h,l.push(h),f.pop()),h=f[f.length-1]}return l}function f7(t,e,n){const r=Math.atan2(n[1]-t[1],n[0]-t[0]),i=Math.atan2(e[1]-t[1],e[0]-t[0]);return Math.abs(r-i)}function T3(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function c7(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=h7(t));function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=r(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:r,center:a,right:i}}function h7(t){return(e,n)=>T3(t(e),n)}function*d7(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)(r=e(r,++n,t))!=null&&(r=+r)>=r&&(yield r)}}function T0(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function R0(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function R3(t,e,n=0,r=t.length-1,i=T3){for(;r>n;){if(r-n>600){const s=r-n+1,l=e-n+1,f=Math.log(s),c=.5*Math.exp(2*f/3),h=.5*Math.sqrt(f*c*(s-c)/s)*(l-s/2<0?-1:1),d=Math.max(n,Math.floor(e-l*c/s+h)),g=Math.min(r,Math.floor(e+(s-l)*c/s+h));R3(t,e,d,g,i)}const a=t[e];let o=n,u=r;for(go(t,n,e),i(t[r],a)>0&&go(t,n,r);o<u;){for(go(t,o,u),++o,--u;i(t[o],a)<0;)++o;for(;i(t[u],a)>0;)--u}i(t[n],a)===0?go(t,n,u):(++u,go(t,u,r)),u<=e&&(n=u+1),e<=u&&(r=u-1)}return t}function go(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function g7(t,e,n){if(t=Float64Array.from(d7(t,n)),!!(r=t.length)){if((e=+e)<=0||r<2)return R0(t);if(e>=1)return T0(t);var r,i=(r-1)*e,a=Math.floor(i),o=T0(R3(t,a).subarray(0,a+1)),u=R0(t.subarray(a+1));return o+(u-o)*(i-a)}}function p7(t,e){let n=0,r=0;if(e===void 0)for(let i of t)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let a of t)(a=e(a,++i,t))!=null&&(a=+a)>=a&&(++n,r+=a)}if(n)return r/n}function m7(t,e){return g7(t,.5,e)}function N3(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(i);++r<i;)a[r]=t+r*n;return a}function y7(t){return e=>{const n=t.length;let r=1,i=String(t[0](e));for(;r<n;++r)i+="|"+t[r](e);return i}}function N0(t){return!t||!t.length?function(){return""}:t.length===1?t[0]:y7(t)}function O3(t,e,n){return n||t+(e?"_"+e:"")}const gh=()=>{},v7={init:gh,add:gh,rem:gh,idx:0},mu={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.sum,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||t.min===void 0)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||t.max===void 0)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3}},Uu=Object.keys(mu);function x7(t,e){return n=>tt({name:t,out:n||t},v7,e)}Uu.forEach(t=>{mu[t]=x7(t,mu[t])});function z3(t,e){return mu[t](e)}function L3(t,e){return t.idx-e.idx}function b7(t){const e={};t.forEach(r=>e[r.name]=r);const n=r=>{r.req&&r.req.forEach(i=>{e[i]||n(e[i]=mu[i]())})};return t.forEach(n),Object.values(e).sort(L3)}function w7(){this.valid=0,this.missing=0,this._ops.forEach(t=>t.init(this))}function _7(t,e){if(t==null||t===""){++this.missing;return}t===t&&(++this.valid,this._ops.forEach(n=>n.add(this,t,e)))}function M7(t,e){if(t==null||t===""){--this.missing;return}t===t&&(--this.valid,this._ops.forEach(n=>n.rem(this,t,e)))}function k7(t){return this._out.forEach(e=>t[e.out]=e.value(this)),t}function B3(t,e){const n=e||Ee,r=b7(t),i=t.slice().sort(L3);function a(o){this._ops=r,this._out=i,this.cell=o,this.init()}return a.prototype.init=w7,a.prototype.add=_7,a.prototype.rem=M7,a.prototype.set=k7,a.prototype.get=n,a.fields=t.map(o=>o.out),a}function y1(t){this._key=t?Le(t):H,this.reset()}const ne=y1.prototype;ne.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null};ne.add=function(t){this._add.push(t)};ne.rem=function(t){this._rem.push(t)};ne.values=function(){if(this._get=null,this._rem.length===0)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,a=Array(r-i),o={};let u,s,l;for(u=0;u<i;++u)o[n(e[u])]=1;for(u=0,s=0;u<r;++u)o[n(l=t[u])]?o[n(l)]=0:a[s++]=l;return this._rem=[],this._add=a};ne.distinct=function(t){const e=this.values(),n={};let r=e.length,i=0,a;for(;--r>=0;)a=t(e[r])+"",K(n,a)||(n[a]=1,++i);return i};ne.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=Xw(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext};ne.argmin=function(t){return this.extent(t)[0]||{}};ne.argmax=function(t){return this.extent(t)[1]||{}};ne.min=function(t){const e=this.extent(t)[0];return e!=null?t(e):void 0};ne.max=function(t){const e=this.extent(t)[1];return e!=null?t(e):void 0};ne.quartile=function(t){return(this._get!==t||!this._q)&&(this._q=n1(this.values(),t),this._get=t),this._q};ne.q1=function(t){return this.quartile(t)[0]};ne.q2=function(t){return this.quartile(t)[1]};ne.q3=function(t){return this.quartile(t)[2]};ne.ci=function(t){return(this._get!==t||!this._ci)&&(this._ci=w3(this.values(),1e3,.05,t),this._get=t),this._ci};ne.ci0=function(t){return this.ci(t)[0]};ne.ci1=function(t){return this.ci(t)[1]};function Hr(t){R.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}Hr.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Uu},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]};P(Hr,R,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):{},e.visit(e.SOURCE,a=>n.add(a))):(n.value=n.value||n.init(t),e.visit(e.REM,a=>n.rem(a)),e.visit(e.ADD,a=>n.add(a))),r.modifies(n._outputs),n._drop=t.drop!==!1,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter(()=>this.clean()),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map(()=>({})),i=n.length;function a(u){let s,l,f,c;for(s in u)for(f=u[s].tuple,l=0;l<i;++l)r[l][c=f[n[l]]]=c}a(t._prev),a(e);function o(u,s,l){const f=n[l],c=r[l++];for(const h in c){const d=u?u+"|"+h:h;s[f]=c[h],l<i?o(d,s,l):e[d]||t.cell(d,s)}}o("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(m){const y=Z(fe(m)),v=y.length;let x=0,b;for(;x<v;++x)r[b=y[x]]||(r[b]=1,e.push(b))}this._dims=Z(t.groupby),this._dnames=this._dims.map(m=>{const y=Nt(m);return i(m),n.push(y),y}),this.cellkey=t.key?t.key:N0(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const a=t.fields||[null],o=t.ops||["count"],u=t.as||[],s=a.length,l={};let f,c,h,d,g,p;for(s!==o.length&&z("Unmatched number of fields and aggregate ops."),p=0;p<s;++p){if(f=a[p],c=o[p],f==null&&c!=="count"&&z("Null aggregate field specified."),d=Nt(f),g=O3(c,d,u[p]),n.push(g),c==="count"){this._counts.push(g);continue}h=l[d],h||(i(f),h=l[d]=[],h.field=f,this._measures.push(h)),c!=="count"&&(this._countOnly=!1),h.push(z3(c,g))}return this._measures=this._measures.map(m=>B3(m,m.field)),{}},cellkey:N0(),cell(t,e){let n=this.value[t];return n?n.num===0&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const r=this._measures,i=r.length;n.agg=Array(i);for(let a=0;a<i;++a)n.agg[a]=new r[a](n)}return n.store&&(n.data=new y1),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,a={};for(let o=0;o<i;++o)a[n[o]]=r[o](t);return e?h3(e.tuple,a):gt(a)},clean(){const t=this.value;for(const e in t)t[e].num===0&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].add(r[i].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let i=0,a=r.length;i<a;++i)r[i].rem(r[i].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const r=t.agg;for(let i=0,a=r.length;i<a;++i)r[i].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,a=t.add,o=t.rem,u=t.mod;let s,l,f,c;if(r)for(l in r)s=r[l],(!i||s.num)&&o.push(s.tuple);for(f=0,c=this._alen;f<c;++f)a.push(this.celltuple(e[f])),e[f]=null;for(f=0,c=this._mlen;f<c;++f)s=n[f],(s.num===0&&i?o:u).push(this.celltuple(s)),n[f]=null;return this._alen=this._mlen=0,this._prev=null,t}});const A7=1e-14;function v1(t){R.call(this,null,t)}v1.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]};P(v1,R,{transform(t,e){const n=t.interval!==!1,r=this._bins(t),i=r.start,a=r.step,o=t.as||["bin0","bin1"],u=o[0],s=o[1];let l;return t.modified()?(e=e.reflow(!0),l=e.SOURCE):l=e.modified(fe(t.field))?e.ADD_MOD:e.ADD,e.visit(l,n?f=>{const c=r(f);f[u]=c,f[s]=c==null?null:i+a*(1+(c-i)/a)}:f=>f[u]=r(f)),e.modifies(n?o:u)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=b3(t),r=n.step;let i=n.start,a=i+Math.ceil((n.stop-i)/r)*r,o,u;(o=t.anchor)!=null&&(u=o-(i+r*Math.floor((o-i)/r)),i+=u,a+=u);const s=function(l){let f=le(e(l));return f==null?null:f<i?-1/0:f>a?1/0:(f=Math.max(i,Math.min(f,a-r)),i+r*Math.floor(A7+(f-i)/r))};return s.start=i,s.stop=n.stop,s.step=r,this.value=Ie(s,fe(e),t.name||"bin_"+Nt(e))}});function P3(t,e,n){const r=t;let i=e||[],a=n||[],o={},u=0;return{add:s=>a.push(s),remove:s=>o[r(s)]=++u,size:()=>i.length,data:(s,l)=>(u&&(i=i.filter(f=>!o[r(f)]),o={},u=0),l&&s&&i.sort(s),a.length&&(i=s?n_(s,i,a.sort(s)):i.concat(a),a=[]),i)}}function x1(t){R.call(this,[],t)}x1.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]};P(x1,R,{transform(t,e){const n=e.fork(e.ALL),r=P3(H,this.value,n.materialize(n.ADD).add),i=t.sort,a=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(a),this.value=n.source=r.data(Bi(i),a),e.source&&e.source.root&&(this.value.root=e.source.root),n}});function U3(t){kt.call(this,null,E7,t)}P(U3,kt);function E7(t){return this.value&&!t.modified()?this.value:Tg(t.fields,t.orders)}function b1(t){R.call(this,null,t)}b1.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]};function C7(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase();break}return t.match(n)}P(b1,R,{transform(t,e){const n=c=>h=>{for(var d=C7(u(h),t.case,a)||[],g,p=0,m=d.length;p<m;++p)o.test(g=d[p])||c(g)},r=this._parameterCheck(t,e),i=this._counts,a=this._match,o=this._stop,u=t.field,s=t.as||["text","count"],l=n(c=>i[c]=1+(i[c]||0)),f=n(c=>i[c]-=1);return r?e.visit(e.SOURCE,l):(e.visit(e.ADD,l),e.visit(e.REM,f)),this._finish(e,s)},_parameterCheck(t,e){let n=!1;return(t.modified("stopwords")||!this._stop)&&(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),(t.modified("pattern")||!this._match)&&(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],a=e[1],o=t.fork(t.NO_SOURCE|t.NO_FIELDS);let u,s,l;for(u in n)s=r[u],l=n[u]||0,!s&&l?(r[u]=s=gt({}),s[i]=u,s[a]=l,o.add.push(s)):l===0?(s&&o.rem.push(s),n[u]=null,r[u]=null):s[a]!==l&&(s[a]=l,o.mod.push(s));return o.modifies(e)}});function w1(t){R.call(this,null,t)}w1.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]};P(w1,R,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],a=r[1],o=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let u=this.value;return o?(u&&(n.rem=u),u=e.materialize(e.SOURCE).source,n.add=this.value=S7(u,i,a,t.filter||sn)):n.mod=u,n.source=this.value,n.modifies(r)}});function S7(t,e,n,r){for(var i=[],a={},o=t.length,u=0,s,l;u<o;++u)for(a[e]=l=t[u],s=0;s<o;++s)a[n]=t[s],r(a)&&(i.push(gt(a)),a={},a[e]=l);return i}const W2={kde:o1,mixture:A3,normal:a1,lognormal:k3,uniform:E3},D7="distributions",H2="function",$7="field";function I3(t,e){const n=t[H2];K(W2,n)||z("Unknown distribution function: "+n);const r=W2[n]();for(const i in t)i===$7?r.data((t.from||e()).map(t[i])):i===D7?r[i](t[i].map(a=>I3(a,e))):typeof r[i]===H2&&r[i](t[i]);return r}function _1(t){R.call(this,null,t)}const q3=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],F7={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:q3},{name:"weights",type:"number",array:!0}]};_1.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:q3.concat(F7)},{name:"as",type:"string",array:!0,default:["value","density"]}]};P(_1,R,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=I3(t.distribution,T7(e)),i=t.steps||t.minsteps||25,a=t.steps||t.maxsteps||200;let o=t.method||"pdf";o!=="pdf"&&o!=="cdf"&&z("Invalid density method: "+o),!t.extent&&!r.data&&z("Missing density extent parameter."),o=r[o];const u=t.as||["value","density"],s=t.extent||Vn(r.data()),l=Jf(o,s,i,a).map(f=>{const c={};return c[u[0]]=f[0],c[u[1]]=f[1],gt(c)});this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function T7(t){return()=>t.materialize(t.SOURCE).source}function j3(t,e){return t?t.map((n,r)=>e[r]||Nt(n)):null}function M1(t,e,n){const r=[],i=c=>c(s);let a,o,u,s,l,f;if(e==null)r.push(t.map(n));else for(a={},o=0,u=t.length;o<u;++o)s=t[o],l=e.map(i),f=a[l],f||(a[l]=f=[],f.dims=l,r.push(f)),f.push(n(s));return r}const Y3="bin";function k1(t){R.call(this,null,t)}k1.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:Y3}]};const R7=(t,e)=>Lu(Vn(t,e))/30;P(k1,R,{transform(t,e){if(this.value&&!(t.modified()||e.changed()))return e;const n=e.materialize(e.SOURCE).source,r=M1(e.source,t.groupby,Ee),i=t.smooth||!1,a=t.field,o=t.step||R7(n,a),u=Bi((g,p)=>a(g)-a(p)),s=t.as||Y3,l=r.length;let f=1/0,c=-1/0,h=0,d;for(;h<l;++h){const g=r[h].sort(u);d=-1;for(const p of _3(g,o,i,a))p<f&&(f=p),p>c&&(c=p),g[++d][s]=p}return this.value={start:f,stop:c,step:o},e.reflow(!0).modifies(s)}});function W3(t){kt.call(this,null,N7,t),this.modified(!0)}P(W3,kt);function N7(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:Ie(n=>e(n,t),fe(e),Nt(e))}function A1(t){R.call(this,[void 0,void 0],t)}A1.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]};P(A1,R,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let a=n[0],o=n[1];if((i||a==null)&&(a=1/0,o=-1/0),e.visit(i?e.SOURCE:e.ADD,u=>{const s=le(r(u));s!=null&&(s<a&&(a=s),s>o&&(o=s))}),!Number.isFinite(a)||!Number.isFinite(o)){let u=Nt(r);u&&(u=` for field "${u}"`),e.dataflow.warn(`Infinite extent${u}: [${a}, ${o}]`),a=o=void 0}this.value=[a,o]}});function E1(t,e){kt.call(this,t),this.parent=e,this.count=0}P(E1,kt,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}});function tc(t){R.call(this,{},t),this._keys=ja();const e=this._targets=[];e.active=0,e.forEach=n=>{for(let r=0,i=e.active;r<i;++r)n(e[r],r,e)}}P(tc,R,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let a=K(i,t)&&i[t],o,u;return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(u=r||(u=this._group[t])&&u.tuple,o=n.dataflow,a=new E1(n.fork(n.NO_SOURCE),this),o.add(a).connect(e(o,t,u)),i[t]=a,this.activate(a)),a},clean(){const t=this.value;let e=0;for(const n in t)if(t[n].count===0){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const n=this._targets.filter(r=>r&&r.count>0);this.initTargets(n)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&e[i]!=null;++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,a=this._keys,o=t.modified("key"),u=s=>this.subflow(s,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,s=>{const l=H(s),f=a.get(l);f!==void 0&&(a.delete(l),u(f).rem(s))}),e.visit(e.ADD,s=>{const l=r(s);a.set(H(s),l),u(l).add(s)}),o||e.modified(r.fields)?e.visit(e.MOD,s=>{const l=H(s),f=a.get(l),c=r(s);f===c?u(c).mod(s):(a.set(l,c),u(f).rem(s),u(c).add(s))}):e.changed(e.MOD)&&e.visit(e.MOD,s=>{u(a.get(H(s))).mod(s)}),o&&e.visit(e.REFLOW,s=>{const l=H(s),f=a.get(l),c=r(s);f!==c&&(a.set(l,c),u(f).rem(s),u(c).add(s))}),e.clean()?n.runAfter(()=>{this.clean(),a.clean()}):a.empty>n.cleanThreshold&&n.runAfter(a.clean),e}});function H3(t){kt.call(this,null,O7,t)}P(H3,kt);function O7(t){return this.value&&!t.modified()?this.value:G(t.name)?Z(t.name).map(e=>Le(e)):Le(t.name,t.as)}function C1(t){R.call(this,ja(),t)}C1.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]};P(C1,R,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),a=i.add,o=i.rem,u=i.mod,s=t.expr;let l=!0;e.visit(e.REM,c=>{const h=H(c);r.has(h)?r.delete(h):o.push(c)}),e.visit(e.ADD,c=>{s(c,t)?a.push(c):r.set(H(c),1)});function f(c){const h=H(c),d=s(c,t),g=r.get(h);d&&g?(r.delete(h),a.push(c)):!d&&!g?(r.set(h,1),o.push(c)):l&&d&&!g&&u.push(c)}return e.visit(e.MOD,f),t.modified()&&(l=!1,e.visit(e.REFLOW,f)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}});function S1(t){R.call(this,[],t)}S1.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]};P(S1,R,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=j3(r,t.as||[]),a=t.index||null,o=i.length;return n.rem=this.value,e.visit(e.SOURCE,u=>{const s=r.map(g=>g(u)),l=s.reduce((g,p)=>Math.max(g,p.length),0);let f=0,c,h,d;for(;f<l;++f){for(h=Kg(u),c=0;c<o;++c)h[i[c]]=(d=s[c][f])==null?null:d;a&&(h[a]=f),n.add.push(h)}}),this.value=n.source=n.add,a&&n.modifies(a),n.modifies(i)}});function D1(t){R.call(this,[],t)}D1.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]};P(D1,R,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(Nt),a=t.as||["key","value"],o=a[0],u=a[1],s=r.length;return n.rem=this.value,e.visit(e.SOURCE,l=>{for(let f=0,c;f<s;++f)c=Kg(l),c[o]=i[f],c[u]=r[f](l),n.add.push(c)}),this.value=n.source=n.add,n.modifies(a)}});function $1(t){R.call(this,null,t)}$1.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]};P($1,R,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),a=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(a,o=>o[r]=n(o,t))}});function G3(t){R.call(this,[],t)}P(G3,R,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i=this.value,a=t.size-i.length,o,u,s;if(a>0){for(o=[];--a>=0;)o.push(s=gt(r(t))),i.push(s);n.add=n.add.length?n.materialize(n.ADD).add.concat(o):o}else u=i.slice(0,-a),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(u):u,i=i.slice(-a);return n.source=this.value=i,n}});const Ms={value:"value",median:m7,mean:p7,min:R0,max:T0},z7=[];function F1(t){R.call(this,[],t)}F1.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]};function L7(t){var e=t.method||Ms.value,n;if(Ms[e]==null)z("Unrecognized imputation method: "+e);else return e===Ms.value?(n=t.value!==void 0?t.value:0,()=>n):Ms[e]}function B7(t){const e=t.field;return n=>n?e(n):NaN}P(F1,R,{transform(t,e){var n=e.fork(e.ALL),r=L7(t),i=B7(t),a=Nt(t.field),o=Nt(t.key),u=(t.groupby||[]).map(Nt),s=P7(e.source,t.groupby,t.key,t.keyvals),l=[],f=this.value,c=s.domain.length,h,d,g,p,m,y,v,x,b,_;for(m=0,x=s.length;m<x;++m)for(h=s[m],g=h.values,d=NaN,v=0;v<c;++v)if(h[v]==null){for(p=s.domain[v],_={_impute:!0},y=0,b=g.length;y<b;++y)_[u[y]]=g[y];_[o]=p,_[a]=Number.isNaN(d)?d=r(h,i):d,l.push(gt(_))}return l.length&&(n.add=n.materialize(n.ADD).add.concat(l)),f.length&&(n.rem=n.materialize(n.REM).rem.concat(f)),this.value=l,n}});function P7(t,e,n,r){var i=y=>y(m),a=[],o=r?r.slice():[],u={},s={},l,f,c,h,d,g,p,m;for(o.forEach((y,v)=>u[y]=v+1),h=0,p=t.length;h<p;++h)m=t[h],g=n(m),d=u[g]||(u[g]=o.push(g)),f=(l=e?e.map(i):z7)+"",(c=s[f])||(c=s[f]=[],a.push(c),c.values=l),c[d-1]=m;return a.domain=o,a}function T1(t){Hr.call(this,t)}T1.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Uu},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]};P(T1,Hr,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,a=>n.add(a))):(i=n.value=n.value||this.init(t),e.visit(e.REM,a=>n.rem(a)),e.visit(e.ADD,a=>n.add(a))),n.changes(),e.visit(e.SOURCE,a=>{tt(a,i[n.cellkey(a)].tuple)}),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}});function R1(t){R.call(this,null,t)}R1.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]};P(R1,R,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=M1(r,t.groupby,t.field),a=(t.groupby||[]).map(Nt),o=t.bandwidth,u=t.cumulative?"cdf":"pdf",s=t.as||["value","density"],l=[];let f=t.extent,c=t.steps||t.minsteps||25,h=t.steps||t.maxsteps||200;u!=="pdf"&&u!=="cdf"&&z("Invalid density method: "+u),t.resolve==="shared"&&(f||(f=Vn(r,t.field)),c=h=t.steps||h),i.forEach(d=>{const g=o1(d,o)[u],p=t.counts?d.length:1,m=f||Vn(d);Jf(g,m,c,h).forEach(y=>{const v={};for(let x=0;x<a.length;++x)v[a[x]]=d.dims[x];v[s[0]]=y[0],v[s[1]]=y[1]*p,l.push(gt(v))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}});function V3(t){kt.call(this,null,U7,t)}P(V3,kt);function U7(t){return this.value&&!t.modified()?this.value:Ng(t.fields,t.flat)}function X3(t){R.call(this,[],t),this._pending=null}P(X3,R,{transform(t,e){const n=e.dataflow;return this._pending?ph(this,e,this._pending):I7(t)?e.StopPropagation:t.values?ph(this,e,n.parse(t.values,t.format)):t.async?{async:n.request(t.url,t.format).then(i=>(this._pending=Z(i.data),a=>a.touch(this)))}:n.request(t.url,t.format).then(r=>ph(this,e,Z(r.data)))}});function I7(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}function ph(t,e,n){n.forEach(gt);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function N1(t){R.call(this,{},t)}N1.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]};P(N1,R,{transform(t,e){const n=t.fields,r=t.index,i=t.values,a=t.default==null?null:t.default,o=t.modified(),u=n.length;let s=o?e.SOURCE:e.ADD,l=e,f=t.as,c,h,d;return i?(h=i.length,u>1&&!f&&z('Multi-field lookup requires explicit "as" parameter.'),f&&f.length!==u*h&&z('The "as" parameter has too few output field names.'),f=f||i.map(Nt),c=function(g){for(var p=0,m=0,y,v;p<u;++p)if(v=r.get(n[p](g)),v==null)for(y=0;y<h;++y,++m)g[f[m]]=a;else for(y=0;y<h;++y,++m)g[f[m]]=i[y](v)}):(f||z("Missing output field names."),c=function(g){for(var p=0,m;p<u;++p)m=r.get(n[p](g)),g[f[p]]=m==null?a:m}),o?l=e.reflow(!0):(d=n.some(g=>e.modified(g.fields)),s|=d?e.MOD:0),e.visit(s,c),l.modifies(f)}});function Z3(t){kt.call(this,null,q7,t)}P(Z3,kt);function q7(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r=1/0,i=-1/0,a,o;for(a=0;a<n;++a)o=e[a],o[0]<r&&(r=o[0]),o[1]>i&&(i=o[1]);return[r,i]}function K3(t){kt.call(this,null,j7,t)}P(K3,kt);function j7(t){return this.value&&!t.modified()?this.value:t.values.reduce((e,n)=>e.concat(n),[])}function Q3(t){R.call(this,null,t)}P(Q3,R,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function O1(t){Hr.call(this,t)}O1.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Uu,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]};P(O1,Hr,{_transform:Hr.prototype.transform,transform(t,e){return this._transform(Y7(t,e),e)}});function Y7(t,e){const n=t.field,r=t.value,i=(t.op==="count"?"__count__":t.op)||"sum",a=fe(n).concat(fe(r)),o=H7(n,t.limit||0,e);return e.changed()&&t.set("__pivot__",null,null,!0),{key:t.key,groupby:t.groupby,ops:o.map(()=>i),fields:o.map(u=>W7(u,n,r,a)),as:o.map(u=>u+""),modified:t.modified.bind(t)}}function W7(t,e,n,r){return Ie(i=>e(i)===t?n(i):NaN,r,t+"")}function H7(t,e,n){const r={},i=[];return n.visit(n.SOURCE,a=>{const o=t(a);r[o]||(r[o]=1,i.push(o))}),i.sort(If),e?i.slice(0,e):i}function J3(t){tc.call(this,t)}P(J3,tc,{transform(t,e){const n=t.subflow,r=t.field,i=a=>this.subflow(H(a),n,e,a);return(t.modified("field")||r&&e.modified(fe(r)))&&z("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,a=>{const o=i(a);r(a).forEach(u=>o.mod(u))}),e.visit(e.ADD,a=>{const o=i(a);r(a).forEach(u=>o.add(gt(u)))}),e.visit(e.REM,a=>{const o=i(a);r(a).forEach(u=>o.rem(u))})):(e.visit(e.MOD,a=>i(a).mod(a)),e.visit(e.ADD,a=>i(a).add(a)),e.visit(e.REM,a=>i(a).rem(a))),e.clean()&&e.runAfter(()=>this.clean()),e}});function z1(t){R.call(this,null,t)}z1.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]};P(z1,R,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=j3(t.fields,t.as||[]),a=r?(u,s)=>G7(u,s,r,i):Hf;let o;return this.value?o=this.value:(e=e.addAll(),o=this.value={}),e.visit(e.REM,u=>{const s=H(u);n.rem.push(o[s]),o[s]=null}),e.visit(e.ADD,u=>{const s=a(u,gt({}));o[H(u)]=s,n.add.push(s)}),e.visit(e.MOD,u=>{n.mod.push(a(u,o[H(u)]))}),n}});function G7(t,e,n,r){for(let i=0,a=n.length;i<a;++i)e[r[i]]=n[i](t);return e}function tM(t){R.call(this,null,t)}P(tM,R,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});function L1(t){R.call(this,null,t)}L1.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};const V7=1e-14;P(L1,R,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=e.materialize(e.SOURCE).source,a=M1(i,t.groupby,t.field),o=(t.groupby||[]).map(Nt),u=[],s=t.step||.01,l=t.probs||N3(s/2,1-V7,s),f=l.length;return a.forEach(c=>{const h=e1(c,l);for(let d=0;d<f;++d){const g={};for(let p=0;p<o.length;++p)g[o[p]]=c.dims[p];g[r[0]]=l[d],g[r[1]]=h[d],u.push(gt(g))}}),this.value&&(n.rem=this.value),this.value=n.add=n.source=u,n}});function eM(t){R.call(this,null,t)}P(eM,R,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,i=>{const a=H(i);n.rem.push(r[a]),r[a]=null}),e.visit(e.ADD,i=>{const a=Kg(i);r[H(i)]=a,n.add.push(a)}),e.visit(e.MOD,i=>{const a=r[H(i)];for(const o in i)a[o]=i[o],n.modifies(o);n.mod.push(a)})),n}});function B1(t){R.call(this,[],t),this.count=0}B1.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]};P(B1,R,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,a=this.value.reduce((f,c)=>(f[H(c)]=1,f),{});let o=this.value,u=this.count,s=0;function l(f){let c,h;o.length<i?o.push(f):(h=~~((u+1)*fn()),h<o.length&&h>=s&&(c=o[h],a[H(c)]&&n.rem.push(c),o[h]=f)),++u}if(e.rem.length&&(e.visit(e.REM,f=>{const c=H(f);a[c]&&(a[c]=-1,n.rem.push(f)),--u}),o=o.filter(f=>a[H(f)]!==-1)),(e.rem.length||r)&&o.length<i&&e.source&&(s=u=o.length,e.visit(e.SOURCE,f=>{a[H(f)]||l(f)}),s=-1),r&&o.length>i){const f=o.length-i;for(let c=0;c<f;++c)a[H(o[c])]=-1,n.rem.push(o[c]);o=o.slice(f)}return e.mod.length&&e.visit(e.MOD,f=>{a[H(f)]&&n.mod.push(f)}),e.add.length&&e.visit(e.ADD,l),(e.add.length||s<0)&&(n.add=o.filter(f=>!a[H(f)])),this.count=u,this.value=n.source=o,n}});function P1(t){R.call(this,null,t)}P1.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]};P(P1,R,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=N3(t.start,t.stop,t.step||1).map(i=>{const a={};return a[r]=i,gt(a)}),n.add=e.add.concat(this.value),n}});function nM(t){R.call(this,null,t),this.modified(!0)}P(nM,R,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});function U1(t){R.call(this,null,t)}const rM=["unit0","unit1"];U1.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:Gg,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:rM}]};P(U1,R,{transform(t,e){const n=t.field,r=t.interval!==!1,i=t.timezone==="utc",a=this._floor(t,e),o=(i?Wa:Ya)(a.unit).offset,u=t.as||rM,s=u[0],l=u[1],f=a.step;let c=a.start||1/0,h=a.stop||-1/0,d=e.ADD;return(t.modified()||e.modified(fe(n)))&&(e=e.reflow(!0),d=e.SOURCE,c=1/0,h=-1/0),e.visit(d,g=>{const p=n(g);let m,y;p==null?(g[s]=null,r&&(g[l]=null)):(g[s]=m=y=a(p),r&&(g[l]=y=o(m,f)),m<c&&(c=m),y>h&&(h=y))}),a.start=c,a.stop=h,e.modifies(r?u:s)},_floor(t,e){const n=t.timezone==="utc",{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:H_({extent:t.extent||Vn(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),a=Vg(r),o=this.value||{},u=(n?L_:z_)(a,i);return u.unit=ot(a),u.units=a,u.step=i,u.start=o.start,u.stop=o.stop,this.value=u}});function iM(t){R.call(this,ja(),t)}P(iM,R,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,a=u=>i.set(r(u),u);let o=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,a)):e.changed()?(e.visit(e.REM,u=>i.delete(r(u))),e.visit(e.ADD,a)):o=!1,this.modified(o),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}});function aM(t){R.call(this,null,t)}P(aM,R,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(Bi(t.sort)):e.source).map(t.field))}});function X7(t,e,n,r){const i=yu[t](e,n);return{init:i.init||$r,update:function(a,o){o[r]=i.next(a)}}}const yu={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=yu.rank(),e=t.next;return{init:t.init,next:n=>(e(n)-1)/(n.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){e=+e,e>0||z("ntile num must be greater than zero.");const n=yu.cume_dist(),r=n.next;return{init:n.init,next:i=>Math.ceil(e*r(i))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return e=+e,e>0||z("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return r!=null?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=Z7(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}};function Z7(t,e,n){for(let r=e.length;n<r;++n)if(t(e[n])!=null)return n;return-1}const K7=Object.keys(yu);function oM(t){const e=Z(t.ops),n=Z(t.fields),r=Z(t.params),i=Z(t.as),a=this.outputs=[],o=this.windows=[],u={},s={},l=[],f=[];let c=!0;function h(d){Z(fe(d)).forEach(g=>u[g]=1)}h(t.sort),e.forEach((d,g)=>{const p=n[g],m=Nt(p),y=O3(d,m,i[g]);if(h(p),a.push(y),K(yu,d))o.push(X7(d,n[g],r[g],y));else{if(p==null&&d!=="count"&&z("Null aggregate field specified."),d==="count"){l.push(y);return}c=!1;let v=s[m];v||(v=s[m]=[],v.field=p,f.push(v)),v.push(z3(d,y))}}),(l.length||f.length)&&(this.cell=Q7(f,l,c)),this.inputs=Object.keys(u)}const uM=oM.prototype;uM.init=function(){this.windows.forEach(t=>t.init()),this.cell&&this.cell.init()};uM.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,a=r&&r.length;let o;if(n){for(o=t.p0;o<t.i0;++o)n.rem(i[o]);for(o=t.p1;o<t.i1;++o)n.add(i[o]);n.set(e)}for(o=0;o<a;++o)r[o].update(t,e)};function Q7(t,e,n){t=t.map(s=>B3(s,s.field));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,a=r.agg=Array(i),o=0;o<i;++o)a[o]=new t[o](r);if(r.store)var u=r.data=new y1;return r.add=function(s){if(r.num+=1,!n){u&&u.add(s);for(let l=0;l<i;++l)a[l].add(a[l].get(s),s)}},r.rem=function(s){if(r.num-=1,!n){u&&u.rem(s);for(let l=0;l<i;++l)a[l].rem(a[l].get(s),s)}},r.set=function(s){let l,f;for(u&&u.values(),l=0,f=e.length;l<f;++l)s[e[l]]=r.num;if(!n)for(l=0,f=a.length;l<f;++l)a[l].set(s)},r.init=function(){r.num=0,u&&u.reset();for(let s=0;s<i;++s)a[s].init()},r}function I1(t){R.call(this,{},t),this._mlen=0,this._mods=[]}I1.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:K7.concat(Uu)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]};P(I1,R,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=Bi(t.sort),i=N0(t.groupby),a=u=>this.group(i(u));let o=this.state;(!o||n)&&(o=this.state=new oM(t)),n||e.modified(o.inputs)?(this.value={},e.visit(e.SOURCE,u=>a(u).add(u))):(e.visit(e.REM,u=>a(u).remove(u)),e.visit(e.ADD,u=>a(u).add(u)));for(let u=0,s=this._mlen;u<s;++u)J7(this._mods[u],o,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(o.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=P3(H),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}});function J7(t,e,n,r){const i=r.sort,a=i&&!r.ignorePeers,o=r.frame||[null,0],u=t.data(n),s=u.length,l=a?c7(i):null,f={i0:0,i1:0,p0:0,p1:0,index:0,data:u,compare:i||ge(-1)};e.init();for(let c=0;c<s;++c)t9(f,o,c,s),a&&e9(f,l),e.update(f,u[c])}function t9(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=e[0]==null?0:Math.max(0,n-Math.abs(e[0])),t.i1=e[1]==null?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function e9(t,e){const n=t.i0,r=t.i1-1,i=t.compare,a=t.data,o=a.length-1;n>0&&!i(a[n],a[n-1])&&(t.i0=e.left(a,a[n])),r<o&&!i(a[r],a[r+1])&&(t.i1=e.right(a,a[r]))}const n9=Object.freeze(Object.defineProperty({__proto__:null,aggregate:Hr,bin:v1,collect:x1,compare:U3,countpattern:b1,cross:w1,density:_1,dotbin:k1,expression:W3,extent:A1,facet:tc,field:H3,filter:C1,flatten:S1,fold:D1,formula:$1,generate:G3,impute:F1,joinaggregate:T1,kde:R1,key:V3,load:X3,lookup:N1,multiextent:Z3,multivalues:K3,params:Q3,pivot:O1,prefacet:J3,project:z1,proxy:tM,quantile:L1,relay:eM,sample:B1,sequence:P1,sieve:nM,subflow:E1,timeunit:U1,tupleindex:iM,values:aM,window:I1},Symbol.toStringTag,{value:"Module"})),O0=Math.PI,z0=2*O0,li=1e-6,r9=z0-li;function L0(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ui(){return new L0}L0.prototype=Ui.prototype={constructor:L0,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,u=n-t,s=r-e,l=a-t,f=o-e,c=l*l+f*f;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>li)if(!(Math.abs(f*u-s*l)>li)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var h=n-a,d=r-o,g=u*u+s*s,p=h*h+d*d,m=Math.sqrt(g),y=Math.sqrt(c),v=i*Math.tan((O0-Math.acos((g+c-p)/(2*m*y)))/2),x=v/y,b=v/m;Math.abs(x-1)>li&&(this._+="L"+(t+x*l)+","+(e+x*f)),this._+="A"+i+","+i+",0,0,"+ +(f*h>l*d)+","+(this._x1=t+b*u)+","+(this._y1=e+b*s)}},arc:function(t,e,n,r,i,a){t=+t,e=+e,n=+n,a=!!a;var o=n*Math.cos(r),u=n*Math.sin(r),s=t+o,l=e+u,f=1^a,c=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+s+","+l:(Math.abs(this._x1-s)>li||Math.abs(this._y1-l)>li)&&(this._+="L"+s+","+l),n&&(c<0&&(c=c%z0+z0),c>r9?this._+="A"+n+","+n+",0,1,"+f+","+(t-o)+","+(e-u)+"A"+n+","+n+",0,1,"+f+","+(this._x1=s)+","+(this._y1=l):c>li&&(this._+="A"+n+","+n+",0,"+ +(c>=O0)+","+f+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function pt(t){return function(){return t}}var G2=Math.abs,re=Math.atan2,oi=Math.cos,i9=Math.max,mh=Math.min,Tn=Math.sin,la=Math.sqrt,ie=1e-12,Sa=Math.PI,$l=Sa/2,sM=2*Sa;function a9(t){return t>1?0:t<-1?Sa:Math.acos(t)}function V2(t){return t>=1?$l:t<=-1?-$l:Math.asin(t)}function o9(t){return t.innerRadius}function u9(t){return t.outerRadius}function s9(t){return t.startAngle}function l9(t){return t.endAngle}function f9(t){return t&&t.padAngle}function c9(t,e,n,r,i,a,o,u){var s=n-t,l=r-e,f=o-i,c=u-a,h=c*s-f*l;if(!(h*h<ie))return h=(f*(e-a)-c*(t-i))/h,[t+h*s,e+h*l]}function ks(t,e,n,r,i,a,o){var u=t-n,s=e-r,l=(o?a:-a)/la(u*u+s*s),f=l*s,c=-l*u,h=t+f,d=e+c,g=n+f,p=r+c,m=(h+g)/2,y=(d+p)/2,v=g-h,x=p-d,b=v*v+x*x,_=i-a,M=h*p-g*d,w=(x<0?-1:1)*la(i9(0,_*_*b-M*M)),A=(M*x-v*w)/b,S=(-M*v-x*w)/b,C=(M*x+v*w)/b,E=(-M*v+x*w)/b,$=A-m,F=S-y,L=C-m,k=E-y;return $*$+F*F>L*L+k*k&&(A=C,S=E),{cx:A,cy:S,x01:-f,y01:-c,x11:A*(i/_-1),y11:S*(i/_-1)}}function h9(){var t=o9,e=u9,n=pt(0),r=null,i=s9,a=l9,o=f9,u=null;function s(){var l,f,c=+t.apply(this,arguments),h=+e.apply(this,arguments),d=i.apply(this,arguments)-$l,g=a.apply(this,arguments)-$l,p=G2(g-d),m=g>d;if(u||(u=l=Ui()),h<c&&(f=h,h=c,c=f),!(h>ie))u.moveTo(0,0);else if(p>sM-ie)u.moveTo(h*oi(d),h*Tn(d)),u.arc(0,0,h,d,g,!m),c>ie&&(u.moveTo(c*oi(g),c*Tn(g)),u.arc(0,0,c,g,d,m));else{var y=d,v=g,x=d,b=g,_=p,M=p,w=o.apply(this,arguments)/2,A=w>ie&&(r?+r.apply(this,arguments):la(c*c+h*h)),S=mh(G2(h-c)/2,+n.apply(this,arguments)),C=S,E=S,$,F;if(A>ie){var L=V2(A/c*Tn(w)),k=V2(A/h*Tn(w));(_-=L*2)>ie?(L*=m?1:-1,x+=L,b-=L):(_=0,x=b=(d+g)/2),(M-=k*2)>ie?(k*=m?1:-1,y+=k,v-=k):(M=0,y=v=(d+g)/2)}var T=h*oi(y),B=h*Tn(y),U=c*oi(b),q=c*Tn(b);if(S>ie){var it=h*oi(v),lt=h*Tn(v),At=c*oi(x),bt=c*Tn(x),Dt;if(p<Sa&&(Dt=c9(T,B,At,bt,it,lt,U,q))){var Ot=T-Dt[0],ri=B-Dt[1],ii=it-Dt[0],ai=lt-Dt[1],N=1/Tn(a9((Ot*ii+ri*ai)/(la(Ot*Ot+ri*ri)*la(ii*ii+ai*ai)))/2),I=la(Dt[0]*Dt[0]+Dt[1]*Dt[1]);C=mh(S,(c-I)/(N-1)),E=mh(S,(h-I)/(N+1))}}M>ie?E>ie?($=ks(At,bt,T,B,h,E,m),F=ks(it,lt,U,q,h,E,m),u.moveTo($.cx+$.x01,$.cy+$.y01),E<S?u.arc($.cx,$.cy,E,re($.y01,$.x01),re(F.y01,F.x01),!m):(u.arc($.cx,$.cy,E,re($.y01,$.x01),re($.y11,$.x11),!m),u.arc(0,0,h,re($.cy+$.y11,$.cx+$.x11),re(F.cy+F.y11,F.cx+F.x11),!m),u.arc(F.cx,F.cy,E,re(F.y11,F.x11),re(F.y01,F.x01),!m))):(u.moveTo(T,B),u.arc(0,0,h,y,v,!m)):u.moveTo(T,B),!(c>ie)||!(_>ie)?u.lineTo(U,q):C>ie?($=ks(U,q,it,lt,c,-C,m),F=ks(T,B,At,bt,c,-C,m),u.lineTo($.cx+$.x01,$.cy+$.y01),C<S?u.arc($.cx,$.cy,C,re($.y01,$.x01),re(F.y01,F.x01),!m):(u.arc($.cx,$.cy,C,re($.y01,$.x01),re($.y11,$.x11),!m),u.arc(0,0,c,re($.cy+$.y11,$.cx+$.x11),re(F.cy+F.y11,F.cx+F.x11),m),u.arc(F.cx,F.cy,C,re(F.y11,F.x11),re(F.y01,F.x01),!m))):u.arc(0,0,c,b,x,m)}if(u.closePath(),l)return u=null,l+""||null}return s.centroid=function(){var l=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,f=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Sa/2;return[oi(f)*l,Tn(f)*l]},s.innerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:pt(+l),s):t},s.outerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:pt(+l),s):e},s.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:pt(+l),s):n},s.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:pt(+l),s):r},s.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:pt(+l),s):i},s.endAngle=function(l){return arguments.length?(a=typeof l=="function"?l:pt(+l),s):a},s.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:pt(+l),s):o},s.context=function(l){return arguments.length?(u=l==null?null:l,s):u},s}function lM(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function fM(t){this._context=t}fM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function q1(t){return new fM(t)}function cM(t){return t[0]}function hM(t){return t[1]}function dM(t,e){var n=pt(!0),r=null,i=q1,a=null;t=typeof t=="function"?t:t===void 0?cM:pt(t),e=typeof e=="function"?e:e===void 0?hM:pt(e);function o(u){var s,l=(u=lM(u)).length,f,c=!1,h;for(r==null&&(a=i(h=Ui())),s=0;s<=l;++s)!(s<l&&n(f=u[s],s,u))===c&&((c=!c)?a.lineStart():a.lineEnd()),c&&a.point(+t(f,s,u),+e(f,s,u));if(h)return a=null,h+""||null}return o.x=function(u){return arguments.length?(t=typeof u=="function"?u:pt(+u),o):t},o.y=function(u){return arguments.length?(e=typeof u=="function"?u:pt(+u),o):e},o.defined=function(u){return arguments.length?(n=typeof u=="function"?u:pt(!!u),o):n},o.curve=function(u){return arguments.length?(i=u,r!=null&&(a=i(r)),o):i},o.context=function(u){return arguments.length?(u==null?r=a=null:a=i(r=u),o):r},o}function gM(t,e,n){var r=null,i=pt(!0),a=null,o=q1,u=null;t=typeof t=="function"?t:t===void 0?cM:pt(+t),e=typeof e=="function"?e:pt(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?hM:pt(+n);function s(f){var c,h,d,g=(f=lM(f)).length,p,m=!1,y,v=new Array(g),x=new Array(g);for(a==null&&(u=o(y=Ui())),c=0;c<=g;++c){if(!(c<g&&i(p=f[c],c,f))===m)if(m=!m)h=c,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),d=c-1;d>=h;--d)u.point(v[d],x[d]);u.lineEnd(),u.areaEnd()}m&&(v[c]=+t(p,c,f),x[c]=+e(p,c,f),u.point(r?+r(p,c,f):v[c],n?+n(p,c,f):x[c]))}if(y)return u=null,y+""||null}function l(){return dM().defined(i).curve(o).context(a)}return s.x=function(f){return arguments.length?(t=typeof f=="function"?f:pt(+f),r=null,s):t},s.x0=function(f){return arguments.length?(t=typeof f=="function"?f:pt(+f),s):t},s.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:pt(+f),s):r},s.y=function(f){return arguments.length?(e=typeof f=="function"?f:pt(+f),n=null,s):e},s.y0=function(f){return arguments.length?(e=typeof f=="function"?f:pt(+f),s):e},s.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:pt(+f),s):n},s.lineX0=s.lineY0=function(){return l().x(t).y(e)},s.lineY1=function(){return l().x(t).y(n)},s.lineX1=function(){return l().x(r).y(e)},s.defined=function(f){return arguments.length?(i=typeof f=="function"?f:pt(!!f),s):i},s.curve=function(f){return arguments.length?(o=f,a!=null&&(u=o(a)),s):o},s.context=function(f){return arguments.length?(f==null?a=u=null:u=o(a=f),s):a},s}const d9={draw:function(t,e){var n=Math.sqrt(e/Sa);t.moveTo(n,0),t.arc(0,0,n,0,sM)}};function g9(t,e){var n=null;t=typeof t=="function"?t:pt(t||d9),e=typeof e=="function"?e:pt(e===void 0?64:+e);function r(){var i;if(n||(n=i=Ui()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return r.type=function(i){return arguments.length?(t=typeof i=="function"?i:pt(i),r):t},r.size=function(i){return arguments.length?(e=typeof i=="function"?i:pt(+i),r):e},r.context=function(i){return arguments.length?(n=i==null?null:i,r):n},r}function Gr(){}function Fl(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function ec(t){this._context=t}ec.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Fl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Fl(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function p9(t){return new ec(t)}function pM(t){this._context=t}pM.prototype={areaStart:Gr,areaEnd:Gr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Fl(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function m9(t){return new pM(t)}function mM(t){this._context=t}mM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Fl(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function y9(t){return new mM(t)}function yM(t,e){this._basis=new ec(t),this._beta=e}yM.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r=t[0],i=e[0],a=t[n]-r,o=e[n]-i,u=-1,s;++u<=n;)s=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(r+s*a),this._beta*e[u]+(1-this._beta)*(i+s*o));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const v9=function t(e){function n(r){return e===1?new ec(r):new yM(r,e)}return n.beta=function(r){return t(+r)},n}(.85);function Tl(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function j1(t,e){this._context=t,this._k=(1-e)/6}j1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Tl(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Tl(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const x9=function t(e){function n(r){return new j1(r,e)}return n.tension=function(r){return t(+r)},n}(0);function Y1(t,e){this._context=t,this._k=(1-e)/6}Y1.prototype={areaStart:Gr,areaEnd:Gr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Tl(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const b9=function t(e){function n(r){return new Y1(r,e)}return n.tension=function(r){return t(+r)},n}(0);function W1(t,e){this._context=t,this._k=(1-e)/6}W1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Tl(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const w9=function t(e){function n(r){return new W1(r,e)}return n.tension=function(r){return t(+r)},n}(0);function H1(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>ie){var u=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,s=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*u-t._x0*t._l12_2a+t._x2*t._l01_2a)/s,i=(i*u-t._y0*t._l12_2a+t._y2*t._l01_2a)/s}if(t._l23_a>ie){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,f=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/f,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/f}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function vM(t,e){this._context=t,this._alpha=e}vM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:H1(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const _9=function t(e){function n(r){return e?new vM(r,e):new j1(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function xM(t,e){this._context=t,this._alpha=e}xM.prototype={areaStart:Gr,areaEnd:Gr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:H1(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const M9=function t(e){function n(r){return e?new xM(r,e):new Y1(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function bM(t,e){this._context=t,this._alpha=e}bM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:H1(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const k9=function t(e){function n(r){return e?new bM(r,e):new W1(r,0)}return n.alpha=function(r){return t(+r)},n}(.5);function wM(t){this._context=t}wM.prototype={areaStart:Gr,areaEnd:Gr,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function A9(t){return new wM(t)}function X2(t){return t<0?-1:1}function Z2(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),u=(a*i+o*r)/(r+i);return(X2(a)+X2(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(u))||0}function K2(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function yh(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,u=(a-r)/3;t._context.bezierCurveTo(r+u,i+u*e,a-u,o-u*n,a,o)}function Rl(t){this._context=t}Rl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:yh(this,this._t0,K2(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,yh(this,K2(this,n=Z2(this,t,e)),n);break;default:yh(this,this._t0,n=Z2(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function _M(t){this._context=new MM(t)}(_M.prototype=Object.create(Rl.prototype)).point=function(t,e){Rl.prototype.point.call(this,e,t)};function MM(t){this._context=t}MM.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}};function E9(t){return new Rl(t)}function C9(t){return new _M(t)}function kM(t){this._context=t}kM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=Q2(t),i=Q2(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function Q2(t){var e,n=t.length-1,r,i=new Array(n),a=new Array(n),o=new Array(n);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<n-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[n-1]=2,a[n-1]=7,o[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=i[e]/a[e-1],a[e]-=r,o[e]-=r*o[e-1];for(i[n-1]=o[n-1]/a[n-1],e=n-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[n-1]=(t[n]+i[n-1])/2,e=0;e<n-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}function S9(t){return new kM(t)}function nc(t,e){this._context=t,this._t=e}nc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function D9(t){return new nc(t,.5)}function $9(t){return new nc(t,0)}function F9(t){return new nc(t,1)}function Ga(t,e){if(typeof document<"u"&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}const T9=()=>typeof Image<"u"?Image:null;function G1(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function V1(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=R9(t));function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=r(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:r,center:a,right:i}}function R9(t){return(e,n)=>G1(t(e),n)}function AM(t){return t===null?NaN:+t}const N9=V1(G1),B0=N9.right;V1(AM).center;const Iu=B0;var P0=Math.sqrt(50),U0=Math.sqrt(10),I0=Math.sqrt(2);function q0(t,e,n){var r,i=-1,a,o,u;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(a=t,t=e,e=a),(u=EM(t,e,n))===0||!isFinite(u))return[];if(u>0){let s=Math.round(t/u),l=Math.round(e/u);for(s*u<t&&++s,l*u>e&&--l,o=new Array(a=l-s+1);++i<a;)o[i]=(s+i)*u}else{u=-u;let s=Math.round(t*u),l=Math.round(e*u);for(s/u<t&&++s,l/u>e&&--l,o=new Array(a=l-s+1);++i<a;)o[i]=(s+i)/u}return r&&o.reverse(),o}function EM(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=P0?10:a>=U0?5:a>=I0?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=P0?10:a>=U0?5:a>=I0?2:1)}function j0(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=P0?i*=10:a>=U0?i*=5:a>=I0&&(i*=2),e<t?-i:i}function O9(t,e,n=AM){if(r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t),u=+n(t[a+1],a+1,t);return o+(u-o)*(i-a)}}function z9(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(i);++r<i;)a[r]=t+r*n;return a}function Qn(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function ti(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Y0=Symbol("implicit");function X1(){var t=new Map,e=[],n=[],r=Y0;function i(a){var o=a+"",u=t.get(o);if(!u){if(r!==Y0)return r;t.set(o,u=e.push(a))}return n[(u-1)%n.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new Map;for(const o of a){const u=o+"";t.has(u)||t.set(u,e.push(o))}return i},i.range=function(a){return arguments.length?(n=Array.from(a),i):n.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return X1(e,n).unknown(r)},Qn.apply(i,arguments),i}function CM(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}function SM(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,u=r<e-1?t[r+2]:2*a-i;return CM((n-r/e)*e,o,i,a,u)}}function DM(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],u=t[(r+2)%e];return CM((n-r/e)*e,i,a,o,u)}}const rc=t=>()=>t;function $M(t,e){return function(n){return t+n*e}}function L9(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function ic(t,e){var n=e-t;return n?$M(t,n>180||n<-180?n-360*Math.round(n/360):n):rc(isNaN(t)?e:t)}function B9(t){return(t=+t)==1?Wt:function(e,n){return n-e?L9(e,n,t):rc(isNaN(e)?n:e)}}function Wt(t,e){var n=e-t;return n?$M(t,n):rc(isNaN(t)?e:t)}const W0=function t(e){var n=B9(e);function r(i,a){var o=n((i=uu(i)).r,(a=uu(a)).r),u=n(i.g,a.g),s=n(i.b,a.b),l=Wt(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=u(f),i.b=s(f),i.opacity=l(f),i+""}}return r.gamma=t,r}(1);function FM(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),a=new Array(n),o,u;for(o=0;o<n;++o)u=uu(e[o]),r[o]=u.r||0,i[o]=u.g||0,a[o]=u.b||0;return r=t(r),i=t(i),a=t(a),u.opacity=1,function(s){return u.r=r(s),u.g=i(s),u.b=a(s),u+""}}}var P9=FM(SM),U9=FM(DM);function Z1(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function TM(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function I9(t,e){return(TM(e)?Z1:RM)(t,e)}function RM(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=Ii(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(u){for(o=0;o<r;++o)a[o]=i[o](u);return a}}function NM(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function pn(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function OM(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Ii(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var H0=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,vh=new RegExp(H0.source,"g");function q9(t){return function(){return t}}function j9(t){return function(e){return t(e)+""}}function zM(t,e){var n=H0.lastIndex=vh.lastIndex=0,r,i,a,o=-1,u=[],s=[];for(t=t+"",e=e+"";(r=H0.exec(t))&&(i=vh.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),u[o]?u[o]+=a:u[++o]=a),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,s.push({i:o,x:pn(r,i)})),n=vh.lastIndex;return n<e.length&&(a=e.slice(n),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?j9(s[0].x):q9(e):(e=s.length,function(l){for(var f=0,c;f<e;++f)u[(c=s[f]).i]=c.x(l);return u.join("")})}function Ii(t,e){var n=typeof e,r;return e==null||n==="boolean"?rc(e):(n==="number"?pn:n==="string"?(r=yl(e))?(e=r,W0):zM:e instanceof yl?W0:e instanceof Date?NM:TM(e)?Z1:Array.isArray(e)?RM:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?OM:pn)(t,e)}function Y9(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function W9(t,e){var n=ic(+t,+e);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function ac(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var J2=180/Math.PI,G0={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function LM(t,e,n,r,i,a){var o,u,s;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(s=t*n+e*r)&&(n-=t*s,r-=e*s),(u=Math.sqrt(n*n+r*r))&&(n/=u,r/=u,s/=u),t*r<e*n&&(t=-t,e=-e,s=-s,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*J2,skewX:Math.atan(s)*J2,scaleX:o,scaleY:u}}var As;function H9(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?G0:LM(e.a,e.b,e.c,e.d,e.e,e.f)}function G9(t){return t==null||(As||(As=document.createElementNS("http://www.w3.org/2000/svg","g")),As.setAttribute("transform",t),!(t=As.transform.baseVal.consolidate()))?G0:(t=t.matrix,LM(t.a,t.b,t.c,t.d,t.e,t.f))}function BM(t,e,n,r){function i(l){return l.length?l.pop()+" ":""}function a(l,f,c,h,d,g){if(l!==c||f!==h){var p=d.push("translate(",null,e,null,n);g.push({i:p-4,x:pn(l,c)},{i:p-2,x:pn(f,h)})}else(c||h)&&d.push("translate("+c+e+h+n)}function o(l,f,c,h){l!==f?(l-f>180?f+=360:f-l>180&&(l+=360),h.push({i:c.push(i(c)+"rotate(",null,r)-2,x:pn(l,f)})):f&&c.push(i(c)+"rotate("+f+r)}function u(l,f,c,h){l!==f?h.push({i:c.push(i(c)+"skewX(",null,r)-2,x:pn(l,f)}):f&&c.push(i(c)+"skewX("+f+r)}function s(l,f,c,h,d,g){if(l!==c||f!==h){var p=d.push(i(d)+"scale(",null,",",null,")");g.push({i:p-4,x:pn(l,c)},{i:p-2,x:pn(f,h)})}else(c!==1||h!==1)&&d.push(i(d)+"scale("+c+","+h+")")}return function(l,f){var c=[],h=[];return l=t(l),f=t(f),a(l.translateX,l.translateY,f.translateX,f.translateY,c,h),o(l.rotate,f.rotate,c,h),u(l.skewX,f.skewX,c,h),s(l.scaleX,l.scaleY,f.scaleX,f.scaleY,c,h),l=f=null,function(d){for(var g=-1,p=h.length,m;++g<p;)c[(m=h[g]).i]=m.x(d);return c.join("")}}}var V9=BM(H9,"px, ","px)","deg)"),X9=BM(G9,", ",")",")"),Z9=1e-12;function tv(t){return((t=Math.exp(t))+1/t)/2}function K9(t){return((t=Math.exp(t))-1/t)/2}function Q9(t){return((t=Math.exp(2*t))-1)/(t+1)}const J9=function t(e,n,r){function i(a,o){var u=a[0],s=a[1],l=a[2],f=o[0],c=o[1],h=o[2],d=f-u,g=c-s,p=d*d+g*g,m,y;if(p<Z9)y=Math.log(h/l)/e,m=function(w){return[u+w*d,s+w*g,l*Math.exp(e*w*y)]};else{var v=Math.sqrt(p),x=(h*h-l*l+r*p)/(2*l*n*v),b=(h*h-l*l-r*p)/(2*h*n*v),_=Math.log(Math.sqrt(x*x+1)-x),M=Math.log(Math.sqrt(b*b+1)-b);y=(M-_)/e,m=function(w){var A=w*y,S=tv(_),C=l/(n*v)*(S*Q9(e*A+_)-K9(_));return[u+C*d,s+C*g,l*S/tv(e*A+_)]}}return m.duration=y*1e3*e/Math.SQRT2,m}return i.rho=function(a){var o=Math.max(.001,+a),u=o*o,s=u*u;return t(o,u,s)},i}(Math.SQRT2,2,4);function PM(t){return function(e,n){var r=t((e=Fy(e)).h,(n=Fy(n)).h),i=Wt(e.s,n.s),a=Wt(e.l,n.l),o=Wt(e.opacity,n.opacity);return function(u){return e.h=r(u),e.s=i(u),e.l=a(u),e.opacity=o(u),e+""}}}const tF=PM(ic);var eF=PM(Wt);function nF(t,e){var n=Wt((t=d0(t)).l,(e=d0(e)).l),r=Wt(t.a,e.a),i=Wt(t.b,e.b),a=Wt(t.opacity,e.opacity);return function(o){return t.l=n(o),t.a=r(o),t.b=i(o),t.opacity=a(o),t+""}}function UM(t){return function(e,n){var r=t((e=g0(e)).h,(n=g0(n)).h),i=Wt(e.c,n.c),a=Wt(e.l,n.l),o=Wt(e.opacity,n.opacity);return function(u){return e.h=r(u),e.c=i(u),e.l=a(u),e.opacity=o(u),e+""}}}const rF=UM(ic);var iF=UM(Wt);function IM(t){return function e(n){n=+n;function r(i,a){var o=t((i=p0(i)).h,(a=p0(a)).h),u=Wt(i.s,a.s),s=Wt(i.l,a.l),l=Wt(i.opacity,a.opacity);return function(f){return i.h=o(f),i.s=u(f),i.l=s(Math.pow(f,n)),i.opacity=l(f),i+""}}return r.gamma=e,r}(1)}const aF=IM(ic);var oF=IM(Wt);function K1(t,e){e===void 0&&(e=t,t=Ii);for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(o){var u=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return a[u](o-u)}}function uF(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}const sF=Object.freeze(Object.defineProperty({__proto__:null,interpolate:Ii,interpolateArray:I9,interpolateBasis:SM,interpolateBasisClosed:DM,interpolateCubehelix:aF,interpolateCubehelixLong:oF,interpolateDate:NM,interpolateDiscrete:Y9,interpolateHcl:rF,interpolateHclLong:iF,interpolateHsl:tF,interpolateHslLong:eF,interpolateHue:W9,interpolateLab:nF,interpolateNumber:pn,interpolateNumberArray:Z1,interpolateObject:OM,interpolateRgb:W0,interpolateRgbBasis:P9,interpolateRgbBasisClosed:U9,interpolateRound:ac,interpolateString:zM,interpolateTransformCss:V9,interpolateTransformSvg:X9,interpolateZoom:J9,piecewise:K1,quantize:uF},Symbol.toStringTag,{value:"Module"}));function lF(t){return function(){return t}}function V0(t){return+t}var ev=[0,1];function Oe(t){return t}function X0(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:lF(isNaN(e)?NaN:.5)}function fF(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function cF(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=X0(i,r),a=n(o,a)):(r=X0(r,i),a=n(a,o)),function(u){return a(r(u))}}function hF(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=X0(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(u){var s=Iu(t,u,1,r)-1;return a[s](i[s](u))}}function qu(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function oc(){var t=ev,e=ev,n=Ii,r,i,a,o=Oe,u,s,l;function f(){var h=Math.min(t.length,e.length);return o!==Oe&&(o=fF(t[0],t[h-1])),u=h>2?hF:cF,s=l=null,c}function c(h){return h==null||isNaN(h=+h)?a:(s||(s=u(t.map(r),e,n)))(r(o(h)))}return c.invert=function(h){return o(i((l||(l=u(e,t.map(r),pn)))(h)))},c.domain=function(h){return arguments.length?(t=Array.from(h,V0),f()):t.slice()},c.range=function(h){return arguments.length?(e=Array.from(h),f()):e.slice()},c.rangeRound=function(h){return e=Array.from(h),n=ac,f()},c.clamp=function(h){return arguments.length?(o=h?!0:Oe,f()):o!==Oe},c.interpolate=function(h){return arguments.length?(n=h,f()):n},c.unknown=function(h){return arguments.length?(a=h,c):a},function(h,d){return r=h,i=d,f()}}function qM(){return oc()(Oe,Oe)}function jM(t,e,n,r){var i=j0(t,e,n),a;switch(r=g6(r==null?",f":r),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(a=y6(i,o))&&(r.precision=a),v6(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=m6(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=p6(i))&&(r.precision=a-(r.type==="%")*2);break}}return rw(r)}function qi(t){var e=t.domain;return t.ticks=function(n){var r=e();return q0(r[0],r[r.length-1],n==null?10:n)},t.tickFormat=function(n,r){var i=e();return jM(i[0],i[i.length-1],n==null?10:n,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,a=r.length-1,o=r[i],u=r[a],s,l,f=10;for(u<o&&(l=o,o=u,u=l,l=i,i=a,a=l);f-- >0;){if(l=EM(o,u,n),l===s)return r[i]=o,r[a]=u,e(r);if(l>0)o=Math.floor(o/l)*l,u=Math.ceil(u/l)*l;else if(l<0)o=Math.ceil(o*l)/l,u=Math.floor(u*l)/l;else break;s=l}return t},t}function YM(){var t=qM();return t.copy=function(){return qu(t,YM())},Qn.apply(t,arguments),qi(t)}function WM(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,V0),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return WM(t).unknown(e)},t=arguments.length?Array.from(t,V0):[0,1],qi(n)}function HM(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],a=t[r],o;return a<i&&(o=n,n=r,r=o,o=i,i=a,a=o),t[n]=e.floor(i),t[r]=e.ceil(a),t}function nv(t){return Math.log(t)}function rv(t){return Math.exp(t)}function dF(t){return-Math.log(-t)}function gF(t){return-Math.exp(-t)}function pF(t){return isFinite(t)?+("1e"+t):t<0?0:t}function mF(t){return t===10?pF:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}function yF(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}function iv(t){return function(e){return-t(-e)}}function Q1(t){var e=t(nv,rv),n=e.domain,r=10,i,a;function o(){return i=yF(r),a=mF(r),n()[0]<0?(i=iv(i),a=iv(a),t(dF,gF)):t(nv,rv),e}return e.base=function(u){return arguments.length?(r=+u,o()):r},e.domain=function(u){return arguments.length?(n(u),o()):n()},e.ticks=function(u){var s=n(),l=s[0],f=s[s.length-1],c;(c=f<l)&&(h=l,l=f,f=h);var h=i(l),d=i(f),g,p,m,y=u==null?10:+u,v=[];if(!(r%1)&&d-h<y){if(h=Math.floor(h),d=Math.ceil(d),l>0){for(;h<=d;++h)for(p=1,g=a(h);p<r;++p)if(m=g*p,!(m<l)){if(m>f)break;v.push(m)}}else for(;h<=d;++h)for(p=r-1,g=a(h);p>=1;--p)if(m=g*p,!(m<l)){if(m>f)break;v.push(m)}v.length*2<y&&(v=q0(l,f,y))}else v=q0(h,d,Math.min(d-h,y)).map(a);return c?v.reverse():v},e.tickFormat=function(u,s){if(s==null&&(s=r===10?".0e":","),typeof s!="function"&&(s=rw(s)),u===1/0)return s;u==null&&(u=10);var l=Math.max(1,r*u/e.ticks().length);return function(f){var c=f/a(Math.round(i(f)));return c*r<r-.5&&(c*=r),c<=l?s(f):""}},e.nice=function(){return n(HM(n(),{floor:function(u){return a(Math.floor(i(u)))},ceil:function(u){return a(Math.ceil(i(u)))}}))},e}function GM(){var t=Q1(oc()).domain([1,10]);return t.copy=function(){return qu(t,GM()).base(t.base())},Qn.apply(t,arguments),t}function av(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function ov(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function J1(t){var e=1,n=t(av(e),ov(e));return n.constant=function(r){return arguments.length?t(av(e=+r),ov(e)):e},qi(n)}function VM(){var t=J1(oc());return t.copy=function(){return qu(t,VM()).constant(t.constant())},Qn.apply(t,arguments)}function uv(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function vF(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function xF(t){return t<0?-t*t:t*t}function tp(t){var e=t(Oe,Oe),n=1;function r(){return n===1?t(Oe,Oe):n===.5?t(vF,xF):t(uv(n),uv(1/n))}return e.exponent=function(i){return arguments.length?(n=+i,r()):n},qi(e)}function ep(){var t=tp(oc());return t.copy=function(){return qu(t,ep()).exponent(t.exponent())},Qn.apply(t,arguments),t}function bF(){return ep.apply(null,arguments).exponent(.5)}function XM(){var t=[],e=[],n=[],r;function i(){var o=0,u=Math.max(1,e.length);for(n=new Array(u-1);++o<u;)n[o-1]=O9(t,o/u);return a}function a(o){return o==null||isNaN(o=+o)?r:e[Iu(n,o)]}return a.invertExtent=function(o){var u=e.indexOf(o);return u<0?[NaN,NaN]:[u>0?n[u-1]:t[0],u<n.length?n[u]:t[t.length-1]]},a.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let u of o)u!=null&&!isNaN(u=+u)&&t.push(u);return t.sort(G1),i()},a.range=function(o){return arguments.length?(e=Array.from(o),i()):e.slice()},a.unknown=function(o){return arguments.length?(r=o,a):r},a.quantiles=function(){return n.slice()},a.copy=function(){return XM().domain(t).range(e).unknown(r)},Qn.apply(a,arguments)}function ZM(){var t=0,e=1,n=1,r=[.5],i=[0,1],a;function o(s){return s!=null&&s<=s?i[Iu(r,s,0,n)]:a}function u(){var s=-1;for(r=new Array(n);++s<n;)r[s]=((s+1)*e-(s-n)*t)/(n+1);return o}return o.domain=function(s){return arguments.length?([t,e]=s,t=+t,e=+e,u()):[t,e]},o.range=function(s){return arguments.length?(n=(i=Array.from(s)).length-1,u()):i.slice()},o.invertExtent=function(s){var l=i.indexOf(s);return l<0?[NaN,NaN]:l<1?[t,r[0]]:l>=n?[r[n-1],e]:[r[l-1],r[l]]},o.unknown=function(s){return arguments.length&&(a=s),o},o.thresholds=function(){return r.slice()},o.copy=function(){return ZM().domain([t,e]).range(i).unknown(a)},Qn.apply(qi(o),arguments)}function KM(){var t=[.5],e=[0,1],n,r=1;function i(a){return a!=null&&a<=a?e[Iu(t,a,0,r)]:n}return i.domain=function(a){return arguments.length?(t=Array.from(a),r=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(a){return arguments.length?(e=Array.from(a),r=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(a){var o=e.indexOf(a);return[t[o-1],t[o]]},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return KM().domain(t).range(e).unknown(n)},Qn.apply(i,arguments)}var xh=new Date,bh=new Date;function Qt(t,e,n,r){function i(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return t(a=new Date(+a)),a},i.ceil=function(a){return t(a=new Date(a-1)),e(a,1),t(a),a},i.round=function(a){var o=i(a),u=i.ceil(a);return a-o<u-a?o:u},i.offset=function(a,o){return e(a=new Date(+a),o==null?1:Math.floor(o)),a},i.range=function(a,o,u){var s=[],l;if(a=i.ceil(a),u=u==null?1:Math.floor(u),!(a<o)||!(u>0))return s;do s.push(l=new Date(+a)),e(a,u),t(a);while(l<a&&a<o);return s},i.filter=function(a){return Qt(function(o){if(o>=o)for(;t(o),!a(o);)o.setTime(o-1)},function(o,u){if(o>=o)if(u<0)for(;++u<=0;)for(;e(o,-1),!a(o););else for(;--u>=0;)for(;e(o,1),!a(o););})},n&&(i.count=function(a,o){return xh.setTime(+a),bh.setTime(+o),t(xh),t(bh),Math.floor(n(xh,bh))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?function(o){return r(o)%a===0}:function(o){return i.count(0,o)%a===0}):i}),i}var Nl=Qt(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});Nl.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Qt(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):Nl};const wF=Nl;Nl.range;const fr=1e3,en=fr*60,cr=en*60,ki=cr*24,np=ki*7,sv=ki*30,wh=ki*365;var QM=Qt(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*fr)},function(t,e){return(e-t)/fr},function(t){return t.getUTCSeconds()});const fa=QM;QM.range;var JM=Qt(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*fr)},function(t,e){t.setTime(+t+e*en)},function(t,e){return(e-t)/en},function(t){return t.getMinutes()});const t5=JM;JM.range;var e5=Qt(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*fr-t.getMinutes()*en)},function(t,e){t.setTime(+t+e*cr)},function(t,e){return(e-t)/cr},function(t){return t.getHours()});const n5=e5;e5.range;var r5=Qt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*en)/ki,t=>t.getDate()-1);const i5=r5;r5.range;function ji(t){return Qt(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n*7)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*en)/np})}var rp=ji(0),_F=ji(1),MF=ji(2),kF=ji(3),AF=ji(4),EF=ji(5),CF=ji(6);rp.range;_F.range;MF.range;kF.range;AF.range;EF.range;CF.range;var a5=Qt(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()});const o5=a5;a5.range;var ip=Qt(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});ip.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Qt(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)})};const u5=ip;ip.range;var s5=Qt(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*en)},function(t,e){return(e-t)/en},function(t){return t.getUTCMinutes()});const l5=s5;s5.range;var f5=Qt(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*cr)},function(t,e){return(e-t)/cr},function(t){return t.getUTCHours()});const c5=f5;f5.range;var h5=Qt(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/ki},function(t){return t.getUTCDate()-1});const d5=h5;h5.range;function Yi(t){return Qt(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n*7)},function(e,n){return(n-e)/np})}var ap=Yi(0),SF=Yi(1),DF=Yi(2),$F=Yi(3),FF=Yi(4),TF=Yi(5),RF=Yi(6);ap.range;SF.range;DF.range;$F.range;FF.range;TF.range;RF.range;var g5=Qt(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()});const p5=g5;g5.range;var op=Qt(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});op.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:Qt(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})};const m5=op;op.range;function y5(t,e,n,r,i,a){const o=[[fa,1,fr],[fa,5,5*fr],[fa,15,15*fr],[fa,30,30*fr],[a,1,en],[a,5,5*en],[a,15,15*en],[a,30,30*en],[i,1,cr],[i,3,3*cr],[i,6,6*cr],[i,12,12*cr],[r,1,ki],[r,2,2*ki],[n,1,np],[e,1,sv],[e,3,3*sv],[t,1,wh]];function u(l,f,c){const h=f<l;h&&([l,f]=[f,l]);const d=c&&typeof c.range=="function"?c:s(l,f,c),g=d?d.range(l,+f+1):[];return h?g.reverse():g}function s(l,f,c){const h=Math.abs(f-l)/c,d=V1(([,,m])=>m).right(o,h);if(d===o.length)return t.every(j0(l/wh,f/wh,c));if(d===0)return wF.every(Math.max(j0(l,f,c),1));const[g,p]=o[h/o[d-1][2]<o[d][2]/h?d-1:d];return g.every(p)}return[u,s]}const[NF,OF]=y5(m5,p5,ap,d5,c5,l5),[zF,LF]=y5(u5,o5,rp,i5,n5,t5);function BF(t){return new Date(t)}function PF(t){return t instanceof Date?+t:+new Date(+t)}function up(t,e,n,r,i,a,o,u,s,l){var f=qM(),c=f.invert,h=f.domain,d=l(".%L"),g=l(":%S"),p=l("%I:%M"),m=l("%I %p"),y=l("%a %d"),v=l("%b %d"),x=l("%B"),b=l("%Y");function _(M){return(s(M)<M?d:u(M)<M?g:o(M)<M?p:a(M)<M?m:r(M)<M?i(M)<M?y:v:n(M)<M?x:b)(M)}return f.invert=function(M){return new Date(c(M))},f.domain=function(M){return arguments.length?h(Array.from(M,PF)):h().map(BF)},f.ticks=function(M){var w=h();return t(w[0],w[w.length-1],M==null?10:M)},f.tickFormat=function(M,w){return w==null?_:l(w)},f.nice=function(M){var w=h();return(!M||typeof M.range!="function")&&(M=e(w[0],w[w.length-1],M==null?10:M)),M?h(HM(w,M)):f},f.copy=function(){return qu(f,up(t,e,n,r,i,a,o,u,s,l))},f}function UF(){return Qn.apply(up(zF,LF,u5,o5,rp,i5,n5,t5,fa,Dw).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function IF(){return Qn.apply(up(NF,OF,m5,p5,ap,d5,c5,l5,fa,$w).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function uc(){var t=0,e=1,n,r,i,a,o=Oe,u=!1,s;function l(c){return c==null||isNaN(c=+c)?s:o(i===0?.5:(c=(a(c)-n)*i,u?Math.max(0,Math.min(1,c)):c))}l.domain=function(c){return arguments.length?([t,e]=c,n=a(t=+t),r=a(e=+e),i=n===r?0:1/(r-n),l):[t,e]},l.clamp=function(c){return arguments.length?(u=!!c,l):u},l.interpolator=function(c){return arguments.length?(o=c,l):o};function f(c){return function(h){var d,g;return arguments.length?([d,g]=h,o=c(d,g),l):[o(0),o(1)]}}return l.range=f(Ii),l.rangeRound=f(ac),l.unknown=function(c){return arguments.length?(s=c,l):s},function(c){return a=c,n=c(t),r=c(e),i=n===r?0:1/(r-n),l}}function ei(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function sp(){var t=qi(uc()(Oe));return t.copy=function(){return ei(t,sp())},ti.apply(t,arguments)}function v5(){var t=Q1(uc()).domain([1,10]);return t.copy=function(){return ei(t,v5()).base(t.base())},ti.apply(t,arguments)}function x5(){var t=J1(uc());return t.copy=function(){return ei(t,x5()).constant(t.constant())},ti.apply(t,arguments)}function lp(){var t=tp(uc());return t.copy=function(){return ei(t,lp()).exponent(t.exponent())},ti.apply(t,arguments)}function qF(){return lp.apply(null,arguments).exponent(.5)}function sc(){var t=0,e=.5,n=1,r=1,i,a,o,u,s,l=Oe,f,c=!1,h;function d(p){return isNaN(p=+p)?h:(p=.5+((p=+f(p))-a)*(r*p<r*a?u:s),l(c?Math.max(0,Math.min(1,p)):p))}d.domain=function(p){return arguments.length?([t,e,n]=p,i=f(t=+t),a=f(e=+e),o=f(n=+n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1,d):[t,e,n]},d.clamp=function(p){return arguments.length?(c=!!p,d):c},d.interpolator=function(p){return arguments.length?(l=p,d):l};function g(p){return function(m){var y,v,x;return arguments.length?([y,v,x]=m,l=K1(p,[y,v,x]),d):[l(0),l(.5),l(1)]}}return d.range=g(Ii),d.rangeRound=g(ac),d.unknown=function(p){return arguments.length?(h=p,d):h},function(p){return f=p,i=p(t),a=p(e),o=p(n),u=i===a?0:.5/(a-i),s=a===o?0:.5/(o-a),r=a<i?-1:1,d}}function b5(){var t=qi(sc()(Oe));return t.copy=function(){return ei(t,b5())},ti.apply(t,arguments)}function w5(){var t=Q1(sc()).domain([.1,1,10]);return t.copy=function(){return ei(t,w5()).base(t.base())},ti.apply(t,arguments)}function _5(){var t=J1(sc());return t.copy=function(){return ei(t,_5()).constant(t.constant())},ti.apply(t,arguments)}function fp(){var t=tp(sc());return t.copy=function(){return ei(t,fp()).exponent(t.exponent())},ti.apply(t,arguments)}function jF(){return fp.apply(null,arguments).exponent(.5)}function cp(t,e,n){const r=t-e+n*2;return t?r>0?r:1:0}const YF="identity",Da="linear",gr="log",ju="pow",Yu="sqrt",lc="symlog",Ai="time",Ei="utc",In="sequential",Va="diverging",$a="quantile",fc="quantize",cc="threshold",hp="ordinal",Z0="point",M5="band",dp="bin-ordinal",Yt="continuous",Wu="discrete",Hu="discretizing",hn="interpolating",gp="temporal";function WF(t){return function(e){let n=e[0],r=e[1],i;return r<n&&(i=n,n=r,r=i),[t.invert(n),t.invert(r)]}}function HF(t){return function(e){const n=t.range();let r=e[0],i=e[1],a=-1,o,u,s,l;for(i<r&&(u=r,r=i,i=u),s=0,l=n.length;s<l;++s)n[s]>=r&&n[s]<=i&&(a<0&&(a=s),o=s);if(!(a<0))return r=t.invertExtent(n[a]),i=t.invertExtent(n[o]),[r[0]===void 0?r[1]:r[0],i[1]===void 0?i[0]:i[1]]}}function pp(){const t=X1().unknown(void 0),e=t.domain,n=t.range;let r=[0,1],i,a,o=!1,u=0,s=0,l=.5;delete t.unknown;function f(){const c=e().length,h=r[1]<r[0],d=r[1-h],g=cp(c,u,s);let p=r[h-0];i=(d-p)/(g||1),o&&(i=Math.floor(i)),p+=(d-p-i*(c-u))*l,a=i*(1-u),o&&(p=Math.round(p),a=Math.round(a));const m=z9(c).map(y=>p+i*y);return n(h?m.reverse():m)}return t.domain=function(c){return arguments.length?(e(c),f()):e()},t.range=function(c){return arguments.length?(r=[+c[0],+c[1]],f()):r.slice()},t.rangeRound=function(c){return r=[+c[0],+c[1]],o=!0,f()},t.bandwidth=function(){return a},t.step=function(){return i},t.round=function(c){return arguments.length?(o=!!c,f()):o},t.padding=function(c){return arguments.length?(s=Math.max(0,Math.min(1,c)),u=s,f()):u},t.paddingInner=function(c){return arguments.length?(u=Math.max(0,Math.min(1,c)),f()):u},t.paddingOuter=function(c){return arguments.length?(s=Math.max(0,Math.min(1,c)),f()):s},t.align=function(c){return arguments.length?(l=Math.max(0,Math.min(1,c)),f()):l},t.invertRange=function(c){if(c[0]==null||c[1]==null)return;const h=r[1]<r[0],d=h?n().reverse():n(),g=d.length-1;let p=+c[0],m=+c[1],y,v,x;if(!(p!==p||m!==m)&&(m<p&&(x=p,p=m,m=x),!(m<d[0]||p>r[1-h])))return y=Math.max(0,B0(d,p)-1),v=p===m?y:B0(d,m)-1,p-d[y]>a+1e-10&&++y,h&&(x=y,y=g-v,v=g-x),y>v?void 0:e().slice(y,v+1)},t.invert=function(c){const h=t.invertRange([c,c]);return h&&h[0]},t.copy=function(){return pp().domain(e()).range(r).round(o).paddingInner(u).paddingOuter(s).align(l)},f()}function k5(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return k5(e())},t}function GF(){return k5(pp().paddingInner(1))}var VF=Array.prototype.map;function XF(t){return VF.call(t,le)}const ZF=Array.prototype.slice;function A5(){let t=[],e=[];function n(r){return r==null||r!==r?void 0:e[(Iu(t,r)-1)%e.length]}return n.domain=function(r){return arguments.length?(t=XF(r),n):t.slice()},n.range=function(r){return arguments.length?(e=ZF.call(r),n):e.slice()},n.tickFormat=function(r,i){return jM(t[0],ot(t),r==null?10:r,i)},n.copy=function(){return A5().domain(n.domain()).range(n.range())},n}const Ol={};function KF(t,e,n){const r=function(){const a=e();return a.invertRange||(a.invertRange=a.invert?WF(a):a.invertExtent?HF(a):void 0),a.type=t,a};return r.metadata=En(Z(n)),r}function dt(t,e,n){return arguments.length>1?(Ol[t]=KF(t,e,n),this):E5(t)?Ol[t]:void 0}dt(YF,WM);dt(Da,YM,Yt);dt(gr,GM,[Yt,gr]);dt(ju,ep,Yt);dt(Yu,bF,Yt);dt(lc,VM,Yt);dt(Ai,UF,[Yt,gp]);dt(Ei,IF,[Yt,gp]);dt(In,sp,[Yt,hn]);dt("".concat(In,"-").concat(Da),sp,[Yt,hn]);dt("".concat(In,"-").concat(gr),v5,[Yt,hn,gr]);dt("".concat(In,"-").concat(ju),lp,[Yt,hn]);dt("".concat(In,"-").concat(Yu),qF,[Yt,hn]);dt("".concat(In,"-").concat(lc),x5,[Yt,hn]);dt("".concat(Va,"-").concat(Da),b5,[Yt,hn]);dt("".concat(Va,"-").concat(gr),w5,[Yt,hn,gr]);dt("".concat(Va,"-").concat(ju),fp,[Yt,hn]);dt("".concat(Va,"-").concat(Yu),jF,[Yt,hn]);dt("".concat(Va,"-").concat(lc),_5,[Yt,hn]);dt($a,XM,[Hu,$a]);dt(fc,ZM,Hu);dt(cc,KM,Hu);dt(dp,A5,[Wu,Hu]);dt(hp,X1,Wu);dt(M5,pp,Wu);dt(Z0,GF,Wu);function E5(t){return K(Ol,t)}function Wi(t,e){const n=Ol[t];return n&&n.metadata[e]}function mp(t){return Wi(t,Yt)}function Fa(t){return Wi(t,Wu)}function K0(t){return Wi(t,Hu)}function C5(t){return Wi(t,gr)}function QF(t){return Wi(t,gp)}function S5(t){return Wi(t,hn)}function D5(t){return Wi(t,$a)}const JF=["clamp","base","constant","exponent"];function $5(t,e){const n=e[0],r=ot(e)-n;return function(i){return t(n+i*r)}}function hc(t,e,n){return K1(yp(e||"rgb",n),t)}function F5(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}function T5(t,e,n){const r=n-e;let i,a,o;return!r||!Number.isFinite(r)?ge(.5):(i=(a=t.type).indexOf("-"),a=i<0?a:a.slice(i+1),o=dt(a)().domain([e,n]).range([0,1]),JF.forEach(u=>t[u]?o[u](t[u]()):0),o)}function yp(t,e){const n=sF[tT(t)];return e!=null&&n&&n.gamma?n.gamma(e):n}function tT(t){return"interpolate"+t.toLowerCase().split("-").map(e=>e[0].toUpperCase()+e.slice(1)).join("")}const eT={blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},nT={category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"};function R5(t){const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}function N5(t,e){for(const n in t)vp(n,e(t[n]))}const lv={};N5(nT,R5);N5(eT,t=>hc(R5(t)));function vp(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(lv[t]=e,this):lv[t]}const tl="symbol",rT="discrete",iT="gradient",aT=t=>G(t)?t.map(e=>String(e)):String(t),oT=(t,e)=>t[1]-e[1],uT=(t,e)=>e[1]-t[1];function xp(t,e,n){let r;return Yr(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),n!=null&&(e=Math.min(e,Math.floor(Lu(t.domain())/n||1)))),et(e)&&(r=e.step,e=e.interval),Ct(e)&&(e=t.type===Ai?Ya(e):t.type==Ei?Wa(e):z("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function O5(t,e,n){let r=t.range(),i=r[0],a=ot(r),o=oT;if(i>a&&(r=a,a=i,i=r,o=uT),i=Math.floor(i),a=Math.ceil(a),e=e.map(u=>[u,t(u)]).filter(u=>i<=u[1]&&u[1]<=a).sort(o).map(u=>u[0]),n>0&&e.length>1){const u=[e[0],ot(e)];for(;e.length>n&&e.length>=3;)e=e.filter((s,l)=>!(l%2));e.length<3&&(e=u)}return e}function bp(t,e){return t.bins?O5(t,t.bins):t.ticks?t.ticks(e):t.domain()}function z5(t,e,n,r,i,a){const o=e.type;let u=aT;if(o===Ai||i===Ai)u=t.timeFormat(r);else if(o===Ei||i===Ei)u=t.utcFormat(r);else if(C5(o)){const s=t.formatFloat(r);if(a||e.bins)u=s;else{const l=L5(e,n,!1);u=f=>l(f)?s(f):""}}else if(e.tickFormat){const s=e.domain();u=t.formatSpan(s[0],s[s.length-1],n,r)}else r&&(u=t.format(r));return u}function L5(t,e,n){const r=bp(t,e),i=t.base(),a=Math.log(i),o=Math.max(1,i*e/r.length),u=s=>{let l=s/Math.pow(i,Math.round(Math.log(s)/a));return l*i<i-.5&&(l*=i),l<=o};return n?r.filter(u):u}const Q0={[$a]:"quantiles",[fc]:"thresholds",[cc]:"domain"},B5={[$a]:"quantiles",[fc]:"domain"};function P5(t,e){return t.bins?fT(t.bins):t.type===gr?L5(t,e,!0):Q0[t.type]?lT(t[Q0[t.type]]()):bp(t,e)}function sT(t,e,n){const r=e[B5[e.type]](),i=r.length;let a=i>1?r[1]-r[0]:r[0],o;for(o=1;o<i;++o)a=Math.min(a,r[o]-r[o-1]);return t.formatSpan(0,a,3*10,n)}function lT(t){const e=[-1/0].concat(t);return e.max=1/0,e}function fT(t){const e=t.slice(0,-1);return e.max=ot(t),e}const cT=t=>Q0[t.type]||t.bins;function U5(t,e,n,r,i,a,o){const u=B5[e.type]&&a!==Ai&&a!==Ei?sT(t,e,i):z5(t,e,n,i,a,o);return r===tl&&cT(e)?hT(u):r===rT?dT(u):gT(u)}const hT=t=>(e,n,r)=>{const i=fv(r[n+1],fv(r.max,1/0)),a=cv(e,t),o=cv(i,t);return a&&o?a+" – "+o:o?"< "+o:"≥ "+a},fv=(t,e)=>t!=null?t:e,dT=t=>(e,n)=>n?t(e):null,gT=t=>e=>t(e),cv=(t,e)=>Number.isFinite(t)?e(t):null;function pT(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+ot(e),a=i-r;if(t.type===cc){const o=n?a/n:.1;r-=o,i+=o,a=i-r}return o=>(o-r)/a}function mT(t,e,n,r){const i=r||e.type;return Ct(n)&&QF(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),!n&&i===Ai?t.timeFormat("%A, %d %B %Y, %X"):!n&&i===Ei?t.utcFormat("%A, %d %B %Y, %X UTC"):U5(t,e,5,null,n,r,!0)}function I5(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=mT(t,e,n.format,n.formatType);if(K0(e.type)){const a=P5(e).slice(1).map(i),o=a.length;return"".concat(o," boundar").concat(o===1?"y":"ies",": ").concat(a.join(", "))}else if(Fa(e.type)){const a=e.domain(),o=a.length,u=o>r?a.slice(0,r-2).map(i).join(", ")+", ending with "+a.slice(-1).map(i):a.map(i).join(", ");return"".concat(o," value").concat(o===1?"":"s",": ").concat(u)}else{const a=e.domain();return"values from ".concat(i(a[0])," to ").concat(i(ot(a)))}}let q5=0;function yT(){q5=0}const zl="p_";function wp(t){return t&&t.gradient}function j5(t,e,n){const r=t.gradient;let i=t.id,a=r==="radial"?zl:"";return i||(i=t.id="gradient_"+q5++,r==="radial"?(t.x1=Rn(t.x1,.5),t.y1=Rn(t.y1,.5),t.r1=Rn(t.r1,0),t.x2=Rn(t.x2,.5),t.y2=Rn(t.y2,.5),t.r2=Rn(t.r2,.5),a=zl):(t.x1=Rn(t.x1,0),t.y1=Rn(t.y1,0),t.x2=Rn(t.x2,1),t.y2=Rn(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+a+i+")"}function Rn(t,e){return t!=null?t:e}function Y5(t,e){var n=[],r;return r={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:n,stop:function(i,a){return n.push({offset:i,color:a}),r}}}const hv={basis:{curve:p9},"basis-closed":{curve:m9},"basis-open":{curve:y9},bundle:{curve:v9,tension:"beta",value:.85},cardinal:{curve:x9,tension:"tension",value:0},"cardinal-open":{curve:w9,tension:"tension",value:0},"cardinal-closed":{curve:b9,tension:"tension",value:0},"catmull-rom":{curve:_9,tension:"alpha",value:.5},"catmull-rom-closed":{curve:M9,tension:"alpha",value:.5},"catmull-rom-open":{curve:k9,tension:"alpha",value:.5},linear:{curve:q1},"linear-closed":{curve:A9},monotone:{horizontal:C9,vertical:E9},natural:{curve:S9},step:{curve:D9},"step-after":{curve:F9},"step-before":{curve:$9}};function _p(t,e,n){var r=K(hv,t)&&hv[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&n!=null&&(i=i[r.tension](n))),i}const vT={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},po=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function Ta(t){const e=[];let n,r,i,a,o,u,s,l,f,c;const h=t.slice().replace(po[0],"###$1").split(po[1]).slice(1);for(s=0,f=h.length;s<f;++s){for(n=h[s],r=n.slice(1).trim().replace(po[2],"$1###$2").replace(po[3],"$1###$2").split(po[4]),o=n.charAt(0),i=[o],l=0,c=r.length;l<c;++l)(a=+r[l])===a&&i.push(a);if(u=vT[o.toLowerCase()],i.length-1>u){const d=i.length;for(l=1,e.push([o].concat(i.slice(l,l+=u))),o=o==="M"?"L":o==="m"?"l":o;l<d;l+=u)e.push([o].concat(i.slice(l,l+u)))}else e.push(i)}return e}const Vr=Math.PI/180,xT=1e-14,hi=Math.PI/2,On=Math.PI*2,Ji=Math.sqrt(3)/2;var _h={},Mh={},W5=[].join;function bT(t,e,n,r,i,a,o,u,s){const l=W5.call(arguments);if(_h[l])return _h[l];const f=o*Vr,c=Math.sin(f),h=Math.cos(f);n=Math.abs(n),r=Math.abs(r);const d=h*(u-t)*.5+c*(s-e)*.5,g=h*(s-e)*.5-c*(u-t)*.5;let p=d*d/(n*n)+g*g/(r*r);p>1&&(p=Math.sqrt(p),n*=p,r*=p);const m=h/n,y=c/n,v=-c/r,x=h/r,b=m*u+y*s,_=v*u+x*s,M=m*t+y*e,w=v*t+x*e;let S=1/((M-b)*(M-b)+(w-_)*(w-_))-.25;S<0&&(S=0);let C=Math.sqrt(S);a==i&&(C=-C);const E=.5*(b+M)-C*(w-_),$=.5*(_+w)+C*(M-b),F=Math.atan2(_-$,b-E);let k=Math.atan2(w-$,M-E)-F;k<0&&a===1?k+=On:k>0&&a===0&&(k-=On);const T=Math.ceil(Math.abs(k/(hi+.001))),B=[];for(let U=0;U<T;++U){const q=F+U*k/T,it=F+(U+1)*k/T;B[U]=[E,$,q,it,n,r,c,h]}return _h[l]=B}function wT(t){const e=W5.call(t);if(Mh[e])return Mh[e];var n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7];const f=l*o,c=-s*u,h=s*o,d=l*u,g=Math.cos(i),p=Math.sin(i),m=Math.cos(a),y=Math.sin(a),v=.5*(a-i),x=Math.sin(v*.5),b=8/3*x*x/Math.sin(v),_=n+g-b*p,M=r+p+b*g,w=n+m,A=r+y,S=w+b*y,C=A-b*m;return Mh[e]=[f*_+c*M,h*_+d*M,f*S+c*C,h*S+d*C,f*w+c*A,h*w+d*A]}const Je=["l",0,0,0,0,0,0,0];function _T(t,e,n){const r=Je[0]=t[0];if(r==="a"||r==="A")Je[1]=e*t[1],Je[2]=n*t[2],Je[3]=t[3],Je[4]=t[4],Je[5]=t[5],Je[6]=e*t[6],Je[7]=n*t[7];else if(r==="h"||r==="H")Je[1]=e*t[1];else if(r==="v"||r==="V")Je[1]=n*t[1];else for(var i=1,a=t.length;i<a;++i)Je[i]=(i%2==1?e:n)*t[i];return Je}function vu(t,e,n,r,i,a){var o,u=null,s=0,l=0,f=0,c=0,h,d,g,p;n==null&&(n=0),r==null&&(r=0),i==null&&(i=1),a==null&&(a=i),t.beginPath&&t.beginPath();for(var m=0,y=e.length;m<y;++m){switch(o=e[m],(i!==1||a!==1)&&(o=_T(o,i,a)),o[0]){case"l":s+=o[1],l+=o[2],t.lineTo(s+n,l+r);break;case"L":s=o[1],l=o[2],t.lineTo(s+n,l+r);break;case"h":s+=o[1],t.lineTo(s+n,l+r);break;case"H":s=o[1],t.lineTo(s+n,l+r);break;case"v":l+=o[1],t.lineTo(s+n,l+r);break;case"V":l=o[1],t.lineTo(s+n,l+r);break;case"m":s+=o[1],l+=o[2],t.moveTo(s+n,l+r);break;case"M":s=o[1],l=o[2],t.moveTo(s+n,l+r);break;case"c":h=s+o[5],d=l+o[6],f=s+o[3],c=l+o[4],t.bezierCurveTo(s+o[1]+n,l+o[2]+r,f+n,c+r,h+n,d+r),s=h,l=d;break;case"C":s=o[5],l=o[6],f=o[3],c=o[4],t.bezierCurveTo(o[1]+n,o[2]+r,f+n,c+r,s+n,l+r);break;case"s":h=s+o[3],d=l+o[4],f=2*s-f,c=2*l-c,t.bezierCurveTo(f+n,c+r,s+o[1]+n,l+o[2]+r,h+n,d+r),f=s+o[1],c=l+o[2],s=h,l=d;break;case"S":h=o[3],d=o[4],f=2*s-f,c=2*l-c,t.bezierCurveTo(f+n,c+r,o[1]+n,o[2]+r,h+n,d+r),s=h,l=d,f=o[1],c=o[2];break;case"q":h=s+o[3],d=l+o[4],f=s+o[1],c=l+o[2],t.quadraticCurveTo(f+n,c+r,h+n,d+r),s=h,l=d;break;case"Q":h=o[3],d=o[4],t.quadraticCurveTo(o[1]+n,o[2]+r,h+n,d+r),s=h,l=d,f=o[1],c=o[2];break;case"t":h=s+o[1],d=l+o[2],u[0].match(/[QqTt]/)===null?(f=s,c=l):u[0]==="t"?(f=2*s-g,c=2*l-p):u[0]==="q"&&(f=2*s-f,c=2*l-c),g=f,p=c,t.quadraticCurveTo(f+n,c+r,h+n,d+r),s=h,l=d,f=s+o[1],c=l+o[2];break;case"T":h=o[1],d=o[2],f=2*s-f,c=2*l-c,t.quadraticCurveTo(f+n,c+r,h+n,d+r),s=h,l=d;break;case"a":dv(t,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+s+n,o[7]+l+r]),s+=o[6],l+=o[7];break;case"A":dv(t,s+n,l+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),s=o[6],l=o[7];break;case"z":case"Z":t.closePath();break}u=o}}function dv(t,e,n,r){const i=bT(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let a=0;a<i.length;++a){const o=wT(i[a]);t.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}const gv=.5773502691896257,pv={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,On)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,a=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-a),t.lineTo(i,-a),t.lineTo(0,-n),t.lineTo(-i,-a),t.lineTo(-r,-a),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Ji*n,i=r-n*gv,a=n/4;t.moveTo(0,-r-i),t.lineTo(-a,r-i),t.lineTo(a,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=Ji*n,i=r-n*gv;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Ji*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Ji*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Ji*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=Ji*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function H5(t){return K(pv,t)?pv[t]:MT(t)}var kh={};function MT(t){if(!K(kh,t)){const e=Ta(t);kh[t]={draw:function(n,r){vu(n,e,0,0,Math.sqrt(r)/2)}}}return kh[t]}const _r=.448084975506;function kT(t){return t.x}function AT(t){return t.y}function ET(t){return t.width}function CT(t){return t.height}function rr(t){return typeof t=="function"?t:()=>+t}function Es(t,e,n){return Math.max(e,Math.min(t,n))}function G5(){var t=kT,e=AT,n=ET,r=CT,i=rr(0),a=i,o=i,u=i,s=null;function l(f,c,h){var d,g=c!=null?c:+t.call(this,f),p=h!=null?h:+e.call(this,f),m=+n.call(this,f),y=+r.call(this,f),v=Math.min(m,y)/2,x=Es(+i.call(this,f),0,v),b=Es(+a.call(this,f),0,v),_=Es(+o.call(this,f),0,v),M=Es(+u.call(this,f),0,v);if(s||(s=d=Ui()),x<=0&&b<=0&&_<=0&&M<=0)s.rect(g,p,m,y);else{var w=g+m,A=p+y;s.moveTo(g+x,p),s.lineTo(w-b,p),s.bezierCurveTo(w-_r*b,p,w,p+_r*b,w,p+b),s.lineTo(w,A-M),s.bezierCurveTo(w,A-_r*M,w-_r*M,A,w-M,A),s.lineTo(g+_,A),s.bezierCurveTo(g+_r*_,A,g,A-_r*_,g,A-_),s.lineTo(g,p+x),s.bezierCurveTo(g,p+_r*x,g+_r*x,p,g+x,p),s.closePath()}if(d)return s=null,d+""||null}return l.x=function(f){return arguments.length?(t=rr(f),l):t},l.y=function(f){return arguments.length?(e=rr(f),l):e},l.width=function(f){return arguments.length?(n=rr(f),l):n},l.height=function(f){return arguments.length?(r=rr(f),l):r},l.cornerRadius=function(f,c,h,d){return arguments.length?(i=rr(f),a=c!=null?rr(c):i,u=h!=null?rr(h):i,o=d!=null?rr(d):a,l):i},l.context=function(f){return arguments.length?(s=f==null?null:f,l):s},l}function V5(){var t,e,n,r,i=null,a,o,u,s;function l(c,h,d){const g=d/2;if(a){var p=u-h,m=c-o;if(p||m){var y=Math.sqrt(p*p+m*m),v=(p/=y)*s,x=(m/=y)*s,b=Math.atan2(m,p);i.moveTo(o-v,u-x),i.lineTo(c-p*g,h-m*g),i.arc(c,h,g,b-Math.PI,b),i.lineTo(o+v,u+x),i.arc(o,u,s,b,b+Math.PI)}else i.arc(c,h,g,0,On);i.closePath()}else a=1;o=c,u=h,s=g}function f(c){var h,d=c.length,g,p=!1,m;for(i==null&&(i=m=Ui()),h=0;h<=d;++h)!(h<d&&r(g=c[h],h,c))===p&&(p=!p)&&(a=0),p&&l(+t(g,h,c),+e(g,h,c),+n(g,h,c));if(m)return i=null,m+""||null}return f.x=function(c){return arguments.length?(t=c,f):t},f.y=function(c){return arguments.length?(e=c,f):e},f.size=function(c){return arguments.length?(n=c,f):n},f.defined=function(c){return arguments.length?(r=c,f):r},f.context=function(c){return arguments.length?(c==null?i=null:i=c,f):i},f}function Gu(t,e){return t!=null?t:e}const Vu=t=>t.x||0,Xu=t=>t.y||0,ST=t=>t.width||0,DT=t=>t.height||0,$T=t=>(t.x||0)+(t.width||0),FT=t=>(t.y||0)+(t.height||0),TT=t=>t.startAngle||0,RT=t=>t.endAngle||0,NT=t=>t.padAngle||0,OT=t=>t.innerRadius||0,zT=t=>t.outerRadius||0,LT=t=>t.cornerRadius||0,BT=t=>Gu(t.cornerRadiusTopLeft,t.cornerRadius)||0,PT=t=>Gu(t.cornerRadiusTopRight,t.cornerRadius)||0,UT=t=>Gu(t.cornerRadiusBottomRight,t.cornerRadius)||0,IT=t=>Gu(t.cornerRadiusBottomLeft,t.cornerRadius)||0,qT=t=>Gu(t.size,64),jT=t=>t.size||1,dc=t=>t.defined!==!1,YT=t=>H5(t.shape||"circle"),WT=h9().startAngle(TT).endAngle(RT).padAngle(NT).innerRadius(OT).outerRadius(zT).cornerRadius(LT),HT=gM().x(Vu).y1(Xu).y0(FT).defined(dc),GT=gM().y(Xu).x1(Vu).x0($T).defined(dc),VT=dM().x(Vu).y(Xu).defined(dc),XT=G5().x(Vu).y(Xu).width(ST).height(DT).cornerRadius(BT,PT,UT,IT),ZT=g9().type(YT).size(qT),KT=V5().x(Vu).y(Xu).defined(dc).size(jT);function Mp(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function QT(t,e){return WT.context(t)(e)}function JT(t,e){const n=e[0],r=n.interpolate||"linear";return(n.orient==="horizontal"?GT:HT).curve(_p(r,n.orient,n.tension)).context(t)(e)}function tR(t,e){const n=e[0],r=n.interpolate||"linear";return VT.curve(_p(r,n.orient,n.tension)).context(t)(e)}function Xa(t,e,n,r){return XT.context(t)(e,n,r)}function eR(t,e){return(e.mark.shape||e.shape).context(t)(e)}function nR(t,e){return ZT.context(t)(e)}function rR(t,e){return KT.context(t)(e)}var X5=1;function Z5(){X5=1}function kp(t,e,n){var r=e.clip,i=t._defs,a=e.clip_id||(e.clip_id="clip"+X5++),o=i.clipping[a]||(i.clipping[a]={id:a});return nt(r)?o.path=r(null):Mp(n)?o.path=Xa(null,n,0,0):(o.width=n.width||0,o.height=n.height||0),"url(#"+a+")"}function jt(t){this.clear(),t&&this.union(t)}jt.prototype={clone(){return new jt(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:a,y2:o}=this,u=Math.cos(t),s=Math.sin(t),l=e-e*u+n*s,f=n-e*s-n*u;return[u*r-s*i+l,s*r+u*i+f,u*r-s*o+l,s*r+u*o+f,u*a-s*i+l,s*a+u*i+f,u*a-s*o+l,s*a+u*o+f]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}};function gc(t){this.mark=t,this.bounds=this.bounds||new jt}function pc(t){gc.call(this,t),this.items=this.items||[]}P(pc,gc);function Ap(t){this._pending=0,this._loader=t||jf()}function mv(t){t._pending+=1}function mo(t){t._pending-=1}Ap.prototype={pending(){return this._pending},sanitizeURL(t){const e=this;return mv(e),e._loader.sanitize(t,{context:"href"}).then(n=>(mo(e),n)).catch(()=>(mo(e),null))},loadImage(t){const e=this,n=T9();return mv(e),e._loader.sanitize(t,{context:"image"}).then(r=>{const i=r.href;if(!i||!n)throw{url:i};const a=new n,o=K(r,"crossOrigin")?r.crossOrigin:"anonymous";return o!=null&&(a.crossOrigin=o),a.onload=()=>mo(e),a.onerror=()=>mo(e),a.src=i,a}).catch(r=>(mo(e),{complete:!1,width:0,height:0,src:r&&r.url||""}))},ready(){const t=this;return new Promise(e=>{function n(r){t.pending()?setTimeout(()=>{n(!0)},10):e(r)}n(!1)})}};function vr(t,e,n){if(e.stroke&&e.opacity!==0&&e.strokeOpacity!==0){const r=e.strokeWidth!=null?+e.strokeWidth:1;t.expand(r+(n?iR(e,r):0))}return t}function iR(t,e){return t.strokeJoin&&t.strokeJoin!=="miter"?0:e}const aR=On-1e-8;let mc,el,nl,mi,J0,rl,td,ed;const Tr=(t,e)=>mc.add(t,e),il=(t,e)=>Tr(el=t,nl=e),yv=t=>Tr(t,mc.y1),vv=t=>Tr(mc.x1,t),di=(t,e)=>J0*t+td*e,gi=(t,e)=>rl*t+ed*e,Ah=(t,e)=>Tr(di(t,e),gi(t,e)),Eh=(t,e)=>il(di(t,e),gi(t,e));function Zu(t,e){return mc=t,e?(mi=e*Vr,J0=ed=Math.cos(mi),rl=Math.sin(mi),td=-rl):(J0=ed=1,mi=rl=td=0),oR}const oR={beginPath(){},closePath(){},moveTo:Eh,lineTo:Eh,rect(t,e,n,r){mi?(Ah(t+n,e),Ah(t+n,e+r),Ah(t,e+r),Eh(t,e)):(Tr(t+n,e+r),il(t,e))},quadraticCurveTo(t,e,n,r){const i=di(t,e),a=gi(t,e),o=di(n,r),u=gi(n,r);xv(el,i,o,yv),xv(nl,a,u,vv),il(o,u)},bezierCurveTo(t,e,n,r,i,a){const o=di(t,e),u=gi(t,e),s=di(n,r),l=gi(n,r),f=di(i,a),c=gi(i,a);bv(el,o,s,f,yv),bv(nl,u,l,c,vv),il(f,c)},arc(t,e,n,r,i,a){if(r+=mi,i+=mi,el=n*Math.cos(i)+t,nl=n*Math.sin(i)+e,Math.abs(i-r)>aR)Tr(t-n,e-n),Tr(t+n,e+n);else{const o=l=>Tr(n*Math.cos(l)+t,n*Math.sin(l)+e);let u,s;if(o(r),o(i),i!==r)if(r=r%On,r<0&&(r+=On),i=i%On,i<0&&(i+=On),i<r&&(a=!a,u=r,r=i,i=u),a)for(i-=On,u=r-r%hi,s=0;s<4&&u>i;++s,u-=hi)o(u);else for(u=r-r%hi+hi,s=0;s<4&&u<i;++s,u=u+hi)o(u)}}};function xv(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function bv(t,e,n,r,i){const a=r-t+3*e-3*n,o=t+n-2*e,u=t-e;let s=0,l=0,f;Math.abs(a)>xT?(f=o*o+u*a,f>=0&&(f=Math.sqrt(f),s=(-o+f)/a,l=(-o-f)/a)):s=.5*u/o,0<s&&s<1&&i(wv(s,t,e,n,r)),0<l&&l<1&&i(wv(l,t,e,n,r))}function wv(t,e,n,r,i){const a=1-t,o=a*a,u=t*t;return o*a*e+3*o*t*n+3*a*u*r+u*t*i}var qr=(qr=Ga(1,1))?qr.getContext("2d"):null;const nd=new jt;function Ep(t){return function(e,n){if(!qr)return!0;t(qr,e),nd.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:a,y2:o}=nd;for(let u=i;u<=o;++u)for(let s=r;s<=a;++s)if(qr.isPointInPath(s,u))return!0;return!1}}function Cp(t,e){return e.contains(t.x||0,t.y||0)}function K5(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,a=t.height||0;return e.intersects(nd.set(n,r,n+i,r+a))}function Q5(t,e){const n=t.x||0,r=t.y||0,i=t.x2!=null?t.x2:n,a=t.y2!=null?t.y2:r;return ca(e,n,r,i,a)}function ca(t,e,n,r,i){const{x1:a,y1:o,x2:u,y2:s}=t,l=r-e,f=i-n;let c=0,h=1,d,g,p,m;for(m=0;m<4;++m){if(m===0&&(d=-l,g=-(a-e)),m===1&&(d=l,g=u-e),m===2&&(d=-f,g=-(o-n)),m===3&&(d=f,g=s-n),Math.abs(d)<1e-10&&g<0)return!1;if(p=g/d,d<0){if(p>h)return!1;p>c&&(c=p)}else if(d>0){if(p<c)return!1;p<h&&(h=p)}}return!0}function Ra(t,e){t.globalCompositeOperation=e.blend||"source-over"}function dn(t,e){return t==null?e:t}function _v(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function uR(t,e,n){const r=n.width(),i=n.height();let a;if(e.gradient==="radial")a=t.createRadialGradient(n.x1+dn(e.x1,.5)*r,n.y1+dn(e.y1,.5)*i,Math.max(r,i)*dn(e.r1,0),n.x1+dn(e.x2,.5)*r,n.y1+dn(e.y2,.5)*i,Math.max(r,i)*dn(e.r2,.5));else{const o=dn(e.x1,0),u=dn(e.y1,0),s=dn(e.x2,1),l=dn(e.y2,0);if(o===s||u===l||r===i)a=t.createLinearGradient(n.x1+o*r,n.y1+u*i,n.x1+s*r,n.y1+l*i);else{const f=Ga(Math.ceil(r),Math.ceil(i)),c=f.getContext("2d");return c.scale(r,i),c.fillStyle=_v(c.createLinearGradient(o,u,s,l),e.stops),c.fillRect(0,0,r,i),t.createPattern(f,"no-repeat")}}return _v(a,e.stops)}function J5(t,e,n){return wp(n)?uR(t,n,e.bounds):n}function Ll(t,e,n){return n*=e.fillOpacity==null?1:e.fillOpacity,n>0?(t.globalAlpha=n,t.fillStyle=J5(t,e,e.fill),!0):!1}var sR=[];function Na(t,e,n){var r=(r=e.strokeWidth)!=null?r:1;return r<=0?!1:(n*=e.strokeOpacity==null?1:e.strokeOpacity,n>0?(t.globalAlpha=n,t.strokeStyle=J5(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||sR),t.lineDashOffset=e.strokeDashOffset||0),!0):!1)}function lR(t,e){return t.zindex-e.zindex||t.index-e.index}function Sp(t){if(!t.zdirty)return t.zitems;var e=t.items,n=[],r,i,a;for(i=0,a=e.length;i<a;++i)r=e[i],r.index=i,r.zindex&&n.push(r);return t.zdirty=!1,t.zitems=n.sort(lR)}function Sn(t,e){var n=t.items,r,i;if(!n||!n.length)return;const a=Sp(t);if(a&&a.length){for(r=0,i=n.length;r<i;++r)n[r].zindex||e(n[r]);n=a}for(r=0,i=n.length;r<i;++r)e(n[r])}function Bl(t,e){var n=t.items,r,i;if(!n||!n.length)return null;const a=Sp(t);for(a&&a.length&&(n=a),i=n.length;--i>=0;)if(r=e(n[i]))return r;if(n===a){for(n=t.items,i=n.length;--i>=0;)if(!n[i].zindex&&(r=e(n[i])))return r}return null}function Dp(t){return function(e,n,r){Sn(n,i=>{(!r||r.intersects(i.bounds))&&tk(t,e,i,i)})}}function fR(t){return function(e,n,r){n.items.length&&(!r||r.intersects(n.bounds))&&tk(t,e,n.items[0],n.items)}}function tk(t,e,n,r){var i=n.opacity==null?1:n.opacity;i!==0&&(t(e,r)||(Ra(e,n),n.fill&&Ll(e,n,i)&&e.fill(),n.stroke&&Na(e,n,i)&&e.stroke()))}function yc(t){return t=t||sn,function(e,n,r,i,a,o){return r*=e.pixelRatio,i*=e.pixelRatio,Bl(n,u=>{const s=u.bounds;if(!(s&&!s.contains(a,o)||!s)&&t(e,u,r,i,a,o))return u})}}function Ku(t,e){return function(n,r,i,a){var o=Array.isArray(r)?r[0]:r,u=e==null?o.fill:e,s=o.stroke&&n.isPointInStroke,l,f;return s&&(l=o.strokeWidth,f=o.strokeCap,n.lineWidth=l!=null?l:1,n.lineCap=f!=null?f:"butt"),t(n,r)?!1:u&&n.isPointInPath(i,a)||s&&n.isPointInStroke(i,a)}}function $p(t){return yc(Ku(t))}function bi(t,e){return"translate("+t+","+e+")"}function Fp(t){return"rotate("+t+")"}function cR(t,e){return"scale("+t+","+e+")"}function ek(t){return bi(t.x||0,t.y||0)}function hR(t){return bi(t.x||0,t.y||0)+(t.angle?" "+Fp(t.angle):"")}function dR(t){return bi(t.x||0,t.y||0)+(t.angle?" "+Fp(t.angle):"")+(t.scaleX||t.scaleY?" "+cR(t.scaleX||1,t.scaleY||1):"")}function Tp(t,e,n){function r(o,u){o("transform",hR(u)),o("d",e(null,u))}function i(o,u){return e(Zu(o,u.angle),u),vr(o,u).translate(u.x||0,u.y||0)}function a(o,u){var s=u.x||0,l=u.y||0,f=u.angle||0;o.translate(s,l),f&&o.rotate(f*=Vr),o.beginPath(),e(o,u),f&&o.rotate(-f),o.translate(-s,-l)}return{type:t,tag:"path",nested:!1,attr:r,bound:i,draw:Dp(a),pick:$p(a),isect:n||Ep(a)}}var gR=Tp("arc",QT);function pR(t,e){for(var n=t[0].orient==="horizontal"?e[1]:e[0],r=t[0].orient==="horizontal"?"y":"x",i=t.length,a=1/0,o,u;--i>=0;)t[i].defined!==!1&&(u=Math.abs(t[i][r]-n),u<a&&(a=u,o=t[i]));return o}function mR(t,e){for(var n=Math.pow(t[0].strokeWidth||1,2),r=t.length,i,a,o;--r>=0;)if(t[r].defined!==!1&&(i=t[r].x-e[0],a=t[r].y-e[1],o=i*i+a*a,o<n))return t[r];return null}function yR(t,e){for(var n=t.length,r,i,a;--n>=0;)if(t[n].defined!==!1&&(r=t[n].x-e[0],i=t[n].y-e[1],a=r*r+i*i,r=t[n].size||1,a<r*r))return t[n];return null}function Rp(t,e,n){function r(s,l){var f=l.mark.items;f.length&&s("d",e(null,f))}function i(s,l){var f=l.items;return f.length===0?s:(e(Zu(s),f),vr(s,f[0]))}function a(s,l){s.beginPath(),e(s,l)}const o=Ku(a);function u(s,l,f,c,h,d){var g=l.items,p=l.bounds;return!g||!g.length||p&&!p.contains(h,d)?null:(f*=s.pixelRatio,c*=s.pixelRatio,o(s,g,f,c)?g[0]:null)}return{type:t,tag:"path",nested:!0,attr:r,bound:i,draw:fR(a),pick:u,isect:Cp,tip:n}}var vR=Rp("area",JT,pR);function xR(t,e){var n=e.clip;t.save(),nt(n)?(t.beginPath(),n(t),t.clip()):nk(t,e.group)}function nk(t,e){t.beginPath(),Mp(e)?Xa(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function rk(t){const e=dn(t.strokeWidth,1);return t.strokeOffset!=null?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function bR(t,e){t("transform",ek(e))}function ik(t,e){const n=rk(e);t("d",Xa(null,e,n,n))}function wR(t,e){t("class","background"),t("aria-hidden",!0),ik(t,e)}function _R(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?ik(t,e):t("d","")}function MR(t,e,n){const r=e.clip?kp(n,e,e):null;t("clip-path",r)}function kR(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let i=0;i<r;++i)t.union(n[i].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),vr(t,e),t.translate(e.x||0,e.y||0)}function xu(t,e,n,r){const i=rk(e);t.beginPath(),Xa(t,e,(n||0)+i,(r||0)+i)}const AR=Ku(xu),ER=Ku(xu,!1),CR=Ku(xu,!0);function SR(t,e,n){Sn(e,r=>{const i=r.x||0,a=r.y||0,o=r.strokeForeground,u=r.opacity==null?1:r.opacity;(r.stroke||r.fill)&&u&&(xu(t,r,i,a),Ra(t,r),r.fill&&Ll(t,r,u)&&t.fill(),r.stroke&&!o&&Na(t,r,u)&&t.stroke()),t.save(),t.translate(i,a),r.clip&&nk(t,r),n&&n.translate(-i,-a),Sn(r,s=>{this.draw(t,s,n)}),n&&n.translate(i,a),t.restore(),o&&r.stroke&&u&&(xu(t,r,i,a),Ra(t,r),Na(t,r,u)&&t.stroke())})}function DR(t,e,n,r,i,a){if(e.bounds&&!e.bounds.contains(i,a)||!e.items)return null;const o=n*t.pixelRatio,u=r*t.pixelRatio;return Bl(e,s=>{let l,f,c;const h=s.bounds;if(h&&!h.contains(i,a))return;f=s.x||0,c=s.y||0;const d=f+(s.width||0),g=c+(s.height||0),p=s.clip;if(p&&(i<f||i>d||a<c||a>g))return;if(t.save(),t.translate(f,c),f=i-f,c=a-c,p&&Mp(s)&&!CR(t,s,o,u))return t.restore(),null;const m=s.strokeForeground,y=e.interactive!==!1;return y&&m&&s.stroke&&ER(t,s,o,u)?(t.restore(),s):(l=Bl(s,v=>$R(v,f,c)?this.pick(v,n,r,f,c):null),!l&&y&&(s.fill||!m&&s.stroke)&&AR(t,s,o,u)&&(l=s),t.restore(),l||null)})}function $R(t,e,n){return(t.interactive!==!1||t.marktype==="group")&&t.bounds&&t.bounds.contains(e,n)}var FR={type:"group",tag:"g",nested:!1,attr:bR,bound:kR,draw:SR,pick:DR,isect:K5,content:MR,background:wR,foreground:_R},bu={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Np(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then(r=>{t.image=r,t.image.url=t.url})),n}function Op(t,e){return t.width!=null?t.width:!e||!e.width?0:t.aspect!==!1&&t.height?t.height*e.width/e.height:e.width}function zp(t,e){return t.height!=null?t.height:!e||!e.height?0:t.aspect!==!1&&t.width?t.width*e.height/e.width:e.height}function vc(t,e){return t==="center"?e/2:t==="right"?e:0}function xc(t,e){return t==="middle"?e/2:t==="bottom"?e:0}function TR(t,e,n){const r=Np(e,n),i=Op(e,r),a=zp(e,r),o=(e.x||0)-vc(e.align,i),u=(e.y||0)-xc(e.baseline,a),s=!r.src&&r.toDataURL?r.toDataURL():r.src||"";t("href",s,bu["xmlns:xlink"],"xlink:href"),t("transform",bi(o,u)),t("width",i),t("height",a),t("preserveAspectRatio",e.aspect===!1?"none":"xMidYMid")}function RR(t,e){const n=e.image,r=Op(e,n),i=zp(e,n),a=(e.x||0)-vc(e.align,r),o=(e.y||0)-xc(e.baseline,i);return t.set(a,o,a+r,o+i)}function NR(t,e,n){Sn(e,r=>{if(n&&!n.intersects(r.bounds))return;const i=Np(r,this);let a=Op(r,i),o=zp(r,i);if(a===0||o===0)return;let u=(r.x||0)-vc(r.align,a),s=(r.y||0)-xc(r.baseline,o),l,f,c,h;r.aspect!==!1&&(f=i.width/i.height,c=r.width/r.height,f===f&&c===c&&f!==c&&(c<f?(h=a/f,s+=(o-h)/2,o=h):(h=o*f,u+=(a-h)/2,a=h))),(i.complete||i.toDataURL)&&(Ra(t,r),t.globalAlpha=(l=r.opacity)!=null?l:1,t.imageSmoothingEnabled=r.smooth!==!1,t.drawImage(i,u,s,a,o))})}var OR={type:"image",tag:"image",nested:!1,attr:TR,bound:RR,draw:NR,pick:yc(),isect:sn,get:Np,xOffset:vc,yOffset:xc},zR=Rp("line",tR,mR);function LR(t,e){var n=e.scaleX||1,r=e.scaleY||1;(n!==1||r!==1)&&t("vector-effect","non-scaling-stroke"),t("transform",dR(e)),t("d",e.path)}function al(t,e){var n=e.path;if(n==null)return!0;var r=e.x||0,i=e.y||0,a=e.scaleX||1,o=e.scaleY||1,u=(e.angle||0)*Vr,s=e.pathCache;(!s||s.path!==n)&&((e.pathCache=s=Ta(n)).path=n),u&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(u),vu(t,s,0,0,a,o),t.rotate(-u),t.translate(-r,-i)):vu(t,s,r,i,a,o)}function BR(t,e){return al(Zu(t,e.angle),e)?t.set(0,0,0,0):vr(t,e,!0)}var PR={type:"path",tag:"path",nested:!1,attr:LR,bound:BR,draw:Dp(al),pick:$p(al),isect:Ep(al)};function UR(t,e){t("d",Xa(null,e))}function IR(t,e){var n,r;return vr(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)}function Mv(t,e){t.beginPath(),Xa(t,e)}var qR={type:"rect",tag:"path",nested:!1,attr:UR,bound:IR,draw:Dp(Mv),pick:$p(Mv),isect:K5};function jR(t,e){t("transform",ek(e)),t("x2",e.x2!=null?e.x2-(e.x||0):0),t("y2",e.y2!=null?e.y2-(e.y||0):0)}function YR(t,e){var n,r;return vr(t.set(n=e.x||0,r=e.y||0,e.x2!=null?e.x2:n,e.y2!=null?e.y2:r),e)}function ak(t,e,n){var r,i,a,o;return e.stroke&&Na(t,e,n)?(r=e.x||0,i=e.y||0,a=e.x2!=null?e.x2:r,o=e.y2!=null?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(a,o),!0):!1}function WR(t,e,n){Sn(e,r=>{if(!(n&&!n.intersects(r.bounds))){var i=r.opacity==null?1:r.opacity;i&&ak(t,r,i)&&(Ra(t,r),t.stroke())}})}function HR(t,e,n,r){return t.isPointInStroke?ak(t,e,1)&&t.isPointInStroke(n,r):!1}var GR={type:"rule",tag:"line",nested:!1,attr:jR,bound:YR,draw:WR,pick:yc(HR),isect:Q5},VR=Tp("shape",eR),XR=Tp("symbol",nR,Cp);const kv=e_();var qn={height:Jn,measureWidth:Lp,estimateWidth:rd,width:rd,canvas:ok};ok(!0);function ok(t){qn.width=t&&qr?Lp:rd}function rd(t,e){return uk(Zr(t,e),Jn(t))}function uk(t,e){return~~(.8*t.length*e)}function Lp(t,e){return Jn(t)<=0||!(e=Zr(t,e))?0:sk(e,bc(t))}function sk(t,e){const n=`(${e}) ${t}`;let r=kv.get(n);return r===void 0&&(qr.font=e,r=qr.measureText(t).width,kv.set(n,r)),r}function Jn(t){return t.fontSize!=null?+t.fontSize||0:11}function Xr(t){return t.lineHeight!=null?t.lineHeight:Jn(t)+2}function ZR(t){return G(t)?t.length>1?t:t[0]:t}function Qu(t){return ZR(t.lineBreak&&t.text&&!G(t.text)?t.text.split(t.lineBreak):t.text)}function Bp(t){const e=Qu(t);return(G(e)?e.length-1:0)*Xr(t)}function Zr(t,e){const n=e==null?"":(e+"").trim();return t.limit>0&&n.length?QR(t,n):n}function KR(t){if(qn.width===Lp){const e=bc(t);return n=>sk(n,e)}else{const e=Jn(t);return n=>uk(n,e)}}function QR(t,e){var n=+t.limit,r=KR(t);if(r(e)<n)return e;var i=t.ellipsis||"…",a=t.dir==="rtl",o=0,u=e.length,s;if(n-=r(i),a){for(;o<u;)s=o+u>>>1,r(e.slice(s))>n?o=s+1:u=s;return i+e.slice(o)}else{for(;o<u;)s=1+(o+u>>>1),r(e.slice(0,s))<n?o=s:u=s-1;return e.slice(0,o)+i}}function Ju(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function bc(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+Jn(t)+"px "+Ju(t,e)}function Pp(t){var e=t.baseline,n=Jn(t);return Math.round(e==="top"?.79*n:e==="middle"?.3*n:e==="bottom"?-.21*n:e==="line-top"?.29*n+.5*Xr(t):e==="line-bottom"?.29*n-.5*Xr(t):0)}const JR={left:"start",center:"middle",right:"end"},Xo=new jt;function wc(t){var e=t.x||0,n=t.y||0,r=t.radius||0,i;return r&&(i=(t.theta||0)-hi,e+=r*Math.cos(i),n+=r*Math.sin(i)),Xo.x1=e,Xo.y1=n,Xo}function tN(t,e){var n=e.dx||0,r=(e.dy||0)+Pp(e),i=wc(e),a=i.x1,o=i.y1,u=e.angle||0,s;t("text-anchor",JR[e.align]||"start"),u?(s=bi(a,o)+" "+Fp(u),(n||r)&&(s+=" "+bi(n,r))):s=bi(a+n,o+r),t("transform",s)}function Up(t,e,n){var r=qn.height(e),i=e.align,a=wc(e),o=a.x1,u=a.y1,s=e.dx||0,l=(e.dy||0)+Pp(e)-Math.round(.8*r),f=Qu(e),c;if(G(f)?(r+=Xr(e)*(f.length-1),c=f.reduce((h,d)=>Math.max(h,qn.width(e,d)),0)):c=qn.width(e,f),i==="center"?s-=c/2:i==="right"&&(s-=c),t.set(s+=o,l+=u,s+c,l+r),e.angle&&!n)t.rotate(e.angle*Vr,o,u);else if(n===2)return t.rotatedPoints(e.angle*Vr,o,u);return t}function eN(t,e,n){Sn(e,r=>{var i=r.opacity==null?1:r.opacity,a,o,u,s,l,f,c;if(!(n&&!n.intersects(r.bounds)||i===0||r.fontSize<=0||r.text==null||r.text.length===0)){if(t.font=bc(r),t.textAlign=r.align||"left",a=wc(r),o=a.x1,u=a.y1,r.angle&&(t.save(),t.translate(o,u),t.rotate(r.angle*Vr),o=u=0),o+=r.dx||0,u+=(r.dy||0)+Pp(r),f=Qu(r),Ra(t,r),G(f))for(l=Xr(r),s=0;s<f.length;++s)c=Zr(r,f[s]),r.fill&&Ll(t,r,i)&&t.fillText(c,o,u),r.stroke&&Na(t,r,i)&&t.strokeText(c,o,u),u+=l;else c=Zr(r,f),r.fill&&Ll(t,r,i)&&t.fillText(c,o,u),r.stroke&&Na(t,r,i)&&t.strokeText(c,o,u);r.angle&&t.restore()}})}function nN(t,e,n,r,i,a){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var o=wc(e),u=o.x1,s=o.y1,l=Up(Xo,e,1),f=-e.angle*Vr,c=Math.cos(f),h=Math.sin(f),d=c*i-h*a+(u-c*u+h*s),g=h*i+c*a+(s-h*u-c*s);return l.contains(d,g)}function rN(t,e){const n=Up(Xo,t,2);return ca(e,n[0],n[1],n[2],n[3])||ca(e,n[0],n[1],n[4],n[5])||ca(e,n[4],n[5],n[6],n[7])||ca(e,n[2],n[3],n[6],n[7])}var iN={type:"text",tag:"text",nested:!1,attr:tN,bound:Up,draw:eN,pick:yc(nN),isect:rN},aN=Rp("trail",rR,yR),Ze={arc:gR,area:vR,group:FR,image:OR,line:zR,path:PR,rect:qR,rule:GR,shape:VR,symbol:XR,text:iN,trail:aN};function id(t,e,n){var r=Ze[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new jt),t,n)}var Av={mark:null};function lk(t,e,n){var r=Ze[t.marktype],i=r.bound,a=t.items,o=a&&a.length,u,s,l,f;if(r.nested)return o?l=a[0]:(Av.mark=t,l=Av),f=id(l,i,n),e=e&&e.union(f)||f,e;if(e=e||t.bounds&&t.bounds.clear()||new jt,o)for(u=0,s=a.length;u<s;++u)e.union(id(a[u],i,n));return t.bounds=e}const oN=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function fk(t,e){return JSON.stringify(t,oN,e)}function ck(t){const e=typeof t=="string"?JSON.parse(t):t;return hk(e)}function hk(t){var e=t.marktype,n=t.items,r,i,a;if(n)for(i=0,a=n.length;i<a;++i)r=e?"mark":"group",n[i][r]=t,n[i].zindex&&(n[i][r].zdirty=!0),(e||r)==="group"&&hk(n[i]);return e&&lk(t),t}function Ip(t){arguments.length?this.root=ck(t):(this.root=dk({marktype:"group",name:"root",role:"frame"}),this.root.items=[new pc(this.root)])}Ip.prototype={toJSON(t){return fk(this.root,t||0)},mark(t,e,n){e=e||this.root.items[0];const r=dk(t,e);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}};function dk(t,e){const n={bounds:new jt,clip:!!t.clip,group:e,interactive:t.interactive!==!1,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return t.aria!=null&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function Rr(t,e,n){return!t&&typeof document<"u"&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function qp(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function Re(t,e,n,r){var i=t.childNodes[e],a;return(!i||i.tagName.toLowerCase()!==n.toLowerCase())&&(a=i||null,i=Rr(t.ownerDocument,n,r),t.insertBefore(i,a)),i}function yn(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function gk(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function _c(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}function uN(t,e,n,r){var i=t&&t.mark,a,o;if(i&&(a=Ze[i.marktype]).tip){for(o=_c(e,n),o[0]-=r[0],o[1]-=r[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=a.tip(i.items,o)}return t}function Kr(t,e){this._active=null,this._handlers={},this._loader=t||jf(),this._tooltip=e||sN}function sN(t,e,n,r){t.element().setAttribute("title",r||"")}Kr.prototype={initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()},scene(t){return arguments.length?(this._scene=t,this):this._scene},on(){},off(){},_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1},handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const r in e)n.push(...e[r]);return n},eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)},handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then(r=>{const i=new MouseEvent(t.type,t),a=Rr(null,"a");for(const o in r)a.setAttribute(o,r[o]);a.dispatchEvent(i)}).catch(()=>{})},handleTooltip(t,e,n){if(e&&e.tooltip!=null){e=uN(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}},getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,a=i.width(),o=i.height();let u=i.x1+r[0]+n.left,s=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)u+=t.x||0,s+=t.y||0;return{x:u,y:s,width:a,height:o,left:u,top:s,right:u+a,bottom:s+o}}};function tr(t){this._el=null,this._bgcolor=null,this._loader=new Ap(t)}tr.prototype={initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)},element(){return this._el},canvas(){return this._el&&this._el.firstChild},background(t){return arguments.length===0?this._bgcolor:(this._bgcolor=t,this)},resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this},dirty(){},render(t){const e=this;return e._call=function(){e._render(t)},e._call(),e._call=null,e},_render(){},renderAsync(t){const e=this.render(t);return this._ready?this._ready.then(()=>e):Promise.resolve(e)},_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const i=n._call;n._ready=n._loader.ready().then(a=>{a&&i(),n._ready=null})}return r},sanitizeURL(t){return this._load("sanitizeURL",t)},loadImage(t){return this._load("loadImage",t)}};const lN="keydown",fN="keypress",cN="keyup",pk="dragenter",ol="dragleave",mk="dragover",ad="mousedown",hN="mouseup",Pl="mousemove",Zo="mouseout",yk="mouseover",Ul="click",dN="dblclick",gN="wheel",vk="mousewheel",Il="touchstart",ql="touchmove",jl="touchend",pN=[lN,fN,cN,pk,ol,mk,ad,hN,Pl,Zo,yk,Ul,dN,gN,vk,Il,ql,jl],od=Pl,wu=Zo,ud=Ul;function ts(t,e){Kr.call(this,t,e),this._down=null,this._touch=null,this._first=!0,this._events={}}const mN=t=>t===Il||t===ql||t===jl?[Il,ql,jl]:[t];function Ev(t,e){mN(e).forEach(n=>yN(t,n))}function yN(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?r=>t[e](r):r=>t.fire(e,r)))}function Cv(t,e,n){return function(r){const i=this._active,a=this.pickEvent(r);a===i?this.fire(t,r):((!i||!i.exit)&&this.fire(n,r),this._active=a,this.fire(e,r),this.fire(t,r))}}function Sv(t){return function(e){this.fire(t,e),this._active=null}}P(ts,Kr,{initialize(t,e,n){return this._canvas=t&&qp(t,"canvas"),[Ul,ad,Pl,Zo,ol].forEach(r=>Ev(this,r)),Kr.prototype.initialize.call(this,t,e,n)},canvas(){return this._canvas},context(){return this._canvas.getContext("2d")},events:pN,DOMMouseScroll(t){this.fire(vk,t)},mousemove:Cv(Pl,yk,Zo),dragover:Cv(mk,pk,ol),mouseout:Sv(Zo),dragleave:Sv(ol),mousedown(t){this._down=this._active,this.fire(ad,t)},click(t){this._down===this._active&&(this.fire(Ul,t),this._down=null)},touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(Il,t,!0)},touchmove(t){this.fire(ql,t,!0)},touchend(t){this.fire(jl,t,!0),this._touch=null},fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===ud&&r&&r.href?this.handleHref(e,r,r.href):(t===od||t===wu)&&this.handleTooltip(e,r,t!==wu),i)for(let a=0,o=i.length;a<o;++a)i[a].handler.call(this._obj,e,r)},on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(Ev(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this},pickEvent(t){const e=_c(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])},pick(t,e,n,r,i){const a=this.context();return Ze[t.marktype].pick.call(this,a,t,e,n,r,i)}});function vN(){return typeof window<"u"&&window.devicePixelRatio||1}var xN=vN();function bN(t,e,n,r,i,a){const o=typeof HTMLElement<"u"&&t instanceof HTMLElement&&t.parentNode!=null,u=t.getContext("2d"),s=o?xN:i;t.width=e*s,t.height=n*s;for(const l in a)u[l]=a[l];return o&&s!==1&&(t.style.width=e+"px",t.style.height=n+"px"),u.pixelRatio=s,u.setTransform(s,0,0,s,s*r[0],s*r[1]),t}function Yl(t){tr.call(this,t),this._options={},this._redraw=!1,this._dirty=new jt,this._tempb=new jt}const Dv=tr.prototype,wN=(t,e,n)=>new jt().set(0,0,e,n).translate(-t[0],-t[1]);function _N(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-(n[0]%1),-(n[1]%1)),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}P(Yl,tr,{initialize(t,e,n,r,i,a){return this._options=a||{},this._canvas=this._options.externalContext?null:Ga(1,1,this._options.type),t&&this._canvas&&(yn(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),Dv.initialize.call(this,t,e,n,r,i)},resize(t,e,n,r){if(Dv.resize.call(this,t,e,n,r),this._canvas)bN(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const i=this._options.externalContext;i||z("CanvasRenderer is missing a valid canvas or context"),i.scale(this._scale,this._scale),i.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas(){return this._canvas},context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)},_render(t){const e=this.context(),n=this._origin,r=this._width,i=this._height,a=this._dirty,o=wN(n,r,i);e.save();const u=this._redraw||a.empty()?(this._redraw=!1,o.expand(1)):_N(e,o.intersect(a),n);return this.clear(-n[0],-n[1],r,i),this.draw(e,t,u),e.restore(),a.clear(),this},draw(t,e,n){const r=Ze[e.marktype];e.clip&&xR(t,e),r.draw.call(this,t,e,n),e.clip&&t.restore()},clear(t,e,n,r){const i=this._options,a=this.context();i.type!=="pdf"&&!i.externalContext&&a.clearRect(t,e,n,r),this._bgcolor!=null&&(a.fillStyle=this._bgcolor,a.fillRect(t,e,n,r))}});function jp(t,e){Kr.call(this,t,e);const n=this;n._hrefHandler=sd(n,(r,i)=>{i&&i.href&&n.handleHref(r,i,i.href)}),n._tooltipHandler=sd(n,(r,i)=>{n.handleTooltip(r,i,r.type!==wu)})}const sd=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)};P(jp,Kr,{initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(ud,this._hrefHandler),r.removeEventListener(od,this._tooltipHandler),r.removeEventListener(wu,this._tooltipHandler)),this._svg=r=t&&qp(t,"svg"),r&&(r.addEventListener(ud,this._hrefHandler),r.addEventListener(od,this._tooltipHandler),r.addEventListener(wu,this._tooltipHandler)),Kr.prototype.initialize.call(this,t,e,n)},canvas(){return this._svg},on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const a={type:t,handler:e,listener:sd(this,e)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}});const xk="aria-hidden",Yp="aria-label",Wp="role",Hp="aria-roledescription",bk="graphics-object",Gp="graphics-symbol",wk=(t,e,n)=>({[Wp]:t,[Hp]:e,[Yp]:n||void 0}),MN=En(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),$v={axis:{desc:"axis",caption:EN},legend:{desc:"legend",caption:CN},"title-text":{desc:"title",caption:t=>`Title text '${Tv(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${Tv(t)}'`}},Fv={ariaRole:Wp,ariaRoleDescription:Hp,description:Yp};function _k(t,e){const n=e.aria===!1;if(t(xk,n||void 0),n||e.description==null)for(const r in Fv)t(Fv[r],void 0);else{const r=e.mark.marktype;t(Yp,e.description),t(Wp,e.ariaRole||(r==="group"?bk:Gp)),t(Hp,e.ariaRoleDescription||`${r} mark`)}}function Mk(t){return t.aria===!1?{[xk]:!0}:MN[t.role]?null:$v[t.role]?AN(t,$v[t.role]):kN(t)}function kN(t){const e=t.marktype,n=e==="group"||e==="text"||t.items.some(r=>r.description!=null&&r.aria!==!1);return wk(n?bk:Gp,`${e} mark container`,t.description)}function AN(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return wk(e.role||Gp,e.desc,n.description||r(n))}catch(n){return null}}function Tv(t){return Z(t.text).join(" ")}function EN(t){const e=t.datum,n=t.orient,r=e.title?kk(t):null,i=t.context,a=i.scales[e.scale].value,o=i.dataflow.locale(),u=a.type;return`${n==="left"||n==="right"?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${Fa(u)?"discrete":u} scale with ${I5(o,a,t)}`}function CN(t){const e=t.datum,n=e.title?kk(t):null,r=`${e.type||""} legend`.trim(),i=e.scales,a=Object.keys(i),o=t.context,u=o.scales[i[a[0]]].value,s=o.dataflow.locale();return DN(r)+(n?` titled '${n}'`:"")+` for ${SN(a)} with ${I5(s,u,t)}`}function kk(t){try{return Z(ot(t.items).items[0].text).join(" ")}catch(e){return null}}function SN(t){return t=t.map(e=>e+(e==="fill"||e==="stroke"?" color":"")),t.length<2?t[0]:t.slice(0,-1).join(", ")+" and "+ot(t)}function DN(t){return t.length?t[0].toUpperCase()+t.slice(1):t}const Ak=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),$N=t=>Ak(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function Vp(){let t="",e="",n="";const r=[],i=()=>e=n="",a=s=>{e&&(t+=`${e}>${n}`,i()),r.push(s)},o=(s,l)=>(l!=null&&(e+=` ${s}="${$N(l)}"`),u),u={open(s,...l){a(s),e="<"+s;for(const f of l)for(const c in f)o(c,f[c]);return u},close(){const s=r.pop();return e?t+=e+(n?`>${n}</${s}>`:"/>"):t+=`</${s}>`,i(),u},attr:o,text:s=>(n+=Ak(s),u),toString:()=>t};return u}const Ek=t=>Ck(Vp(),t)+"";function Ck(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let i=0;i<r;++i)t.attr(n[i].name,n[i].value)}if(e.hasChildNodes()){const n=e.childNodes,r=n.length;for(let i=0;i<r;i++){const a=n[i];a.nodeType===3?t.text(a.nodeValue):Ck(t,a)}}return t.close()}const Wl={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Sk={fill:"none","stroke-miterlimit":10},yo=0,Rv="http://www.w3.org/2000/xmlns/",Ut=bu.xmlns;function Xp(t){tr.call(this,t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}const Ch=tr.prototype;P(Xp,tr,{initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=Re(t,0,"svg",Ut),this._svg.setAttributeNS(Rv,"xmlns",Ut),this._svg.setAttributeNS(Rv,"xmlns:xlink",bu["xmlns:xlink"]),this._svg.setAttribute("version",bu.version),this._svg.setAttribute("class","marks"),yn(t,1),this._root=Re(this._svg,yo,"g",Ut),Nr(this._root,Sk),yn(this._svg,yo+1)),this.background(this._bgcolor),Ch.initialize.call(this,t,e,n,r,i)},background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),Ch.background.apply(this,arguments)},resize(t,e,n,r){return Ch.resize.call(this,t,e,n,r),this._svg&&(Nr(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this},canvas(){return this._svg},svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=Re(t,yo,"rect",Ut),Nr(n,{width:this._width,height:this._height,fill:e}));const r=Ek(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r},_render(t){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t),yn(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))},isDirty(t){return this._dirtyAll||!t._svg||t.dirty===this._dirtyID},_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,a,o,u,s;for(o=0,u=t.length;o<u;++o)if(n=t[o],r=n.mark,r.marktype!==i&&(i=r.marktype,a=Ze[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,Nv(n,e),r.items.forEach(l=>{l.dirty=e})),!r.zdirty){if(n.exit){a.nested&&r.items.length?(s=r.items[0],s._svg&&this._update(a,s._svg,s)):n._svg&&(s=n._svg.parentNode,s&&s.removeChild(n._svg)),n._svg=null;continue}n=a.nested?r.items[0]:n,n._update!==e&&(!n._svg||!n._svg.ownerSVGElement?(this._dirtyAll=!1,Nv(n,e)):this._update(a,n._svg,n),n._update=e)}return!this._dirtyAll},mark(t,e,n){if(!this.isDirty(e))return e._svg;const r=this._svg,i=Ze[e.marktype],a=e.interactive===!1?"none":null,o=i.tag==="g";let u=null,s=0;const l=Ov(e,t,n,"g",r);l.setAttribute("class",gk(e));const f=Mk(e);for(const h in f)ve(l,h,f[h]);o||ve(l,"pointer-events",a),ve(l,"clip-path",e.clip?kp(this,e,e.group):null);const c=h=>{const d=this.isDirty(h),g=Ov(h,l,u,i.tag,r);d&&(this._update(i,g,h),o&&RN(this,g,h)),u=g,++s};return i.nested?e.items.length&&c(e.items[0]):Sn(e,c),yn(l,s),l},_update(t,e,n){hr=e,oe=e.__values__,_k(Ko,n),t.attr(Ko,n,this);const r=ON[t.type];r&&r.call(this,t,e,n),hr&&this.style(hr,n)},style(t,e){if(e!=null)for(const n in Wl){let r=n==="font"?Ju(e):e[n];if(r===oe[n])continue;const i=Wl[n];r==null?t.removeAttribute(i):(wp(r)&&(r=j5(r,this._defs.gradient,Dk())),t.setAttribute(i,r+"")),oe[n]=r}},defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=Re(t,yo+1,"defs",Ut)),r=FN(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=Re(t,yo+1,"defs",Ut)),r=TN(n,e.clipping[i],r);n&&(r===0?(t.removeChild(n),e.el=null):yn(n,r))},_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}});function Nv(t,e){for(;t&&t.dirty!==e;t=t.mark.group)if(t.dirty=e,t.mark&&t.mark.dirty!==e)t.mark.dirty=e;else return}function FN(t,e,n){let r,i,a;if(e.gradient==="radial"){let o=Re(t,n++,"pattern",Ut);Nr(o,{id:zl+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),o=Re(o,0,"rect",Ut),Nr(o,{width:1,height:1,fill:`url(${Dk()}#${e.id})`}),t=Re(t,n++,"radialGradient",Ut),Nr(t,{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else t=Re(t,n++,"linearGradient",Ut),Nr(t,{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)a=Re(t,r,"stop",Ut),a.setAttribute("offset",e.stops[r].offset),a.setAttribute("stop-color",e.stops[r].color);return yn(t,r),n}function TN(t,e,n){let r;return t=Re(t,n,"clipPath",Ut),t.setAttribute("id",e.id),e.path?(r=Re(t,0,"path",Ut),r.setAttribute("d",e.path)):(r=Re(t,0,"rect",Ut),Nr(r,{x:0,y:0,width:e.width,height:e.height})),yn(t,1),n+1}function RN(t,e,n){e=e.lastChild.previousSibling;let r,i=0;Sn(n,a=>{r=t.mark(e,a,r),++i}),yn(e,1+i)}function Ov(t,e,n,r,i){let a=t._svg,o;if(!a&&(o=e.ownerDocument,a=Rr(o,r,Ut),t._svg=a,t.mark&&(a.__data__=t,a.__values__={fill:"default"},r==="g"))){const u=Rr(o,"path",Ut);a.appendChild(u),u.__data__=t;const s=Rr(o,"g",Ut);a.appendChild(s),s.__data__=t;const l=Rr(o,"path",Ut);a.appendChild(l),l.__data__=t,l.__values__={fill:"default"}}return(a.ownerSVGElement!==i||NN(a,n))&&e.insertBefore(a,n?n.nextSibling:e.firstChild),a}function NN(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}let hr=null,oe=null;const ON={group(t,e,n){const r=hr=e.childNodes[2];oe=r.__values__,t.foreground(Ko,n,this),oe=e.__values__,hr=e.childNodes[1],t.content(Ko,n,this);const i=hr=e.childNodes[0];t.background(Ko,n,this);const a=n.mark.interactive===!1?"none":null;if(a!==oe.events&&(ve(r,"pointer-events",a),ve(i,"pointer-events",a),oe.events=a),n.strokeForeground&&n.stroke){const o=n.fill;ve(r,"display",null),this.style(i,n),ve(i,"stroke",null),o&&(n.fill=null),oe=r.__values__,this.style(r,n),o&&(n.fill=o),hr=null}else ve(r,"display","none")},image(t,e,n){n.smooth===!1?(Sh(e,"image-rendering","optimizeSpeed"),Sh(e,"image-rendering","pixelated")):Sh(e,"image-rendering",null)},text(t,e,n){const r=Qu(n);let i,a,o,u;G(r)?(a=r.map(s=>Zr(n,s)),i=a.join(`
`),i!==oe.text&&(yn(e,0),o=e.ownerDocument,u=Xr(n),a.forEach((s,l)=>{const f=Rr(o,"tspan",Ut);f.__data__=n,f.textContent=s,l&&(f.setAttribute("x",0),f.setAttribute("dy",u)),e.appendChild(f)}),oe.text=i)):(a=Zr(n,r),a!==oe.text&&(e.textContent=a,oe.text=a)),ve(e,"font-family",Ju(n)),ve(e,"font-size",Jn(n)+"px"),ve(e,"font-style",n.fontStyle),ve(e,"font-variant",n.fontVariant),ve(e,"font-weight",n.fontWeight)}};function Ko(t,e,n){e!==oe[t]&&(n?zN(hr,t,e,n):ve(hr,t,e),oe[t]=e)}function Sh(t,e,n){n!==oe[e]&&(n==null?t.style.removeProperty(e):t.style.setProperty(e,n+""),oe[e]=n)}function Nr(t,e){for(const n in e)ve(t,n,e[n])}function ve(t,e,n){n!=null?t.setAttribute(e,n):t.removeAttribute(e)}function zN(t,e,n,r){n!=null?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}function Dk(){let t;return typeof window>"u"?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}function Zp(t){tr.call(this,t),this._text=null,this._defs={gradient:{},clipping:{}}}P(Zp,tr,{svg(){return this._text},_render(t){const e=Vp();e.open("svg",tt({},bu,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&n!=="transparent"&&n!=="none"&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",Sk,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this},mark(t,e){const n=Ze[e.marktype],r=n.tag,i=[_k,n.attr];t.open("g",{class:gk(e),"clip-path":e.clip?kp(this,e,e.group):null},Mk(e),{"pointer-events":r!=="g"&&e.interactive===!1?"none":null});const a=o=>{const u=this.href(o);if(u&&t.open("a",u),t.open(r,this.attr(e,o,i,r!=="g"?r:null)),r==="text"){const s=Qu(o);if(G(s)){const l={x:0,dy:Xr(o)};for(let f=0;f<s.length;++f)t.open("tspan",f?l:null).text(Zr(o,s[f])).close()}else t.text(Zr(o,s))}else if(r==="g"){const s=o.strokeForeground,l=o.fill,f=o.stroke;s&&f&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),Sn(o,c=>this.mark(t,c)),t.close(),s&&f?(l&&(o.fill=null),o.stroke=f,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),l&&(o.fill=l)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),u&&t.close()};return n.nested?e.items&&e.items.length&&a(e.items[0]):Sn(e,a),t.close()},href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then(r=>{r["xlink:href"]=r.href,r.href=null,(this._hrefs||(this._hrefs={}))[e]=r})}return null},attr(t,e,n,r){const i={},a=(o,u,s,l)=>{i[l||o]=u};return Array.isArray(n)?n.forEach(o=>o(a,e,this)):n(a,e,this),r&&LN(i,e,t,r,this._defs),i},defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(Object.keys(e).length+Object.keys(n).length!==0){t.open("defs");for(const i in e){const a=e[i],o=a.stops;a.gradient==="radial"?(t.open("pattern",{id:zl+i,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+i+")"}).close(),t.close(),t.open("radialGradient",{id:i,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):t.open("linearGradient",{id:i,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(let u=0;u<o.length;++u)t.open("stop",{offset:o[u].offset,"stop-color":o[u].color}).close();t.close()}for(const i in n){const a=n[i];t.open("clipPath",{id:i}),a.path?t.open("path",{d:a.path}).close():t.open("rect",{x:0,y:0,width:a.width,height:a.height}).close(),t.close()}t.close()}}});function LN(t,e,n,r,i){if(e==null||(r==="bgrect"&&n.interactive===!1&&(t["pointer-events"]="none"),r==="bgfore"&&(n.interactive===!1&&(t["pointer-events"]="none"),t.display="none",e.fill!==null)))return t;r==="image"&&e.smooth===!1&&(t.style="image-rendering: optimizeSpeed; image-rendering: pixelated;"),r==="text"&&(t["font-family"]=Ju(e),t["font-size"]=Jn(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const a in Wl){let o=e[a];const u=Wl[a];o==="transparent"&&(u==="fill"||u==="stroke")||o!=null&&(wp(o)&&(o=j5(o,i.gradient,"")),t[u]=o)}return t}const $k="canvas",Fk="png",Tk="svg",Rk="none",Or={Canvas:$k,PNG:Fk,SVG:Tk,None:Rk},Oa={};Oa[$k]=Oa[Fk]={renderer:Yl,headless:Yl,handler:ts};Oa[Tk]={renderer:Xp,headless:Zp,handler:jp};Oa[Rk]={};function Mc(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(Oa[t]=e,this):Oa[t]}function Nk(t,e,n){const r=[],i=new jt().union(e),a=t.marktype;return a?Ok(t,i,n,r):a==="group"?zk(t,i,n,r):z("Intersect scene must be mark node or group item.")}function Ok(t,e,n,r){if(BN(t,e,n)){const i=t.items,a=t.marktype,o=i.length;let u=0;if(a==="group")for(;u<o;++u)zk(i[u],e,n,r);else for(const s=Ze[a].isect;u<o;++u){const l=i[u];Lk(l,e,s)&&r.push(l)}}return r}function BN(t,e,n){return t.bounds&&e.intersects(t.bounds)&&(t.marktype==="group"||t.interactive!==!1&&(!n||n(t)))}function zk(t,e,n,r){n&&n(t.mark)&&Lk(t,e,Ze.group.isect)&&r.push(t);const i=t.items,a=i&&i.length;if(a){const o=t.x||0,u=t.y||0;e.translate(-o,-u);for(let s=0;s<a;++s)Ok(i[s],e,n,r);e.translate(o,u)}return r}function Lk(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}const Dh=new jt;function Bk(t){const e=t.clip;if(nt(e))e(Zu(Dh.clear()));else if(e)Dh.set(0,0,t.group.width,t.group.height);else return;t.bounds.intersect(Dh)}const PN=1e-9;function Kp(t,e,n){return t===e?!0:n==="path"?Pk(t,e):t instanceof Date&&e instanceof Date?+t==+e:Yr(t)&&Yr(e)?Math.abs(t-e)<=PN:!t||!e||!et(t)&&!et(e)?t==e:UN(t,e)}function Pk(t,e){return Kp(Ta(t),Ta(e))}function UN(t,e){var n=Object.keys(t),r=Object.keys(e),i,a;if(n.length!==r.length)return!1;for(n.sort(),r.sort(),a=n.length-1;a>=0;a--)if(n[a]!=r[a])return!1;for(a=n.length-1;a>=0;a--)if(i=n[a],!Kp(t[i],e[i],i))return!1;return typeof t==typeof e}function IN(){Z5(),yT()}const za="top",vn="left",bn="right",Qr="bottom",qN="top-left",jN="top-right",YN="bottom-left",WN="bottom-right",Qp="start",ld="middle",xe="end",HN="x",GN="y",kc="group",Jp="axis",tm="title",VN="frame",XN="scope",em="legend",Uk="row-header",Ik="row-footer",qk="row-title",jk="column-header",Yk="column-footer",Wk="column-title",ZN="padding",KN="symbol",Hk="fit",QN="fit-x",JN="fit-y",tO="pad",nm="none",Cs="all",fd="each",rm="flush",zr="column",Lr="row";function Gk(t){R.call(this,null,t)}P(Gk,R,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,a=Ze[i],o=a.bound;let u=r.bounds,s;if(a.nested)r.items.length&&n.dirty(r.items[0]),u=Ss(r,o),r.items.forEach(l=>{l.bounds.clear().union(u)});else if(i===kc||t.modified())switch(e.visit(e.MOD,l=>n.dirty(l)),u.clear(),r.items.forEach(l=>u.union(Ss(l,o))),r.role){case Jp:case em:case tm:e.reflow()}else s=e.changed(e.REM),e.visit(e.ADD,l=>{u.union(Ss(l,o))}),e.visit(e.MOD,l=>{s=s||u.alignsWith(l.bounds),n.dirty(l),u.union(Ss(l,o))}),s&&(u.clear(),r.items.forEach(l=>u.union(l.bounds)));return Bk(r),e.modifies("bounds")}});function Ss(t,e,n){return e(t.bounds.clear(),t,n)}const zv=":vega_identifier:";function im(t){R.call(this,0,t)}im.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]};P(im,R,{transform(t,e){const n=eO(e.dataflow),r=t.as;let i=n.value;return e.visit(e.ADD,a=>a[r]=a[r]||++i),n.set(this.value=i),e}});function eO(t){return t._signals[zv]||(t._signals[zv]=t.add(0))}function Vk(t){R.call(this,null,t)}P(Vk,R,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,nO(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===kc?pc:gc;return e.visit(e.ADD,i=>r.call(i,n)),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});function nO(t){const e=t.groups,n=t.parent;return e&&e.size===1?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}function Xk(t){R.call(this,null,t)}const Lv={parity:t=>t.filter((e,n)=>n%2?e.opacity=0:1),greedy:(t,e)=>{let n;return t.filter((r,i)=>!i||!Zk(n.bounds,r.bounds,e)?(n=r,1):r.opacity=0)}},Zk=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),Bv=(t,e)=>{for(var n=1,r=t.length,i=t[0].bounds,a;n<r;i=a,++n)if(Zk(i,a=t[n].bounds,e))return!0},rO=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},iO=(t,e,n)=>{var r=t.range(),i=new jt;return e===za||e===Qr?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),a=>i.encloses(a.bounds)},Pv=t=>(t.forEach(e=>e.opacity=1),t),Uv=(t,e)=>t.reflow(e.modified()).modifies("opacity");P(Xk,R,{transform(t,e){const n=Lv[t.method]||Lv.parity,r=t.separation||0;let i=e.materialize(e.SOURCE).source,a,o;if(!i||!i.length)return;if(!t.method)return t.modified("method")&&(Pv(i),e=Uv(e,t)),e;if(i=i.filter(rO),!i.length)return;if(t.sort&&(i=i.slice().sort(t.sort)),a=Pv(i),e=Uv(e,t),a.length>=3&&Bv(a,r)){do a=n(a,r);while(a.length>=3&&Bv(a,r));a.length<3&&!ot(i).opacity&&(a.length>1&&(ot(a).opacity=0),ot(i).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(o=iO(t.boundScale,t.boundOrient,+t.boundTolerance),i.forEach(s=>{o(s)||(s.opacity=0)}));const u=a[0].mark.bounds.clear();return i.forEach(s=>{s.opacity&&u.union(s.bounds)}),e}});function Kk(t){R.call(this,null,t)}P(Kk,R,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,r=>n.dirty(r)),e.fields&&e.fields.zindex){const r=e.source&&e.source[0];r&&(r.mark.zdirty=!0)}}});const ae=new jt;function ha(t,e,n){return t[e]===n?0:(t[e]=n,1)}function aO(t){var e=t.items[0].orient;return e===vn||e===bn}function oO(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}function uO(t,e,n,r){var i=e.items[0],a=i.datum,o=i.translate!=null?i.translate:.5,u=i.orient,s=oO(a),l=i.range,f=i.offset,c=i.position,h=i.minExtent,d=i.maxExtent,g=a.title&&i.items[s[2]].items[0],p=i.titlePadding,m=i.bounds,y=g&&Bp(g),v=0,x=0,b,_;switch(ae.clear().union(m),m.clear(),(b=s[0])>-1&&m.union(i.items[b].bounds),(b=s[1])>-1&&m.union(i.items[b].bounds),u){case za:v=c||0,x=-f,_=Math.max(h,Math.min(d,-m.y1)),m.add(0,-_).add(l,0),g&&Ds(t,g,_,p,y,0,-1,m);break;case vn:v=-f,x=c||0,_=Math.max(h,Math.min(d,-m.x1)),m.add(-_,0).add(0,l),g&&Ds(t,g,_,p,y,1,-1,m);break;case bn:v=n+f,x=c||0,_=Math.max(h,Math.min(d,m.x2)),m.add(0,0).add(_,l),g&&Ds(t,g,_,p,y,1,1,m);break;case Qr:v=c||0,x=r+f,_=Math.max(h,Math.min(d,m.y2)),m.add(0,0).add(l,_),g&&Ds(t,g,_,p,0,0,1,m);break;default:v=i.x,x=i.y}return vr(m.translate(v,x),i),ha(i,"x",v+o)|ha(i,"y",x+o)&&(i.bounds=ae,t.dirty(i),i.bounds=m,t.dirty(i)),i.mark.bounds.clear().union(m)}function Ds(t,e,n,r,i,a,o,u){const s=e.bounds;if(e.auto){const l=o*(n+i+r);let f=0,c=0;t.dirty(e),a?f=(e.x||0)-(e.x=l):c=(e.y||0)-(e.y=l),e.mark.bounds.clear().union(s.translate(-f,-c)),t.dirty(e)}u.union(s)}const Iv=(t,e)=>Math.floor(Math.min(t,e)),qv=(t,e)=>Math.ceil(Math.max(t,e));function sO(t){var e=t.items,n=e.length,r=0,i,a;const o={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;r<n;++r)if(i=e[r],a=i.items,i.marktype===kc)switch(i.role){case Jp:case em:case tm:break;case Uk:o.rowheaders.push(...a);break;case Ik:o.rowfooters.push(...a);break;case jk:o.colheaders.push(...a);break;case Yk:o.colfooters.push(...a);break;case qk:o.rowtitle=a[0];break;case Wk:o.coltitle=a[0];break;default:o.marks.push(...a)}return o}function lO(t){return new jt().set(0,0,t.width||0,t.height||0)}function fO(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function St(t,e,n){const r=et(t)?t[e]:t;return r!=null?r:n!==void 0?n:0}function jv(t){return t<0?Math.ceil(-t):0}function Qk(t,e,n){var r=!n.nodirty,i=n.bounds===rm?lO:fO,a=ae.set(0,0,0,0),o=St(n.align,zr),u=St(n.align,Lr),s=St(n.padding,zr),l=St(n.padding,Lr),f=n.columns||e.length,c=f<=0?1:Math.ceil(e.length/f),h=e.length,d=Array(h),g=Array(f),p=0,m=Array(h),y=Array(c),v=0,x=Array(h),b=Array(h),_=Array(h),M,w,A,S,C,E,$,F,L,k,T;for(w=0;w<f;++w)g[w]=0;for(w=0;w<c;++w)y[w]=0;for(w=0;w<h;++w)E=e[w],C=_[w]=i(E),E.x=E.x||0,x[w]=0,E.y=E.y||0,b[w]=0,A=w%f,S=~~(w/f),p=Math.max(p,$=Math.ceil(C.x2)),v=Math.max(v,F=Math.ceil(C.y2)),g[A]=Math.max(g[A],$),y[S]=Math.max(y[S],F),d[w]=s+jv(C.x1),m[w]=l+jv(C.y1),r&&t.dirty(e[w]);for(w=0;w<h;++w)w%f===0&&(d[w]=0),w<f&&(m[w]=0);if(o===fd)for(A=1;A<f;++A){for(T=0,w=A;w<h;w+=f)T<d[w]&&(T=d[w]);for(w=A;w<h;w+=f)d[w]=T+g[A-1]}else if(o===Cs){for(T=0,w=0;w<h;++w)w%f&&T<d[w]&&(T=d[w]);for(w=0;w<h;++w)w%f&&(d[w]=T+p)}else for(o=!1,A=1;A<f;++A)for(w=A;w<h;w+=f)d[w]+=g[A-1];if(u===fd)for(S=1;S<c;++S){for(T=0,w=S*f,M=w+f;w<M;++w)T<m[w]&&(T=m[w]);for(w=S*f;w<M;++w)m[w]=T+y[S-1]}else if(u===Cs){for(T=0,w=f;w<h;++w)T<m[w]&&(T=m[w]);for(w=f;w<h;++w)m[w]=T+v}else for(u=!1,S=1;S<c;++S)for(w=S*f,M=w+f;w<M;++w)m[w]+=y[S-1];for(L=0,w=0;w<h;++w)L=d[w]+(w%f?L:0),x[w]+=L-e[w].x;for(A=0;A<f;++A)for(k=0,w=A;w<h;w+=f)k+=m[w],b[w]+=k-e[w].y;if(o&&St(n.center,zr)&&c>1)for(w=0;w<h;++w)C=o===Cs?p:g[w%f],L=C-_[w].x2-e[w].x-x[w],L>0&&(x[w]+=L/2);if(u&&St(n.center,Lr)&&f!==1)for(w=0;w<h;++w)C=u===Cs?v:y[~~(w/f)],k=C-_[w].y2-e[w].y-b[w],k>0&&(b[w]+=k/2);for(w=0;w<h;++w)a.union(_[w].translate(x[w],b[w]));switch(L=St(n.anchor,HN),k=St(n.anchor,GN),St(n.anchor,zr)){case xe:L-=a.width();break;case ld:L-=a.width()/2}switch(St(n.anchor,Lr)){case xe:k-=a.height();break;case ld:k-=a.height()/2}for(L=Math.round(L),k=Math.round(k),a.clear(),w=0;w<h;++w)e[w].mark.bounds.clear();for(w=0;w<h;++w)E=e[w],E.x+=x[w]+=L,E.y+=b[w]+=k,a.union(E.mark.bounds.union(E.bounds.translate(x[w],b[w]))),r&&t.dirty(E);return a}function cO(t,e,n){var r=sO(e),i=r.marks,a=n.bounds===rm?hO:dO,o=n.offset,u=n.columns||i.length,s=u<=0?1:Math.ceil(i.length/u),l=s*u,f,c,h,d,g,p,m;const y=Qk(t,i,n);y.empty()&&y.set(0,0,0,0),r.rowheaders&&(p=St(n.headerBand,Lr,null),f=$s(t,r.rowheaders,i,u,s,-St(o,"rowHeader"),Iv,0,a,"x1",0,u,1,p)),r.colheaders&&(p=St(n.headerBand,zr,null),c=$s(t,r.colheaders,i,u,u,-St(o,"columnHeader"),Iv,1,a,"y1",0,1,u,p)),r.rowfooters&&(p=St(n.footerBand,Lr,null),h=$s(t,r.rowfooters,i,u,s,St(o,"rowFooter"),qv,0,a,"x2",u-1,u,1,p)),r.colfooters&&(p=St(n.footerBand,zr,null),d=$s(t,r.colfooters,i,u,u,St(o,"columnFooter"),qv,1,a,"y2",l-u,1,u,p)),r.rowtitle&&(g=St(n.titleAnchor,Lr),m=St(o,"rowTitle"),m=g===xe?h+m:f-m,p=St(n.titleBand,Lr,.5),Yv(t,r.rowtitle,m,0,y,p)),r.coltitle&&(g=St(n.titleAnchor,zr),m=St(o,"columnTitle"),m=g===xe?d+m:c-m,p=St(n.titleBand,zr,.5),Yv(t,r.coltitle,m,1,y,p))}function hO(t,e){return e==="x1"?t.x||0:e==="y1"?t.y||0:e==="x2"?(t.x||0)+(t.width||0):e==="y2"?(t.y||0)+(t.height||0):void 0}function dO(t,e){return t.bounds[e]}function $s(t,e,n,r,i,a,o,u,s,l,f,c,h,d){var g=n.length,p=0,m=0,y,v,x,b,_,M,w,A,S;if(!g)return p;for(y=f;y<g;y+=c)n[y]&&(p=o(p,s(n[y],l)));if(!e.length)return p;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),p+=a,v=0,b=e.length;v<b;++v)t.dirty(e[v]),e[v].mark.bounds.clear();for(y=f,v=0,b=e.length;v<b;++v,y+=c){for(M=e[v],_=M.mark.bounds,x=y;x>=0&&(w=n[x])==null;x-=h);u?(A=d==null?w.x:Math.round(w.bounds.x1+d*w.bounds.width()),S=p):(A=p,S=d==null?w.y:Math.round(w.bounds.y1+d*w.bounds.height())),_.union(M.bounds.translate(A-(M.x||0),S-(M.y||0))),M.x=A,M.y=S,t.dirty(M),m=o(m,_[l])}return m}function Yv(t,e,n,r,i,a){if(e){t.dirty(e);var o=n,u=n;r?o=Math.round(i.x1+a*i.width()):u=Math.round(i.y1+a*i.height()),e.bounds.translate(o-(e.x||0),u-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=o,e.y=u,t.dirty(e)}}function gO(t,e){const n=t[e]||{};return(r,i)=>n[r]!=null?n[r]:t[r]!=null?t[r]:i}function pO(t,e){let n=-1/0;return t.forEach(r=>{r.offset!=null&&(n=Math.max(n,r.offset))}),n>-1/0?n:e}function mO(t,e,n,r,i,a,o){const u=gO(n,e),s=pO(t,u("offset",0)),l=u("anchor",Qp),f=l===xe?1:l===ld?.5:0,c={align:fd,bounds:u("bounds",rm),columns:u("direction")==="vertical"?1:t.length,padding:u("margin",8),center:u("center"),nodirty:!0};switch(e){case vn:c.anchor={x:Math.floor(r.x1)-s,column:xe,y:f*(o||r.height()+2*r.y1),row:l};break;case bn:c.anchor={x:Math.ceil(r.x2)+s,y:f*(o||r.height()+2*r.y1),row:l};break;case za:c.anchor={y:Math.floor(i.y1)-s,row:xe,x:f*(a||i.width()+2*i.x1),column:l};break;case Qr:c.anchor={y:Math.ceil(i.y2)+s,x:f*(a||i.width()+2*i.x1),column:l};break;case qN:c.anchor={x:s,y:s};break;case jN:c.anchor={x:a-s,y:s,column:xe};break;case YN:c.anchor={x:s,y:o-s,row:xe};break;case WN:c.anchor={x:a-s,y:o-s,column:xe,row:xe};break}return c}function yO(t,e){var n=e.items[0],r=n.datum,i=n.orient,a=n.bounds,o=n.x,u=n.y,s,l;return n._bounds?n._bounds.clear().union(a):n._bounds=a.clone(),a.clear(),xO(t,n,n.items[0].items[0]),a=vO(n,a),s=2*n.padding,l=2*n.padding,a.empty()||(s=Math.ceil(a.width()+s),l=Math.ceil(a.height()+l)),r.type===KN&&bO(n.items[0].items[0].items[0].items),i!==nm&&(n.x=o=0,n.y=u=0),n.width=s,n.height=l,vr(a.set(o,u,o+s,u+l),n),n.mark.bounds.clear().union(a),n}function vO(t,e){return t.items.forEach(n=>e.union(n.bounds)),e.x1=t.padding,e.y1=t.padding,e}function xO(t,e,n){var r=e.padding,i=r-n.x,a=r-n.y;if(!e.datum.title)(i||a)&&vo(t,n,i,a);else{var o=e.items[1].items[0],u=o.anchor,s=e.titlePadding||0,l=r-o.x,f=r-o.y;switch(o.orient){case vn:i+=Math.ceil(o.bounds.width())+s;break;case bn:case Qr:break;default:a+=o.bounds.height()+s}switch((i||a)&&vo(t,n,i,a),o.orient){case vn:f+=ta(e,n,o,u,1,1);break;case bn:l+=ta(e,n,o,xe,0,0)+s,f+=ta(e,n,o,u,1,1);break;case Qr:l+=ta(e,n,o,u,0,0),f+=ta(e,n,o,xe,-1,0,1)+s;break;default:l+=ta(e,n,o,u,0,0)}(l||f)&&vo(t,o,l,f),(l=Math.round(o.bounds.x1-r))<0&&(vo(t,n,-l,0),vo(t,o,-l,0))}}function ta(t,e,n,r,i,a,o){const u=t.datum.type!=="symbol",s=n.datum.vgrad,l=u&&(a||!s)&&!o?e.items[0]:e,f=l.bounds[i?"y2":"x2"]-t.padding,c=s&&a?f:0,h=s&&a?0:f,d=i<=0?0:Bp(n);return Math.round(r===Qp?c:r===xe?h-d:.5*(f-d))}function vo(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function bO(t){const e=t.reduce((n,r)=>(n[r.column]=Math.max(r.bounds.x2-r.x,n[r.column]||0),n),{});t.forEach(n=>{n.width=e[n.column],n.height=n.bounds.y2-n.y})}function wO(t,e,n,r,i){var a=e.items[0],o=a.frame,u=a.orient,s=a.anchor,l=a.offset,f=a.padding,c=a.items[0].items[0],h=a.items[1]&&a.items[1].items[0],d=u===vn||u===bn?r:n,g=0,p=0,m=0,y=0,v=0,x;if(o!==kc?u===vn?(g=i.y2,d=i.y1):u===bn?(g=i.y1,d=i.y2):(g=i.x1,d=i.x2):u===vn&&(g=r,d=0),x=s===Qp?g:s===xe?d:(g+d)/2,h&&h.text){switch(u){case za:case Qr:v=c.bounds.height()+f;break;case vn:y=c.bounds.width()+f;break;case bn:y=-c.bounds.width()-f;break}ae.clear().union(h.bounds),ae.translate(y-(h.x||0),v-(h.y||0)),ha(h,"x",y)|ha(h,"y",v)&&(t.dirty(h),h.bounds.clear().union(ae),h.mark.bounds.clear().union(ae),t.dirty(h)),ae.clear().union(h.bounds)}else ae.clear();switch(ae.union(c.bounds),u){case za:p=x,m=i.y1-ae.height()-l;break;case vn:p=i.x1-ae.width()-l,m=x;break;case bn:p=i.x2+ae.width()+l,m=x;break;case Qr:p=x,m=i.y2+l;break;default:p=a.x,m=a.y}return ha(a,"x",p)|ha(a,"y",m)&&(ae.translate(p,m),t.dirty(a),a.bounds.clear().union(ae),e.bounds.clear().union(ae),t.dirty(a)),a.bounds}function Jk(t){R.call(this,null,t)}P(Jk,R,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach(r=>{t.layout&&cO(n,r,t.layout),MO(n,r,t)}),_O(t.mark.group)?e.reflow():e}});function _O(t){return t&&t.mark.role!=="legend-entry"}function MO(t,e,n){var r=e.items,i=Math.max(0,e.width||0),a=Math.max(0,e.height||0),o=new jt().set(0,0,i,a),u=o.clone(),s=o.clone(),l=[],f,c,h,d,g,p;for(g=0,p=r.length;g<p;++g)switch(c=r[g],c.role){case Jp:d=aO(c)?u:s,d.union(uO(t,c,i,a));break;case tm:f=c;break;case em:l.push(yO(t,c));break;case VN:case XN:case Uk:case Ik:case qk:case jk:case Yk:case Wk:u.union(c.bounds),s.union(c.bounds);break;default:o.union(c.bounds)}if(l.length){const m={};l.forEach(y=>{h=y.orient||bn,h!==nm&&(m[h]||(m[h]=[])).push(y)});for(const y in m){const v=m[y];Qk(t,v,mO(v,y,n.legends,u,s,i,a))}l.forEach(y=>{const v=y.bounds;if(v.equals(y._bounds)||(y.bounds=y._bounds,t.dirty(y),y.bounds=v,t.dirty(y)),n.autosize&&n.autosize.type===Hk)switch(y.orient){case vn:case bn:o.add(v.x1,0).add(v.x2,0);break;case za:case Qr:o.add(0,v.y1).add(0,v.y2)}else o.union(v)})}o.union(u).union(s),f&&o.union(wO(t,f,i,a,o)),e.clip&&o.set(0,0,e.width||0,e.height||0),kO(t,e,o,n)}function kO(t,e,n,r){const i=r.autosize||{},a=i.type;if(t._autosize<1||!a)return;let o=t._width,u=t._height,s=Math.max(0,e.width||0),l=Math.max(0,Math.ceil(-n.x1)),f=Math.max(0,e.height||0),c=Math.max(0,Math.ceil(-n.y1));const h=Math.max(0,Math.ceil(n.x2-s)),d=Math.max(0,Math.ceil(n.y2-f));if(i.contains===ZN){const g=t.padding();o-=g.left+g.right,u-=g.top+g.bottom}a===nm?(l=0,c=0,s=o,f=u):a===Hk?(s=Math.max(0,o-l-h),f=Math.max(0,u-c-d)):a===QN?(s=Math.max(0,o-l-h),u=f+c+d):a===JN?(o=s+l+h,f=Math.max(0,u-c-d)):a===tO&&(o=s+l+h,u=f+c+d),t._resizeView(o,u,s,f,[l,c],i.resize)}const AO=Object.freeze(Object.defineProperty({__proto__:null,bound:Gk,identifier:im,mark:Vk,overlap:Xk,render:Kk,viewlayout:Jk},Symbol.toStringTag,{value:"Module"}));function tA(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(i);++r<i;)a[r]=t+r*n;return a}function EO(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}const am=t=>()=>t;function CO(t,e){return function(n){return t+n*e}}function SO(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function DO(t){return(t=+t)==1?eA:function(e,n){return n-e?SO(e,n,t):am(isNaN(e)?n:e)}}function eA(t,e){var n=e-t;return n?CO(t,n):am(isNaN(t)?e:t)}const Wv=function t(e){var n=DO(e);function r(i,a){var o=n((i=uu(i)).r,(a=uu(a)).r),u=n(i.g,a.g),s=n(i.b,a.b),l=eA(i.opacity,a.opacity);return function(f){return i.r=o(f),i.g=u(f),i.b=s(f),i.opacity=l(f),i+""}}return r.gamma=t,r}(1);function $O(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(a){for(i=0;i<n;++i)r[i]=t[i]*(1-a)+e[i]*a;return r}}function FO(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function TO(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),a=new Array(n),o;for(o=0;o<r;++o)i[o]=om(t[o],e[o]);for(;o<n;++o)a[o]=e[o];return function(u){for(o=0;o<r;++o)a[o]=i[o](u);return a}}function RO(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function cd(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function NO(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=om(t[i],e[i]):r[i]=e[i];return function(a){for(i in n)r[i]=n[i](a);return r}}var hd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$h=new RegExp(hd.source,"g");function OO(t){return function(){return t}}function zO(t){return function(e){return t(e)+""}}function LO(t,e){var n=hd.lastIndex=$h.lastIndex=0,r,i,a,o=-1,u=[],s=[];for(t=t+"",e=e+"";(r=hd.exec(t))&&(i=$h.exec(e));)(a=i.index)>n&&(a=e.slice(n,a),u[o]?u[o]+=a:u[++o]=a),(r=r[0])===(i=i[0])?u[o]?u[o]+=i:u[++o]=i:(u[++o]=null,s.push({i:o,x:cd(r,i)})),n=$h.lastIndex;return n<e.length&&(a=e.slice(n),u[o]?u[o]+=a:u[++o]=a),u.length<2?s[0]?zO(s[0].x):OO(e):(e=s.length,function(l){for(var f=0,c;f<e;++f)u[(c=s[f]).i]=c.x(l);return u.join("")})}function om(t,e){var n=typeof e,r;return e==null||n==="boolean"?am(e):(n==="number"?cd:n==="string"?(r=yl(e))?(e=r,Wv):LO:e instanceof yl?Wv:e instanceof Date?RO:FO(e)?$O:Array.isArray(e)?TO:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?NO:cd)(t,e)}function BO(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function nA(t){R.call(this,null,t)}P(nA,R,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,a=t.scale,o=t.count==null?t.values?t.values.length:10:t.count,u=xp(a,o,t.minstep),s=t.format||z5(n,a,u,t.formatSpecifier,t.formatType,!!t.values),l=t.values?O5(a,t.values,u):bp(a,u);return i&&(r.rem=i),i=l.map((f,c)=>gt({index:c/(l.length-1||1),value:f,label:s(f)})),t.extra&&i.length&&i.push(gt({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}});function rA(t){R.call(this,null,t)}function PO(){return gt({})}function UO(t){const e=ja().test(n=>n.exit);return e.lookup=n=>e.get(t(n)),e}P(rA,R,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||PO,a=t.key||H,o=this.value;return G(r.encode)&&(r.encode=null),o&&(t.modified("key")||e.modified(a))&&z("DataJoin does not support modified key function or fields."),o||(e=e.addAll(),this.value=o=UO(a)),e.visit(e.ADD,u=>{const s=a(u);let l=o.get(s);l?l.exit?(o.empty--,r.add.push(l)):r.mod.push(l):(l=i(u),o.set(s,l),r.add.push(l)),l.datum=u,l.exit=!1}),e.visit(e.MOD,u=>{const s=a(u),l=o.get(s);l&&(l.datum=u,r.mod.push(l))}),e.visit(e.REM,u=>{const s=a(u),l=o.get(s);u===l.datum&&!l.exit&&(r.rem.push(l),l.exit=!0,++o.empty)}),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&o.empty>n.cleanThreshold)&&n.runAfter(o.clean),r}});function iA(t){R.call(this,null,t)}P(iA,R,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,a=e.encode;if(G(a))if(n.changed()||a.every(c=>i[c]))a=a[0],n.encode=null;else return e.StopPropagation;var o=a==="enter",u=i.update||Mr,s=i.enter||Mr,l=i.exit||Mr,f=(a&&!o?i[a]:u)||Mr;if(e.changed(e.ADD)&&(e.visit(e.ADD,c=>{s(c,t),u(c,t)}),n.modifies(s.output),n.modifies(u.output),f!==Mr&&f!==u&&(e.visit(e.ADD,c=>{f(c,t)}),n.modifies(f.output))),e.changed(e.REM)&&l!==Mr&&(e.visit(e.REM,c=>{l(c,t)}),n.modifies(l.output)),o||f!==Mr){const c=e.MOD|(t.modified()?e.REFLOW:0);o?(e.visit(c,h=>{const d=s(h,t)||r;(f(h,t)||d)&&n.mod.push(h)}),n.mod.length&&n.modifies(s.output)):e.visit(c,h=>{(f(h,t)||r)&&n.mod.push(h)}),n.mod.length&&n.modifies(f.output)}return n.changed()?n:e.StopPropagation}});function aA(t){R.call(this,[],t)}P(aA,R,{transform(t,e){if(this.value!=null&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,a=t.type||tl,o=t.scale,u=+t.limit,s=xp(o,t.count==null?5:t.count,t.minstep),l=!!t.values||a===tl,f=t.format||U5(n,o,s,a,t.formatSpecifier,t.formatType,l),c=t.values||P5(o,s),h,d,g,p,m;return i&&(r.rem=i),a===tl?(u&&c.length>u?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),i=c.slice(0,u-1),m=!0):i=c,nt(g=t.size)?(!t.values&&o(i[0])===0&&(i=i.slice(1)),p=i.reduce((y,v)=>Math.max(y,g(v,t)),0)):g=ge(p=g||8),i=i.map((y,v)=>gt({index:v,label:f(y,v,i),value:y,offset:p,size:g(y,t)})),m&&(m=c[i.length],i.push(gt({index:i.length,label:"…".concat(c.length-i.length," entries"),value:m,offset:p,size:g(m,t)})))):a===iT?(h=o.domain(),d=T5(o,h[0],ot(h)),c.length<3&&!t.values&&h[0]!==ot(h)&&(c=[h[0],ot(h)]),i=c.map((y,v)=>gt({index:v,label:f(y,v,c),value:y,perc:d(y)}))):(g=c.length-1,d=pT(o),i=c.map((y,v)=>gt({index:v,label:f(y,v,c),value:y,perc:v?d(y):0,perc2:v===g?1:d(c[v+1])}))),r.source=i,r.add=i,this.value=i,r}});const IO=t=>t.source.x,qO=t=>t.source.y,jO=t=>t.target.x,YO=t=>t.target.y;function um(t){R.call(this,{},t)}um.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]};P(um,R,{transform(t,e){var n=t.sourceX||IO,r=t.sourceY||qO,i=t.targetX||jO,a=t.targetY||YO,o=t.as||"path",u=t.orient||"vertical",s=t.shape||"line",l=Hv.get(s+"-"+u)||Hv.get(s);return l||z("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,f=>{f[o]=l(n(f),r(f),i(f),a(f))}),e.reflow(t.modified()).modifies(o)}});const oA=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,WO=(t,e,n,r)=>oA(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),uA=(t,e,n,r)=>{var i=n-t,a=r-e,o=Math.sqrt(i*i+a*a)/2,u=180*Math.atan2(a,i)/Math.PI;return"M"+t+","+e+"A"+o+","+o+" "+u+" 0 1 "+n+","+r},HO=(t,e,n,r)=>uA(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),sA=(t,e,n,r)=>{const i=n-t,a=r-e,o=.2*(i+a),u=.2*(a-i);return"M"+t+","+e+"C"+(t+o)+","+(e+u)+" "+(n+u)+","+(r-o)+" "+n+","+r},GO=(t,e,n,r)=>sA(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),VO=(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,XO=(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,ZO=(t,e,n,r)=>{const i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),u=Math.sin(n),s=Math.abs(n-t)>Math.PI?n<=t:n>t;return"M"+e*i+","+e*a+"A"+e+","+e+" 0 0,"+(s?1:0)+" "+e*o+","+e*u+"L"+r*o+","+r*u},KO=(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},QO=(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},JO=(t,e,n,r)=>{const i=Math.cos(t),a=Math.sin(t),o=Math.cos(n),u=Math.sin(n),s=(e+r)/2;return"M"+e*i+","+e*a+"C"+s*i+","+s*a+" "+s*o+","+s*u+" "+r*o+","+r*u},Hv=ja({line:oA,"line-radial":WO,arc:uA,"arc-radial":HO,curve:sA,"curve-radial":GO,"orthogonal-horizontal":VO,"orthogonal-vertical":XO,"orthogonal-radial":ZO,"diagonal-horizontal":KO,"diagonal-vertical":QO,"diagonal-radial":JO});function sm(t){R.call(this,null,t)}sm.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]};P(sm,R,{transform(t,e){var n=t.as||["startAngle","endAngle"],r=n[0],i=n[1],a=t.field||qa,o=t.startAngle||0,u=t.endAngle!=null?t.endAngle:2*Math.PI,s=e.source,l=s.map(a),f=l.length,c=o,h=(u-o)/EO(l),d=tA(f),g,p,m;for(t.sort&&d.sort((y,v)=>l[y]-l[v]),g=0;g<f;++g)m=l[d[g]],p=s[d[g]],p[r]=c,p[i]=c+=m*h;return this.value=l,e.reflow(t.modified()).modifies(n)}});const tz=5;function ez(t){const e=t.type;return!t.bins&&(e===Da||e===ju||e===Yu)}function lA(t){return mp(t)&&t!==In}const nz=En(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function fA(t){R.call(this,null,t),this.modified(!0)}P(fA,R,{transform(t,e){var n=e.dataflow,r=this.value,i=rz(t);(!r||i!==r.type)&&(this.value=r=dt(i)());for(i in t)if(!nz[i]){if(i==="padding"&&lA(r.type))continue;nt(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return lz(r,t,sz(r,t,az(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function rz(t){var e=t.type,n="",r;return e===In?In+"-"+Da:(iz(t)&&(r=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(t.domainMid!=null):0,n=r===2?In+"-":r===3?Va+"-":""),(n+e||Da).toLowerCase())}function iz(t){const e=t.type;return mp(e)&&e!==Ai&&e!==Ei&&(t.scheme||t.range&&t.range.length&&t.range.every(Ct))}function az(t,e,n){const r=oz(t,e.domainRaw,n);if(r>-1)return r;var i=e.domain,a=t.type,o=e.zero||e.zero===void 0&&ez(t),u,s;if(!i)return 0;if(lA(a)&&e.padding&&i[0]!==ot(i)&&(i=uz(a,i,e.range,e.padding,e.exponent,e.constant)),(o||e.domainMin!=null||e.domainMax!=null||e.domainMid!=null)&&(u=(i=i.slice()).length-1||1,o&&(i[0]>0&&(i[0]=0),i[u]<0&&(i[u]=0)),e.domainMin!=null&&(i[0]=e.domainMin),e.domainMax!=null&&(i[u]=e.domainMax),e.domainMid!=null)){s=e.domainMid;const l=s>i[u]?u+1:s<i[0]?0:u;l!==u&&n.warn("Scale domainMid exceeds domain min or max.",s),i.splice(l,0,s)}return t.domain(cA(a,i,n)),a===hp&&t.unknown(e.domainImplicit?Y0:void 0),e.nice&&t.nice&&t.nice(e.nice!==!0&&xp(t,e.nice)||null),i.length}function oz(t,e,n){return e?(t.domain(cA(t.type,e,n)),e.length):-1}function uz(t,e,n,r,i,a){var o=Math.abs(ot(n)-n[0]),u=o/(o-2*r),s=t===gr?$g(e,null,u):t===Yu?Al(e,null,u,.5):t===ju?Al(e,null,u,i||1):t===lc?Fg(e,null,u,a||1):Dg(e,null,u);return e=e.slice(),e[0]=s[0],e[e.length-1]=s[1],e}function cA(t,e,n){if(C5(t)){var r=Math.abs(e.reduce((i,a)=>i+(a<0?-1:a>0?1:0),0));r!==e.length&&n.warn("Log scale domain includes zero: "+V(e))}return e}function sz(t,e,n){let r=e.bins;if(r&&!G(r)){const i=t.domain(),a=i[0],o=ot(i),u=r.step;let s=r.start==null?a:r.start,l=r.stop==null?o:r.stop;u||z("Scale bins parameter missing step property."),s<a&&(s=u*Math.ceil(a/u)),l>o&&(l=u*Math.floor(o/u)),r=tA(s,l+u/2,u)}return r?t.bins=r:t.bins&&delete t.bins,t.type===dp&&(r?!e.domain&&!e.domainRaw&&(t.domain(r),n=r.length):t.bins=t.domain()),n}function lz(t,e,n){var r=t.type,i=e.round||!1,a=e.range;if(e.rangeStep!=null)a=fz(r,e,n);else if(e.scheme&&(a=cz(r,e,n),nt(a))){if(t.interpolator)return t.interpolator(a);z("Scale type ".concat(r," does not support interpolating color schemes."))}if(a&&S5(r))return t.interpolator(hc(dd(a,e.reverse),e.interpolate,e.interpolateGamma));a&&e.interpolate&&t.interpolate?t.interpolate(yp(e.interpolate,e.interpolateGamma)):nt(t.round)?t.round(i):nt(t.rangeRound)&&t.interpolate(i?BO:om),a&&t.range(dd(a,e.reverse))}function fz(t,e,n){t!==M5&&t!==Z0&&z("Only band and point scales support rangeStep.");var r=(e.paddingOuter!=null?e.paddingOuter:e.padding)||0,i=t===Z0?1:(e.paddingInner!=null?e.paddingInner:e.padding)||0;return[0,e.rangeStep*cp(n,i,r)]}function cz(t,e,n){var r=e.schemeExtent,i,a;return G(e.scheme)?a=hc(e.scheme,e.interpolate,e.interpolateGamma):(i=e.scheme.toLowerCase(),a=vp(i),a||z("Unrecognized scheme name: ".concat(e.scheme))),n=t===cc?n+1:t===dp?n-1:t===$a||t===fc?+e.schemeCount||tz:n,S5(t)?Gv(a,r,e.reverse):nt(a)?F5(Gv(a,r),n):t===hp?a:a.slice(0,n)}function Gv(t,e,n){return nt(t)&&(e||n)?$5(t,dd(e||[0,1],n)):t}function dd(t,e){return e?t.slice().reverse():t}function hA(t){R.call(this,null,t)}P(hA,R,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(Bi(t.sort)),this.modified(n),e}});const Vv="zero",dA="center",gA="normalize",pA=["y0","y1"];function lm(t){R.call(this,null,t)}lm.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:Vv,values:[Vv,dA,gA]},{name:"as",type:"string",array:!0,length:2,default:pA}]};P(lm,R,{transform(t,e){var n=t.as||pA,r=n[0],i=n[1],a=Bi(t.sort),o=t.field||qa,u=t.offset===dA?hz:t.offset===gA?dz:gz,s,l,f,c;for(s=pz(e.source,t.groupby,a,o),l=0,f=s.length,c=s.max;l<f;++l)u(s[l],c,o,r,i);return e.reflow(t.modified()).modifies(n)}});function hz(t,e,n,r,i){for(var a=(e-t.sum)/2,o=t.length,u=0,s;u<o;++u)s=t[u],s[r]=a,s[i]=a+=Math.abs(n(s))}function dz(t,e,n,r,i){for(var a=1/t.sum,o=0,u=t.length,s=0,l=0,f;s<u;++s)f=t[s],f[r]=o,f[i]=o=a*(l+=Math.abs(n(f)))}function gz(t,e,n,r,i){for(var a=0,o=0,u=t.length,s=0,l,f;s<u;++s)f=t[s],l=+n(f),l<0?(f[r]=o,f[i]=o+=l):(f[r]=a,f[i]=a+=l)}function pz(t,e,n,r){var i=[],a=p=>p(f),o,u,s,l,f,c,h,d,g;if(e==null)i.push(t.slice());else for(o={},u=0,s=t.length;u<s;++u)f=t[u],c=e.map(a),h=o[c],h||(o[c]=h=[],i.push(h)),h.push(f);for(c=0,g=0,l=i.length;c<l;++c){for(h=i[c],u=0,d=0,s=h.length;u<s;++u)d+=Math.abs(r(h[u]));h.sum=d,d>g&&(g=d),n&&h.sort(n)}return i.max=g,i}const mz=Object.freeze(Object.defineProperty({__proto__:null,axisticks:nA,datajoin:rA,encode:iA,legendentries:aA,linkpath:um,pie:sm,scale:fA,sortitems:hA,stack:lm},Symbol.toStringTag,{value:"Module"}));var yz=Math.sqrt(50),vz=Math.sqrt(10),xz=Math.sqrt(2);function bz(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=yz?i*=10:a>=vz?i*=5:a>=xz&&(i*=2),e<t?-i:i}function ul(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function yi(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(i);++r<i;)a[r]=t+r*n;return a}function wz(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}let Ci=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=n[i],o=e+a,u=Math.abs(e)<Math.abs(a)?e-(o-a):a-(o-e);u&&(n[r++]=u),e=o}return n[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let n=this._n,r,i,a,o=0;if(n>0){for(o=e[--n];n>0&&(r=o,i=e[--n],o=r+i,a=i-(o-r),!a););n>0&&(a<0&&e[n-1]<0||a>0&&e[n-1]>0)&&(i=a*2,r=o+i,i==r-o&&(o=r))}return o}};function*_z(t){for(const e of t)yield*e}function mA(t){return Array.from(_z(t))}var J=1e-6,yA=1e-12,at=Math.PI,Rt=at/2,Xv=at/4,Ke=at*2,ue=180/at,Ft=at/180,vt=Math.abs,Za=Math.atan,pr=Math.atan2,rt=Math.cos,vA=Math.exp,Hl=Math.log,Fh=Math.pow,Q=Math.sin,nn=Math.sign||function(t){return t>0?1:t<0?-1:0},Ue=Math.sqrt,fm=Math.tan;function xA(t){return t>1?0:t<-1?at:Math.acos(t)}function cn(t){return t>1?Rt:t<-1?-Rt:Math.asin(t)}function rn(){}function Gl(t,e){t&&Kv.hasOwnProperty(t.type)&&Kv[t.type](t,e)}var Zv={Feature:function(t,e){Gl(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)Gl(n[r].geometry,e)}},Kv={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){gd(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)gd(n[r],e,0)},Polygon:function(t,e){Qv(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Qv(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)Gl(n[r],e)}};function gd(t,e,n){var r=-1,i=t.length-n,a;for(e.lineStart();++r<i;)a=t[r],e.point(a[0],a[1],a[2]);e.lineEnd()}function Qv(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)gd(t[n],e,1);e.polygonEnd()}function aa(t,e){t&&Zv.hasOwnProperty(t.type)?Zv[t.type](t,e):Gl(t,e)}function pd(t){return[pr(t[1],t[0]),cn(t[2])]}function La(t){var e=t[0],n=t[1],r=rt(n);return[r*rt(e),r*Q(e),Q(n)]}function Fs(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Vl(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Th(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Ts(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function md(t){var e=Ue(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function yd(t,e){function n(r,i){return r=t(r,i),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,i){return r=e.invert(r,i),r&&t.invert(r[0],r[1])}),n}function vd(t,e){return[vt(t)>at?t+Math.round(-t/Ke)*Ke:t,e]}vd.invert=vd;function bA(t,e,n){return(t%=Ke)?e||n?yd(tx(t),ex(e,n)):tx(t):e||n?ex(e,n):vd}function Jv(t){return function(e,n){return e+=t,[e>at?e-Ke:e<-at?e+Ke:e,n]}}function tx(t){var e=Jv(t);return e.invert=Jv(-t),e}function ex(t,e){var n=rt(t),r=Q(t),i=rt(e),a=Q(e);function o(u,s){var l=rt(s),f=rt(u)*l,c=Q(u)*l,h=Q(s),d=h*n+f*r;return[pr(c*i-d*a,f*n-h*r),cn(d*i+c*a)]}return o.invert=function(u,s){var l=rt(s),f=rt(u)*l,c=Q(u)*l,h=Q(s),d=h*i-c*a;return[pr(c*i+h*a,f*n+d*r),cn(d*n-f*r)]},o}function Mz(t){t=bA(t[0]*Ft,t[1]*Ft,t.length>2?t[2]*Ft:0);function e(n){return n=t(n[0]*Ft,n[1]*Ft),n[0]*=ue,n[1]*=ue,n}return e.invert=function(n){return n=t.invert(n[0]*Ft,n[1]*Ft),n[0]*=ue,n[1]*=ue,n},e}function kz(t,e,n,r,i,a){if(n){var o=rt(e),u=Q(e),s=r*n;i==null?(i=e+r*Ke,a=e-s/2):(i=nx(o,i),a=nx(o,a),(r>0?i<a:i>a)&&(i+=r*Ke));for(var l,f=i;r>0?f>a:f<a;f-=s)l=pd([o,-u*rt(f),-u*Q(f)]),t.point(l[0],l[1])}}function nx(t,e){e=La(e),e[0]-=t,md(e);var n=xA(-e[1]);return((-e[2]<0?-n:n)+Ke-J)%Ke}function wA(){var t=[],e;return{point:function(n,r,i){e.push([n,r,i])},lineStart:function(){t.push(e=[])},lineEnd:rn,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function sl(t,e){return vt(t[0]-e[0])<J&&vt(t[1]-e[1])<J}function Rs(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function _A(t,e,n,r,i){var a=[],o=[],u,s;if(t.forEach(function(g){if(!((p=g.length-1)<=0)){var p,m=g[0],y=g[p],v;if(sl(m,y)){if(!m[2]&&!y[2]){for(i.lineStart(),u=0;u<p;++u)i.point((m=g[u])[0],m[1]);i.lineEnd();return}y[0]+=2*J}a.push(v=new Rs(m,g,null,!0)),o.push(v.o=new Rs(m,null,v,!1)),a.push(v=new Rs(y,g,null,!1)),o.push(v.o=new Rs(y,null,v,!0))}}),!!a.length){for(o.sort(e),rx(a),rx(o),u=0,s=o.length;u<s;++u)o[u].e=n=!n;for(var l=a[0],f,c;;){for(var h=l,d=!0;h.v;)if((h=h.n)===l)return;f=h.z,i.lineStart();do{if(h.v=h.o.v=!0,h.e){if(d)for(u=0,s=f.length;u<s;++u)i.point((c=f[u])[0],c[1]);else r(h.x,h.n.x,1,i);h=h.n}else{if(d)for(f=h.p.z,u=f.length-1;u>=0;--u)i.point((c=f[u])[0],c[1]);else r(h.x,h.p.x,-1,i);h=h.p}h=h.o,f=h.z,d=!d}while(!h.v);i.lineEnd()}}}function rx(t){if(e=t.length){for(var e,n=0,r=t[0],i;++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function Rh(t){return vt(t[0])<=at?t[0]:nn(t[0])*((vt(t[0])+at)%Ke-at)}function Az(t,e){var n=Rh(e),r=e[1],i=Q(r),a=[Q(n),-rt(n),0],o=0,u=0,s=new Ci;i===1?r=Rt+J:i===-1&&(r=-Rt-J);for(var l=0,f=t.length;l<f;++l)if(h=(c=t[l]).length)for(var c,h,d=c[h-1],g=Rh(d),p=d[1]/2+Xv,m=Q(p),y=rt(p),v=0;v<h;++v,g=b,m=M,y=w,d=x){var x=c[v],b=Rh(x),_=x[1]/2+Xv,M=Q(_),w=rt(_),A=b-g,S=A>=0?1:-1,C=S*A,E=C>at,$=m*M;if(s.add(pr($*S*Q(C),y*w+$*rt(C))),o+=E?A+S*Ke:A,E^g>=n^b>=n){var F=Vl(La(d),La(x));md(F);var L=Vl(a,F);md(L);var k=(E^A>=0?-1:1)*cn(L[2]);(r>k||r===k&&(F[0]||F[1]))&&(u+=E^A>=0?1:-1)}}return(o<-J||o<J&&s<-yA)^u&1}function MA(t,e,n,r){return function(i){var a=e(i),o=wA(),u=e(o),s=!1,l,f,c,h={point:d,lineStart:p,lineEnd:m,polygonStart:function(){h.point=y,h.lineStart=v,h.lineEnd=x,f=[],l=[]},polygonEnd:function(){h.point=d,h.lineStart=p,h.lineEnd=m,f=mA(f);var b=Az(l,r);f.length?(s||(i.polygonStart(),s=!0),_A(f,Cz,b,n,i)):b&&(s||(i.polygonStart(),s=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),s&&(i.polygonEnd(),s=!1),f=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(b,_){t(b,_)&&i.point(b,_)}function g(b,_){a.point(b,_)}function p(){h.point=g,a.lineStart()}function m(){h.point=d,a.lineEnd()}function y(b,_){c.push([b,_]),u.point(b,_)}function v(){u.lineStart(),c=[]}function x(){y(c[0][0],c[0][1]),u.lineEnd();var b=u.clean(),_=o.result(),M,w=_.length,A,S,C;if(c.pop(),l.push(c),c=null,!!w){if(b&1){if(S=_[0],(A=S.length-1)>0){for(s||(i.polygonStart(),s=!0),i.lineStart(),M=0;M<A;++M)i.point((C=S[M])[0],C[1]);i.lineEnd()}return}w>1&&b&2&&_.push(_.pop().concat(_.shift())),f.push(_.filter(Ez))}}return h}}function Ez(t){return t.length>1}function Cz(t,e){return((t=t.x)[0]<0?t[1]-Rt-J:Rt-t[1])-((e=e.x)[0]<0?e[1]-Rt-J:Rt-e[1])}const ix=MA(function(){return!0},Sz,$z,[-at,-Rt]);function Sz(t){var e=NaN,n=NaN,r=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(a,o){var u=a>0?at:-at,s=vt(a-e);vt(s-at)<J?(t.point(e,n=(n+o)/2>0?Rt:-Rt),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),t.point(a,n),i=0):r!==u&&s>=at&&(vt(e-r)<J&&(e-=r*J),vt(a-u)<J&&(a-=u*J),n=Dz(e,n,a,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(u,n),i=0),t.point(e=a,n=o),r=u},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-i}}}function Dz(t,e,n,r){var i,a,o=Q(t-n);return vt(o)>J?Za((Q(e)*(a=rt(r))*Q(n)-Q(r)*(i=rt(e))*Q(t))/(i*a*o)):(e+r)/2}function $z(t,e,n,r){var i;if(t==null)i=n*Rt,r.point(-at,i),r.point(0,i),r.point(at,i),r.point(at,0),r.point(at,-i),r.point(0,-i),r.point(-at,-i),r.point(-at,0),r.point(-at,i);else if(vt(t[0]-e[0])>J){var a=t[0]<e[0]?at:-at;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}function Fz(t){var e=rt(t),n=6*Ft,r=e>0,i=vt(e)>J;function a(f,c,h,d){kz(d,t,n,h,f,c)}function o(f,c){return rt(f)*rt(c)>e}function u(f){var c,h,d,g,p;return{lineStart:function(){g=d=!1,p=1},point:function(m,y){var v=[m,y],x,b=o(m,y),_=r?b?0:l(m,y):b?l(m+(m<0?at:-at),y):0;if(!c&&(g=d=b)&&f.lineStart(),b!==d&&(x=s(c,v),(!x||sl(c,x)||sl(v,x))&&(v[2]=1)),b!==d)p=0,b?(f.lineStart(),x=s(v,c),f.point(x[0],x[1])):(x=s(c,v),f.point(x[0],x[1],2),f.lineEnd()),c=x;else if(i&&c&&r^b){var M;!(_&h)&&(M=s(v,c,!0))&&(p=0,r?(f.lineStart(),f.point(M[0][0],M[0][1]),f.point(M[1][0],M[1][1]),f.lineEnd()):(f.point(M[1][0],M[1][1]),f.lineEnd(),f.lineStart(),f.point(M[0][0],M[0][1],3)))}b&&(!c||!sl(c,v))&&f.point(v[0],v[1]),c=v,d=b,h=_},lineEnd:function(){d&&f.lineEnd(),c=null},clean:function(){return p|(g&&d)<<1}}}function s(f,c,h){var d=La(f),g=La(c),p=[1,0,0],m=Vl(d,g),y=Fs(m,m),v=m[0],x=y-v*v;if(!x)return!h&&f;var b=e*y/x,_=-e*v/x,M=Vl(p,m),w=Ts(p,b),A=Ts(m,_);Th(w,A);var S=M,C=Fs(w,S),E=Fs(S,S),$=C*C-E*(Fs(w,w)-1);if(!($<0)){var F=Ue($),L=Ts(S,(-C-F)/E);if(Th(L,w),L=pd(L),!h)return L;var k=f[0],T=c[0],B=f[1],U=c[1],q;T<k&&(q=k,k=T,T=q);var it=T-k,lt=vt(it-at)<J,At=lt||it<J;if(!lt&&U<B&&(q=B,B=U,U=q),At?lt?B+U>0^L[1]<(vt(L[0]-k)<J?B:U):B<=L[1]&&L[1]<=U:it>at^(k<=L[0]&&L[0]<=T)){var bt=Ts(S,(-C+F)/E);return Th(bt,w),[L,pd(bt)]}}}function l(f,c){var h=r?t:at-t,d=0;return f<-h?d|=1:f>h&&(d|=2),c<-h?d|=4:c>h&&(d|=8),d}return MA(o,u,a,r?[0,-t]:[-at,t-at])}function Tz(t,e,n,r,i,a){var o=t[0],u=t[1],s=e[0],l=e[1],f=0,c=1,h=s-o,d=l-u,g;if(g=n-o,!(!h&&g>0)){if(g/=h,h<0){if(g<f)return;g<c&&(c=g)}else if(h>0){if(g>c)return;g>f&&(f=g)}if(g=i-o,!(!h&&g<0)){if(g/=h,h<0){if(g>c)return;g>f&&(f=g)}else if(h>0){if(g<f)return;g<c&&(c=g)}if(g=r-u,!(!d&&g>0)){if(g/=d,d<0){if(g<f)return;g<c&&(c=g)}else if(d>0){if(g>c)return;g>f&&(f=g)}if(g=a-u,!(!d&&g<0)){if(g/=d,d<0){if(g>c)return;g>f&&(f=g)}else if(d>0){if(g<f)return;g<c&&(c=g)}return f>0&&(t[0]=o+f*h,t[1]=u+f*d),c<1&&(e[0]=o+c*h,e[1]=u+c*d),!0}}}}}var zo=1e9,Ns=-zo;function kA(t,e,n,r){function i(l,f){return t<=l&&l<=n&&e<=f&&f<=r}function a(l,f,c,h){var d=0,g=0;if(l==null||(d=o(l,c))!==(g=o(f,c))||s(l,f)<0^c>0)do h.point(d===0||d===3?t:n,d>1?r:e);while((d=(d+c+4)%4)!==g);else h.point(f[0],f[1])}function o(l,f){return vt(l[0]-t)<J?f>0?0:3:vt(l[0]-n)<J?f>0?2:1:vt(l[1]-e)<J?f>0?1:0:f>0?3:2}function u(l,f){return s(l.x,f.x)}function s(l,f){var c=o(l,1),h=o(f,1);return c!==h?c-h:c===0?f[1]-l[1]:c===1?l[0]-f[0]:c===2?l[1]-f[1]:f[0]-l[0]}return function(l){var f=l,c=wA(),h,d,g,p,m,y,v,x,b,_,M,w={point:A,lineStart:$,lineEnd:F,polygonStart:C,polygonEnd:E};function A(k,T){i(k,T)&&f.point(k,T)}function S(){for(var k=0,T=0,B=d.length;T<B;++T)for(var U=d[T],q=1,it=U.length,lt=U[0],At,bt,Dt=lt[0],Ot=lt[1];q<it;++q)At=Dt,bt=Ot,lt=U[q],Dt=lt[0],Ot=lt[1],bt<=r?Ot>r&&(Dt-At)*(r-bt)>(Ot-bt)*(t-At)&&++k:Ot<=r&&(Dt-At)*(r-bt)<(Ot-bt)*(t-At)&&--k;return k}function C(){f=c,h=[],d=[],M=!0}function E(){var k=S(),T=M&&k,B=(h=mA(h)).length;(T||B)&&(l.polygonStart(),T&&(l.lineStart(),a(null,null,1,l),l.lineEnd()),B&&_A(h,u,k,a,l),l.polygonEnd()),f=l,h=d=g=null}function $(){w.point=L,d&&d.push(g=[]),_=!0,b=!1,v=x=NaN}function F(){h&&(L(p,m),y&&b&&c.rejoin(),h.push(c.result())),w.point=A,b&&f.lineEnd()}function L(k,T){var B=i(k,T);if(d&&g.push([k,T]),_)p=k,m=T,y=B,_=!1,B&&(f.lineStart(),f.point(k,T));else if(B&&b)f.point(k,T);else{var U=[v=Math.max(Ns,Math.min(zo,v)),x=Math.max(Ns,Math.min(zo,x))],q=[k=Math.max(Ns,Math.min(zo,k)),T=Math.max(Ns,Math.min(zo,T))];Tz(U,q,t,e,n,r)?(b||(f.lineStart(),f.point(U[0],U[1])),f.point(q[0],q[1]),B||f.lineEnd(),M=!1):B&&(f.lineStart(),f.point(k,T),M=!1)}v=k,x=T,b=B}return w}}const _u=t=>t;var Nh=new Ci,xd=new Ci,AA,EA,bd,wd,Fr={point:rn,lineStart:rn,lineEnd:rn,polygonStart:function(){Fr.lineStart=Rz,Fr.lineEnd=Oz},polygonEnd:function(){Fr.lineStart=Fr.lineEnd=Fr.point=rn,Nh.add(vt(xd)),xd=new Ci},result:function(){var t=Nh/2;return Nh=new Ci,t}};function Rz(){Fr.point=Nz}function Nz(t,e){Fr.point=CA,AA=bd=t,EA=wd=e}function CA(t,e){xd.add(wd*t-bd*e),bd=t,wd=e}function Oz(){CA(AA,EA)}const ax=Fr;var Ba=1/0,Xl=Ba,Mu=-Ba,Zl=Mu,zz={point:Lz,lineStart:rn,lineEnd:rn,polygonStart:rn,polygonEnd:rn,result:function(){var t=[[Ba,Xl],[Mu,Zl]];return Mu=Zl=-(Xl=Ba=1/0),t}};function Lz(t,e){t<Ba&&(Ba=t),t>Mu&&(Mu=t),e<Xl&&(Xl=e),e>Zl&&(Zl=e)}const Kl=zz;var _d=0,Md=0,Lo=0,Ql=0,Jl=0,da=0,kd=0,Ad=0,Bo=0,SA,DA,zn,Ln,xn={point:Si,lineStart:ox,lineEnd:ux,polygonStart:function(){xn.lineStart=Uz,xn.lineEnd=Iz},polygonEnd:function(){xn.point=Si,xn.lineStart=ox,xn.lineEnd=ux},result:function(){var t=Bo?[kd/Bo,Ad/Bo]:da?[Ql/da,Jl/da]:Lo?[_d/Lo,Md/Lo]:[NaN,NaN];return _d=Md=Lo=Ql=Jl=da=kd=Ad=Bo=0,t}};function Si(t,e){_d+=t,Md+=e,++Lo}function ox(){xn.point=Bz}function Bz(t,e){xn.point=Pz,Si(zn=t,Ln=e)}function Pz(t,e){var n=t-zn,r=e-Ln,i=Ue(n*n+r*r);Ql+=i*(zn+t)/2,Jl+=i*(Ln+e)/2,da+=i,Si(zn=t,Ln=e)}function ux(){xn.point=Si}function Uz(){xn.point=qz}function Iz(){$A(SA,DA)}function qz(t,e){xn.point=$A,Si(SA=zn=t,DA=Ln=e)}function $A(t,e){var n=t-zn,r=e-Ln,i=Ue(n*n+r*r);Ql+=i*(zn+t)/2,Jl+=i*(Ln+e)/2,da+=i,i=Ln*t-zn*e,kd+=i*(zn+t),Ad+=i*(Ln+e),Bo+=i*3,Si(zn=t,Ln=e)}const sx=xn;function FA(t){this._context=t}FA.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Ke);break}}},result:rn};var Ed=new Ci,Oh,TA,RA,Po,Uo,tf={point:rn,lineStart:function(){tf.point=jz},lineEnd:function(){Oh&&NA(TA,RA),tf.point=rn},polygonStart:function(){Oh=!0},polygonEnd:function(){Oh=null},result:function(){var t=+Ed;return Ed=new Ci,t}};function jz(t,e){tf.point=NA,TA=Po=t,RA=Uo=e}function NA(t,e){Po-=t,Uo-=e,Ed.add(Ue(Po*Po+Uo*Uo)),Po=t,Uo=e}const lx=tf;function OA(){this._string=[]}OA.prototype={_radius:4.5,_circle:fx(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._string.push("M",t,",",e),this._point=1;break}case 1:{this._string.push("L",t,",",e);break}default:{this._circle==null&&(this._circle=fx(this._radius)),this._string.push("M",t,",",e,this._circle);break}}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}else return null}};function fx(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function zA(t,e){var n=4.5,r,i;function a(o){return o&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),aa(o,r(i))),i.result()}return a.area=function(o){return aa(o,r(ax)),ax.result()},a.measure=function(o){return aa(o,r(lx)),lx.result()},a.bounds=function(o){return aa(o,r(Kl)),Kl.result()},a.centroid=function(o){return aa(o,r(sx)),sx.result()},a.projection=function(o){return arguments.length?(r=o==null?(t=null,_u):(t=o).stream,a):t},a.context=function(o){return arguments.length?(i=o==null?(e=null,new OA):new FA(e=o),typeof n!="function"&&i.pointRadius(n),a):e},a.pointRadius=function(o){return arguments.length?(n=typeof o=="function"?o:(i.pointRadius(+o),+o),a):n},a.projection(t).context(e)}function Ac(t){return function(e){var n=new Cd;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Cd(){}Cd.prototype={constructor:Cd,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function cm(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),aa(n,t.stream(Kl)),e(Kl.result()),r!=null&&t.clipExtent(r),t}function Ec(t,e,n){return cm(t,function(r){var i=e[1][0]-e[0][0],a=e[1][1]-e[0][1],o=Math.min(i/(r[1][0]-r[0][0]),a/(r[1][1]-r[0][1])),u=+e[0][0]+(i-o*(r[1][0]+r[0][0]))/2,s=+e[0][1]+(a-o*(r[1][1]+r[0][1]))/2;t.scale(150*o).translate([u,s])},n)}function hm(t,e,n){return Ec(t,[[0,0],e],n)}function dm(t,e,n){return cm(t,function(r){var i=+e,a=i/(r[1][0]-r[0][0]),o=(i-a*(r[1][0]+r[0][0]))/2,u=-a*r[0][1];t.scale(150*a).translate([o,u])},n)}function gm(t,e,n){return cm(t,function(r){var i=+e,a=i/(r[1][1]-r[0][1]),o=-a*r[0][0],u=(i-a*(r[1][1]+r[0][1]))/2;t.scale(150*a).translate([o,u])},n)}var cx=16,Yz=rt(30*Ft);function hx(t,e){return+e?Hz(t,e):Wz(t)}function Wz(t){return Ac({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function Hz(t,e){function n(r,i,a,o,u,s,l,f,c,h,d,g,p,m){var y=l-r,v=f-i,x=y*y+v*v;if(x>4*e&&p--){var b=o+h,_=u+d,M=s+g,w=Ue(b*b+_*_+M*M),A=cn(M/=w),S=vt(vt(M)-1)<J||vt(a-c)<J?(a+c)/2:pr(_,b),C=t(S,A),E=C[0],$=C[1],F=E-r,L=$-i,k=v*F-y*L;(k*k/x>e||vt((y*F+v*L)/x-.5)>.3||o*h+u*d+s*g<Yz)&&(n(r,i,a,o,u,s,E,$,S,b/=w,_/=w,M,p,m),m.point(E,$),n(E,$,S,b,_,M,l,f,c,h,d,g,p,m))}}return function(r){var i,a,o,u,s,l,f,c,h,d,g,p,m={point:y,lineStart:v,lineEnd:b,polygonStart:function(){r.polygonStart(),m.lineStart=_},polygonEnd:function(){r.polygonEnd(),m.lineStart=v}};function y(A,S){A=t(A,S),r.point(A[0],A[1])}function v(){c=NaN,m.point=x,r.lineStart()}function x(A,S){var C=La([A,S]),E=t(A,S);n(c,h,f,d,g,p,c=E[0],h=E[1],f=A,d=C[0],g=C[1],p=C[2],cx,r),r.point(c,h)}function b(){m.point=y,r.lineEnd()}function _(){v(),m.point=M,m.lineEnd=w}function M(A,S){x(i=A,S),a=c,o=h,u=d,s=g,l=p,m.point=x}function w(){n(c,h,f,d,g,p,a,o,i,u,s,l,cx,r),m.lineEnd=b,b()}return m}}var Gz=Ac({point:function(t,e){this.stream.point(t*Ft,e*Ft)}});function Vz(t){return Ac({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function Xz(t,e,n,r,i){function a(o,u){return o*=r,u*=i,[e+t*o,n-t*u]}return a.invert=function(o,u){return[(o-e)/t*r,(n-u)/t*i]},a}function dx(t,e,n,r,i,a){if(!a)return Xz(t,e,n,r,i);var o=rt(a),u=Q(a),s=o*t,l=u*t,f=o/t,c=u/t,h=(u*n-o*e)/t,d=(u*e+o*n)/t;function g(p,m){return p*=r,m*=i,[s*p-l*m+e,n-l*p-s*m]}return g.invert=function(p,m){return[r*(f*p-c*m+h),i*(d-c*p-f*m)]},g}function xr(t){return LA(function(){return t})()}function LA(t){var e,n=150,r=480,i=250,a=0,o=0,u=0,s=0,l=0,f,c=0,h=1,d=1,g=null,p=ix,m=null,y,v,x,b=_u,_=.5,M,w,A,S,C;function E(k){return A(k[0]*Ft,k[1]*Ft)}function $(k){return k=A.invert(k[0],k[1]),k&&[k[0]*ue,k[1]*ue]}E.stream=function(k){return S&&C===k?S:S=Gz(Vz(f)(p(M(b(C=k)))))},E.preclip=function(k){return arguments.length?(p=k,g=void 0,L()):p},E.postclip=function(k){return arguments.length?(b=k,m=y=v=x=null,L()):b},E.clipAngle=function(k){return arguments.length?(p=+k?Fz(g=k*Ft):(g=null,ix),L()):g*ue},E.clipExtent=function(k){return arguments.length?(b=k==null?(m=y=v=x=null,_u):kA(m=+k[0][0],y=+k[0][1],v=+k[1][0],x=+k[1][1]),L()):m==null?null:[[m,y],[v,x]]},E.scale=function(k){return arguments.length?(n=+k,F()):n},E.translate=function(k){return arguments.length?(r=+k[0],i=+k[1],F()):[r,i]},E.center=function(k){return arguments.length?(a=k[0]%360*Ft,o=k[1]%360*Ft,F()):[a*ue,o*ue]},E.rotate=function(k){return arguments.length?(u=k[0]%360*Ft,s=k[1]%360*Ft,l=k.length>2?k[2]%360*Ft:0,F()):[u*ue,s*ue,l*ue]},E.angle=function(k){return arguments.length?(c=k%360*Ft,F()):c*ue},E.reflectX=function(k){return arguments.length?(h=k?-1:1,F()):h<0},E.reflectY=function(k){return arguments.length?(d=k?-1:1,F()):d<0},E.precision=function(k){return arguments.length?(M=hx(w,_=k*k),L()):Ue(_)},E.fitExtent=function(k,T){return Ec(E,k,T)},E.fitSize=function(k,T){return hm(E,k,T)},E.fitWidth=function(k,T){return dm(E,k,T)},E.fitHeight=function(k,T){return gm(E,k,T)};function F(){var k=dx(n,0,0,h,d,c).apply(null,e(a,o)),T=dx(n,r-k[0],i-k[1],h,d,c);return f=bA(u,s,l),w=yd(e,T),A=yd(f,w),M=hx(w,_),L()}function L(){return S=C=null,E}return function(){return e=t.apply(this,arguments),E.invert=e.invert&&$,F()}}function pm(t){var e=0,n=at/3,r=LA(t),i=r(e,n);return i.parallels=function(a){return arguments.length?r(e=a[0]*Ft,n=a[1]*Ft):[e*ue,n*ue]},i}function Zz(t){var e=rt(t);function n(r,i){return[r*e,Q(i)/e]}return n.invert=function(r,i){return[r/e,cn(i*e)]},n}function Kz(t,e){var n=Q(t),r=(n+Q(e))/2;if(vt(r)<J)return Zz(t);var i=1+n*(2*r-n),a=Ue(i)/r;function o(u,s){var l=Ue(i-2*r*Q(s))/r;return[l*Q(u*=r),a-l*rt(u)]}return o.invert=function(u,s){var l=a-s,f=pr(u,vt(l))*nn(l);return l*r<0&&(f-=at*nn(u)*nn(l)),[f/r,cn((i-(u*u+l*l)*r*r)/(2*r))]},o}function ef(){return pm(Kz).scale(155.424).center([0,33.6442])}function BA(){return ef().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Qz(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function Jz(){var t,e,n=BA(),r,i=ef().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a,o=ef().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,s,l={point:function(h,d){s=[h,d]}};function f(h){var d=h[0],g=h[1];return s=null,r.point(d,g),s||(a.point(d,g),s)||(u.point(d,g),s)}f.invert=function(h){var d=n.scale(),g=n.translate(),p=(h[0]-g[0])/d,m=(h[1]-g[1])/d;return(m>=.12&&m<.234&&p>=-.425&&p<-.214?i:m>=.166&&m<.234&&p>=-.214&&p<-.115?o:n).invert(h)},f.stream=function(h){return t&&e===h?t:t=Qz([n.stream(e=h),i.stream(h),o.stream(h)])},f.precision=function(h){return arguments.length?(n.precision(h),i.precision(h),o.precision(h),c()):n.precision()},f.scale=function(h){return arguments.length?(n.scale(h),i.scale(h*.35),o.scale(h),f.translate(n.translate())):n.scale()},f.translate=function(h){if(!arguments.length)return n.translate();var d=n.scale(),g=+h[0],p=+h[1];return r=n.translate(h).clipExtent([[g-.455*d,p-.238*d],[g+.455*d,p+.238*d]]).stream(l),a=i.translate([g-.307*d,p+.201*d]).clipExtent([[g-.425*d+J,p+.12*d+J],[g-.214*d-J,p+.234*d-J]]).stream(l),u=o.translate([g-.205*d,p+.212*d]).clipExtent([[g-.214*d+J,p+.166*d+J],[g-.115*d-J,p+.234*d-J]]).stream(l),c()},f.fitExtent=function(h,d){return Ec(f,h,d)},f.fitSize=function(h,d){return hm(f,h,d)},f.fitWidth=function(h,d){return dm(f,h,d)},f.fitHeight=function(h,d){return gm(f,h,d)};function c(){return t=e=null,f}return f.scale(1070)}function PA(t){return function(e,n){var r=rt(e),i=rt(n),a=t(r*i);return a===1/0?[2,0]:[a*i*Q(e),a*Q(n)]}}function es(t){return function(e,n){var r=Ue(e*e+n*n),i=t(r),a=Q(i),o=rt(i);return[pr(e*a,r*o),cn(r&&n*a/r)]}}var UA=PA(function(t){return Ue(2/(1+t))});UA.invert=es(function(t){return 2*cn(t/2)});function tL(){return xr(UA).scale(124.75).clipAngle(180-.001)}var IA=PA(function(t){return(t=xA(t))&&t/Q(t)});IA.invert=es(function(t){return t});function eL(){return xr(IA).scale(79.4188).clipAngle(180-.001)}function Cc(t,e){return[t,Hl(fm((Rt+e)/2))]}Cc.invert=function(t,e){return[t,2*Za(vA(e))-Rt]};function nL(){return qA(Cc).scale(961/Ke)}function qA(t){var e=xr(t),n=e.center,r=e.scale,i=e.translate,a=e.clipExtent,o=null,u,s,l;e.scale=function(c){return arguments.length?(r(c),f()):r()},e.translate=function(c){return arguments.length?(i(c),f()):i()},e.center=function(c){return arguments.length?(n(c),f()):n()},e.clipExtent=function(c){return arguments.length?(c==null?o=u=s=l=null:(o=+c[0][0],u=+c[0][1],s=+c[1][0],l=+c[1][1]),f()):o==null?null:[[o,u],[s,l]]};function f(){var c=at*r(),h=e(Mz(e.rotate()).invert([0,0]));return a(o==null?[[h[0]-c,h[1]-c],[h[0]+c,h[1]+c]]:t===Cc?[[Math.max(h[0]-c,o),u],[Math.min(h[0]+c,s),l]]:[[o,Math.max(h[1]-c,u)],[s,Math.min(h[1]+c,l)]])}return f()}function Os(t){return fm((Rt+t)/2)}function rL(t,e){var n=rt(t),r=t===e?Q(t):Hl(n/rt(e))/Hl(Os(e)/Os(t)),i=n*Fh(Os(t),r)/r;if(!r)return Cc;function a(o,u){i>0?u<-Rt+J&&(u=-Rt+J):u>Rt-J&&(u=Rt-J);var s=i/Fh(Os(u),r);return[s*Q(r*o),i-s*rt(r*o)]}return a.invert=function(o,u){var s=i-u,l=nn(r)*Ue(o*o+s*s),f=pr(o,vt(s))*nn(s);return s*r<0&&(f-=at*nn(o)*nn(s)),[f/r,2*Za(Fh(i/l,1/r))-Rt]},a}function iL(){return pm(rL).scale(109.5).parallels([30,30])}function nf(t,e){return[t,e]}nf.invert=nf;function aL(){return xr(nf).scale(152.63)}function oL(t,e){var n=rt(t),r=t===e?Q(t):(n-rt(e))/(e-t),i=n/r+t;if(vt(r)<J)return nf;function a(o,u){var s=i-u,l=r*o;return[s*Q(l),i-s*rt(l)]}return a.invert=function(o,u){var s=i-u,l=pr(o,vt(s))*nn(s);return s*r<0&&(l-=at*nn(o)*nn(s)),[l/r,i-nn(r)*Ue(o*o+s*s)]},a}function uL(){return pm(oL).scale(131.154).center([0,13.9389])}var Qo=1.340264,Jo=-.081106,tu=893e-6,eu=.003796,rf=Ue(3)/2,sL=12;function jA(t,e){var n=cn(rf*Q(e)),r=n*n,i=r*r*r;return[t*rt(n)/(rf*(Qo+3*Jo*r+i*(7*tu+9*eu*r))),n*(Qo+Jo*r+i*(tu+eu*r))]}jA.invert=function(t,e){for(var n=e,r=n*n,i=r*r*r,a=0,o,u,s;a<sL&&(u=n*(Qo+Jo*r+i*(tu+eu*r))-e,s=Qo+3*Jo*r+i*(7*tu+9*eu*r),n-=o=u/s,r=n*n,i=r*r*r,!(vt(o)<yA));++a);return[rf*t*(Qo+3*Jo*r+i*(7*tu+9*eu*r))/rt(n),cn(Q(n)/rf)]};function lL(){return xr(jA).scale(177.158)}function YA(t,e){var n=rt(e),r=rt(t)*n;return[n*Q(t)/r,Q(e)/r]}YA.invert=es(Za);function fL(){return xr(YA).scale(144.049).clipAngle(60)}function cL(){var t=1,e=0,n=0,r=1,i=1,a=0,o,u,s=null,l,f,c,h=1,d=1,g=Ac({point:function(b,_){var M=x([b,_]);this.stream.point(M[0],M[1])}}),p=_u,m,y;function v(){return h=t*r,d=t*i,m=y=null,x}function x(b){var _=b[0]*h,M=b[1]*d;if(a){var w=M*o-_*u;_=_*o+M*u,M=w}return[_+e,M+n]}return x.invert=function(b){var _=b[0]-e,M=b[1]-n;if(a){var w=M*o+_*u;_=_*o-M*u,M=w}return[_/h,M/d]},x.stream=function(b){return m&&y===b?m:m=g(p(y=b))},x.postclip=function(b){return arguments.length?(p=b,s=l=f=c=null,v()):p},x.clipExtent=function(b){return arguments.length?(p=b==null?(s=l=f=c=null,_u):kA(s=+b[0][0],l=+b[0][1],f=+b[1][0],c=+b[1][1]),v()):s==null?null:[[s,l],[f,c]]},x.scale=function(b){return arguments.length?(t=+b,v()):t},x.translate=function(b){return arguments.length?(e=+b[0],n=+b[1],v()):[e,n]},x.angle=function(b){return arguments.length?(a=b%360*Ft,u=Q(a),o=rt(a),v()):a*ue},x.reflectX=function(b){return arguments.length?(r=b?-1:1,v()):r<0},x.reflectY=function(b){return arguments.length?(i=b?-1:1,v()):i<0},x.fitExtent=function(b,_){return Ec(x,b,_)},x.fitSize=function(b,_){return hm(x,b,_)},x.fitWidth=function(b,_){return dm(x,b,_)},x.fitHeight=function(b,_){return gm(x,b,_)},x}function WA(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),e*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}WA.invert=function(t,e){var n=e,r=25,i;do{var a=n*n,o=a*a;n-=i=(n*(1.007226+a*(.015085+o*(-.044475+.028874*a-.005916*o)))-e)/(1.007226+a*(.015085*3+o*(-.044475*7+.028874*9*a-.005916*11*o)))}while(vt(i)>J&&--r>0);return[t/(.8707+(a=n*n)*(-.131979+a*(-.013791+a*a*a*(.003971-.001529*a)))),n]};function hL(){return xr(WA).scale(175.295)}function HA(t,e){return[rt(e)*Q(t),Q(e)]}HA.invert=es(cn);function dL(){return xr(HA).scale(249.5).clipAngle(90+J)}function GA(t,e){var n=rt(e),r=1+rt(t)*n;return[n*Q(t)/r,Q(e)/r]}GA.invert=es(function(t){return 2*Za(t)});function gL(){return xr(GA).scale(250).clipAngle(142)}function VA(t,e){return[Hl(fm((Rt+e)/2)),-t]}VA.invert=function(t,e){return[-e,2*Za(vA(t))-Rt]};function pL(){var t=qA(VA),e=t.center,n=t.rotate;return t.center=function(r){return arguments.length?e([-r[1],r[0]]):(r=e(),[r[1],-r[0]])},t.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}var mL=Math.abs,Sd=Math.cos,af=Math.sin,yL=1e-6,XA=Math.PI,Dd=XA/2,gx=vL(2);function px(t){return t>1?Dd:t<-1?-Dd:Math.asin(t)}function vL(t){return t>0?Math.sqrt(t):0}function xL(t,e){var n=t*af(e),r=30,i;do e-=i=(e+af(e)-n)/(1+Sd(e));while(mL(i)>yL&&--r>0);return e/2}function bL(t,e,n){function r(i,a){return[t*i*Sd(a=xL(n,a)),e*af(a)]}return r.invert=function(i,a){return a=px(a/e),[i/(t*Sd(a)),px((2*a+af(2*a))/n)]},r}var wL=bL(gx/Dd,gx,XA);function _L(){return d4(wL).scale(169.529)}const ML=zA(),$d=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function kL(t,e){return function n(){const r=e();return r.type=t,r.path=zA().projection(r),r.copy=r.copy||function(){const i=n();return $d.forEach(a=>{r[a]&&i[a](r[a]())}),i.path.pointRadius(r.path.pointRadius()),i},r}}function mm(t,e){if(!t||typeof t!="string")throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(of[t]=kL(t,e),this):of[t]||null}function ZA(t){return t&&t.path||ML}const of={albers:BA,albersusa:Jz,azimuthalequalarea:tL,azimuthalequidistant:eL,conicconformal:iL,conicequalarea:ef,conicequidistant:uL,equalEarth:lL,equirectangular:aL,gnomonic:fL,identity:cL,mercator:nL,mollweide:_L,naturalEarth1:hL,orthographic:dL,stereographic:gL,transversemercator:pL};for(const t in of)mm(t,of[t]);var Cr=1e-6,mx=Math.abs,zs=Math.ceil;function yx(t,e,n){var r=yi(t,e-Cr,n).concat(e);return function(i){return r.map(function(a){return[i,a]})}}function vx(t,e,n){var r=yi(t,e-Cr,n).concat(e);return function(i){return r.map(function(a){return[a,i]})}}function AL(){var t,e,n,r,i,a,o,u,s=10,l=s,f=90,c=360,h,d,g,p,m=2.5;function y(){return{type:"MultiLineString",coordinates:v()}}function v(){return yi(zs(r/f)*f,n,f).map(g).concat(yi(zs(u/c)*c,o,c).map(p)).concat(yi(zs(e/s)*s,t,s).filter(function(x){return mx(x%f)>Cr}).map(h)).concat(yi(zs(a/l)*l,i,l).filter(function(x){return mx(x%c)>Cr}).map(d))}return y.lines=function(){return v().map(function(x){return{type:"LineString",coordinates:x}})},y.outline=function(){return{type:"Polygon",coordinates:[g(r).concat(p(o).slice(1),g(n).reverse().slice(1),p(u).reverse().slice(1))]}},y.extent=function(x){return arguments.length?y.extentMajor(x).extentMinor(x):y.extentMinor()},y.extentMajor=function(x){return arguments.length?(r=+x[0][0],n=+x[1][0],u=+x[0][1],o=+x[1][1],r>n&&(x=r,r=n,n=x),u>o&&(x=u,u=o,o=x),y.precision(m)):[[r,u],[n,o]]},y.extentMinor=function(x){return arguments.length?(e=+x[0][0],t=+x[1][0],a=+x[0][1],i=+x[1][1],e>t&&(x=e,e=t,t=x),a>i&&(x=a,a=i,i=x),y.precision(m)):[[e,a],[t,i]]},y.step=function(x){return arguments.length?y.stepMajor(x).stepMinor(x):y.stepMinor()},y.stepMajor=function(x){return arguments.length?(f=+x[0],c=+x[1],y):[f,c]},y.stepMinor=function(x){return arguments.length?(s=+x[0],l=+x[1],y):[s,l]},y.precision=function(x){return arguments.length?(m=+x,h=yx(a,i,90),d=vx(e,t,m),g=yx(u,o,90),p=vx(r,n,m),y):m},y.extentMajor([[-180,-90+Cr],[180,90-Cr]]).extentMinor([[-180,-80-Cr],[180,80+Cr]])}function ym(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function KA(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ns(){}var ku=.7,uf=1/ku,va="\\s*([+-]?\\d+)\\s*",Au="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",jn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",EL=/^#([0-9a-f]{3,8})$/,CL=new RegExp("^rgb\\("+[va,va,va]+"\\)$"),SL=new RegExp("^rgb\\("+[jn,jn,jn]+"\\)$"),DL=new RegExp("^rgba\\("+[va,va,va,Au]+"\\)$"),$L=new RegExp("^rgba\\("+[jn,jn,jn,Au]+"\\)$"),FL=new RegExp("^hsl\\("+[Au,jn,jn]+"\\)$"),TL=new RegExp("^hsla\\("+[Au,jn,jn,Au]+"\\)$"),xx={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ym(ns,vm,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:bx,formatHex:bx,formatHsl:RL,formatRgb:wx,toString:wx});function bx(){return this.rgb().formatHex()}function RL(){return QA(this).formatHsl()}function wx(){return this.rgb().formatRgb()}function vm(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=EL.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?_x(e):n===3?new He(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ls(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ls(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=CL.exec(t))?new He(e[1],e[2],e[3],1):(e=SL.exec(t))?new He(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=DL.exec(t))?Ls(e[1],e[2],e[3],e[4]):(e=$L.exec(t))?Ls(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=FL.exec(t))?Ax(e[1],e[2]/100,e[3]/100,1):(e=TL.exec(t))?Ax(e[1],e[2]/100,e[3]/100,e[4]):xx.hasOwnProperty(t)?_x(xx[t]):t==="transparent"?new He(NaN,NaN,NaN,0):null}function _x(t){return new He(t>>16&255,t>>8&255,t&255,1)}function Ls(t,e,n,r){return r<=0&&(t=e=n=NaN),new He(t,e,n,r)}function NL(t){return t instanceof ns||(t=vm(t)),t?(t=t.rgb(),new He(t.r,t.g,t.b,t.opacity)):new He}function Fd(t,e,n,r){return arguments.length===1?NL(t):new He(t,e,n,r==null?1:r)}function He(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}ym(He,Fd,KA(ns,{brighter:function(t){return t=t==null?uf:Math.pow(uf,t),new He(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?ku:Math.pow(ku,t),new He(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Mx,formatHex:Mx,formatRgb:kx,toString:kx}));function Mx(){return"#"+zh(this.r)+zh(this.g)+zh(this.b)}function kx(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function zh(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function Ax(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Bn(t,e,n,r)}function QA(t){if(t instanceof Bn)return new Bn(t.h,t.s,t.l,t.opacity);if(t instanceof ns||(t=vm(t)),!t)return new Bn;if(t instanceof Bn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,u=a-i,s=(a+i)/2;return u?(e===a?o=(n-r)/u+(n<r)*6:n===a?o=(r-e)/u+2:o=(e-n)/u+4,u/=s<.5?a+i:2-a-i,o*=60):u=s>0&&s<1?0:o,new Bn(o,u,s,t.opacity)}function OL(t,e,n,r){return arguments.length===1?QA(t):new Bn(t,e,n,r==null?1:r)}function Bn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}ym(Bn,OL,KA(ns,{brighter:function(t){return t=t==null?uf:Math.pow(uf,t),new Bn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?ku:Math.pow(ku,t),new Bn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new He(Lh(t>=240?t-240:t+120,i,r),Lh(t,i,r),Lh(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function Lh(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function zL(){}const ir=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function JA(){var t=1,e=1,n=u;function r(s,l){return l.map(f=>i(s,f))}function i(s,l){var f=[],c=[];return a(s,l,h=>{n(h,s,l),LL(h)>0?f.push([h]):c.push(h)}),c.forEach(h=>{for(var d=0,g=f.length,p;d<g;++d)if(BL((p=f[d])[0],h)!==-1){p.push(h);return}}),{type:"MultiPolygon",value:l,coordinates:f}}function a(s,l,f){var c=new Array,h=new Array,d,g,p,m,y,v;for(d=g=-1,m=s[0]>=l,ir[m<<1].forEach(x);++d<t-1;)p=m,m=s[d+1]>=l,ir[p|m<<1].forEach(x);for(ir[m<<0].forEach(x);++g<e-1;){for(d=-1,m=s[g*t+t]>=l,y=s[g*t]>=l,ir[m<<1|y<<2].forEach(x);++d<t-1;)p=m,m=s[g*t+t+d+1]>=l,v=y,y=s[g*t+d+1]>=l,ir[p|m<<1|y<<2|v<<3].forEach(x);ir[m|y<<3].forEach(x)}for(d=-1,y=s[g*t]>=l,ir[y<<2].forEach(x);++d<t-1;)v=y,y=s[g*t+d+1]>=l,ir[y<<2|v<<3].forEach(x);ir[y<<3].forEach(x);function x(b){var _=[b[0][0]+d,b[0][1]+g],M=[b[1][0]+d,b[1][1]+g],w=o(_),A=o(M),S,C;(S=h[w])?(C=c[A])?(delete h[S.end],delete c[C.start],S===C?(S.ring.push(M),f(S.ring)):c[S.start]=h[C.end]={start:S.start,end:C.end,ring:S.ring.concat(C.ring)}):(delete h[S.end],S.ring.push(M),h[S.end=A]=S):(S=c[A])?(C=h[w])?(delete c[S.start],delete h[C.end],S===C?(S.ring.push(M),f(S.ring)):c[C.start]=h[S.end]={start:C.start,end:S.end,ring:C.ring.concat(S.ring)}):(delete c[S.start],S.ring.unshift(_),c[S.start=w]=S):c[w]=h[A]={start:w,end:A,ring:[_,M]}}}function o(s){return s[0]*2+s[1]*(t+1)*4}function u(s,l,f){s.forEach(c=>{var h=c[0],d=c[1],g=h|0,p=d|0,m,y=l[p*t+g];h>0&&h<t&&g===h&&(m=l[p*t+g-1],c[0]=h+(f-m)/(y-m)-.5),d>0&&d<e&&p===d&&(m=l[(p-1)*t+g],c[1]=d+(f-m)/(y-m)-.5)})}return r.contour=i,r.size=function(s){if(!arguments.length)return[t,e];var l=Math.floor(s[0]),f=Math.floor(s[1]);return l>=0&&f>=0||z("invalid size"),t=l,e=f,r},r.smooth=function(s){return arguments.length?(n=s?u:zL,r):n===u},r}function LL(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}function BL(t,e){for(var n=-1,r=e.length,i;++n<r;)if(i=PL(t,e[n]))return i;return 0}function PL(t,e){for(var n=e[0],r=e[1],i=-1,a=0,o=t.length,u=o-1;a<o;u=a++){var s=t[a],l=s[0],f=s[1],c=t[u],h=c[0],d=c[1];if(UL(s,c,e))return 0;f>r!=d>r&&n<(h-l)*(r-f)/(d-f)+l&&(i=-i)}return i}function UL(t,e,n){var r;return IL(t,e,n)&&qL(t[r=+(t[0]===e[0])],n[r],e[r])}function IL(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}function qL(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}function tE(t,e,n){return function(r){var i=Vn(r),a=n?Math.min(i[0],0):i[0],o=i[1],u=o-a,s=e?bz(a,o,t):u/(t+1);return yi(a+s,o,s)}}function xm(t){R.call(this,null,t)}xm.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]};P(xm,R,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||Ee,a=JA().smooth(t.smooth!==!1),o=t.thresholds||jL(r,i,t),u=t.as===null?null:t.as||"contour",s=[];return r.forEach(l=>{const f=i(l),c=a.size([f.width,f.height])(f.values,G(o)?o:o(f.values));YL(c,f,l,t),c.forEach(h=>{s.push(Hf(l,gt(u!=null?{[u]:h}:h)))})}),this.value&&(n.rem=this.value),this.value=n.source=n.add=s,n}});function jL(t,e,n){const r=tE(n.levels||10,n.nice,n.zero!==!1);return n.resolve!=="shared"?r:r(t.map(i=>ul(e(i).values)))}function YL(t,e,n,r){let i=r.scale||e.scale,a=r.translate||e.translate;if(nt(i)&&(i=i(n,r)),nt(a)&&(a=a(n,r)),(i===1||i==null)&&!a)return;const o=(Yr(i)?i:i[0])||1,u=(Yr(i)?i:i[1])||1,s=a&&a[0]||0,l=a&&a[1]||0;t.forEach(eE(e,o,u,s,l))}function eE(t,e,n,r,i){const a=t.x1||0,o=t.y1||0,u=e*n<0;function s(c){c.forEach(l)}function l(c){u&&c.reverse(),c.forEach(f)}function f(c){c[0]=(c[0]-a)*e+r,c[1]=(c[1]-o)*n+i}return function(c){return c.coordinates.forEach(s),c}}function Ex(t,e,n){const r=t>=0?t:r1(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function Bh(t){return nt(t)?t:ge(+t)}function nE(){var t=s=>s[0],e=s=>s[1],n=qa,r=[-1,-1],i=960,a=500,o=2;function u(s,l){const f=Ex(r[0],s,t)>>o,c=Ex(r[1],s,e)>>o,h=f?f+2:0,d=c?c+2:0,g=2*h+(i>>o),p=2*d+(a>>o),m=new Float32Array(g*p),y=new Float32Array(g*p);let v=m;s.forEach(b=>{const _=h+(+t(b)>>o),M=d+(+e(b)>>o);_>=0&&_<g&&M>=0&&M<p&&(m[_+M*g]+=+n(b))}),f>0&&c>0?(ea(g,p,m,y,f),na(g,p,y,m,c),ea(g,p,m,y,f),na(g,p,y,m,c),ea(g,p,m,y,f),na(g,p,y,m,c)):f>0?(ea(g,p,m,y,f),ea(g,p,y,m,f),ea(g,p,m,y,f),v=y):c>0&&(na(g,p,m,y,c),na(g,p,y,m,c),na(g,p,m,y,c),v=y);const x=l?Math.pow(2,-2*o):1/wz(v);for(let b=0,_=g*p;b<_;++b)v[b]*=x;return{values:v,scale:1<<o,width:g,height:p,x1:h,y1:d,x2:h+(i>>o),y2:d+(a>>o)}}return u.x=function(s){return arguments.length?(t=Bh(s),u):t},u.y=function(s){return arguments.length?(e=Bh(s),u):e},u.weight=function(s){return arguments.length?(n=Bh(s),u):n},u.size=function(s){if(!arguments.length)return[i,a];var l=+s[0],f=+s[1];return l>=0&&f>=0||z("invalid size"),i=l,a=f,u},u.cellSize=function(s){return arguments.length?((s=+s)>=1||z("invalid cell size"),o=Math.floor(Math.log(s)/Math.LN2),u):1<<o},u.bandwidth=function(s){return arguments.length?(s=Z(s),s.length===1&&(s=[+s[0],+s[0]]),s.length!==2&&z("invalid bandwidth"),r=s,u):r},u}function ea(t,e,n,r,i){const a=(i<<1)+1;for(let o=0;o<e;++o)for(let u=0,s=0;u<t+i;++u)u<t&&(s+=n[u+o*t]),u>=i&&(u>=a&&(s-=n[u-a+o*t]),r[u-i+o*t]=s/Math.min(u+1,t-1+a-u,a))}function na(t,e,n,r,i){const a=(i<<1)+1;for(let o=0;o<t;++o)for(let u=0,s=0;u<e+i;++u)u<e&&(s+=n[o+u*t]),u>=i&&(u>=a&&(s-=n[o+(u-a)*t]),r[o+(u-i)*t]=s/Math.min(u+1,e-1+a-u,a))}function bm(t){R.call(this,null,t)}bm.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const WL=["x","y","weight","size","cellSize","bandwidth"];function rE(t,e){return WL.forEach(n=>e[n]!=null?t[n](e[n]):0),t}P(bm,R,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=HL(r,t.groupby),a=(t.groupby||[]).map(Nt),o=rE(nE(),t),u=t.as||"grid",s=[];function l(f,c){for(let h=0;h<a.length;++h)f[a[h]]=c[h];return f}return s=i.map(f=>gt(l({[u]:o(f,t.counts)},f.dims))),this.value&&(n.rem=this.value),this.value=n.source=n.add=s,n}});function HL(t,e){var n=[],r=f=>f(u),i,a,o,u,s,l;if(e==null)n.push(t);else for(i={},a=0,o=t.length;a<o;++a)u=t[a],s=e.map(r),l=i[s],l||(i[s]=l=[],l.dims=s,n.push(l)),l.push(u);return n}function wm(t){R.call(this,null,t)}wm.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]};P(wm,R,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=JA().smooth(t.smooth!==!1),i=t.values,a=t.thresholds||tE(t.count||10,t.nice,!!i),o=t.size,u,s;return i||(i=e.materialize(e.SOURCE).source,u=rE(nE(),t)(i,!0),s=eE(u,u.scale||1,u.scale||1,0,0),o=[u.width,u.height],i=u.values),a=G(a)?a:a(i),i=r.size(o)(i,a),s&&i.forEach(s),this.value&&(n.rem=this.value),this.value=n.source=n.add=(i||[]).map(gt),n}});const Td="Feature",_m="FeatureCollection",GL="MultiPoint";function Mm(t){R.call(this,null,t)}Mm.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]};P(Mm,R,{transform(t,e){var n=this._features,r=this._points,i=t.fields,a=i&&i[0],o=i&&i[1],u=t.geojson||!i&&Ee,s=e.ADD,l;l=t.modified()||e.changed(e.REM)||e.modified(fe(u))||a&&e.modified(fe(a))||o&&e.modified(fe(o)),(!this.value||l)&&(s=e.SOURCE,this._features=n=[],this._points=r=[]),u&&e.visit(s,f=>n.push(u(f))),a&&o&&(e.visit(s,f=>{var c=a(f),h=o(f);c!=null&&h!=null&&(c=+c)===c&&(h=+h)===h&&r.push([c,h])}),n=n.concat({type:Td,geometry:{type:GL,coordinates:r}})),this.value={type:_m,features:n}}});function km(t){R.call(this,null,t)}km.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]};P(km,R,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||Ee,a=t.as||"path",o=n.SOURCE;!r||t.modified()?(this.value=r=ZA(t.projection),n.materialize().reflow()):o=i===Ee||e.modified(i.fields)?n.ADD_MOD:n.ADD;const u=VL(r,t.pointRadius);return n.visit(o,s=>s[a]=r(i(s))),r.pointRadius(u),n.modifies(a)}});function VL(t,e){const n=t.pointRadius();return t.context(null),e!=null&&t.pointRadius(e),n}function Am(t){R.call(this,null,t)}Am.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]};P(Am,R,{transform(t,e){var n=t.projection,r=t.fields[0],i=t.fields[1],a=t.as||["x","y"],o=a[0],u=a[1],s;function l(f){const c=n([r(f),i(f)]);c?(f[o]=c[0],f[u]=c[1]):(f[o]=void 0,f[u]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,l):(s=e.modified(r.fields)||e.modified(i.fields),e.visit(s?e.ADD_MOD:e.ADD,l)),e.modifies(a)}});function Em(t){R.call(this,null,t)}Em.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]};P(Em,R,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",a=n.ADD;return(!r||t.modified())&&(this.value=r=XL(ZA(t.projection),t.field||Le("datum"),t.pointRadius),n.materialize().reflow(),a=n.SOURCE),n.visit(a,o=>o[i]=r),n.modifies(i)}});function XL(t,e,n){const r=n==null?i=>t(e(i)):i=>{var a=t.pointRadius(),o=t.pointRadius(n)(e(i));return t.pointRadius(a),o};return r.context=i=>(t.context(i),r),r}function Cm(t){R.call(this,[],t),this.generator=AL()}Cm.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]};P(Cm,R,{transform(t,e){var n=this.value,r=this.generator,i;if(!n.length||t.modified())for(const a in t)nt(r[a])&&r[a](t[a]);return i=r(),n.length?e.mod.push(h3(n[0],i)):e.add.push(gt(i)),n[0]=i,e}});function Sm(t){R.call(this,null,t)}Sm.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]};P(Sm,R,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r=t.resolve==="shared",i=t.field||Ee,a=KL(t.opacity,t),o=ZL(t.color,t),u=t.as||"image",s={$x:0,$y:0,$value:0,$max:r?ul(n.map(l=>ul(i(l).values))):0};return n.forEach(l=>{const f=i(l),c=tt({},l,s);r||(c.$max=ul(f.values||[])),l[u]=QL(f,c,o.dep?o:ge(o(c)),a.dep?a:ge(a(c)))}),e.reflow(!0).modifies(u)}});function ZL(t,e){let n;return nt(t)?(n=r=>Fd(t(r,e)),n.dep=iE(t)):n=ge(Fd(t||"#888")),n}function KL(t,e){let n;return nt(t)?(n=r=>t(r,e),n.dep=iE(t)):t?n=ge(t):(n=r=>r.$value/r.$max||0,n.dep=!0),n}function iE(t){if(!nt(t))return!1;const e=En(fe(t));return e.$x||e.$y||e.$value||e.$max}function QL(t,e,n,r){const i=t.width,a=t.height,o=t.x1||0,u=t.y1||0,s=t.x2||i,l=t.y2||a,f=t.values,c=f?m=>f[m]:$r,h=Ga(s-o,l-u),d=h.getContext("2d"),g=d.getImageData(0,0,s-o,l-u),p=g.data;for(let m=u,y=0;m<l;++m){e.$y=m-u;for(let v=o,x=m*i;v<s;++v,y+=4){e.$x=v-o,e.$value=c(v+x);const b=n(e);p[y+0]=b.r,p[y+1]=b.g,p[y+2]=b.b,p[y+3]=~~(255*r(e))}}return d.putImageData(g,0,0),h}function aE(t){R.call(this,null,t),this.modified(!0)}P(aE,R,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=tB(t.type),$d.forEach(r=>{t[r]!=null&&Cx(n,r,t[r])})):$d.forEach(r=>{t.modified(r)&&Cx(n,r,t[r])}),t.pointRadius!=null&&n.path.pointRadius(t.pointRadius),t.fit&&JL(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});function JL(t,e){const n=eB(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}function tB(t){const e=mm((t||"mercator").toLowerCase());return e||z("Unrecognized projection type: "+t),e()}function Cx(t,e,n){nt(t[e])&&t[e](n)}function eB(t){return t=Z(t),t.length===1?t[0]:{type:_m,features:t.reduce((e,n)=>e.concat(nB(n)),[])}}function nB(t){return t.type===_m?t.features:Z(t).filter(e=>e!=null).map(e=>e.type===Td?e:{type:Td,geometry:e})}const rB=Object.freeze(Object.defineProperty({__proto__:null,contour:wm,geojson:Mm,geopath:km,geopoint:Am,geoshape:Em,graticule:Cm,heatmap:Sm,isocontour:xm,kde2d:bm,projection:aE},Symbol.toStringTag,{value:"Module"}));function iB(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var a,o=n.length,u,s=0,l=0;for(a=0;a<o;++a)u=n[a],s+=u.x,l+=u.y;for(s=(s/o-t)*r,l=(l/o-e)*r,a=0;a<o;++a)u=n[a],u.x-=s,u.y-=l}return i.initialize=function(a){n=a},i.x=function(a){return arguments.length?(t=+a,i):t},i.y=function(a){return arguments.length?(e=+a,i):e},i.strength=function(a){return arguments.length?(r=+a,i):r},i}function ke(t){return function(){return t}}function Br(t){return(t()-.5)*1e-6}function aB(t){return t.x+t.vx}function oB(t){return t.y+t.vy}function uB(t){var e,n,r,i=1,a=1;typeof t!="function"&&(t=ke(t==null?1:+t));function o(){for(var l,f=e.length,c,h,d,g,p,m,y=0;y<a;++y)for(c=xg(e,aB,oB).visitAfter(u),l=0;l<f;++l)h=e[l],p=n[h.index],m=p*p,d=h.x+h.vx,g=h.y+h.vy,c.visit(v);function v(x,b,_,M,w){var A=x.data,S=x.r,C=p+S;if(A){if(A.index>h.index){var E=d-A.x-A.vx,$=g-A.y-A.vy,F=E*E+$*$;F<C*C&&(E===0&&(E=Br(r),F+=E*E),$===0&&($=Br(r),F+=$*$),F=(C-(F=Math.sqrt(F)))/F*i,h.vx+=(E*=F)*(C=(S*=S)/(m+S)),h.vy+=($*=F)*C,A.vx-=E*(C=1-C),A.vy-=$*C)}return}return b>d+C||M<d-C||_>g+C||w<g-C}}function u(l){if(l.data)return l.r=n[l.data.index];for(var f=l.r=0;f<4;++f)l[f]&&l[f].r>l.r&&(l.r=l[f].r)}function s(){if(e){var l,f=e.length,c;for(n=new Array(f),l=0;l<f;++l)c=e[l],n[c.index]=+t(c,l,e)}}return o.initialize=function(l,f){e=l,r=f,s()},o.iterations=function(l){return arguments.length?(a=+l,o):a},o.strength=function(l){return arguments.length?(i=+l,o):i},o.radius=function(l){return arguments.length?(t=typeof l=="function"?l:ke(+l),s(),o):t},o}function sB(t){return t.index}function Sx(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function lB(t){var e=sB,n=c,r,i=ke(30),a,o,u,s,l,f=1;t==null&&(t=[]);function c(m){return 1/Math.min(u[m.source.index],u[m.target.index])}function h(m){for(var y=0,v=t.length;y<f;++y)for(var x=0,b,_,M,w,A,S,C;x<v;++x)b=t[x],_=b.source,M=b.target,w=M.x+M.vx-_.x-_.vx||Br(l),A=M.y+M.vy-_.y-_.vy||Br(l),S=Math.sqrt(w*w+A*A),S=(S-a[x])/S*m*r[x],w*=S,A*=S,M.vx-=w*(C=s[x]),M.vy-=A*C,_.vx+=w*(C=1-C),_.vy+=A*C}function d(){if(o){var m,y=o.length,v=t.length,x=new Map(o.map((_,M)=>[e(_,M,o),_])),b;for(m=0,u=new Array(y);m<v;++m)b=t[m],b.index=m,typeof b.source!="object"&&(b.source=Sx(x,b.source)),typeof b.target!="object"&&(b.target=Sx(x,b.target)),u[b.source.index]=(u[b.source.index]||0)+1,u[b.target.index]=(u[b.target.index]||0)+1;for(m=0,s=new Array(v);m<v;++m)b=t[m],s[m]=u[b.source.index]/(u[b.source.index]+u[b.target.index]);r=new Array(v),g(),a=new Array(v),p()}}function g(){if(o)for(var m=0,y=t.length;m<y;++m)r[m]=+n(t[m],m,t)}function p(){if(o)for(var m=0,y=t.length;m<y;++m)a[m]=+i(t[m],m,t)}return h.initialize=function(m,y){o=m,l=y,d()},h.links=function(m){return arguments.length?(t=m,d(),h):t},h.id=function(m){return arguments.length?(e=m,h):e},h.iterations=function(m){return arguments.length?(f=+m,h):f},h.strength=function(m){return arguments.length?(n=typeof m=="function"?m:ke(+m),g(),h):n},h.distance=function(m){return arguments.length?(i=typeof m=="function"?m:ke(+m),p(),h):i},h}const fB=1664525,cB=1013904223,Dx=4294967296;function hB(){let t=1;return()=>(t=(fB*t+cB)%Dx)/Dx}function dB(t){return t.x}function gB(t){return t.y}var pB=10,mB=Math.PI*(3-Math.sqrt(5));function yB(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,u=new Map,s=x6(c),l=b6("tick","end"),f=hB();t==null&&(t=[]);function c(){h(),l.call("tick",e),n<r&&(s.stop(),l.call("end",e))}function h(p){var m,y=t.length,v;p===void 0&&(p=1);for(var x=0;x<p;++x)for(n+=(a-n)*i,u.forEach(function(b){b(n)}),m=0;m<y;++m)v=t[m],v.fx==null?v.x+=v.vx*=o:(v.x=v.fx,v.vx=0),v.fy==null?v.y+=v.vy*=o:(v.y=v.fy,v.vy=0);return e}function d(){for(var p=0,m=t.length,y;p<m;++p){if(y=t[p],y.index=p,y.fx!=null&&(y.x=y.fx),y.fy!=null&&(y.y=y.fy),isNaN(y.x)||isNaN(y.y)){var v=pB*Math.sqrt(.5+p),x=p*mB;y.x=v*Math.cos(x),y.y=v*Math.sin(x)}(isNaN(y.vx)||isNaN(y.vy))&&(y.vx=y.vy=0)}}function g(p){return p.initialize&&p.initialize(t,f),p}return d(),e={tick:h,restart:function(){return s.restart(c),e},stop:function(){return s.stop(),e},nodes:function(p){return arguments.length?(t=p,d(),u.forEach(g),e):t},alpha:function(p){return arguments.length?(n=+p,e):n},alphaMin:function(p){return arguments.length?(r=+p,e):r},alphaDecay:function(p){return arguments.length?(i=+p,e):+i},alphaTarget:function(p){return arguments.length?(a=+p,e):a},velocityDecay:function(p){return arguments.length?(o=1-p,e):1-o},randomSource:function(p){return arguments.length?(f=p,u.forEach(g),e):f},force:function(p,m){return arguments.length>1?(m==null?u.delete(p):u.set(p,g(m)),e):u.get(p)},find:function(p,m,y){var v=0,x=t.length,b,_,M,w,A;for(y==null?y=1/0:y*=y,v=0;v<x;++v)w=t[v],b=p-w.x,_=m-w.y,M=b*b+_*_,M<y&&(A=w,y=M);return A},on:function(p,m){return arguments.length>1?(l.on(p,m),e):l.on(p)}}}function vB(){var t,e,n,r,i=ke(-30),a,o=1,u=1/0,s=.81;function l(d){var g,p=t.length,m=xg(t,dB,gB).visitAfter(c);for(r=d,g=0;g<p;++g)e=t[g],m.visit(h)}function f(){if(t){var d,g=t.length,p;for(a=new Array(g),d=0;d<g;++d)p=t[d],a[p.index]=+i(p,d,t)}}function c(d){var g=0,p,m,y=0,v,x,b;if(d.length){for(v=x=b=0;b<4;++b)(p=d[b])&&(m=Math.abs(p.value))&&(g+=p.value,y+=m,v+=m*p.x,x+=m*p.y);d.x=v/y,d.y=x/y}else{p=d,p.x=p.data.x,p.y=p.data.y;do g+=a[p.data.index];while(p=p.next)}d.value=g}function h(d,g,p,m){if(!d.value)return!0;var y=d.x-e.x,v=d.y-e.y,x=m-g,b=y*y+v*v;if(x*x/s<b)return b<u&&(y===0&&(y=Br(n),b+=y*y),v===0&&(v=Br(n),b+=v*v),b<o&&(b=Math.sqrt(o*b)),e.vx+=y*d.value*r/b,e.vy+=v*d.value*r/b),!0;if(d.length||b>=u)return;(d.data!==e||d.next)&&(y===0&&(y=Br(n),b+=y*y),v===0&&(v=Br(n),b+=v*v),b<o&&(b=Math.sqrt(o*b)));do d.data!==e&&(x=a[d.data.index]*r/b,e.vx+=y*x,e.vy+=v*x);while(d=d.next)}return l.initialize=function(d,g){t=d,n=g,f()},l.strength=function(d){return arguments.length?(i=typeof d=="function"?d:ke(+d),f(),l):i},l.distanceMin=function(d){return arguments.length?(o=d*d,l):Math.sqrt(o)},l.distanceMax=function(d){return arguments.length?(u=d*d,l):Math.sqrt(u)},l.theta=function(d){return arguments.length?(s=d*d,l):Math.sqrt(s)},l}function xB(t){var e=ke(.1),n,r,i;typeof t!="function"&&(t=ke(t==null?0:+t));function a(u){for(var s=0,l=n.length,f;s<l;++s)f=n[s],f.vx+=(i[s]-f.x)*r[s]*u}function o(){if(n){var u,s=n.length;for(r=new Array(s),i=new Array(s),u=0;u<s;++u)r[u]=isNaN(i[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return a.initialize=function(u){n=u,o()},a.strength=function(u){return arguments.length?(e=typeof u=="function"?u:ke(+u),o(),a):e},a.x=function(u){return arguments.length?(t=typeof u=="function"?u:ke(+u),o(),a):t},a}function bB(t){var e=ke(.1),n,r,i;typeof t!="function"&&(t=ke(t==null?0:+t));function a(u){for(var s=0,l=n.length,f;s<l;++s)f=n[s],f.vy+=(i[s]-f.y)*r[s]*u}function o(){if(n){var u,s=n.length;for(r=new Array(s),i=new Array(s),u=0;u<s;++u)r[u]=isNaN(i[u]=+t(n[u],u,n))?0:+e(n[u],u,n)}}return a.initialize=function(u){n=u,o()},a.strength=function(u){return arguments.length?(e=typeof u=="function"?u:ke(+u),o(),a):e},a.y=function(u){return arguments.length?(t=typeof u=="function"?u:ke(+u),o(),a):t},a}const $x={center:iB,collide:uB,nbody:vB,link:lB,x:xB,y:bB},Io="forces",Rd=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],wB=["static","iterations"],oE=["x","y","vx","vy"];function Dm(t){R.call(this,null,t)}Dm.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:oE}]};P(Dm,R,{transform(t,e){var n=this.value,r=e.changed(e.ADD_REM),i=t.modified(Rd),a=t.iterations||300;if(n?(r&&(e.modifies("index"),n.nodes(e.source)),(i||e.changed(e.MOD))&&uE(n,t,0,e)):(this.value=n=MB(e.source,t),n.on("tick",_B(e.dataflow,this)),t.static||(r=!0,n.tick()),e.modifies("index")),i||r||t.modified(wB)||e.changed()&&t.restart){if(n.alpha(Math.max(n.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(n.alphaMin(),1/a)),t.static)for(n.stop();--a>=0;)n.tick();else if(n.stopped()&&n.restart(),!r)return e.StopPropagation}return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let u=this._argops,s=0,l=u.length,f;s<l;++s)if(f=u[s],!(f.name!==Io||f.op._argval.force!=="link")){for(var r=f.op._argops,i=0,a=r.length,o;i<a;++i)if(r[i].name==="links"&&(o=r[i].op.source)){n.pulse(o,n.changeset().reflow());break}}return e.reflow(t.modified()).modifies(oE)}});function _B(t,e){return()=>t.touch(e).run()}function MB(t,e){const n=yB(t),r=n.stop,i=n.restart;let a=!1;return n.stopped=()=>a,n.restart=()=>(a=!1,i()),n.stop=()=>(a=!0,r()),uE(n,e,!0).on("end",()=>a=!0)}function uE(t,e,n,r){var i=Z(e.forces),a,o,u,s;for(a=0,o=Rd.length;a<o;++a)u=Rd[a],u!==Io&&e.modified(u)&&t[u](e[u]);for(a=0,o=i.length;a<o;++a)s=Io+a,u=n||e.modified(Io,a)?AB(i[a]):r&&kB(i[a],r)?t.force(s):null,u&&t.force(s,u);for(o=t.numForces||0;a<o;++a)t.force(Io+a,null);return t.numForces=i.length,t}function kB(t,e){var n,r;for(n in t)if(nt(r=t[n])&&e.modified(fe(r)))return 1;return 0}function AB(t){var e,n;K($x,t.force)||z("Unrecognized force: "+t.force),e=$x[t.force]();for(n in t)nt(e[n])&&EB(e[n],t[n],t);return e}function EB(t,e,n){t(nt(e)?r=>e(r,n):e)}const CB=Object.freeze(Object.defineProperty({__proto__:null,force:Dm},Symbol.toStringTag,{value:"Module"}));function SB(t,e){return t.parent===e.parent?1:2}function DB(t){return t.reduce($B,0)/t.length}function $B(t,e){return t+e.x}function FB(t){return 1+t.reduce(TB,0)}function TB(t,e){return Math.max(t,e.y)}function RB(t){for(var e;e=t.children;)t=e[0];return t}function NB(t){for(var e;e=t.children;)t=e[e.length-1];return t}function OB(){var t=SB,e=1,n=1,r=!1;function i(a){var o,u=0;a.eachAfter(function(h){var d=h.children;d?(h.x=DB(d),h.y=FB(d)):(h.x=o?u+=t(h,o):0,h.y=0,o=h)});var s=RB(a),l=NB(a),f=s.x-t(s,l)/2,c=l.x+t(l,s)/2;return a.eachAfter(r?function(h){h.x=(h.x-a.x)*e,h.y=(a.y-h.y)*n}:function(h){h.x=(h.x-f)/(c-f)*e,h.y=(1-(a.y?h.y/a.y:1))*n})}return i.separation=function(a){return arguments.length?(t=a,i):t},i.size=function(a){return arguments.length?(r=!1,e=+a[0],n=+a[1],i):r?null:[e,n]},i.nodeSize=function(a){return arguments.length?(r=!0,e=+a[0],n=+a[1],i):r?[e,n]:null},i}function zB(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function LB(){return this.eachAfter(zB)}function BB(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function PB(t,e){for(var n=this,r=[n],i,a,o=-1;n=r.pop();)if(t.call(e,n,++o,this),i=n.children)for(a=i.length-1;a>=0;--a)r.push(i[a]);return this}function UB(t,e){for(var n=this,r=[n],i=[],a,o,u,s=-1;n=r.pop();)if(i.push(n),a=n.children)for(o=0,u=a.length;o<u;++o)r.push(a[o]);for(;n=i.pop();)t.call(e,n,++s,this);return this}function IB(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function qB(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function jB(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function YB(t){for(var e=this,n=WB(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function WB(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function HB(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function GB(){return Array.from(this)}function VB(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function XB(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*ZB(){var t=this,e,n=[t],r,i,a;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,a=r.length;i<a;++i)n.push(r[i]);while(n.length)}function $m(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=JB)):e===void 0&&(e=QB);for(var n=new Pa(t),r,i=[n],a,o,u,s;r=i.pop();)if((o=e(r.data))&&(s=(o=Array.from(o)).length))for(r.children=o,u=s-1;u>=0;--u)i.push(a=o[u]=new Pa(o[u])),a.parent=r,a.depth=r.depth+1;return n.eachBefore(sE)}function KB(){return $m(this).eachBefore(tP)}function QB(t){return t.children}function JB(t){return Array.isArray(t)?t[1]:null}function tP(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function sE(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Pa(t){this.data=t,this.depth=this.height=0,this.parent=null}Pa.prototype=$m.prototype={constructor:Pa,count:LB,each:BB,eachAfter:UB,eachBefore:PB,find:IB,sum:qB,sort:jB,path:YB,ancestors:HB,descendants:GB,leaves:VB,links:XB,copy:KB,[Symbol.iterator]:ZB};function eP(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function nP(t){for(var e=t.length,n,r;e;)r=Math.random()*e--|0,n=t[e],t[e]=t[r],t[r]=n;return t}function rP(t){for(var e=0,n=(t=nP(Array.from(t))).length,r=[],i,a;e<n;)i=t[e],a&&lE(a,i)?++e:(a=aP(r=iP(r,i)),e=0);return a}function iP(t,e){var n,r;if(Ph(e,t))return[e];for(n=0;n<t.length;++n)if(Bs(e,t[n])&&Ph(qo(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(Bs(qo(t[n],t[r]),e)&&Bs(qo(t[n],e),t[r])&&Bs(qo(t[r],e),t[n])&&Ph(fE(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function Bs(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function lE(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function Ph(t,e){for(var n=0;n<e.length;++n)if(!lE(t,e[n]))return!1;return!0}function aP(t){switch(t.length){case 1:return oP(t[0]);case 2:return qo(t[0],t[1]);case 3:return fE(t[0],t[1],t[2])}}function oP(t){return{x:t.x,y:t.y,r:t.r}}function qo(t,e){var n=t.x,r=t.y,i=t.r,a=e.x,o=e.y,u=e.r,s=a-n,l=o-r,f=u-i,c=Math.sqrt(s*s+l*l);return{x:(n+a+s/c*f)/2,y:(r+o+l/c*f)/2,r:(c+i+u)/2}}function fE(t,e,n){var r=t.x,i=t.y,a=t.r,o=e.x,u=e.y,s=e.r,l=n.x,f=n.y,c=n.r,h=r-o,d=r-l,g=i-u,p=i-f,m=s-a,y=c-a,v=r*r+i*i-a*a,x=v-o*o-u*u+s*s,b=v-l*l-f*f+c*c,_=d*g-h*p,M=(g*b-p*x)/(_*2)-r,w=(p*m-g*y)/_,A=(d*x-h*b)/(_*2)-i,S=(h*y-d*m)/_,C=w*w+S*S-1,E=2*(a+M*w+A*S),$=M*M+A*A-a*a,F=-(C?(E+Math.sqrt(E*E-4*C*$))/(2*C):$/E);return{x:r+M+w*F,y:i+A+S*F,r:F}}function Fx(t,e,n){var r=t.x-e.x,i,a,o=t.y-e.y,u,s,l=r*r+o*o;l?(a=e.r+n.r,a*=a,s=t.r+n.r,s*=s,a>s?(i=(l+s-a)/(2*l),u=Math.sqrt(Math.max(0,s/l-i*i)),n.x=t.x-i*r-u*o,n.y=t.y-i*o+u*r):(i=(l+a-s)/(2*l),u=Math.sqrt(Math.max(0,a/l-i*i)),n.x=e.x+i*r-u*o,n.y=e.y+i*o+u*r)):(n.x=e.x+n.r,n.y=e.y)}function Tx(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function Rx(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,a=(e.y*n.r+n.y*e.r)/r;return i*i+a*a}function Ps(t){this._=t,this.next=null,this.previous=null}function uP(t){if(!(i=(t=eP(t)).length))return 0;var e,n,r,i,a,o,u,s,l,f,c;if(e=t[0],e.x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;Fx(n,e,r=t[2]),e=new Ps(e),n=new Ps(n),r=new Ps(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(u=3;u<i;++u){Fx(e._,n._,r=t[u]),r=new Ps(r),s=n.next,l=e.previous,f=n._.r,c=e._.r;do if(f<=c){if(Tx(s._,r._)){n=s,e.next=n,n.previous=e,--u;continue t}f+=s._.r,s=s.next}else{if(Tx(l._,r._)){e=l,e.next=n,n.previous=e,--u;continue t}c+=l._.r,l=l.previous}while(s!==l.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,a=Rx(e);(r=r.next)!==n;)(o=Rx(r))<a&&(e=r,a=o);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=rP(e),u=0;u<i;++u)e=t[u],e.x-=r.x,e.y-=r.y;return r.r}function sP(t){return t==null?null:sf(t)}function sf(t){if(typeof t!="function")throw new Error;return t}function pi(){return 0}function oa(t){return function(){return t}}function lP(t){return Math.sqrt(t.value)}function fP(){var t=null,e=1,n=1,r=pi;function i(a){return a.x=e/2,a.y=n/2,t?a.eachBefore(Nx(t)).eachAfter(Uh(r,.5)).eachBefore(Ox(1)):a.eachBefore(Nx(lP)).eachAfter(Uh(pi,1)).eachAfter(Uh(r,a.r/Math.min(e,n))).eachBefore(Ox(Math.min(e,n)/(2*a.r))),a}return i.radius=function(a){return arguments.length?(t=sP(a),i):t},i.size=function(a){return arguments.length?(e=+a[0],n=+a[1],i):[e,n]},i.padding=function(a){return arguments.length?(r=typeof a=="function"?a:oa(+a),i):r},i}function Nx(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Uh(t,e){return function(n){if(r=n.children){var r,i,a=r.length,o=t(n)*e||0,u;if(o)for(i=0;i<a;++i)r[i].r+=o;if(u=uP(r),o)for(i=0;i<a;++i)r[i].r-=o;n.r=u+o}}}function Ox(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function cE(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function rs(t,e,n,r,i){for(var a=t.children,o,u=-1,s=a.length,l=t.value&&(r-e)/t.value;++u<s;)o=a[u],o.y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*l}function cP(){var t=1,e=1,n=0,r=!1;function i(o){var u=o.height+1;return o.x0=o.y0=n,o.x1=t,o.y1=e/u,o.eachBefore(a(e,u)),r&&o.eachBefore(cE),o}function a(o,u){return function(s){s.children&&rs(s,s.x0,o*(s.depth+1)/u,s.x1,o*(s.depth+2)/u);var l=s.x0,f=s.y0,c=s.x1-n,h=s.y1-n;c<l&&(l=c=(l+c)/2),h<f&&(f=h=(f+h)/2),s.x0=l,s.y0=f,s.x1=c,s.y1=h}}return i.round=function(o){return arguments.length?(r=!!o,i):r},i.size=function(o){return arguments.length?(t=+o[0],e=+o[1],i):[t,e]},i.padding=function(o){return arguments.length?(n=+o,i):n},i}var hP={depth:-1},zx={};function dP(t){return t.id}function gP(t){return t.parentId}function Lx(){var t=dP,e=gP;function n(r){var i=Array.from(r),a=i.length,o,u,s,l,f,c,h,d=new Map;for(u=0;u<a;++u)o=i[u],f=i[u]=new Pa(o),(c=t(o,u,r))!=null&&(c+="")&&(h=f.id=c,d.set(h,d.has(h)?zx:f)),(c=e(o,u,r))!=null&&(c+="")&&(f.parent=c);for(u=0;u<a;++u)if(f=i[u],c=f.parent){if(l=d.get(c),!l)throw new Error("missing: "+c);if(l===zx)throw new Error("ambiguous: "+c);l.children?l.children.push(f):l.children=[f],f.parent=l}else{if(s)throw new Error("multiple roots");s=f}if(!s)throw new Error("no root");if(s.parent=hP,s.eachBefore(function(g){g.depth=g.parent.depth+1,--a}).eachBefore(sE),s.parent=null,a>0)throw new Error("cycle");return s}return n.id=function(r){return arguments.length?(t=sf(r),n):t},n.parentId=function(r){return arguments.length?(e=sf(r),n):e},n}function pP(t,e){return t.parent===e.parent?1:2}function Ih(t){var e=t.children;return e?e[0]:t.t}function qh(t){var e=t.children;return e?e[e.length-1]:t.t}function mP(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function yP(t){for(var e=0,n=0,r=t.children,i=r.length,a;--i>=0;)a=r[i],a.z+=e,a.m+=e,e+=a.s+(n+=a.c)}function vP(t,e,n){return t.a.parent===e.parent?t.a:n}function ll(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}ll.prototype=Object.create(Pa.prototype);function xP(t){for(var e=new ll(t,0),n,r=[e],i,a,o,u;n=r.pop();)if(a=n._.children)for(n.children=new Array(u=a.length),o=u-1;o>=0;--o)r.push(i=n.children[o]=new ll(a[o],o)),i.parent=n;return(e.parent=new ll(null,0)).children=[e],e}function bP(){var t=pP,e=1,n=1,r=null;function i(l){var f=xP(l);if(f.eachAfter(a),f.parent.m=-f.z,f.eachBefore(o),r)l.eachBefore(s);else{var c=l,h=l,d=l;l.eachBefore(function(v){v.x<c.x&&(c=v),v.x>h.x&&(h=v),v.depth>d.depth&&(d=v)});var g=c===h?1:t(c,h)/2,p=g-c.x,m=e/(h.x+g+p),y=n/(d.depth||1);l.eachBefore(function(v){v.x=(v.x+p)*m,v.y=v.depth*y})}return l}function a(l){var f=l.children,c=l.parent.children,h=l.i?c[l.i-1]:null;if(f){yP(l);var d=(f[0].z+f[f.length-1].z)/2;h?(l.z=h.z+t(l._,h._),l.m=l.z-d):l.z=d}else h&&(l.z=h.z+t(l._,h._));l.parent.A=u(l,h,l.parent.A||c[0])}function o(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function u(l,f,c){if(f){for(var h=l,d=l,g=f,p=h.parent.children[0],m=h.m,y=d.m,v=g.m,x=p.m,b;g=qh(g),h=Ih(h),g&&h;)p=Ih(p),d=qh(d),d.a=l,b=g.z+v-h.z-m+t(g._,h._),b>0&&(mP(vP(g,l,c),l,b),m+=b,y+=b),v+=g.m,m+=h.m,x+=p.m,y+=d.m;g&&!qh(d)&&(d.t=g,d.m+=v-y),h&&!Ih(p)&&(p.t=h,p.m+=m-x,c=l)}return c}function s(l){l.x*=e,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(t=l,i):t},i.size=function(l){return arguments.length?(r=!1,e=+l[0],n=+l[1],i):r?null:[e,n]},i.nodeSize=function(l){return arguments.length?(r=!0,e=+l[0],n=+l[1],i):r?[e,n]:null},i}function Sc(t,e,n,r,i){for(var a=t.children,o,u=-1,s=a.length,l=t.value&&(i-n)/t.value;++u<s;)o=a[u],o.x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*l}var hE=(1+Math.sqrt(5))/2;function dE(t,e,n,r,i,a){for(var o=[],u=e.children,s,l,f=0,c=0,h=u.length,d,g,p=e.value,m,y,v,x,b,_,M;f<h;){d=i-n,g=a-r;do m=u[c++].value;while(!m&&c<h);for(y=v=m,_=Math.max(g/d,d/g)/(p*t),M=m*m*_,b=Math.max(v/M,M/y);c<h;++c){if(m+=l=u[c].value,l<y&&(y=l),l>v&&(v=l),M=m*m*_,x=Math.max(v/M,M/y),x>b){m-=l;break}b=x}o.push(s={value:m,dice:d<g,children:u.slice(f,c)}),s.dice?rs(s,n,r,i,p?r+=g*m/p:a):Sc(s,n,r,p?n+=d*m/p:i,a),p-=m,f=c}return o}const gE=function t(e){function n(r,i,a,o,u){dE(e,r,i,a,o,u)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(hE);function wP(){var t=gE,e=!1,n=1,r=1,i=[0],a=pi,o=pi,u=pi,s=pi,l=pi;function f(h){return h.x0=h.y0=0,h.x1=n,h.y1=r,h.eachBefore(c),i=[0],e&&h.eachBefore(cE),h}function c(h){var d=i[h.depth],g=h.x0+d,p=h.y0+d,m=h.x1-d,y=h.y1-d;m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),h.x0=g,h.y0=p,h.x1=m,h.y1=y,h.children&&(d=i[h.depth+1]=a(h)/2,g+=l(h)-d,p+=o(h)-d,m-=u(h)-d,y-=s(h)-d,m<g&&(g=m=(g+m)/2),y<p&&(p=y=(p+y)/2),t(h,g,p,m,y))}return f.round=function(h){return arguments.length?(e=!!h,f):e},f.size=function(h){return arguments.length?(n=+h[0],r=+h[1],f):[n,r]},f.tile=function(h){return arguments.length?(t=sf(h),f):t},f.padding=function(h){return arguments.length?f.paddingInner(h).paddingOuter(h):f.paddingInner()},f.paddingInner=function(h){return arguments.length?(a=typeof h=="function"?h:oa(+h),f):a},f.paddingOuter=function(h){return arguments.length?f.paddingTop(h).paddingRight(h).paddingBottom(h).paddingLeft(h):f.paddingTop()},f.paddingTop=function(h){return arguments.length?(o=typeof h=="function"?h:oa(+h),f):o},f.paddingRight=function(h){return arguments.length?(u=typeof h=="function"?h:oa(+h),f):u},f.paddingBottom=function(h){return arguments.length?(s=typeof h=="function"?h:oa(+h),f):s},f.paddingLeft=function(h){return arguments.length?(l=typeof h=="function"?h:oa(+h),f):l},f}function _P(t,e,n,r,i){var a=t.children,o,u=a.length,s,l=new Array(u+1);for(l[0]=s=o=0;o<u;++o)l[o+1]=s+=a[o].value;f(0,u,t.value,e,n,r,i);function f(c,h,d,g,p,m,y){if(c>=h-1){var v=a[c];v.x0=g,v.y0=p,v.x1=m,v.y1=y;return}for(var x=l[c],b=d/2+x,_=c+1,M=h-1;_<M;){var w=_+M>>>1;l[w]<b?_=w+1:M=w}b-l[_-1]<l[_]-b&&c+1<_&&--_;var A=l[_]-x,S=d-A;if(m-g>y-p){var C=d?(g*S+m*A)/d:m;f(c,_,A,g,p,C,y),f(_,h,S,C,p,m,y)}else{var E=d?(p*S+y*A)/d:y;f(c,_,A,g,p,m,E),f(_,h,S,g,E,m,y)}}}function MP(t,e,n,r,i){(t.depth&1?Sc:rs)(t,e,n,r,i)}const kP=function t(e){function n(r,i,a,o,u){if((s=r._squarify)&&s.ratio===e)for(var s,l,f,c,h=-1,d,g=s.length,p=r.value;++h<g;){for(l=s[h],f=l.children,c=l.value=0,d=f.length;c<d;++c)l.value+=f[c].value;l.dice?rs(l,i,a,o,p?a+=(u-a)*l.value/p:u):Sc(l,i,a,p?i+=(o-i)*l.value/p:o,u),p-=l.value}else r._squarify=s=dE(e,r,i,a,o,u),s.ratio=e}return n.ratio=function(r){return t((r=+r)>1?r:1)},n}(hE);function Nd(t,e,n){const r={};return t.each(i=>{const a=i.data;n(a)&&(r[e(a)]=i)}),t.lookup=r,t}function Fm(t){R.call(this,null,t)}Fm.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const AP=t=>t.values;P(Fm,R,{transform(t,e){e.source||z("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),a=this.value;return(!a||r||e.changed())&&(a&&a.each(o=>{o.children&&Wf(o.data)&&i.rem.push(o.data)}),this.value=a=$m({values:Z(t.keys).reduce((o,u)=>(o.key(u),o),EP()).entries(i.source)},AP),n&&a.each(o=>{o.children&&(o=gt(o.data),i.add.push(o),i.source.push(o))}),Nd(a,H,H)),i.source.root=a,i}});function EP(){const t=[],e={entries:i=>r(n(i,0),0),key:i=>(t.push(i),e)};function n(i,a){if(a>=t.length)return i;const o=i.length,u=t[a++],s={},l={};let f=-1,c,h,d;for(;++f<o;)c=u(h=i[f])+"",(d=s[c])?d.push(h):s[c]=[h];for(c in s)l[c]=n(s[c],a);return l}function r(i,a){if(++a>t.length)return i;const o=[];for(const u in i)o.push({key:u,values:r(i[u],a)});return o}return e}function br(t){R.call(this,null,t)}const CP=(t,e)=>t.parent===e.parent?1:2;P(br,R,{transform(t,e){(!e.source||!e.source.root)&&z(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,a=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(Bi(t.sort,o=>o.data)),SP(n,this.params,t),n.separation&&n.separation(t.separation!==!1?CP:qa);try{this.value=n(i)}catch(o){z(o)}return i.each(o=>DP(o,r,a)),e.reflow(t.modified()).modifies(a).modifies("leaf")}});function SP(t,e,n){for(let r,i=0,a=e.length;i<a;++i)r=e[i],r in n&&t[r](n[r])}function DP(t,e,n){const r=t.data,i=e.length-1;for(let a=0;a<i;++a)r[n[a]]=t[e[a]];r[n[i]]=t.children?t.children.length:0}const Od=["x","y","r","depth","children"];function Tm(t){br.call(this,t)}Tm.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Od.length,default:Od}]};P(Tm,br,{layout:fP,params:["radius","size","padding"],fields:Od});const zd=["x0","y0","x1","y1","depth","children"];function Rm(t){br.call(this,t)}Rm.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:zd.length,default:zd}]};P(Rm,br,{layout:cP,params:["size","round","padding"],fields:zd});function Nm(t){R.call(this,null,t)}Nm.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]};P(Nm,R,{transform(t,e){e.source||z("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),a=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),a&&(n=i.source.length?Nd(Lx().id(t.key).parentId(t.parentKey)(i.source),t.key,sn):Nd(Lx()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const Bx={tidy:bP,cluster:OB},Ld=["x","y","depth","children"];function Om(t){br.call(this,t)}Om.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:Ld.length,default:Ld}]};P(Om,br,{layout(t){const e=t||"tidy";if(K(Bx,e))return Bx[e]();z("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:Ld});function zm(t){R.call(this,[],t)}zm.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]};P(zm,R,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),a={};return r||z("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,o=>a[H(o)]=1),r.each(o=>{const u=o.data,s=o.parent&&o.parent.data;s&&a[H(u)]&&a[H(s)]&&i.add.push(gt({source:s,target:u}))}),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,o=>a[H(o)]=1),n.forEach(o=>{(a[H(o.source)]||a[H(o.target)])&&i.mod.push(o)})),i}});const Px={binary:_P,dice:rs,slice:Sc,slicedice:MP,squarify:gE,resquarify:kP},Bd=["x0","y0","x1","y1","depth","children"];function Lm(t){br.call(this,t)}Lm.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:Bd.length,default:Bd}]};P(Lm,br,{layout(){const t=wP();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{K(Px,e)?t.tile(Px[e]):z("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:Bd});const $P=Object.freeze(Object.defineProperty({__proto__:null,nest:Fm,pack:Tm,partition:Rm,stratify:Nm,tree:Om,treelinks:zm,treemap:Lm},Symbol.toStringTag,{value:"Module"})),FP=4278190080,TP=268435456,RP=.0625;function NP(t,e){const n=t.bitmap();return(e||[]).forEach(r=>n.set(t(r.boundary[0]),t(r.boundary[3]))),[n,void 0]}function OP(t,e,n,r){const i=t.width,a=t.height,o=n||r,u=Ga(i,a).getContext("2d");e.forEach(m=>pE(u,m,o));const s=new Uint32Array(u.getImageData(0,0,i,a).data.buffer),l=t.bitmap(),f=o&&t.bitmap();let c,h,d,g,p;for(h=0;h<a;++h)for(c=0;c<i;++c)p=s[h*i+c]&FP,p&&(d=t(c),g=t(h),r||l.set(d,g),o&&p^TP&&f.set(d,g));return[l,f]}function pE(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;r==="group"?e.forEach(i=>{i.items.forEach(a=>pE(t,a.items,n))}):Ze[r].draw(t,{items:n?e.map(zP):e})}function zP(t){const e=Hf(t,{});return e.stroke&&(e.strokeOpacity=1),e.fill&&(e.fillOpacity=RP,e.stroke="#000",e.strokeOpacity=1,e.strokeWidth=2),e}const ar=5,ye=31,Eu=32,Sr=new Uint32Array(Eu+1),mn=new Uint32Array(Eu+1);mn[0]=0;Sr[0]=~mn[0];for(let t=1;t<=Eu;++t)mn[t]=mn[t-1]<<1|1,Sr[t]=~mn[t];function LP(t,e){const n=new Uint32Array(~~((t*e+Eu)/Eu));function r(a,o){n[a]|=o}function i(a,o){n[a]&=o}return{array:n,get:(a,o)=>{const u=o*t+a;return n[u>>>ar]&1<<(u&ye)},set:(a,o)=>{const u=o*t+a;r(u>>>ar,1<<(u&ye))},clear:(a,o)=>{const u=o*t+a;i(u>>>ar,~(1<<(u&ye)))},getRange:(a,o,u,s)=>{let l=s,f,c,h,d;for(;l>=o;--l)if(f=l*t+a,c=l*t+u,h=f>>>ar,d=c>>>ar,h===d){if(n[h]&Sr[f&ye]&mn[(c&ye)+1])return!0}else{if(n[h]&Sr[f&ye]||n[d]&mn[(c&ye)+1])return!0;for(let g=h+1;g<d;++g)if(n[g])return!0}return!1},setRange:(a,o,u,s)=>{let l,f,c,h,d;for(;o<=s;++o)if(l=o*t+a,f=o*t+u,c=l>>>ar,h=f>>>ar,c===h)r(c,Sr[l&ye]&mn[(f&ye)+1]);else for(r(c,Sr[l&ye]),r(h,mn[(f&ye)+1]),d=c+1;d<h;++d)r(d,4294967295)},clearRange:(a,o,u,s)=>{let l,f,c,h,d;for(;o<=s;++o)if(l=o*t+a,f=o*t+u,c=l>>>ar,h=f>>>ar,c===h)i(c,mn[l&ye]|Sr[(f&ye)+1]);else for(i(c,mn[l&ye]),i(h,Sr[(f&ye)+1]),d=c+1;d<h;++d)i(d,0)},outOfBounds:(a,o,u,s)=>a<0||o<0||s>=e||u>=t}}function BP(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),a=~~((e+2*n+r)/r),o=u=>~~((u+n)/r);return o.invert=u=>u*r-n,o.bitmap=()=>LP(i,a),o.ratio=r,o.padding=n,o.width=t,o.height=e,o}function PP(t,e,n,r){const i=t.width,a=t.height;return function(o){const u=o.datum.datum.items[r].items,s=u.length,l=o.datum.fontSize,f=qn.width(o.datum,o.datum.text);let c=0,h,d,g,p,m,y,v;for(let x=0;x<s;++x)h=u[x].x,g=u[x].y,d=u[x].x2===void 0?h:u[x].x2,p=u[x].y2===void 0?g:u[x].y2,m=(h+d)/2,y=(g+p)/2,v=Math.abs(d-h+p-g),v>=c&&(c=v,o.x=m,o.y=y);return m=f/2,y=l/2,h=o.x-m,d=o.x+m,g=o.y-y,p=o.y+y,o.align="center",h<0&&d<=i?o.align="left":0<=h&&i<d&&(o.align="right"),o.baseline="middle",g<0&&p<=a?o.baseline="top":0<=g&&a<p&&(o.baseline="bottom"),!0}}function lf(t,e,n,r,i,a){let o=n/2;return t-o<0||t+o>i||e-(o=r/2)<0||e+o>a}function Pr(t,e,n,r,i,a,o,u){const s=i*a/(r*2),l=t(e-s),f=t(e+s),c=t(n-(a=a/2)),h=t(n+a);return o.outOfBounds(l,c,f,h)||o.getRange(l,c,f,h)||u&&u.getRange(l,c,f,h)}function UP(t,e,n,r){const i=t.width,a=t.height,o=e[0],u=e[1];function s(l,f,c,h,d){const g=t.invert(l),p=t.invert(f);let m=c,y=a,v;if(!lf(g,p,h,d,i,a)&&!Pr(t,g,p,d,h,m,o,u)&&!Pr(t,g,p,d,h,d,o,null)){for(;y-m>=1;)v=(m+y)/2,Pr(t,g,p,d,h,v,o,u)?y=v:m=v;if(m>c)return[g,p,m,!0]}}return function(l){const f=l.datum.datum.items[r].items,c=f.length,h=l.datum.fontSize,d=qn.width(l.datum,l.datum.text);let g=n?h:0,p=!1,m=!1,y=0,v,x,b,_,M,w,A,S,C,E,$,F,L,k,T,B,U;for(let q=0;q<c;++q){for(v=f[q].x,b=f[q].y,x=f[q].x2===void 0?v:f[q].x2,_=f[q].y2===void 0?b:f[q].y2,v>x&&(U=v,v=x,x=U),b>_&&(U=b,b=_,_=U),C=t(v),$=t(x),E=~~((C+$)/2),F=t(b),k=t(_),L=~~((F+k)/2),A=E;A>=C;--A)for(S=L;S>=F;--S)B=s(A,S,g,d,h),B&&([l.x,l.y,g,p]=B);for(A=E;A<=$;++A)for(S=L;S<=k;++S)B=s(A,S,g,d,h),B&&([l.x,l.y,g,p]=B);!p&&!n&&(T=Math.abs(x-v+_-b),M=(v+x)/2,w=(b+_)/2,T>=y&&!lf(M,w,d,h,i,a)&&!Pr(t,M,w,h,d,h,o,null)&&(y=T,l.x=M,l.y=w,m=!0))}return p||m?(M=d/2,w=h/2,o.setRange(t(l.x-M),t(l.y-w),t(l.x+M),t(l.y+w)),l.align="center",l.baseline="middle",!0):!1}}const IP=[-1,-1,1,1],qP=[-1,1,-1,1];function jP(t,e,n,r){const i=t.width,a=t.height,o=e[0],u=e[1],s=t.bitmap();return function(l){const f=l.datum.datum.items[r].items,c=f.length,h=l.datum.fontSize,d=qn.width(l.datum,l.datum.text),g=[];let p=n?h:0,m=!1,y=!1,v=0,x,b,_,M,w,A,S,C,E,$,F,L;for(let k=0;k<c;++k){for(x=f[k].x,_=f[k].y,b=f[k].x2===void 0?x:f[k].x2,M=f[k].y2===void 0?_:f[k].y2,g.push([t((x+b)/2),t((_+M)/2)]);g.length;)if([S,C]=g.pop(),!(o.get(S,C)||u.get(S,C)||s.get(S,C))){s.set(S,C);for(let T=0;T<4;++T)w=S+IP[T],A=C+qP[T],s.outOfBounds(w,A,w,A)||g.push([w,A]);if(w=t.invert(S),A=t.invert(C),E=p,$=a,!lf(w,A,d,h,i,a)&&!Pr(t,w,A,h,d,E,o,u)&&!Pr(t,w,A,h,d,h,o,null)){for(;$-E>=1;)F=(E+$)/2,Pr(t,w,A,h,d,F,o,u)?$=F:E=F;E>p&&(l.x=w,l.y=A,p=E,m=!0)}}!m&&!n&&(L=Math.abs(b-x+M-_),w=(x+b)/2,A=(_+M)/2,L>=v&&!lf(w,A,d,h,i,a)&&!Pr(t,w,A,h,d,h,o,null)&&(v=L,l.x=w,l.y=A,y=!0))}return m||y?(w=d/2,A=h/2,o.setRange(t(l.x-w),t(l.y-A),t(l.x+w),t(l.y+A)),l.align="center",l.baseline="middle",!0):!1}}const YP=["right","center","left"],WP=["bottom","middle","top"];function HP(t,e,n,r){const i=t.width,a=t.height,o=e[0],u=e[1],s=r.length;return function(l){const f=l.boundary,c=l.datum.fontSize;if(f[2]<0||f[5]<0||f[0]>i||f[3]>a)return!1;let h=0,d,g,p,m,y,v,x,b,_,M,w,A,S,C,E;for(let $=0;$<s;++$){if(d=(n[$]&3)-1,g=(n[$]>>>2&3)-1,p=d===0&&g===0||r[$]<0,m=d&&g?Math.SQRT1_2:1,y=r[$]<0?-1:1,v=f[1+d]+r[$]*d*m,w=f[4+g]+y*c*g/2+r[$]*g*m,b=w-c/2,_=w+c/2,A=t(v),C=t(b),E=t(_),!h)if(Ux(A,A,C,E,o,u,v,v,b,_,f,p))h=qn.width(l.datum,l.datum.text);else continue;if(M=v+y*h*d/2,v=M-h/2,x=M+h/2,A=t(v),S=t(x),Ux(A,S,C,E,o,u,v,x,b,_,f,p))return l.x=d?d*y<0?x:v:M,l.y=g?g*y<0?_:b:w,l.align=YP[d*y+1],l.baseline=WP[g*y+1],o.setRange(A,C,S,E),!0}return!1}}function Ux(t,e,n,r,i,a,o,u,s,l,f,c){return!(i.outOfBounds(t,n,e,r)||(c&&a?a.getRange(t,n,e,r)||!GP(o,s,u,l,f):i.getRange(t,n,e,r)))}function GP(t,e,n,r,i){return i[0]<=t&&n<=i[2]&&i[3]<=e&&r<=i[5]}const jh=0,Yh=4,Wh=8,Hh=0,Gh=1,Vh=2,VP={"top-left":jh+Hh,top:jh+Gh,"top-right":jh+Vh,left:Yh+Hh,middle:Yh+Gh,right:Yh+Vh,"bottom-left":Wh+Hh,bottom:Wh+Gh,"bottom-right":Wh+Vh},XP={naive:PP,"reduced-search":UP,floodfill:jP};function ZP(t,e,n,r,i,a,o,u,s,l,f){if(!t.length)return t;const c=Math.max(r.length,i.length),h=KP(r,c),d=QP(i,c),g=JP(t[0].datum),p=g==="group"&&t[0].datum.items[s].marktype,m=p==="area",y=tU(g,p,u,s),v=BP(e[0],e[1],l),x=m&&f==="naive",b=t.map(w=>({datum:w,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(w)}));let _;if(!x){n&&b.sort((A,S)=>n(A.datum,S.datum));let w=!1;for(let A=0;A<d.length&&!w;++A)w=d[A]===5||h[A]<0;g&&(o||m)&&(a=[t.map(A=>A.datum)].concat(a)),_=a.length?OP(v,a,w,m):NP(v,o&&b)}const M=m?XP[f](v,_,o,s):HP(v,_,d,h);return b.forEach(w=>w.opacity=+M(w)),b}function KP(t,e){const n=new Float64Array(e),r=t.length;for(let i=0;i<r;++i)n[i]=t[i]||0;for(let i=r;i<e;++i)n[i]=n[r-1];return n}function QP(t,e){const n=new Int8Array(e),r=t.length;for(let i=0;i<r;++i)n[i]|=VP[t[i]];for(let i=r;i<e;++i)n[i]=n[r-1];return n}function JP(t){return t&&t.mark&&t.mark.marktype}function tU(t,e,n,r){const i=a=>[a.x,a.x,a.x,a.y,a.y,a.y];return t?t==="line"||t==="area"?a=>i(a.datum):e==="line"?a=>{const o=a.datum.items[r].items;return i(o.length?o[n==="start"?0:o.length-1]:{x:NaN,y:NaN})}:a=>{const o=a.datum.bounds;return[o.x1,(o.x1+o.x2)/2,o.x2,o.y1,(o.y1+o.y2)/2,o.y2]}:i}const Pd=["x","y","opacity","align","baseline"],mE=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function Bm(t){R.call(this,null,t)}Bm.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:mE},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:Pd.length,default:Pd}]};P(Bm,R,{transform(t,e){function n(a){const o=t[a];return nt(o)&&e.modified(o.fields)}const r=t.modified();if(!(r||e.changed(e.ADD_REM)||n("sort")))return;(!t.size||t.size.length!==2)&&z("Size parameter should be specified as a [width, height] array.");const i=t.as||Pd;return ZP(e.materialize(e.SOURCE).source,t.size,t.sort,Z(t.offset||1),Z(t.anchor||mE),t.avoidMarks||[],t.avoidBaseMark!==!1,t.lineAnchor||"end",t.markIndex||0,t.padding||0,t.method||"naive").forEach(a=>{const o=a.datum;o[i[0]]=a.x,o[i[1]]=a.y,o[i[2]]=a.opacity,o[i[3]]=a.align,o[i[4]]=a.baseline}),e.reflow(r).modifies(i)}});const eU=Object.freeze(Object.defineProperty({__proto__:null,label:Bm},Symbol.toStringTag,{value:"Module"}));function yE(t,e){var n=[],r=function(f){return f(u)},i,a,o,u,s,l;if(e==null)n.push(t);else for(i={},a=0,o=t.length;a<o;++a)u=t[a],s=e.map(r),l=i[s],l||(i[s]=l=[],l.dims=s,n.push(l)),l.push(u);return n}function Pm(t){R.call(this,null,t)}Pm.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]};P(Pm,R,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=yE(r,t.groupby),a=(t.groupby||[]).map(Nt),o=a.length,u=t.as||[Nt(t.x),Nt(t.y)],s=[];i.forEach(l=>{F3(l,t.x,t.y,t.bandwidth||.3).forEach(f=>{const c={};for(let h=0;h<o;++h)c[a[h]]=l.dims[h];c[u[0]]=f[0],c[u[1]]=f[1],s.push(gt(c))})}),this.value&&(n.rem=this.value),this.value=n.add=n.source=s}return n}});const Ud={linear:p1,log:C3,exp:S3,pow:D3,quad:m1,poly:$3},nU=(t,e)=>t==="poly"?e:t==="quad"?2:1;function Um(t){R.call(this,null,t)}Um.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(Ud)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]};P(Um,R,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=yE(r,t.groupby),a=(t.groupby||[]).map(Nt),o=t.method||"linear",u=t.order||3,s=nU(o,u),l=t.as||[Nt(t.x),Nt(t.y)],f=Ud[o],c=[];let h=t.extent;K(Ud,o)||z("Invalid regression method: "+o),h!=null&&o==="log"&&h[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),i.forEach(d=>{if(d.length<=s){e.dataflow.warn("Skipping regression with more parameters than data points.");return}const p=f(d,t.x,t.y,u);if(t.params){c.push(gt({keys:d.dims,coef:p.coef,rSquared:p.rSquared}));return}const m=h||Vn(d,t.x),y=v=>{const x={};for(let b=0;b<a.length;++b)x[a[b]]=d.dims[b];x[l[0]]=v[0],x[l[1]]=v[1],c.push(gt(x))};o==="linear"?m.forEach(v=>y([v,p.predict(v)])):Jf(p.predict,m,25,200).forEach(y)}),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});const rU=Object.freeze(Object.defineProperty({__proto__:null,loess:Pm,regression:Um},Symbol.toStringTag,{value:"Module"})),Ix=Math.pow(2,-52),Us=new Uint32Array(512);class ff{static from(e,n=sU,r=lU){const i=e.length,a=new Float64Array(i*2);for(let o=0;o<i;o++){const u=e[o];a[2*o]=n(u),a[2*o+1]=r(u)}return new ff(a)}constructor(e){const n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:e,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:a}=this,o=e.length>>1;let u=1/0,s=1/0,l=-1/0,f=-1/0;for(let C=0;C<o;C++){const E=e[2*C],$=e[2*C+1];E<u&&(u=E),$<s&&(s=$),E>l&&(l=E),$>f&&(f=$),this._ids[C]=C}const c=(u+l)/2,h=(s+f)/2;let d=1/0,g,p,m;for(let C=0;C<o;C++){const E=Xh(c,h,e[2*C],e[2*C+1]);E<d&&(g=C,d=E)}const y=e[2*g],v=e[2*g+1];d=1/0;for(let C=0;C<o;C++){if(C===g)continue;const E=Xh(y,v,e[2*C],e[2*C+1]);E<d&&E>0&&(p=C,d=E)}let x=e[2*p],b=e[2*p+1],_=1/0;for(let C=0;C<o;C++){if(C===g||C===p)continue;const E=oU(y,v,x,b,e[2*C],e[2*C+1]);E<_&&(m=C,_=E)}let M=e[2*m],w=e[2*m+1];if(_===1/0){for(let $=0;$<o;$++)this._dists[$]=e[2*$]-e[0]||e[2*$+1]-e[1];ga(this._ids,this._dists,0,o-1);const C=new Uint32Array(o);let E=0;for(let $=0,F=-1/0;$<o;$++){const L=this._ids[$];this._dists[L]>F&&(C[E++]=L,F=this._dists[L])}this.hull=C.subarray(0,E),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Is(y,v,x,b,M,w)){const C=p,E=x,$=b;p=m,x=M,b=w,m=C,M=E,w=$}const A=uU(y,v,x,b,M,w);this._cx=A.x,this._cy=A.y;for(let C=0;C<o;C++)this._dists[C]=Xh(e[2*C],e[2*C+1],A.x,A.y);ga(this._ids,this._dists,0,o-1),this._hullStart=g;let S=3;r[g]=n[m]=p,r[p]=n[g]=m,r[m]=n[p]=g,i[g]=0,i[p]=1,i[m]=2,a.fill(-1),a[this._hashKey(y,v)]=g,a[this._hashKey(x,b)]=p,a[this._hashKey(M,w)]=m,this.trianglesLen=0,this._addTriangle(g,p,m,-1,-1,-1);for(let C=0,E,$;C<this._ids.length;C++){const F=this._ids[C],L=e[2*F],k=e[2*F+1];if(C>0&&Math.abs(L-E)<=Ix&&Math.abs(k-$)<=Ix||(E=L,$=k,F===g||F===p||F===m))continue;let T=0;for(let lt=0,At=this._hashKey(L,k);lt<this._hashSize&&(T=a[(At+lt)%this._hashSize],!(T!==-1&&T!==r[T]));lt++);T=n[T];let B=T,U;for(;U=r[B],!Is(L,k,e[2*B],e[2*B+1],e[2*U],e[2*U+1]);)if(B=U,B===T){B=-1;break}if(B===-1)continue;let q=this._addTriangle(B,F,r[B],-1,-1,i[B]);i[F]=this._legalize(q+2),i[B]=q,S++;let it=r[B];for(;U=r[it],Is(L,k,e[2*it],e[2*it+1],e[2*U],e[2*U+1]);)q=this._addTriangle(it,F,U,i[F],-1,i[it]),i[F]=this._legalize(q+2),r[it]=it,S--,it=U;if(B===T)for(;U=n[B],Is(L,k,e[2*U],e[2*U+1],e[2*B],e[2*B+1]);)q=this._addTriangle(U,F,B,-1,i[B],i[U]),this._legalize(q+2),i[U]=q,r[B]=B,S--,B=U;this._hullStart=n[F]=B,r[B]=n[it]=F,r[F]=it,a[this._hashKey(L,k)]=F,a[this._hashKey(e[2*B],e[2*B+1])]=B}this.hull=new Uint32Array(S);for(let C=0,E=this._hullStart;C<S;C++)this.hull[C]=E,E=r[E];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor(iU(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:n,_halfedges:r,coords:i}=this;let a=0,o=0;for(;;){const u=r[e],s=e-e%3;if(o=s+(e+2)%3,u===-1){if(a===0)break;e=Us[--a];continue}const l=u-u%3,f=s+(e+1)%3,c=l+(u+2)%3,h=n[o],d=n[e],g=n[f],p=n[c];if(aU(i[2*h],i[2*h+1],i[2*d],i[2*d+1],i[2*g],i[2*g+1],i[2*p],i[2*p+1])){n[e]=p,n[u]=h;const y=r[c];if(y===-1){let x=this._hullStart;do{if(this._hullTri[x]===c){this._hullTri[x]=e;break}x=this._hullPrev[x]}while(x!==this._hullStart)}this._link(e,y),this._link(u,r[o]),this._link(o,c);const v=l+(u+1)%3;a<Us.length&&(Us[a++]=v)}else{if(a===0)break;e=Us[--a]}}return o}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,r,i,a,o){const u=this.trianglesLen;return this._triangles[u]=e,this._triangles[u+1]=n,this._triangles[u+2]=r,this._link(u,i),this._link(u+1,a),this._link(u+2,o),this.trianglesLen+=3,u}}function iU(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}function Xh(t,e,n,r){const i=t-n,a=e-r;return i*i+a*a}function Zh(t,e,n,r,i,a){const o=(r-e)*(i-t),u=(n-t)*(a-e);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function Is(t,e,n,r,i,a){return(Zh(i,a,t,e,n,r)||Zh(t,e,n,r,i,a)||Zh(n,r,i,a,t,e))<0}function aU(t,e,n,r,i,a,o,u){const s=t-o,l=e-u,f=n-o,c=r-u,h=i-o,d=a-u,g=s*s+l*l,p=f*f+c*c,m=h*h+d*d;return s*(c*m-p*d)-l*(f*m-p*h)+g*(f*d-c*h)<0}function oU(t,e,n,r,i,a){const o=n-t,u=r-e,s=i-t,l=a-e,f=o*o+u*u,c=s*s+l*l,h=.5/(o*l-u*s),d=(l*f-u*c)*h,g=(o*c-s*f)*h;return d*d+g*g}function uU(t,e,n,r,i,a){const o=n-t,u=r-e,s=i-t,l=a-e,f=o*o+u*u,c=s*s+l*l,h=.5/(o*l-u*s),d=t+(l*f-u*c)*h,g=e+(o*c-s*f)*h;return{x:d,y:g}}function ga(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const a=t[i],o=e[a];let u=i-1;for(;u>=n&&e[t[u]]>o;)t[u+1]=t[u--];t[u+1]=a}else{const i=n+r>>1;let a=n+1,o=r;xo(t,i,a),e[t[n]]>e[t[r]]&&xo(t,n,r),e[t[a]]>e[t[r]]&&xo(t,a,r),e[t[n]]>e[t[a]]&&xo(t,n,a);const u=t[a],s=e[u];for(;;){do a++;while(e[t[a]]<s);do o--;while(e[t[o]]>s);if(o<a)break;xo(t,a,o)}t[n+1]=t[o],t[o]=u,r-a+1>=o-n?(ga(t,e,a,r),ga(t,e,n,o-1)):(ga(t,e,n,o-1),ga(t,e,a,r))}}function xo(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function sU(t){return t[0]}function lU(t){return t[1]}const qx=1e-6;class vi{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,n){this._+=`L${this._x1=+e},${this._y1=+n}`}arc(e,n,r){e=+e,n=+n,r=+r;const i=e+r,a=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${a}`:(Math.abs(this._x1-i)>qx||Math.abs(this._y1-a)>qx)&&(this._+="L"+i+","+a),r&&(this._+=`A${r},${r},0,1,1,${e-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=a}`)}rect(e,n,r,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class Id{constructor(){this._=[]}moveTo(e,n){this._.push([e,n])}closePath(){this._.push(this._[0].slice())}lineTo(e,n){this._.push([e,n])}value(){return this._.length?this._:null}}let fU=class{constructor(e,[n,r,i,a]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((a=+a)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=n,this.ymax=a,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:n,triangles:r},vectors:i}=this,a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let d=0,g=0,p=r.length,m,y;d<p;d+=3,g+=2){const v=r[d]*2,x=r[d+1]*2,b=r[d+2]*2,_=e[v],M=e[v+1],w=e[x],A=e[x+1],S=e[b],C=e[b+1],E=w-_,$=A-M,F=S-_,L=C-M,k=E*E+$*$,T=F*F+L*L,B=(E*L-$*F)*2;if(!B)m=(_+S)/2-1e8*L,y=(M+C)/2+1e8*F;else if(Math.abs(B)<1e-8)m=(_+S)/2,y=(M+C)/2;else{const U=1/B;m=_+(L*k-$*T)*U,y=M+(E*T-F*k)*U}a[g]=m,a[g+1]=y}let o=n[n.length-1],u,s=o*4,l,f=e[2*o],c,h=e[2*o+1];i.fill(0);for(let d=0;d<n.length;++d)o=n[d],u=s,l=f,c=h,s=o*4,f=e[2*o],h=e[2*o+1],i[u+2]=i[s]=c-h,i[u+3]=i[s+1]=f-l}render(e){const n=e==null?e=new vi:void 0,{delaunay:{halfedges:r,inedges:i,hull:a},circumcenters:o,vectors:u}=this;if(a.length<=1)return null;for(let f=0,c=r.length;f<c;++f){const h=r[f];if(h<f)continue;const d=Math.floor(f/3)*2,g=Math.floor(h/3)*2,p=o[d],m=o[d+1],y=o[g],v=o[g+1];this._renderSegment(p,m,y,v,e)}let s,l=a[a.length-1];for(let f=0;f<a.length;++f){s=l,l=a[f];const c=Math.floor(i[l]/3)*2,h=o[c],d=o[c+1],g=s*4,p=this._project(h,d,u[g+2],u[g+3]);p&&this._renderSegment(h,d,p[0],p[1],e)}return n&&n.value()}renderBounds(e){const n=e==null?e=new vi:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(e,n){const r=n==null?n=new vi:void 0,i=this._clip(e);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let a=i.length;for(;i[0]===i[a-2]&&i[1]===i[a-1]&&a>1;)a-=2;for(let o=2;o<a;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&n.lineTo(i[o],i[o+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let n=0,r=e.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(e){const n=new Id;return this.renderCell(e,n),n.value()}_renderSegment(e,n,r,i,a){let o;const u=this._regioncode(e,n),s=this._regioncode(r,i);u===0&&s===0?(a.moveTo(e,n),a.lineTo(r,i)):(o=this._clipSegment(e,n,r,i,u,s))&&(a.moveTo(o[0],o[1]),a.lineTo(o[2],o[3]))}contains(e,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(e,n,r)===e}*neighbors(e){const n=this._clip(e);if(n)for(const r of this.delaunay.neighbors(e)){const i=this._clip(r);if(i){t:for(let a=0,o=n.length;a<o;a+=2)for(let u=0,s=i.length;u<s;u+=2)if(n[a]==i[u]&&n[a+1]==i[u+1]&&n[(a+2)%o]==i[(u+s-2)%s]&&n[(a+3)%o]==i[(u+s-1)%s]){yield r;break t}}}}_cell(e){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:a}}=this,o=r[e];if(o===-1)return null;const u=[];let s=o;do{const l=Math.floor(s/3);if(u.push(n[l*2],n[l*2+1]),s=s%3===2?s-2:s+1,a[s]!==e)break;s=i[s]}while(s!==o&&s!==-1);return u}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(e);if(n===null)return null;const{vectors:r}=this,i=e*4;return r[i]||r[i+1]?this._clipInfinite(e,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(e,n)}_clipFinite(e,n){const r=n.length;let i=null,a,o,u=n[r-2],s=n[r-1],l,f=this._regioncode(u,s),c,h;for(let d=0;d<r;d+=2)if(a=u,o=s,u=n[d],s=n[d+1],l=f,f=this._regioncode(u,s),l===0&&f===0)c=h,h=0,i?i.push(u,s):i=[u,s];else{let g,p,m,y,v;if(l===0){if((g=this._clipSegment(a,o,u,s,l,f))===null)continue;[p,m,y,v]=g}else{if((g=this._clipSegment(u,s,a,o,f,l))===null)continue;[y,v,p,m]=g,c=h,h=this._edgecode(p,m),c&&h&&this._edge(e,c,h,i,i.length),i?i.push(p,m):i=[p,m]}c=h,h=this._edgecode(y,v),c&&h&&this._edge(e,c,h,i,i.length),i?i.push(y,v):i=[y,v]}if(i)c=h,h=this._edgecode(i[0],i[1]),c&&h&&this._edge(e,c,h,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,n,r,i,a,o){for(;;){if(a===0&&o===0)return[e,n,r,i];if(a&o)return null;let u,s,l=a||o;l&8?(u=e+(r-e)*(this.ymax-n)/(i-n),s=this.ymax):l&4?(u=e+(r-e)*(this.ymin-n)/(i-n),s=this.ymin):l&2?(s=n+(i-n)*(this.xmax-e)/(r-e),u=this.xmax):(s=n+(i-n)*(this.xmin-e)/(r-e),u=this.xmin),a?(e=u,n=s,a=this._regioncode(e,n)):(r=u,i=s,o=this._regioncode(r,i))}}_clipInfinite(e,n,r,i,a,o){let u=Array.from(n),s;if((s=this._project(u[0],u[1],r,i))&&u.unshift(s[0],s[1]),(s=this._project(u[u.length-2],u[u.length-1],a,o))&&u.push(s[0],s[1]),u=this._clipFinite(e,u))for(let l=0,f=u.length,c,h=this._edgecode(u[f-2],u[f-1]);l<f;l+=2)c=h,h=this._edgecode(u[l],u[l+1]),c&&h&&(l=this._edge(e,c,h,u,l),f=u.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}_edge(e,n,r,i,a){for(;n!==r;){let o,u;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,u=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,u=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,u=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,u=this.ymin;break}(i[a]!==o||i[a+1]!==u)&&this.contains(e,o,u)&&(i.splice(a,0,o,u),a+=2)}if(i.length>4)for(let o=0;o<i.length;o+=2){const u=(o+2)%i.length,s=(o+4)%i.length;(i[o]===i[u]&&i[u]===i[s]||i[o+1]===i[u+1]&&i[u+1]===i[s+1])&&(i.splice(u,2),o-=2)}return a}_project(e,n,r,i){let a=1/0,o,u,s;if(i<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/i)<a&&(s=this.ymin,u=e+(a=o)*r)}else if(i>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/i)<a&&(s=this.ymax,u=e+(a=o)*r)}if(r>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/r)<a&&(u=this.xmax,s=n+(a=o)*i)}else if(r<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/r)<a&&(u=this.xmin,s=n+(a=o)*i)}return[u,s]}_edgecode(e,n){return(e===this.xmin?1:e===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(e,n){return(e<this.xmin?1:e>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}};const cU=2*Math.PI,ra=Math.pow;function hU(t){return t[0]}function dU(t){return t[1]}function gU(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const i=2*e[r],a=2*e[r+1],o=2*e[r+2];if((n[o]-n[i])*(n[a+1]-n[i+1])-(n[a]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}function pU(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class Im{static from(e,n=hU,r=dU,i){return new Im("length"in e?mU(e,n,r,i):Float64Array.from(yU(e,n,r,i)))}constructor(e){this._delaunator=new ff(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,n=this.points;if(e.hull&&e.hull.length>2&&gU(e)){this.collinear=Int32Array.from({length:n.length/2},(h,d)=>d).sort((h,d)=>n[2*h]-n[2*d]||n[2*h+1]-n[2*d+1]);const s=this.collinear[0],l=this.collinear[this.collinear.length-1],f=[n[2*s],n[2*s+1],n[2*l],n[2*l+1]],c=1e-8*Math.hypot(f[3]-f[1],f[2]-f[0]);for(let h=0,d=n.length/2;h<d;++h){const g=pU(n[2*h],n[2*h+1],c);n[2*h]=g[0],n[2*h+1]=g[1]}this._delaunator=new ff(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,a=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),u=this._hullIndex.fill(-1);for(let s=0,l=r.length;s<l;++s){const f=a[s%3===2?s-2:s+1];(r[s]===-1||o[f]===-1)&&(o[f]=s)}for(let s=0,l=i.length;s<l;++s)u[i[s]]=s;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],this.triangles[1]=i[1],this.triangles[2]=i[1],o[i[0]]=1,i.length===2&&(o[i[1]]=0))}voronoi(e){return new fU(this,e)}*neighbors(e){const{inedges:n,hull:r,_hullIndex:i,halfedges:a,triangles:o,collinear:u}=this;if(u){const c=u.indexOf(e);c>0&&(yield u[c-1]),c<u.length-1&&(yield u[c+1]);return}const s=n[e];if(s===-1)return;let l=s,f=-1;do{if(yield f=o[l],l=l%3===2?l-2:l+1,o[l]!==e)return;if(l=a[l],l===-1){const c=r[(i[e]+1)%r.length];c!==f&&(yield c);return}}while(l!==s)}find(e,n,r=0){if(e=+e,e!==e||(n=+n,n!==n))return-1;const i=r;let a;for(;(a=this._step(r,e,n))>=0&&a!==r&&a!==i;)r=a;return a}_step(e,n,r){const{inedges:i,hull:a,_hullIndex:o,halfedges:u,triangles:s,points:l}=this;if(i[e]===-1||!l.length)return(e+1)%(l.length>>1);let f=e,c=ra(n-l[e*2],2)+ra(r-l[e*2+1],2);const h=i[e];let d=h;do{let g=s[d];const p=ra(n-l[g*2],2)+ra(r-l[g*2+1],2);if(p<c&&(c=p,f=g),d=d%3===2?d-2:d+1,s[d]!==e)break;if(d=u[d],d===-1){if(d=a[(o[e]+1)%a.length],d!==g&&ra(n-l[d*2],2)+ra(r-l[d*2+1],2)<c)return d;break}}while(d!==h);return f}render(e){const n=e==null?e=new vi:void 0,{points:r,halfedges:i,triangles:a}=this;for(let o=0,u=i.length;o<u;++o){const s=i[o];if(s<o)continue;const l=a[o]*2,f=a[s]*2;e.moveTo(r[l],r[l+1]),e.lineTo(r[f],r[f+1])}return this.renderHull(e),n&&n.value()}renderPoints(e,n=2){const r=e==null?e=new vi:void 0,{points:i}=this;for(let a=0,o=i.length;a<o;a+=2){const u=i[a],s=i[a+1];e.moveTo(u+n,s),e.arc(u,s,n,0,cU)}return r&&r.value()}renderHull(e){const n=e==null?e=new vi:void 0,{hull:r,points:i}=this,a=r[0]*2,o=r.length;e.moveTo(i[a],i[a+1]);for(let u=1;u<o;++u){const s=2*r[u];e.lineTo(i[s],i[s+1])}return e.closePath(),n&&n.value()}hullPolygon(){const e=new Id;return this.renderHull(e),e.value()}renderTriangle(e,n){const r=n==null?n=new vi:void 0,{points:i,triangles:a}=this,o=a[e*=3]*2,u=a[e+1]*2,s=a[e+2]*2;return n.moveTo(i[o],i[o+1]),n.lineTo(i[u],i[u+1]),n.lineTo(i[s],i[s+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:e}=this;for(let n=0,r=e.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(e){const n=new Id;return this.renderTriangle(e,n),n.value()}}function mU(t,e,n,r){const i=t.length,a=new Float64Array(i*2);for(let o=0;o<i;++o){const u=t[o];a[o*2]=e.call(r,u,o,t),a[o*2+1]=n.call(r,u,o,t)}return a}function*yU(t,e,n,r){let i=0;for(const a of t)yield e.call(r,a,i,t),yield n.call(r,a,i,t),++i}function qm(t){R.call(this,null,t)}qm.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const vU=[-1e5,-1e5,1e5,1e5];P(qm,R,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:vU;const a=this.value=Im.from(r,t.x,t.y).voronoi(i);for(let o=0,u=r.length;o<u;++o){const s=a.cellPolygon(o);r[o][n]=s?xU(s):null}return e.reflow(t.modified()).modifies(n)}});function xU(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}const bU=Object.freeze(Object.defineProperty({__proto__:null,voronoi:qm},Symbol.toStringTag,{value:"Module"}));var Kh=Math.PI/180,jo=1<<11>>5,fl=1<<11;function wU(){var t=[256,256],e,n,r,i,a,o,u,s=vE,l=[],f=Math.random,c={};c.layout=function(){for(var g=h(Ga()),p=CU((t[0]>>5)*t[1]),m=null,y=l.length,v=-1,x=[],b=l.map(M=>({text:e(M),font:n(M),style:i(M),weight:a(M),rotate:o(M),size:~~(r(M)+1e-14),padding:u(M),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:M})).sort((M,w)=>w.size-M.size);++v<y;){var _=b[v];_.x=t[0]*(f()+.5)>>1,_.y=t[1]*(f()+.5)>>1,_U(g,_,b,v),_.hasText&&d(p,_,m)&&(x.push(_),m?kU(m,_):m=[{x:_.x+_.x0,y:_.y+_.y0},{x:_.x+_.x1,y:_.y+_.y1}],_.x-=t[0]>>1,_.y-=t[1]>>1)}return x};function h(g){g.width=g.height=1;var p=Math.sqrt(g.getContext("2d").getImageData(0,0,1,1).data.length>>2);g.width=(jo<<5)/p,g.height=fl/p;var m=g.getContext("2d");return m.fillStyle=m.strokeStyle="red",m.textAlign="center",{context:m,ratio:p}}function d(g,p,m){for(var y=p.x,v=p.y,x=Math.sqrt(t[0]*t[0]+t[1]*t[1]),b=s(t),_=f()<.5?1:-1,M=-_,w,A,S;(w=b(M+=_))&&(A=~~w[0],S=~~w[1],!(Math.min(Math.abs(A),Math.abs(S))>=x));)if(p.x=y+A,p.y=v+S,!(p.x+p.x0<0||p.y+p.y0<0||p.x+p.x1>t[0]||p.y+p.y1>t[1])&&(!m||!MU(p,g,t[0]))&&(!m||AU(p,m))){for(var C=p.sprite,E=p.width>>5,$=t[0]>>5,F=p.x-(E<<4),L=F&127,k=32-L,T=p.y1-p.y0,B=(p.y+p.y0)*$+(F>>5),U,q=0;q<T;q++){U=0;for(var it=0;it<=E;it++)g[B+it]|=U<<k|(it<E?(U=C[q*E+it])>>>L:0);B+=$}return p.sprite=null,!0}return!1}return c.words=function(g){return arguments.length?(l=g,c):l},c.size=function(g){return arguments.length?(t=[+g[0],+g[1]],c):t},c.font=function(g){return arguments.length?(n=ui(g),c):n},c.fontStyle=function(g){return arguments.length?(i=ui(g),c):i},c.fontWeight=function(g){return arguments.length?(a=ui(g),c):a},c.rotate=function(g){return arguments.length?(o=ui(g),c):o},c.text=function(g){return arguments.length?(e=ui(g),c):e},c.spiral=function(g){return arguments.length?(s=SU[g]||g,c):s},c.fontSize=function(g){return arguments.length?(r=ui(g),c):r},c.padding=function(g){return arguments.length?(u=ui(g),c):u},c.random=function(g){return arguments.length?(f=g,c):f},c}function _U(t,e,n,r){if(!e.sprite){var i=t.context,a=t.ratio;i.clearRect(0,0,(jo<<5)/a,fl/a);var o=0,u=0,s=0,l=n.length,f,c,h,d,g;for(--r;++r<l;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/a)+"px "+e.font,f=i.measureText(e.text+"m").width*a,h=e.size<<1,e.rotate){var p=Math.sin(e.rotate*Kh),m=Math.cos(e.rotate*Kh),y=f*m,v=f*p,x=h*m,b=h*p;f=Math.max(Math.abs(y+b),Math.abs(y-b))+31>>5<<5,h=~~Math.max(Math.abs(v+x),Math.abs(v-x))}else f=f+31>>5<<5;if(h>s&&(s=h),o+f>=jo<<5&&(o=0,u+=s,s=0),u+h>=fl)break;i.translate((o+(f>>1))/a,(u+(h>>1))/a),e.rotate&&i.rotate(e.rotate*Kh),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=f,e.height=h,e.xoff=o,e.yoff=u,e.x1=f>>1,e.y1=h>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,o+=f}for(var _=i.getImageData(0,0,(jo<<5)/a,fl/a).data,M=[];--r>=0;)if(e=n[r],!!e.hasText){for(f=e.width,c=f>>5,h=e.y1-e.y0,d=0;d<h*c;d++)M[d]=0;if(o=e.xoff,o==null)return;u=e.yoff;var w=0,A=-1;for(g=0;g<h;g++){for(d=0;d<f;d++){var S=c*g+(d>>5),C=_[(u+g)*(jo<<5)+(o+d)<<2]?1<<31-d%32:0;M[S]|=C,w|=C}w?A=g:(e.y0++,h--,g--,u++)}e.y1=e.y0+A,e.sprite=M.slice(0,(e.y1-e.y0)*c)}}}function MU(t,e,n){n>>=5;for(var r=t.sprite,i=t.width>>5,a=t.x-(i<<4),o=a&127,u=32-o,s=t.y1-t.y0,l=(t.y+t.y0)*n+(a>>5),f,c=0;c<s;c++){f=0;for(var h=0;h<=i;h++)if((f<<u|(h<i?(f=r[c*i+h])>>>o:0))&e[l+h])return!0;l+=n}return!1}function kU(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function AU(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function vE(t){var e=t[0]/t[1];return function(n){return[e*(n*=.1)*Math.cos(n),n*Math.sin(n)]}}function EU(t){var e=4,n=e*t[0]/t[1],r=0,i=0;return function(a){var o=a<0?-1:1;switch(Math.sqrt(1+4*o*a)-o&3){case 0:r+=n;break;case 1:i+=e;break;case 2:r-=n;break;default:i-=e;break}return[r,i]}}function CU(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}function ui(t){return typeof t=="function"?t:function(){return t}}var SU={archimedean:vE,rectangular:EU};const xE=["x","y","font","fontSize","fontStyle","fontWeight","angle"],DU=["text","font","rotate","fontSize","fontStyle","fontWeight"];function jm(t){R.call(this,wU(),t)}jm.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:xE}]};P(jm,R,{transform(t,e){t.size&&!(t.size[0]&&t.size[1])&&z("Wordcloud size dimensions must be non-zero.");function n(g){const p=t[g];return nt(p)&&e.modified(p.fields)}const r=t.modified();if(!(r||e.changed(e.ADD_REM)||DU.some(n)))return;const i=e.materialize(e.SOURCE).source,a=this.value,o=t.as||xE;let u=t.fontSize||14,s;if(nt(u)?s=t.fontSizeRange:u=ge(u),s){const g=u,p=dt("sqrt")().domain(Vn(i,g)).range(s);u=m=>p(g(m))}i.forEach(g=>{g[o[0]]=NaN,g[o[1]]=NaN,g[o[3]]=0});const l=a.words(i).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(u).random(fn).layout(),f=a.size(),c=f[0]>>1,h=f[1]>>1,d=l.length;for(let g=0,p,m;g<d;++g)p=l[g],m=p.datum,m[o[0]]=p.x+c,m[o[1]]=p.y+h,m[o[2]]=p.font,m[o[3]]=p.size,m[o[4]]=p.style,m[o[5]]=p.weight,m[o[6]]=p.rotate;return e.reflow(r).modifies(o)}});const $U=Object.freeze(Object.defineProperty({__proto__:null,wordcloud:jm},Symbol.toStringTag,{value:"Module"}));function bE(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function wE(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=FU(t));function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=r(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:r,center:a,right:i}}function FU(t){return(e,n)=>bE(t(e),n)}function TU(t){return t===null?NaN:+t}const _E=wE(bE),RU=_E.right,NU=_E.left;wE(TU).center;function OU(t,e){return Array.from(e,n=>t[n])}const zU=t=>new Uint8Array(t),LU=t=>new Uint16Array(t),nu=t=>new Uint32Array(t);function BU(){let t=8,e=[],n=nu(0),r=qs(0,t),i=qs(0,t);return{data:()=>e,seen:()=>n=PU(n,e.length),add(a){for(let o=0,u=e.length,s=a.length,l;o<s;++o)l=a[o],l._index=u++,e.push(l)},remove(a,o){const u=e.length,s=Array(u-a),l=e;let f,c,h;for(c=0;!o[c]&&c<u;++c)s[c]=e[c],l[c]=c;for(h=c;c<u;++c)f=e[c],o[c]?l[c]=-1:(l[c]=h,r[h]=r[c],i[h]=i[c],s[h]=f,f._index=h++),r[c]=0;return e=s,l},size:()=>e.length,curr:()=>r,prev:()=>i,reset:a=>i[a]=r[a],all:()=>t<257?255:t<65537?65535:4294967295,set(a,o){r[a]|=o},clear(a,o){r[a]&=~o},resize(a,o){const u=r.length;(a>u||o>t)&&(t=Math.max(o,t),r=qs(a,t,r),i=qs(a,t))}}}function PU(t,e,n){return t.length>=e?t:(n=n||new t.constructor(e),n.set(t),n)}function qs(t,e,n){const r=(e<257?zU:e<65537?LU:nu)(t);return n&&r.set(n),r}function jx(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(i,a){const o=this,u=o.bisect(o.range,i.value),s=i.index,l=u[0],f=u[1],c=s.length;let h;for(h=0;h<l;++h)a[s[h]]|=r;for(h=f;h<c;++h)a[s[h]]|=r;return o}}}function Yx(){let t=nu(0),e=[],n=0;function r(u,s,l){if(!s.length)return[];const f=n,c=s.length,h=nu(c);let d=Array(c),g,p,m;for(m=0;m<c;++m)d[m]=u(s[m]),h[m]=m;if(d=UU(d,h),f)g=e,p=t,e=Array(f+c),t=nu(f+c),IU(l,g,p,f,d,h,c,e,t);else{if(l>0)for(m=0;m<c;++m)h[m]+=l;e=d,t=h}return n=f+c,{index:h,value:d}}function i(u,s){const l=n;let f,c,h;for(c=0;!s[t[c]]&&c<l;++c);for(h=c;c<l;++c)s[f=t[c]]||(t[h]=f,e[h]=e[c],++h);n=l-u}function a(u){for(let s=0,l=n;s<l;++s)t[s]=u[t[s]]}function o(u,s){let l;return s?l=s.length:(s=e,l=n),[NU(s,u[0],0,l),RU(s,u[1],0,l)]}return{insert:r,remove:i,bisect:o,reindex:a,index:()=>t,size:()=>n}}function UU(t,e){return t.sort.call(e,(n,r)=>{const i=t[n],a=t[r];return i<a?-1:i>a?1:0}),OU(t,e)}function IU(t,e,n,r,i,a,o,u,s){let l=0,f=0,c;for(c=0;l<r&&f<o;++c)e[l]<i[f]?(u[c]=e[l],s[c]=n[l++]):(u[c]=i[f],s[c]=a[f++]+t);for(;l<r;++l,++c)u[c]=e[l],s[c]=n[l];for(;f<o;++f,++c)u[c]=i[f],s[c]=a[f]+t}function Ym(t){R.call(this,BU(),t),this._indices=null,this._dims=null}Ym.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]};P(Ym,R,{transform(t,e){if(this._dims){var n=t.modified("fields")||t.fields.some(r=>e.modified(r.fields));return n?this.reinit(t,e):this.eval(t,e)}else return this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},a=this._dims=[],o=r.length;let u=0,s,l;for(;u<o;++u)s=n[u].fname,l=i[s]||(i[s]=Yx()),a.push(jx(l,u,r[u]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,a=this._indices,o=this._dims,u=this.value,s=u.curr(),l=u.prev(),f=u.all(),c=n.rem=n.add,h=n.mod,d=i.length,g={};let p,m,y,v,x,b,_,M,w;if(l.set(s),e.rem.length&&(x=this.remove(t,e,n)),e.add.length&&u.add(e.add),e.mod.length)for(b={},v=e.mod,_=0,M=v.length;_<M;++_)b[v[_]._index]=1;for(_=0;_<d;++_)w=r[_],(!o[_]||t.modified("fields",_)||e.modified(w.fields))&&(y=w.fname,(p=g[y])||(a[y]=m=Yx(),g[y]=p=m.insert(w,e.source,0)),o[_]=jx(m,_,i[_]).onAdd(p,s));for(_=0,M=u.data().length;_<M;++_)x[_]||(l[_]!==s[_]?c.push(_):b[_]&&s[_]!==f&&h.push(_));return u.mask=(1<<d)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,a=this._dims,o=this._indices,u=t.fields,s={},l=n.add,f=i.size()+r.length,c=a.length;let h=i.size(),d,g,p;i.resize(f,c),i.add(r);const m=i.curr(),y=i.prev(),v=i.all();for(d=0;d<c;++d)g=u[d].fname,p=s[g]||(s[g]=o[g].insert(u[d],r,h)),a[d].onAdd(p,m);for(;h<f;++h)y[h]=v,m[h]!==v&&l.push(h)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),a=r.all(),o=t.mod;let u,s,l;for(u=0,s=o.length;u<s;++u)l=o[u]._index,i[l]!==a&&n.push(l)},remove(t,e,n){const r=this._indices,i=this.value,a=i.curr(),o=i.prev(),u=i.all(),s={},l=n.rem,f=e.rem;let c,h,d,g;for(c=0,h=f.length;c<h;++c)d=f[c]._index,s[d]=1,o[d]=g=a[d],a[d]=u,g!==u&&l.push(d);for(d in r)r[d].remove(h,s);return this.reindex(e,h,s),s},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter(()=>{const a=i.remove(e,n);for(const o in r)r[o].reindex(a)})},update(t,e,n){const r=this._dims,i=t.query,a=e.stamp,o=r.length;let u=0,s,l;for(n.filters=0,l=0;l<o;++l)t.modified("query",l)&&(s=l,++u);if(u===1)u=r[s].one,this.incrementOne(r[s],i[s],n.add,n.rem);else for(l=0,u=0;l<o;++l)t.modified("query",l)&&(u|=r[l].one,this.incrementAll(r[l],i[l],a,n.add),n.rem=n.add);return u},incrementAll(t,e,n,r){const i=this.value,a=i.seen(),o=i.curr(),u=i.prev(),s=t.index(),l=t.bisect(t.range),f=t.bisect(e),c=f[0],h=f[1],d=l[0],g=l[1],p=t.one;let m,y,v;if(c<d)for(m=c,y=Math.min(d,h);m<y;++m)v=s[m],a[v]!==n&&(u[v]=o[v],a[v]=n,r.push(v)),o[v]^=p;else if(c>d)for(m=d,y=Math.min(c,g);m<y;++m)v=s[m],a[v]!==n&&(u[v]=o[v],a[v]=n,r.push(v)),o[v]^=p;if(h>g)for(m=Math.max(c,g),y=h;m<y;++m)v=s[m],a[v]!==n&&(u[v]=o[v],a[v]=n,r.push(v)),o[v]^=p;else if(h<g)for(m=Math.max(d,h),y=g;m<y;++m)v=s[m],a[v]!==n&&(u[v]=o[v],a[v]=n,r.push(v)),o[v]^=p;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value,a=i.curr(),o=t.index(),u=t.bisect(t.range),s=t.bisect(e),l=s[0],f=s[1],c=u[0],h=u[1],d=t.one;let g,p,m;if(l<c)for(g=l,p=Math.min(c,f);g<p;++g)m=o[g],a[m]^=d,n.push(m);else if(l>c)for(g=c,p=Math.min(l,h);g<p;++g)m=o[g],a[m]^=d,r.push(m);if(f>h)for(g=Math.max(l,h),p=f;g<p;++g)m=o[g],a[m]^=d,n.push(m);else if(f<h)for(g=Math.max(c,f),p=h;g<p;++g)m=o[g],a[m]^=d,r.push(m);t.range=e.slice()}});function Wm(t){R.call(this,null,t)}Wm.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]};P(Wm,R,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(!(i&n))return e.StopPropagation;const a=e.fork(e.ALL),o=r.data(),u=r.curr(),s=r.prev(),l=f=>u[f]&n?null:o[f];return a.filter(a.MOD,l),i&i-1?(a.filter(a.ADD,f=>{const c=u[f]&n;return!c&&c^s[f]&n?o[f]:null}),a.filter(a.REM,f=>{const c=u[f]&n;return c&&!(c^(c^s[f]&n))?o[f]:null})):(a.filter(a.ADD,l),a.filter(a.REM,f=>(u[f]&n)===i?o[f]:null)),a.filter(a.SOURCE,f=>l(f._index))}});const qU=Object.freeze(Object.defineProperty({__proto__:null,crossfilter:Ym,resolvefilter:Wm},Symbol.toStringTag,{value:"Module"}));var jU=Math.sqrt(50),YU=Math.sqrt(10),WU=Math.sqrt(2);function HU(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=jU?i*=10:a>=YU?i*=5:a>=WU&&(i*=2),e<t?-i:i}const GU="RawCode",Di="Literal",VU="Property",XU="Identifier",ZU="ArrayExpression",KU="BinaryExpression",ME="CallExpression",QU="ConditionalExpression",JU="LogicalExpression",tI="MemberExpression",eI="ObjectExpression",nI="UnaryExpression";function Dn(t){this.type=t}Dn.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=rI(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};function rI(t){switch(t.type){case ZU:return t.elements;case KU:case JU:return[t.left,t.right];case ME:return[t.callee].concat(t.arguments);case QU:return[t.test,t.consequent,t.alternate];case tI:return[t.object,t.property];case eI:return t.properties;case VU:return[t.key,t.value];case nI:return[t.argument];case XU:case Di:case GU:default:return[]}}var er,Y,O,he,yt,Dc=1,is=2,$i=3,ni=4,$c=5,Hi=6,Fe=7,as=8,iI=9;er={};er[Dc]="Boolean";er[is]="<end>";er[$i]="Identifier";er[ni]="Keyword";er[$c]="Null";er[Hi]="Numeric";er[Fe]="Punctuator";er[as]="String";er[iI]="RegularExpression";var aI="ArrayExpression",oI="BinaryExpression",uI="CallExpression",sI="ConditionalExpression",kE="Identifier",lI="Literal",fI="LogicalExpression",cI="MemberExpression",hI="ObjectExpression",dI="Property",gI="UnaryExpression",Ht="Unexpected token %0",pI="Unexpected number",mI="Unexpected string",yI="Unexpected identifier",vI="Unexpected reserved word",xI="Unexpected end of input",qd="Invalid regular expression",Qh="Invalid regular expression: missing /",AE="Octal literals are not allowed in strict mode.",bI="Duplicate data property in object literal not allowed in strict mode",Jt="ILLEGAL",Cu="Disabled.",wI=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),_I=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function Fc(t,e){if(!t)throw new Error("ASSERT: "+e)}function ur(t){return t>=48&&t<=57}function Hm(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function ru(t){return"01234567".indexOf(t)>=0}function MI(t){return t===32||t===9||t===11||t===12||t===160||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function Su(t){return t===10||t===13||t===8232||t===8233}function os(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t===92||t>=128&&wI.test(String.fromCharCode(t))}function cf(t){return t===36||t===95||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t===92||t>=128&&_I.test(String.fromCharCode(t))}const kI={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function EE(){for(;O<he;){const t=Y.charCodeAt(O);if(MI(t)||Su(t))++O;else break}}function jd(t){var e,n,r,i=0;for(n=t==="u"?4:2,e=0;e<n;++e)O<he&&Hm(Y[O])?(r=Y[O++],i=i*16+"0123456789abcdef".indexOf(r.toLowerCase())):ft({},Ht,Jt);return String.fromCharCode(i)}function AI(){var t,e,n,r;for(t=Y[O],e=0,t==="}"&&ft({},Ht,Jt);O<he&&(t=Y[O++],!!Hm(t));)e=e*16+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||t!=="}")&&ft({},Ht,Jt),e<=65535?String.fromCharCode(e):(n=(e-65536>>10)+55296,r=(e-65536&1023)+56320,String.fromCharCode(n,r))}function CE(){var t,e;for(t=Y.charCodeAt(O++),e=String.fromCharCode(t),t===92&&(Y.charCodeAt(O)!==117&&ft({},Ht,Jt),++O,t=jd("u"),(!t||t==="\\"||!os(t.charCodeAt(0)))&&ft({},Ht,Jt),e=t);O<he&&(t=Y.charCodeAt(O),!!cf(t));)++O,e+=String.fromCharCode(t),t===92&&(e=e.substr(0,e.length-1),Y.charCodeAt(O)!==117&&ft({},Ht,Jt),++O,t=jd("u"),(!t||t==="\\"||!cf(t.charCodeAt(0)))&&ft({},Ht,Jt),e+=t);return e}function EI(){var t,e;for(t=O++;O<he;){if(e=Y.charCodeAt(O),e===92)return O=t,CE();if(cf(e))++O;else break}return Y.slice(t,O)}function CI(){var t,e,n;return t=O,e=Y.charCodeAt(O)===92?CE():EI(),e.length===1?n=$i:kI.hasOwnProperty(e)?n=ni:e==="null"?n=$c:e==="true"||e==="false"?n=Dc:n=$i,{type:n,value:e,start:t,end:O}}function Jh(){var t=O,e=Y.charCodeAt(O),n,r=Y[O],i,a,o;switch(e){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++O,{type:Fe,value:String.fromCharCode(e),start:t,end:O};default:if(n=Y.charCodeAt(O+1),n===61)switch(e){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return O+=2,{type:Fe,value:String.fromCharCode(e)+String.fromCharCode(n),start:t,end:O};case 33:case 61:return O+=2,Y.charCodeAt(O)===61&&++O,{type:Fe,value:Y.slice(t,O),start:t,end:O}}}if(o=Y.substr(O,4),o===">>>=")return O+=4,{type:Fe,value:o,start:t,end:O};if(a=o.substr(0,3),a===">>>"||a==="<<="||a===">>=")return O+=3,{type:Fe,value:a,start:t,end:O};if(i=a.substr(0,2),r===i[1]&&"+-<>&|".indexOf(r)>=0||i==="=>")return O+=2,{type:Fe,value:i,start:t,end:O};if(i==="//"&&ft({},Ht,Jt),"<>=!+-*%&|^/".indexOf(r)>=0)return++O,{type:Fe,value:r,start:t,end:O};ft({},Ht,Jt)}function SI(t){let e="";for(;O<he&&Hm(Y[O]);)e+=Y[O++];return e.length===0&&ft({},Ht,Jt),os(Y.charCodeAt(O))&&ft({},Ht,Jt),{type:Hi,value:parseInt("0x"+e,16),start:t,end:O}}function DI(t){let e="0"+Y[O++];for(;O<he&&ru(Y[O]);)e+=Y[O++];return(os(Y.charCodeAt(O))||ur(Y.charCodeAt(O)))&&ft({},Ht,Jt),{type:Hi,value:parseInt(e,8),octal:!0,start:t,end:O}}function Wx(){var t,e,n;if(n=Y[O],Fc(ur(n.charCodeAt(0))||n===".","Numeric literal must start with a decimal digit or a decimal point"),e=O,t="",n!=="."){if(t=Y[O++],n=Y[O],t==="0"){if(n==="x"||n==="X")return++O,SI(e);if(ru(n))return DI(e);n&&ur(n.charCodeAt(0))&&ft({},Ht,Jt)}for(;ur(Y.charCodeAt(O));)t+=Y[O++];n=Y[O]}if(n==="."){for(t+=Y[O++];ur(Y.charCodeAt(O));)t+=Y[O++];n=Y[O]}if(n==="e"||n==="E")if(t+=Y[O++],n=Y[O],(n==="+"||n==="-")&&(t+=Y[O++]),ur(Y.charCodeAt(O)))for(;ur(Y.charCodeAt(O));)t+=Y[O++];else ft({},Ht,Jt);return os(Y.charCodeAt(O))&&ft({},Ht,Jt),{type:Hi,value:parseFloat(t),start:e,end:O}}function $I(){var t="",e,n,r,i,a=!1;for(e=Y[O],Fc(e==="'"||e==='"',"String literal must starts with a quote"),n=O,++O;O<he;)if(r=Y[O++],r===e){e="";break}else if(r==="\\")if(r=Y[O++],!r||!Su(r.charCodeAt(0)))switch(r){case"u":case"x":Y[O]==="{"?(++O,t+=AI()):t+=jd(r);break;case"n":t+=`
`;break;case"r":t+="\r";break;case"t":t+="	";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v";break;default:ru(r)?(i="01234567".indexOf(r),i!==0&&(a=!0),O<he&&ru(Y[O])&&(a=!0,i=i*8+"01234567".indexOf(Y[O++]),"0123".indexOf(r)>=0&&O<he&&ru(Y[O])&&(i=i*8+"01234567".indexOf(Y[O++]))),t+=String.fromCharCode(i)):t+=r;break}else r==="\r"&&Y[O]===`
`&&++O;else{if(Su(r.charCodeAt(0)))break;t+=r}return e!==""&&ft({},Ht,Jt),{type:as,value:t,octal:a,start:n,end:O}}function FI(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(r,i)=>{if(parseInt(i,16)<=1114111)return"x";ft({},qd)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(r){ft({},qd)}try{return new RegExp(t,e)}catch(r){return null}}function TI(){var t,e,n,r,i;for(t=Y[O],Fc(t==="/","Regular expression literal must start with a slash"),e=Y[O++],n=!1,r=!1;O<he;)if(t=Y[O++],e+=t,t==="\\")t=Y[O++],Su(t.charCodeAt(0))&&ft({},Qh),e+=t;else if(Su(t.charCodeAt(0)))ft({},Qh);else if(n)t==="]"&&(n=!1);else if(t==="/"){r=!0;break}else t==="["&&(n=!0);return r||ft({},Qh),i=e.substr(1,e.length-2),{value:i,literal:e}}function RI(){var t,e,n;for(e="",n="";O<he&&(t=Y[O],!!cf(t.charCodeAt(0)));)++O,t==="\\"&&O<he?ft({},Ht,Jt):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&ft({},qd,n),{value:n,literal:e}}function NI(){var t,e,n,r;return yt=null,EE(),t=O,e=TI(),n=RI(),r=FI(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:O}}function OI(t){return t.type===$i||t.type===ni||t.type===Dc||t.type===$c}function SE(){if(EE(),O>=he)return{type:is,start:O,end:O};const t=Y.charCodeAt(O);return os(t)?CI():t===40||t===41||t===59?Jh():t===39||t===34?$I():t===46?ur(Y.charCodeAt(O+1))?Wx():Jh():ur(t)?Wx():Jh()}function Ne(){const t=yt;return O=t.end,yt=SE(),O=t.end,t}function DE(){const t=O;yt=SE(),O=t}function zI(t){const e=new Dn(aI);return e.elements=t,e}function Hx(t,e,n){const r=new Dn(t==="||"||t==="&&"?fI:oI);return r.operator=t,r.left=e,r.right=n,r}function LI(t,e){const n=new Dn(uI);return n.callee=t,n.arguments=e,n}function BI(t,e,n){const r=new Dn(sI);return r.test=t,r.consequent=e,r.alternate=n,r}function Gm(t){const e=new Dn(kE);return e.name=t,e}function Yo(t){const e=new Dn(lI);return e.value=t.value,e.raw=Y.slice(t.start,t.end),t.regex&&(e.raw==="//"&&(e.raw="/(?:)/"),e.regex=t.regex),e}function Gx(t,e,n){const r=new Dn(cI);return r.computed=t==="[",r.object=e,r.property=n,r.computed||(n.member=!0),r}function PI(t){const e=new Dn(hI);return e.properties=t,e}function Vx(t,e,n){const r=new Dn(dI);return r.key=e,r.value=n,r.kind=t,r}function UI(t,e){const n=new Dn(gI);return n.operator=t,n.argument=e,n.prefix=!0,n}function ft(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,(a,o)=>(Fc(o<r.length,"Message reference must be in range"),r[o]));throw n=new Error(i),n.index=O,n.description=i,n}function Tc(t){t.type===is&&ft(t,xI),t.type===Hi&&ft(t,pI),t.type===as&&ft(t,mI),t.type===$i&&ft(t,yI),t.type===ni&&ft(t,vI),ft(t,Ht,t.value)}function de(t){const e=Ne();(e.type!==Fe||e.value!==t)&&Tc(e)}function Et(t){return yt.type===Fe&&yt.value===t}function t0(t){return yt.type===ni&&yt.value===t}function II(){const t=[];for(O=yt.start,de("[");!Et("]");)Et(",")?(Ne(),t.push(null)):(t.push(Fi()),Et("]")||de(","));return Ne(),zI(t)}function Xx(){O=yt.start;const t=Ne();return t.type===as||t.type===Hi?(t.octal&&ft(t,AE),Yo(t)):Gm(t.value)}function qI(){var t,e,n,r;if(O=yt.start,t=yt,t.type===$i)return n=Xx(),de(":"),r=Fi(),Vx("init",n,r);if(t.type===is||t.type===Fe)Tc(t);else return e=Xx(),de(":"),r=Fi(),Vx("init",e,r)}function jI(){var t=[],e,n,r,i={},a=String;for(O=yt.start,de("{");!Et("}");)e=qI(),e.key.type===kE?n=e.key.name:n=a(e.key.value),r="$"+n,Object.prototype.hasOwnProperty.call(i,r)?ft({},bI):i[r]=!0,t.push(e),Et("}")||de(",");return de("}"),PI(t)}function YI(){de("(");const t=Vm();return de(")"),t}const WI={if:1};function HI(){var t,e,n;if(Et("("))return YI();if(Et("["))return II();if(Et("{"))return jI();if(t=yt.type,O=yt.start,t===$i||WI[yt.value])n=Gm(Ne().value);else if(t===as||t===Hi)yt.octal&&ft(yt,AE),n=Yo(Ne());else{if(t===ni)throw new Error(Cu);t===Dc?(e=Ne(),e.value=e.value==="true",n=Yo(e)):t===$c?(e=Ne(),e.value=null,n=Yo(e)):Et("/")||Et("/=")?(n=Yo(NI()),DE()):Tc(Ne())}return n}function GI(){const t=[];if(de("("),!Et(")"))for(;O<he&&(t.push(Fi()),!Et(")"));)de(",");return de(")"),t}function VI(){O=yt.start;const t=Ne();return OI(t)||Tc(t),Gm(t.value)}function XI(){return de("."),VI()}function ZI(){de("[");const t=Vm();return de("]"),t}function KI(){var t,e,n;for(t=HI();;)if(Et("."))n=XI(),t=Gx(".",t,n);else if(Et("("))e=GI(),t=LI(t,e);else if(Et("["))n=ZI(),t=Gx("[",t,n);else break;return t}function Zx(){const t=KI();if(yt.type===Fe&&(Et("++")||Et("--")))throw new Error(Cu);return t}function cl(){var t,e;if(yt.type!==Fe&&yt.type!==ni)e=Zx();else{if(Et("++")||Et("--"))throw new Error(Cu);if(Et("+")||Et("-")||Et("~")||Et("!"))t=Ne(),e=cl(),e=UI(t.value,e);else{if(t0("delete")||t0("void")||t0("typeof"))throw new Error(Cu);e=Zx()}}return e}function Kx(t){let e=0;if(t.type!==Fe&&t.type!==ni)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11;break}return e}function QI(){var t,e,n,r,i,a,o,u,s,l;if(t=yt,s=cl(),r=yt,i=Kx(r),i===0)return s;for(r.prec=i,Ne(),e=[t,yt],o=cl(),a=[s,r,o];(i=Kx(yt))>0;){for(;a.length>2&&i<=a[a.length-2].prec;)o=a.pop(),u=a.pop().value,s=a.pop(),e.pop(),n=Hx(u,s,o),a.push(n);r=Ne(),r.prec=i,a.push(r),e.push(yt),n=cl(),a.push(n)}for(l=a.length-1,n=a[l],e.pop();l>1;)e.pop(),n=Hx(a[l-1].value,a[l-2],n),l-=2;return n}function Fi(){var t,e,n;return t=QI(),Et("?")&&(Ne(),e=Fi(),de(":"),n=Fi(),t=BI(t,e,n)),t}function Vm(){const t=Fi();if(Et(","))throw new Error(Cu);return t}function $E(t){Y=t,O=0,he=Y.length,yt=null,DE();const e=Vm();if(yt.type!==is)throw new Error("Unexpect token after expression.");return e}var FE={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function TE(t){function e(o,u,s,l){let f=t(u[0]);return s&&(f=s+"("+f+")",s.lastIndexOf("new ",0)===0&&(f="("+f+")")),f+"."+o+(l<0?"":l===0?"()":"("+u.slice(1).map(t).join(",")+")")}function n(o,u,s){return l=>e(o,l,u,s)}const r="new Date",i="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(o){o.length<3&&z("Missing arguments to clamp function."),o.length>3&&z("Too many arguments to clamp function.");const u=o.map(t);return"Math.max("+u[1]+", Math.min("+u[2]+","+u[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:r,date:n("getDate",r,0),day:n("getDay",r,0),year:n("getFullYear",r,0),month:n("getMonth",r,0),hours:n("getHours",r,0),minutes:n("getMinutes",r,0),seconds:n("getSeconds",r,0),milliseconds:n("getMilliseconds",r,0),time:n("getTime",r,0),timezoneoffset:n("getTimezoneOffset",r,0),utcdate:n("getUTCDate",r,0),utcday:n("getUTCDay",r,0),utcyear:n("getUTCFullYear",r,0),utcmonth:n("getUTCMonth",r,0),utchours:n("getUTCHours",r,0),utcminutes:n("getUTCMinutes",r,0),utcseconds:n("getUTCSeconds",r,0),utcmilliseconds:n("getUTCMilliseconds",r,0),length:n("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:n("toUpperCase",i,0),lower:n("toLowerCase",i,0),substring:n("substring",i),split:n("split",i),trim:n("trim",i,0),regexp:a,test:n("test",a),if:function(o){o.length<3&&z("Missing arguments to if function."),o.length>3&&z("Too many arguments to if function.");const u=o.map(t);return"("+u[0]+"?"+u[1]+":"+u[2]+")"}}}function JI(t){const e=t&&t.length-1;return e&&(t[0]==='"'&&t[e]==='"'||t[0]==="'"&&t[e]==="'")?t.slice(1,-1):t}function RE(t){t=t||{};const e=t.allowed?En(t.allowed):{},n=t.forbidden?En(t.forbidden):{},r=t.constants||FE,i=(t.functions||TE)(c),a=t.globalvar,o=t.fieldvar,u=nt(a)?a:g=>"".concat(a,'["').concat(g,'"]');let s={},l={},f=0;function c(g){if(Ct(g))return g;const p=h[g.type];return p==null&&z("Unsupported type: "+g.type),p(g)}const h={Literal:g=>g.raw,Identifier:g=>{const p=g.name;return f>0?p:K(n,p)?z("Illegal identifier: "+p):K(r,p)?r[p]:K(e,p)?p:(s[p]=1,u(p))},MemberExpression:g=>{const p=!g.computed,m=c(g.object);p&&(f+=1);const y=c(g.property);return m===o&&(l[JI(y)]=1),p&&(f-=1),m+(p?"."+y:"["+y+"]")},CallExpression:g=>{g.callee.type!=="Identifier"&&z("Illegal callee type: "+g.callee.type);const p=g.callee.name,m=g.arguments,y=K(i,p)&&i[p];return y||z("Unrecognized function: "+p),nt(y)?y(m):y+"("+m.map(c).join(",")+")"},ArrayExpression:g=>"["+g.elements.map(c).join(",")+"]",BinaryExpression:g=>"("+c(g.left)+" "+g.operator+" "+c(g.right)+")",UnaryExpression:g=>"("+g.operator+c(g.argument)+")",ConditionalExpression:g=>"("+c(g.test)+"?"+c(g.consequent)+":"+c(g.alternate)+")",LogicalExpression:g=>"("+c(g.left)+g.operator+c(g.right)+")",ObjectExpression:g=>"{"+g.properties.map(c).join(",")+"}",Property:g=>{f+=1;const p=c(g.key);return f-=1,p+":"+c(g.value)}};function d(g){const p={code:c(g),globals:Object.keys(s),fields:Object.keys(l)};return s={},l={},p}return d.functions=i,d.constants=r,d}class jr{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=n[i],o=e+a,u=Math.abs(e)<Math.abs(a)?e-(o-a):a-(o-e);u&&(n[r++]=u),e=o}return n[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let n=this._n,r,i,a,o=0;if(n>0){for(o=e[--n];n>0&&(r=o,i=e[--n],o=r+i,a=i-(o-r),!a););n>0&&(a<0&&e[n-1]<0||a>0&&e[n-1]>0)&&(i=a*2,r=o+i,i==r-o&&(o=r))}return o}}function tq(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(i);++r<i;)a[r]=t+r*n;return a}var hf=1e-6,Qx=1e-12,us=Math.PI,Jx=us/2,NE=us/4,tb=us*2,iu=180/us,pe=us/180,Xm=Math.abs,Rc=Math.atan2,Ce=Math.cos,Yd=Math.hypot,Se=Math.sin,OE=Math.sqrt;function Zm(t){return t>1?Jx:t<-1?-Jx:Math.asin(t)}function Wo(){}function df(t,e){t&&nb.hasOwnProperty(t.type)&&nb[t.type](t,e)}var eb={Feature:function(t,e){df(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)df(n[r].geometry,e)}},nb={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Wd(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Wd(n[r],e,0)},Polygon:function(t,e){rb(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)rb(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)df(n[r],e)}};function Wd(t,e,n){var r=-1,i=t.length-n,a;for(e.lineStart();++r<i;)a=t[r],e.point(a[0],a[1],a[2]);e.lineEnd()}function rb(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Wd(t[n],e,1);e.polygonEnd()}function Km(t,e){t&&eb.hasOwnProperty(t.type)?eb[t.type](t,e):df(t,e)}var gf=new jr,pf=new jr,zE,LE,Hd,Gd,Vd,Zn={point:Wo,lineStart:Wo,lineEnd:Wo,polygonStart:function(){gf=new jr,Zn.lineStart=eq,Zn.lineEnd=nq},polygonEnd:function(){var t=+gf;pf.add(t<0?tb+t:t),this.lineStart=this.lineEnd=this.point=Wo},sphere:function(){pf.add(tb)}};function eq(){Zn.point=rq}function nq(){BE(zE,LE)}function rq(t,e){Zn.point=BE,zE=t,LE=e,t*=pe,e*=pe,Hd=t,Gd=Ce(e=e/2+NE),Vd=Se(e)}function BE(t,e){t*=pe,e*=pe,e=e/2+NE;var n=t-Hd,r=n>=0?1:-1,i=r*n,a=Ce(e),o=Se(e),u=Vd*o,s=Gd*a+u*Ce(i),l=u*r*Se(i);gf.add(Rc(l,s)),Hd=t,Gd=a,Vd=o}function iq(t){return pf=new jr,Km(t,Zn),pf*2}function aq(t){return[Rc(t[1],t[0]),Zm(t[2])]}function oq(t){var e=t[0],n=t[1],r=Ce(n);return[r*Ce(e),r*Se(e),Se(n)]}function ib(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function uq(t){var e=OE(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var $t,Te,Tt,We,fi,PE,UE,xa,au,Dr,mr,sr={point:Xd,lineStart:ab,lineEnd:ob,polygonStart:function(){sr.point=qE,sr.lineStart=sq,sr.lineEnd=lq,au=new jr,Zn.polygonStart()},polygonEnd:function(){Zn.polygonEnd(),sr.point=Xd,sr.lineStart=ab,sr.lineEnd=ob,gf<0?($t=-(Tt=180),Te=-(We=90)):au>hf?We=90:au<-hf&&(Te=-90),mr[0]=$t,mr[1]=Tt},sphere:function(){$t=-(Tt=180),Te=-(We=90)}};function Xd(t,e){Dr.push(mr=[$t=t,Tt=t]),e<Te&&(Te=e),e>We&&(We=e)}function IE(t,e){var n=oq([t*pe,e*pe]);if(xa){var r=ib(xa,n),i=[r[1],-r[0],0],a=ib(i,r);uq(a),a=aq(a);var o=t-fi,u=o>0?1:-1,s=a[0]*iu*u,l,f=Xm(o)>180;f^(u*fi<s&&s<u*t)?(l=a[1]*iu,l>We&&(We=l)):(s=(s+360)%360-180,f^(u*fi<s&&s<u*t)?(l=-a[1]*iu,l<Te&&(Te=l)):(e<Te&&(Te=e),e>We&&(We=e))),f?t<fi?Ye($t,t)>Ye($t,Tt)&&(Tt=t):Ye(t,Tt)>Ye($t,Tt)&&($t=t):Tt>=$t?(t<$t&&($t=t),t>Tt&&(Tt=t)):t>fi?Ye($t,t)>Ye($t,Tt)&&(Tt=t):Ye(t,Tt)>Ye($t,Tt)&&($t=t)}else Dr.push(mr=[$t=t,Tt=t]);e<Te&&(Te=e),e>We&&(We=e),xa=n,fi=t}function ab(){sr.point=IE}function ob(){mr[0]=$t,mr[1]=Tt,sr.point=Xd,xa=null}function qE(t,e){if(xa){var n=t-fi;au.add(Xm(n)>180?n+(n>0?360:-360):n)}else PE=t,UE=e;Zn.point(t,e),IE(t,e)}function sq(){Zn.lineStart()}function lq(){qE(PE,UE),Zn.lineEnd(),Xm(au)>hf&&($t=-(Tt=180)),mr[0]=$t,mr[1]=Tt,xa=null}function Ye(t,e){return(e-=t)<0?e+360:e}function fq(t,e){return t[0]-e[0]}function ub(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function cq(t){var e,n,r,i,a,o,u;if(We=Tt=-($t=Te=1/0),Dr=[],Km(t,sr),n=Dr.length){for(Dr.sort(fq),e=1,r=Dr[0],a=[r];e<n;++e)i=Dr[e],ub(r,i[0])||ub(r,i[1])?(Ye(r[0],i[1])>Ye(r[0],r[1])&&(r[1]=i[1]),Ye(i[0],r[1])>Ye(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,n=a.length-1,e=0,r=a[n];e<=n;r=i,++e)i=a[e],(u=Ye(r[1],i[0]))>o&&(o=u,$t=i[0],Tt=r[1])}return Dr=mr=null,$t===1/0||Te===1/0?[[NaN,NaN],[NaN,NaN]]:[[$t,Te],[Tt,We]]}var Ho,mf,yf,vf,xf,bf,wf,_f,Zd,Kd,Qd,jE,YE,be,we,_e,wn={sphere:Wo,point:Qm,lineStart:sb,lineEnd:lb,polygonStart:function(){wn.lineStart=gq,wn.lineEnd=pq},polygonEnd:function(){wn.lineStart=sb,wn.lineEnd=lb}};function Qm(t,e){t*=pe,e*=pe;var n=Ce(e);ss(n*Ce(t),n*Se(t),Se(e))}function ss(t,e,n){++Ho,yf+=(t-yf)/Ho,vf+=(e-vf)/Ho,xf+=(n-xf)/Ho}function sb(){wn.point=hq}function hq(t,e){t*=pe,e*=pe;var n=Ce(e);be=n*Ce(t),we=n*Se(t),_e=Se(e),wn.point=dq,ss(be,we,_e)}function dq(t,e){t*=pe,e*=pe;var n=Ce(e),r=n*Ce(t),i=n*Se(t),a=Se(e),o=Rc(OE((o=we*a-_e*i)*o+(o=_e*r-be*a)*o+(o=be*i-we*r)*o),be*r+we*i+_e*a);mf+=o,bf+=o*(be+(be=r)),wf+=o*(we+(we=i)),_f+=o*(_e+(_e=a)),ss(be,we,_e)}function lb(){wn.point=Qm}function gq(){wn.point=mq}function pq(){WE(jE,YE),wn.point=Qm}function mq(t,e){jE=t,YE=e,t*=pe,e*=pe,wn.point=WE;var n=Ce(e);be=n*Ce(t),we=n*Se(t),_e=Se(e),ss(be,we,_e)}function WE(t,e){t*=pe,e*=pe;var n=Ce(e),r=n*Ce(t),i=n*Se(t),a=Se(e),o=we*a-_e*i,u=_e*r-be*a,s=be*i-we*r,l=Yd(o,u,s),f=Zm(l),c=l&&-f/l;Zd.add(c*o),Kd.add(c*u),Qd.add(c*s),mf+=f,bf+=f*(be+(be=r)),wf+=f*(we+(we=i)),_f+=f*(_e+(_e=a)),ss(be,we,_e)}function yq(t){Ho=mf=yf=vf=xf=bf=wf=_f=0,Zd=new jr,Kd=new jr,Qd=new jr,Km(t,wn);var e=+Zd,n=+Kd,r=+Qd,i=Yd(e,n,r);return i<Qx&&(e=bf,n=wf,r=_f,mf<hf&&(e=yf,n=vf,r=xf),i=Yd(e,n,r),i<Qx)?[NaN,NaN]:[Rc(n,e)*iu,Zm(r/i)*iu]}function ls(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Nc(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Gi(){}var Du=.7,Mf=1/Du,ba="\\s*([+-]?\\d+)\\s*",$u="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Yn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vq=/^#([0-9a-f]{3,8})$/,xq=new RegExp("^rgb\\("+[ba,ba,ba]+"\\)$"),bq=new RegExp("^rgb\\("+[Yn,Yn,Yn]+"\\)$"),wq=new RegExp("^rgba\\("+[ba,ba,ba,$u]+"\\)$"),_q=new RegExp("^rgba\\("+[Yn,Yn,Yn,$u]+"\\)$"),Mq=new RegExp("^hsl\\("+[$u,Yn,Yn]+"\\)$"),kq=new RegExp("^hsla\\("+[$u,Yn,Yn,$u]+"\\)$"),fb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ls(Gi,Jm,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:cb,formatHex:cb,formatHsl:Aq,formatRgb:hb,toString:hb});function cb(){return this.rgb().formatHex()}function Aq(){return GE(this).formatHsl()}function hb(){return this.rgb().formatRgb()}function Jm(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=vq.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?db(e):n===3?new Ae(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?js(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?js(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=xq.exec(t))?new Ae(e[1],e[2],e[3],1):(e=bq.exec(t))?new Ae(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=wq.exec(t))?js(e[1],e[2],e[3],e[4]):(e=_q.exec(t))?js(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Mq.exec(t))?mb(e[1],e[2]/100,e[3]/100,1):(e=kq.exec(t))?mb(e[1],e[2]/100,e[3]/100,e[4]):fb.hasOwnProperty(t)?db(fb[t]):t==="transparent"?new Ae(NaN,NaN,NaN,0):null}function db(t){return new Ae(t>>16&255,t>>8&255,t&255,1)}function js(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ae(t,e,n,r)}function HE(t){return t instanceof Gi||(t=Jm(t)),t?(t=t.rgb(),new Ae(t.r,t.g,t.b,t.opacity)):new Ae}function ty(t,e,n,r){return arguments.length===1?HE(t):new Ae(t,e,n,r==null?1:r)}function Ae(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}ls(Ae,ty,Nc(Gi,{brighter:function(t){return t=t==null?Mf:Math.pow(Mf,t),new Ae(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?Du:Math.pow(Du,t),new Ae(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gb,formatHex:gb,formatRgb:pb,toString:pb}));function gb(){return"#"+e0(this.r)+e0(this.g)+e0(this.b)}function pb(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function e0(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function mb(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Pn(t,e,n,r)}function GE(t){if(t instanceof Pn)return new Pn(t.h,t.s,t.l,t.opacity);if(t instanceof Gi||(t=Jm(t)),!t)return new Pn;if(t instanceof Pn)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,u=a-i,s=(a+i)/2;return u?(e===a?o=(n-r)/u+(n<r)*6:n===a?o=(r-e)/u+2:o=(e-n)/u+4,u/=s<.5?a+i:2-a-i,o*=60):u=s>0&&s<1?0:o,new Pn(o,u,s,t.opacity)}function VE(t,e,n,r){return arguments.length===1?GE(t):new Pn(t,e,n,r==null?1:r)}function Pn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}ls(Pn,VE,Nc(Gi,{brighter:function(t){return t=t==null?Mf:Math.pow(Mf,t),new Pn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?Du:Math.pow(Du,t),new Pn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ae(n0(t>=240?t-240:t+120,i,r),n0(t,i,r),n0(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function n0(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Eq=Math.PI/180,Cq=180/Math.PI,kf=18,XE=.96422,ZE=1,KE=.82521,QE=4/29,wa=6/29,JE=3*wa*wa,Sq=wa*wa*wa;function tC(t){if(t instanceof Wn)return new Wn(t.l,t.a,t.b,t.opacity);if(t instanceof dr)return rC(t);t instanceof Ae||(t=HE(t));var e=o0(t.r),n=o0(t.g),r=o0(t.b),i=r0((.2225045*e+.7168786*n+.0606169*r)/ZE),a,o;return e===n&&n===r?a=o=i:(a=r0((.4360747*e+.3850649*n+.1430804*r)/XE),o=r0((.0139322*e+.0971045*n+.7141733*r)/KE)),new Wn(116*i-16,500*(a-i),200*(i-o),t.opacity)}function eC(t,e,n,r){return arguments.length===1?tC(t):new Wn(t,e,n,r==null?1:r)}function Wn(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}ls(Wn,eC,Nc(Gi,{brighter:function(t){return new Wn(this.l+kf*(t==null?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Wn(this.l-kf*(t==null?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=XE*i0(e),t=ZE*i0(t),n=KE*i0(n),new Ae(a0(3.1338561*e-1.6168667*t-.4906146*n),a0(-.9787684*e+1.9161415*t+.033454*n),a0(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function r0(t){return t>Sq?Math.pow(t,1/3):t/JE+QE}function i0(t){return t>wa?t*t*t:JE*(t-QE)}function a0(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function o0(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Dq(t){if(t instanceof dr)return new dr(t.h,t.c,t.l,t.opacity);if(t instanceof Wn||(t=tC(t)),t.a===0&&t.b===0)return new dr(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Cq;return new dr(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function nC(t,e,n,r){return arguments.length===1?Dq(t):new dr(t,e,n,r==null?1:r)}function dr(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function rC(t){if(isNaN(t.h))return new Wn(t.l,0,0,t.opacity);var e=t.h*Eq;return new Wn(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}ls(dr,nC,Nc(Gi,{brighter:function(t){return new dr(this.h,this.c,this.l+kf*(t==null?1:t),this.opacity)},darker:function(t){return new dr(this.h,this.c,this.l-kf*(t==null?1:t),this.opacity)},rgb:function(){return rC(this).rgb()}}));function $q(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Fq(t){let e=t,n=t;t.length===1&&(e=(o,u)=>t(o)-u,n=Tq(t));function r(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)<0?s=f+1:l=f}return s}function i(o,u,s,l){for(s==null&&(s=0),l==null&&(l=o.length);s<l;){const f=s+l>>>1;n(o[f],u)>0?l=f:s=f+1}return s}function a(o,u,s,l){s==null&&(s=0),l==null&&(l=o.length);const f=r(o,u,s,l-1);return f>s&&e(o[f-1],u)>-e(o[f],u)?f-1:f}return{left:r,center:a,right:i}}function Tq(t){return(e,n)=>$q(t(e),n)}const ey="intersect",yb="union",Rq="vlMulti",Nq="vlPoint",vb="or",Oq="and",zq="_vgsid_",Lq="E",Bq="R",Pq="R-E",Uq="R-LE",Iq="R-RE",Af="index:unit";function xb(t,e){for(var n=e.fields,r=e.values,i=n.length,a=0,o,u;a<i;++a)if(u=n[a],u.getter=Le.getter||Le(u.field),o=u.getter(t),Ur(o)&&(o=le(o)),Ur(r[a])&&(r[a]=le(r[a])),Ur(r[a][0])&&(r[a]=r[a].map(le)),u.type===Lq){if(G(r[a])?r[a].indexOf(o)<0:o!==r[a])return!1}else if(u.type===Bq){if(!sa(o,r[a]))return!1}else if(u.type===Iq){if(!sa(o,r[a],!0,!1))return!1}else if(u.type===Pq){if(!sa(o,r[a],!1,!1))return!1}else if(u.type===Uq&&!sa(o,r[a],!1,!0))return!1;return!0}function qq(t,e,n){for(var r=this.context.data[t],i=r?r.values.value:[],a=r?r[Af]&&r[Af].value:void 0,o=n===ey,u=i.length,s=0,l,f,c,h,d;s<u;++s)if(l=i[s],a&&o){if(f=f||{},c=f[h=l.unit]||0,c===-1)continue;if(d=xb(e,l),f[h]=d?-1:++c,d&&a.size===1)return!0;if(!d&&c===a.get(h).count)return!1}else if(d=xb(e,l),o^d)return d;return u&&o}const Jd=Le(zq),iC=Fq(Jd),jq=iC.left,Yq=iC.right;function Wq(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],a=r?r[Af]&&r[Af].value:void 0,o=n===ey,u=Jd(e),s=jq(i,u);if(s===i.length||Jd(i[s])!==u)return!1;if(a&&o){if(a.size===1)return!0;if(Yq(i,u)-s<a.size)return!1}return!0}function Hq(t,e){return t.map(n=>tt({values:e.fields.map(r=>(r.getter||(r.getter=Le(r.field)))(n.datum))},e))}function Gq(t,e,n,r){for(var i=this.context.data[t],a=i?i.values.value:[],o={},u={},s={},l,f,c,h,d,g,p,m,y,v=a.length,x=0,b,_;x<v;++x){for(l=a[x],h=l.unit,f=l.fields,c=l.values,b=0,_=f.length;b<_;++b)d=f[b],g=o[d.field]||(o[d.field]={}),p=g[h]||(g[h]=[]),s[d.field]=m=d.type.charAt(0),y=bb[m+"_union"],g[h]=y(p,Z(c[b]));n&&(p=u[h]||(u[h]=[]),p.push(Z(c).reduce((M,w,A)=>(M[f[A].field]=w,M),{})))}if(e=e||yb,Object.keys(o).forEach(M=>{o[M]=Object.keys(o[M]).map(w=>o[M][w]).reduce((w,A)=>w===void 0?A:bb[s[M]+"_"+e](w,A))}),a=Object.keys(u),n&&a.length){const M=r?Nq:Rq;o[M]=e===yb?{[vb]:a.reduce((w,A)=>(w.push(...u[A]),w),[])}:{[Oq]:a.map(w=>({[vb]:u[w]}))}}return o}var bb={E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter(n=>e.indexOf(n)>=0):e},R_union:function(t,e){var n=le(e[0]),r=le(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=le(e[0]),r=le(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};const Vq=":",Xq="@";function ny(t,e,n,r){e[0].type!==Di&&z("First argument to selection functions must be a string literal.");const i=e[0].value,a=e.length>=2&&ot(e).value,o="unit",u=Xq+o,s=Vq+i;a===ey&&!K(r,u)&&(r[u]=n.getData(i).indataRef(n,o)),K(r,s)||(r[s]=n.getData(i).tuplesRef())}function aC(t){const e=this.context.data[t];return e?e.values.value:[]}function Zq(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i&&i.count}function Kq(t,e){const n=this.context.dataflow,r=this.context.data[t],i=r.input;return n.pulse(i,n.changeset().remove(sn).insert(e)),1}function Qq(t,e,n){if(t){const r=this.context.dataflow,i=t.mark.source;r.pulse(i,r.changeset().encode(t,e))}return n!==void 0?n:t}const fs=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},Jq=fs("format"),oC=fs("timeFormat"),tj=fs("utcFormat"),ej=fs("timeParse"),nj=fs("utcParse"),Ys=new Date(2e3,0,1);function Oc(t,e,n){return!Number.isInteger(t)||!Number.isInteger(e)?"":(Ys.setYear(2e3),Ys.setMonth(t),Ys.setDate(e),oC.call(this,Ys,n))}function rj(t){return Oc.call(this,t,1,"%B")}function ij(t){return Oc.call(this,t,1,"%b")}function aj(t){return Oc.call(this,0,2+t,"%A")}function oj(t){return Oc.call(this,0,2+t,"%a")}const uj=":",sj="@",tg="%",uC="$";function ry(t,e,n,r){e[0].type!==Di&&z("First argument to data functions must be a string literal.");const i=e[0].value,a=uj+i;if(!K(a,r))try{r[a]=n.getData(i).tuplesRef()}catch(o){}}function lj(t,e,n,r){e[0].type!==Di&&z("First argument to indata must be a string literal."),e[1].type!==Di&&z("Second argument to indata must be a string literal.");const i=e[0].value,a=e[1].value,o=sj+a;K(o,r)||(r[o]=n.getData(i).indataRef(n,a))}function ze(t,e,n,r){if(e[0].type===Di)wb(n,r,e[0].value);else for(t in n.scales)wb(n,r,t)}function wb(t,e,n){const r=tg+n;if(!K(e,r))try{e[r]=t.scaleRef(n)}catch(i){}}function wr(t,e){let n;return nt(t)?t:Ct(t)?(n=e.scales[t])&&n.value:void 0}function fj(t,e,n){e.__bandwidth=i=>i&&i.bandwidth?i.bandwidth():0,n._bandwidth=ze,n._range=ze,n._scale=ze;const r=i=>"_["+(i.type===Di?V(tg+i.value):V(tg)+"+"+t(i))+"]";return{_bandwidth:i=>"this.__bandwidth(".concat(r(i[0]),")"),_range:i=>"".concat(r(i[0]),".range()"),_scale:i=>"".concat(r(i[0]),"(").concat(t(i[1]),")")}}function iy(t,e){return function(n,r,i){if(n){const a=wr(n,(i||this).context);return a&&a.path[t](r)}else return e(r)}}const cj=iy("area",iq),hj=iy("bounds",cq),dj=iy("centroid",yq);function gj(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n}function ay(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(r){t.warn(r)}return n[n.length-1]}function pj(){return ay(this.context.dataflow,"warn",arguments)}function mj(){return ay(this.context.dataflow,"info",arguments)}function yj(){return ay(this.context.dataflow,"debug",arguments)}function u0(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function eg(t){const e=ty(t),n=u0(e.r),r=u0(e.g),i=u0(e.b);return .2126*n+.7152*r+.0722*i}function vj(t,e){const n=eg(t),r=eg(e),i=Math.max(n,r),a=Math.min(n,r);return(i+.05)/(a+.05)}function xj(){const t=[].slice.call(arguments);return t.unshift({}),tt(...t)}function sC(t,e){return t===e||t!==t&&e!==e?!0:G(t)?G(e)&&t.length===e.length?bj(t,e):!1:et(t)&&et(e)?lC(t,e):!1}function bj(t,e){for(let n=0,r=t.length;n<r;++n)if(!sC(t[n],e[n]))return!1;return!0}function lC(t,e){for(const n in t)if(!sC(t[n],e[n]))return!1;return!0}function _b(t){return e=>lC(t,e)}function wj(t,e,n,r,i,a){const o=this.context.dataflow,u=this.context.data[t],s=u.input,l=o.stamp();let f=u.changes,c,h;if(o._trigger===!1||!(s.value.length||e||r))return 0;if((!f||f.stamp<l)&&(u.changes=f=o.changeset(),f.stamp=l,o.runAfter(()=>{u.modified=!0,o.pulse(s,f).run()},!0,1)),n&&(c=n===!0?sn:G(n)||Wf(n)?n:_b(n),f.remove(c)),e&&f.insert(e),r&&(c=_b(r),s.value.some(c)?f.remove(c):f.insert(r)),i)for(h in a)f.modify(i,h,a[h]);return 1}function _j(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.sqrt(n*n+r*r)}function Mj(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)}const Mb={};function kj(t,e){const n=Mb[e]||(Mb[e]=Le(e));return G(t)?t.map(n):n(t)}function oy(t){return G(t)||ArrayBuffer.isView(t)?t:null}function uy(t){return oy(t)||(Ct(t)?t:null)}function Aj(t,...e){return oy(t).join(...e)}function Ej(t,...e){return uy(t).indexOf(...e)}function Cj(t,...e){return uy(t).lastIndexOf(...e)}function Sj(t,...e){return uy(t).slice(...e)}function Dj(t,e,n){return nt(n)&&z("Function argument passed to replace."),String(t).replace(e,n)}function $j(t){return oy(t).slice().reverse()}function Fj(t,e,n){return cp(t||0,e||0,n||0)}function Tj(t,e){const n=wr(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}function Rj(t,e){const n=wr(t,(e||this).context);return n?n.copy():void 0}function Nj(t,e){const n=wr(t,(e||this).context);return n?n.domain():[]}function Oj(t,e,n){const r=wr(t,(n||this).context);return r?G(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}function zj(t,e){const n=wr(t,(e||this).context);return n&&n.range?n.range():[]}function Lj(t,e,n){const r=wr(t,(n||this).context);return r?r(e):void 0}function Bj(t,e,n,r,i){t=wr(t,(i||this).context);const a=Y5(e,n);let o=t.domain(),u=o[0],s=ot(o),l=Ee;return s-u?l=T5(t,u,s):t=(t.interpolator?dt("sequential")().interpolator(t.interpolator()):dt("linear")().interpolate(t.interpolate()).range(t.range())).domain([u=0,s=1]),t.ticks&&(o=t.ticks(+r||15),u!==o[0]&&o.unshift(u),s!==ot(o)&&o.push(s)),o.forEach(f=>a.stop(l(f),t(f))),a}function Pj(t,e,n){const r=wr(t,(n||this).context);return function(i){return r?r.path.context(i)(e):""}}function Uj(t){let e=null;return function(n){return n?vu(n,e=e||Ta(t)):t}}const fC=t=>t.data;function cC(t,e){const n=aC.call(e,t);return n.root&&n.root.lookup||{}}function Ij(t,e,n){const r=cC(t,this),i=r[e],a=r[n];return i&&a?i.path(a).map(fC):void 0}function qj(t,e){const n=cC(t,this)[e];return n?n.ancestors().map(fC):void 0}const hC=()=>typeof window<"u"&&window||null;function jj(){const t=hC();return t?t.screen:{}}function Yj(){const t=hC();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]}function Wj(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]}function Hj(t,e,n){if(!t)return[];const[r,i]=t,a=new jt().set(r[0],r[1],i[0],i[1]),o=n||this.context.dataflow.scenegraph().root;return Nk(o,a,Gj(e))}function Gj(t){let e=null;if(t){const n=Z(t.marktype),r=Z(t.markname);e=i=>(!n.length||n.some(a=>i.marktype===a))&&(!r.length||r.some(a=>i.name===a))}return e}const Fu={random(){return fn()},cumulativeNormal:Zf,cumulativeLogNormal:l1,cumulativeUniform:d1,densityNormal:i1,densityLogNormal:s1,densityUniform:h1,quantileNormal:Kf,quantileLogNormal:f1,quantileUniform:g1,sampleNormal:Xf,sampleLogNormal:u1,sampleUniform:c1,isArray:G,isBoolean:Kw,isDate:Ur,isDefined(t){return t!==void 0},isNumber:Yr,isObject:et,isRegExp:Jw,isString:Ct,isTuple:Wf,isValid(t){return t!=null&&t===t},toBoolean:Og,toDate:zg,toNumber:le,toString:Lg,indexof:Ej,join:Aj,lastindexof:Cj,replace:Dj,reverse:$j,slice:Sj,flush:Zw,lerp:t_,merge:xj,pad:r_,peek:ot,pluck:kj,span:Lu,inrange:sa,truncate:i_,rgb:ty,lab:eC,hcl:nC,hsl:VE,luminance:eg,contrast:vj,sequence:tq,format:Jq,utcFormat:tj,utcParse:nj,utcOffset:U_,utcSequence:j_,timeFormat:oC,timeParse:ej,timeOffset:P_,timeSequence:q_,timeUnitSpecifier:S_,monthFormat:rj,monthAbbrevFormat:ij,dayFormat:aj,dayAbbrevFormat:oj,quarter:Hw,utcquarter:Gw,week:$_,utcweek:R_,dayofyear:D_,utcdayofyear:T_,warn:pj,info:mj,debug:yj,extent:Vn,inScope:gj,intersect:Hj,clampRange:Vw,pinchDistance:_j,pinchAngle:Mj,screen:jj,containerSize:Wj,windowSize:Yj,bandspace:Fj,setdata:Kq,pathShape:Uj,panLinear:qw,panLog:jw,panPow:Yw,panSymlog:Ww,zoomLinear:Dg,zoomLog:$g,zoomPow:Al,zoomSymlog:Fg,encode:Qq,modify:wj},Vj=["view","item","group","xy","x","y"],Xj="event.vega.",dC="this.",sy={},gC={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>"_[".concat(V(uC+t),"]"),functions:Zj,constants:FE,visitors:sy},ng=RE(gC);function Zj(t){const e=TE(t);Vj.forEach(n=>e[n]=Xj+n);for(const n in Fu)e[n]=dC+n;return tt(e,fj(t,Fu,sy)),e}function Pt(t,e,n){return arguments.length===1?Fu[t]:(Fu[t]=e,n&&(sy[t]=n),ng&&(ng.functions[t]=dC+t),this)}Pt("bandwidth",Tj,ze);Pt("copy",Rj,ze);Pt("domain",Nj,ze);Pt("range",zj,ze);Pt("invert",Oj,ze);Pt("scale",Lj,ze);Pt("gradient",Bj,ze);Pt("geoArea",cj,ze);Pt("geoBounds",hj,ze);Pt("geoCentroid",dj,ze);Pt("geoShape",Pj,ze);Pt("indata",Zq,lj);Pt("data",aC,ry);Pt("treePath",Ij,ry);Pt("treeAncestors",qj,ry);Pt("vlSelectionTest",qq,ny);Pt("vlSelectionIdTest",Wq,ny);Pt("vlSelectionResolve",Gq,ny);Pt("vlSelectionTuples",Hq);function Kn(t,e){const n={};let r;try{t=Ct(t)?t:V(t)+"",r=$E(t)}catch(a){z("Expression parse error: "+t)}r.visit(a=>{if(a.type!==ME)return;const o=a.callee.name,u=gC.visitors[o];u&&u(o,a.arguments,e,n)});const i=ng(r);return i.globals.forEach(a=>{const o=uC+a;!K(n,o)&&e.getSignal(a)&&(n[o]=e.signalRef(a))}),{$expr:tt({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}function Kj(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach(r=>e.parseOperator(r)),n.forEach(r=>e.parseOperatorParameters(r)),(t.streams||[]).forEach(r=>e.parseStream(r)),(t.updates||[]).forEach(r=>e.parseUpdate(r)),e.resolve()}const Qj=En(["rule"]),kb=En(["group","image","rect"]);function Jj(t,e){let n="";return Qj[e]||(t.x2&&(t.x?(kb[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(kb[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}function ly(t){return(t+"").toLowerCase()}function tY(t){return ly(t)==="operator"}function eY(t){return ly(t)==="collect"}function bo(t,e,n){n[n.length-1]!==";"&&(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}function nY(t,e,n,r){return"((u = ".concat(t,") < (v = ").concat(e,") || u == null) && v != null ? ").concat(n,`
  : (u > v || v == null) && u != null ? `).concat(r,`
  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? `).concat(n,`
  : v !== v && u === u ? `).concat(r," : ")}var rY={operator:(t,e)=>bo(t,["_"],e.code),parameter:(t,e)=>bo(t,["datum","_"],e.code),event:(t,e)=>bo(t,["event"],e.code),handler:(t,e)=>{const n="var datum=event.item&&event.item.datum;return ".concat(e.code,";");return bo(t,["_","event"],n)},encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const a in r){const o="o["+V(a)+"]";i+="$=".concat(r[a].code,";if(").concat(o,"!==$)").concat(o,"=$,m=1;")}return i+=Jj(r,n),i+="return m;",bo(t,["item","_"],i)},codegen:{get(t){const e="[".concat(t.map(V).join("]["),"]"),n=Function("_","return _".concat(e,";"));return n.path=e,n},comparator(t,e){let n;const r=(a,o)=>{const u=e[o];let s,l;return a.path?(s="a".concat(a.path),l="b".concat(a.path)):((n=n||{})["f"+o]=a,s="this.f".concat(o,"(a)"),l="this.f".concat(o,"(b)")),nY(s,l,-u,u)},i=Function("a","b","var u, v; return "+t.map(r).join("")+"0;");return n?i.bind(n):i}}};function iY(t){const e=this;tY(t.type)||!t.type?e.operator(t,t.update?e.operatorExpression(t.update):null):e.transform(t,t.type)}function aY(t){const e=this;if(t.params){const n=e.get(t.id);n||z("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}}function oY(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=G(i)?i.map(a=>Ab(a,n,e)):Ab(i,n,e)}return e}function Ab(t,e,n){if(!t||!et(t))return t;for(let r=0,i=Eb.length,a;r<i;++r)if(a=Eb[r],K(t,a.key))return a.parse(t,e,n);return t}var Eb=[{key:"$ref",parse:uY},{key:"$key",parse:lY},{key:"$expr",parse:sY},{key:"$field",parse:fY},{key:"$encode",parse:hY},{key:"$compare",parse:cY},{key:"$context",parse:dY},{key:"$subflow",parse:gY},{key:"$tupleid",parse:pY}];function uY(t,e){return e.get(t.$ref)||z("Operator not defined: "+t.$ref)}function sY(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code+"_"+t.$name;return e.fn[r]||(e.fn[r]=Ie(e.parameterExpression(t.$expr),t.$fields,t.$name))}function lY(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=Ng(t.$key,t.$flat,e.expr.codegen))}function fY(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=Le(t.$field,t.$name,e.expr.codegen))}function cY(t,e){const n="c:"+t.$compare+"_"+t.$order,r=Z(t.$compare).map(i=>i&&i.$tupleid?H:i);return e.fn[n]||(e.fn[n]=Tg(r,t.$order,e.expr.codegen))}function hY(t,e){const n=t.$encode,r={};for(const i in n){const a=n[i];r[i]=Ie(e.encodeExpression(a.$expr),a.$fields),r[i].output=a.$output}return r}function dY(t,e){return e}function gY(t,e){const n=t.$subflow;return function(r,i,a){const o=e.fork().parse(n),u=o.get(n.operators[0].id),s=o.signals.parent;return s&&s.set(a),u.detachSubflow=()=>e.detach(o),u}}function pY(){return H}function mY(t){var e=this,n=t.filter!=null?e.eventExpression(t.filter):void 0,r=t.stream!=null?e.get(t.stream):void 0,i;t.source?r=e.events(t.source,t.type,n):t.merge&&(i=t.merge.map(a=>e.get(a)),r=i[0].merge.apply(i[0],i.slice(1))),t.between&&(i=t.between.map(a=>e.get(a)),r=r.between(i[0],i[1])),t.filter&&(r=r.filter(n)),t.throttle!=null&&(r=r.throttle(+t.throttle)),t.debounce!=null&&(r=r.debounce(+t.debounce)),r==null&&z("Invalid stream definition: "+JSON.stringify(t)),t.consume&&r.consume(!0),e.stream(t,r)}function yY(t){var e=this,n=et(n=t.source)?n.$ref:n,r=e.get(n),i=null,a=t.update,o=void 0;r||z("Source not defined: "+t.source),i=t.target&&t.target.$expr?e.eventExpression(t.target.$expr):e.get(t.target),a&&a.$expr&&(a.$params&&(o=e.parseParameters(a.$params)),a=e.handlerExpression(a.$expr)),e.update(t,r,i,a,o)}const vY={skip:!0};function xY(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach(a=>{const o=e.signals[a];t.signals(a,o)&&(r[a]=o.value)})}if(t.data){var i=n.data={};Object.keys(e.data).forEach(a=>{const o=e.data[a];t.data(a,o)&&(i[a]=o.input.value)})}return e.subcontext&&t.recurse!==!1&&(n.subcontext=e.subcontext.map(a=>a.getState(t))),n}function bY(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach(a=>{n.update(e.signals[a],i[a],vY)}),Object.keys(r||{}).forEach(a=>{n.pulse(e.data[a].input,n.changeset().remove(sn).insert(r[a]))}),(t.subcontext||[]).forEach((a,o)=>{const u=e.subcontext[o];u&&u.setState(a)})}function pC(t,e,n,r){return new mC(t,e,n,r)}function mC(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||rY,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function Cb(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}mC.prototype=Cb.prototype={fork(){const t=new Cb(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter(n=>n!==t);const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),eY(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let a=n.get(t.parent.$ref);a?(r.connect(a,[e]),e.targets().add(a)):(n.unresolved=n.unresolved||[]).push(()=>{a=n.get(t.parent.$ref),r.connect(a,[e]),e.targets().add(a)})}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const a in t.data){const o=n.data[a]||(n.data[a]={});t.data[a].forEach(u=>o[u]=e)}},resolve(){return(this.unresolved||[]).forEach(t=>t()),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[ly(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:Kj,parseOperator:iY,parseOperatorParameters:aY,parseParameters:oY,parseStream:mY,parseUpdate:yY,getState:xY,setState:bY};var Ua=0,Go=0,wo=0,yC=1e3,Ef,Vo,Cf=0,Ti=0,zc=0,Tu=typeof performance=="object"&&performance.now?performance:Date,vC=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function fy(){return Ti||(vC(wY),Ti=Tu.now()+zc)}function wY(){Ti=0}function rg(){this._call=this._time=this._next=null}rg.prototype={constructor:rg,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?fy():+n)+(e==null?0:+e),!this._next&&Vo!==this&&(Vo?Vo._next=this:Ef=this,Vo=this),this._call=t,this._time=n,ig()},stop:function(){this._call&&(this._call=null,this._time=1/0,ig())}};function _Y(){fy(),++Ua;for(var t=Ef,e;t;)(e=Ti-t._time)>=0&&t._call.call(null,e),t=t._next;--Ua}function Sb(){Ti=(Cf=Tu.now())+zc,Ua=Go=0;try{_Y()}finally{Ua=0,kY(),Ti=0}}function MY(){var t=Tu.now(),e=t-Cf;e>yC&&(zc-=e,Cf=t)}function kY(){for(var t,e=Ef,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Ef=n);Vo=t,ig(r)}function ig(t){if(!Ua){Go&&(Go=clearTimeout(Go));var e=t-Ti;e>24?(t<1/0&&(Go=setTimeout(Sb,t-Tu.now()-zc)),wo&&(wo=clearInterval(wo))):(wo||(Cf=Tu.now(),wo=setInterval(MY,yC)),Ua=1,vC(Sb))}}function AY(t,e,n){var r=new rg,i=e;return e==null?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(a,o,u){o=+o,u=u==null?fy():+u,r._restart(function s(l){l+=i,r._restart(s,i+=o,u),a(l)},o,u)},r.restart(t,e,n),r)}function EY(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),xC(e,t.description()))}function xC(t,e){t&&(e==null?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}function CY(t){t.add(null,e=>(t._background=e.bg,t._resize=1,e.bg),{bg:t._signals.background})}const s0="default";function SY(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:s0,item:null}));t.on(t.events("view","mousemove"),e,(n,r)=>{const i=e.value,a=i?Ct(i)?i:i.user:s0,o=r.item&&r.item.cursor||null;return i&&a===i.user&&o==i.item?i:{user:a,item:o}}),t.add(null,function(n){let r=n.cursor,i=this.value;return Ct(r)||(i=r.item,r=r.user),ag(t,r&&r!==s0?r:i||r),i},{cursor:e})}function ag(t,e){const n=t.globalCursor()?typeof document<"u"&&document.body:t.container();if(n)return e==null?n.style.removeProperty("cursor"):n.style.cursor=e}function Sf(t,e){var n=t._runtime.data;return K(n,e)||z("Unrecognized data set: "+e),n[e]}function DY(t,e){return arguments.length<2?Sf(this,t).values.value:Lc.call(this,t,Pi().remove(sn).insert(e))}function Lc(t,e){d3(e)||z("Second argument to changes must be a changeset.");const n=Sf(this,t);return n.modified=!0,this.pulse(n.input,e)}function $Y(t,e){return Lc.call(this,t,Pi().insert(e))}function FY(t,e){return Lc.call(this,t,Pi().remove(e))}function bC(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function wC(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function Bc(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}function TY(t){var e=Bc(t),n=bC(t),r=wC(t);t._renderer.background(t.background()),t._renderer.resize(n,r,e),t._handler.origin(e),t._resizeListeners.forEach(i=>{try{i(n,r)}catch(a){t.error(a)}})}function RY(t,e,n){var r=t._renderer,i=r&&r.canvas(),a,o,u;return i&&(u=Bc(t),o=e.changedTouches?e.changedTouches[0]:e,a=_c(o,i),a[0]-=u[0],a[1]-=u[1]),e.dataflow=t,e.item=n,e.vega=NY(t,n,a),e}function NY(t,e,n){const r=e?e.mark.marktype==="group"?e:e.mark.group:null;function i(o){var u=r,s;if(o){for(s=e;s;s=s.mark.group)if(s.mark.name===o){u=s;break}}return u&&u.mark&&u.mark.interactive?u:{}}function a(o){if(!o)return n;Ct(o)&&(o=i(o));const u=n.slice();for(;o;)u[0]-=o.x||0,u[1]-=o.y||0,o=o.mark&&o.mark.group;return u}return{view:ge(t),item:ge(e||{}),group:i,xy:a,x:o=>a(o)[0],y:o=>a(o)[1]}}const Db="view",OY="timer",zY="window",LY={trap:!1};function BY(t){const e=tt({defaults:{}},t),n=(r,i)=>{i.forEach(a=>{G(r[a])&&(r[a]=En(r[a]))})};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}function _C(t,e,n,r){t._eventListeners.push({type:n,sources:Z(e),handler:r})}function PY(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return r===!1||i===!0?!1:r===!0||i===!1?!0:r?r[e]:i?!i[e]:t.preventDefault()}function Ws(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return r===!1||et(r)&&!r[n]?(t.warn(`Blocked ${e} ${n} event listener.`),!1):!0}function UY(t,e,n){var r=this,i=new Vf(n),a=function(l,f){r.runAsync(null,()=>{t===Db&&PY(r,e)&&l.preventDefault(),i.receive(RY(r,l,f))})},o;if(t===OY)Ws(r,"timer",e)&&r.timer(a,e);else if(t===Db)Ws(r,"view",e)&&r.addEventListener(e,a,LY);else if(t===zY?Ws(r,"window",e)&&typeof window<"u"&&(o=[window]):typeof document<"u"&&Ws(r,"selector",e)&&(o=document.querySelectorAll(t)),!o)r.warn("Can not resolve event source: "+t);else{for(var u=0,s=o.length;u<s;++u)o[u].addEventListener(e,a);_C(r,o,e,a)}return i}function $b(t){return t.item}function Fb(t){return t.item.mark.source}function Tb(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function IY(t,e){return t=[t||"hover"],e=[e||"update",t[0]],this.on(this.events("view","mouseover",$b),Fb,Tb(t)),this.on(this.events("view","mouseout",$b),Fb,Tb(e)),this}function qY(){var t=this._tooltip,e=this._timers,n=this._eventListeners,r,i,a;for(r=e.length;--r>=0;)e[r].stop();for(r=n.length;--r>=0;)for(a=n[r],i=a.sources.length;--i>=0;)a.sources[i].removeEventListener(a.type,a.handler);return t&&t.call(this,this._handler,null,null,null),this}function Ge(t,e,n){const r=document.createElement(t);for(const i in e)r.setAttribute(i,e[i]);return n!=null&&(r.textContent=n),r}const jY="vega-bind",YY="vega-bind-name",WY="vega-bind-radio";function HY(t,e,n){if(!e)return;const r=n.param;let i=n.state;return i||(i=n.state={elements:null,active:!1,set:null,update:o=>{o!=t.signal(r.signal)&&t.runAsync(null,()=>{i.source=!0,t.signal(r.signal,o)})}},r.debounce&&(i.update=Rg(r.debounce,i.update))),(r.input==null&&r.element?GY:XY)(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,()=>{i.source?i.source=!1:i.set(t.signal(r.signal))}),i.active=!0),i}function GY(t,e,n,r){const i=n.event||"input",a=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,a),_C(r,e,i,a),t.set=o=>{e.value=o,e.dispatchEvent(VY(i))}}function VY(t){return typeof Event<"u"?new Event(t):{type:t}}function XY(t,e,n,r){const i=r.signal(n.signal),a=Ge("div",{class:jY}),o=n.input==="radio"?a:a.appendChild(Ge("label"));o.appendChild(Ge("span",{class:YY},n.name||n.signal)),e.appendChild(a);let u=ZY;switch(n.input){case"checkbox":u=KY;break;case"select":u=QY;break;case"radio":u=JY;break;case"range":u=tW;break}u(t,o,n,i)}function ZY(t,e,n,r){const i=Ge("input");for(const a in n)a!=="signal"&&a!=="element"&&i.setAttribute(a==="input"?"type":a,n[a]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",()=>t.update(i.value)),t.elements=[i],t.set=a=>i.value=a}function KY(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const a=Ge("input",i);e.appendChild(a),a.addEventListener("change",()=>t.update(a.checked)),t.elements=[a],t.set=o=>a.checked=!!o||null}function QY(t,e,n,r){const i=Ge("select",{name:n.signal}),a=n.labels||[];n.options.forEach((o,u)=>{const s={value:o};Df(o,r)&&(s.selected=!0),i.appendChild(Ge("option",s,(a[u]||o)+""))}),e.appendChild(i),i.addEventListener("change",()=>{t.update(n.options[i.selectedIndex])}),t.elements=[i],t.set=o=>{for(let u=0,s=n.options.length;u<s;++u)if(Df(n.options[u],o)){i.selectedIndex=u;return}}}function JY(t,e,n,r){const i=Ge("span",{class:WY}),a=n.labels||[];e.appendChild(i),t.elements=n.options.map((o,u)=>{const s={type:"radio",name:n.signal,value:o};Df(o,r)&&(s.checked=!0);const l=Ge("input",s);l.addEventListener("change",()=>t.update(o));const f=Ge("label",{},(a[u]||o)+"");return f.prepend(l),i.appendChild(f),l}),t.set=o=>{const u=t.elements,s=u.length;for(let l=0;l<s;++l)Df(u[l].value,o)&&(u[l].checked=!0)}}function tW(t,e,n,r){r=r!==void 0?r:(+n.max+ +n.min)/2;const i=n.max!=null?n.max:Math.max(100,+r)||100,a=n.min||Math.min(0,i,+r)||0,o=n.step||HU(a,i,100),u=Ge("input",{type:"range",name:n.signal,min:a,max:i,step:o});u.value=r;const s=Ge("span",{},+r);e.appendChild(u),e.appendChild(s);const l=()=>{s.textContent=u.value,t.update(+u.value)};u.addEventListener("input",l),u.addEventListener("change",l),t.elements=[u],t.set=f=>{u.value=f,s.textContent=f}}function Df(t,e){return t===e||t+""==e+""}function MC(t,e,n,r,i,a){return e=e||new r(t.loader()),e.initialize(n,bC(t),wC(t),Bc(t),i,a).background(t.background())}function cy(t,e){return e?function(){try{e.apply(this,arguments)}catch(n){t.error(n)}}:null}function eW(t,e,n,r){const i=new r(t.loader(),cy(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,Bc(t),t);return e&&e.handlers().forEach(a=>{i.on(a.type,a.handler)}),i}function nW(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,a=Mc(r);t=n._el=t?l0(n,t,!0):null,EY(n),a||n.error("Unrecognized renderer type: "+r);const o=a.handler||ts,u=t?a.renderer:a.headless;return n._renderer=u?MC(n,n._renderer,t,u):null,n._handler=eW(n,n._handler,t,o),n._redraw=!0,t&&i!=="none"&&(e=e?n._elBind=l0(n,e,!0):t.appendChild(Ge("form",{class:"vega-bindings"})),n._bind.forEach(s=>{s.param.element&&i!=="container"&&(s.element=l0(n,s.param.element,!!s.param.input))}),n._bind.forEach(s=>{HY(n,s.element||e,s)})),n}function l0(t,e,n){if(typeof e=="string")if(typeof document<"u"){if(e=document.querySelector(e),!e)return t.error("Signal bind element not found: "+e),null}else return t.error("DOM document instance not found."),null;if(e&&n)try{e.innerHTML=""}catch(r){e=null,t.error(r)}return e}const _o=t=>+t||0,rW=t=>({top:t,bottom:t,left:t,right:t});function Rb(t){return et(t)?{top:_o(t.top),bottom:_o(t.bottom),left:_o(t.left),right:_o(t.right)}:rW(_o(t))}async function hy(t,e,n,r){const i=Mc(e),a=i&&i.headless;return a||z("Unrecognized renderer type: "+e),await t.runAsync(),MC(t,null,null,a,n,r).renderAsync(t._scenegraph.root)}async function iW(t,e){t!==Or.Canvas&&t!==Or.SVG&&t!==Or.PNG&&z("Unrecognized image type: "+t);const n=await hy(this,t,e);return t===Or.SVG?aW(n.svg(),"image/svg+xml"):n.canvas().toDataURL("image/png")}function aW(t,e){const n=new Blob([t],{type:e});return window.URL.createObjectURL(n)}async function oW(t,e){return(await hy(this,Or.Canvas,t,e)).canvas()}async function uW(t){return(await hy(this,Or.SVG,t)).svg()}function sW(t,e,n){return pC(t,Ca,Fu,n).parse(e)}function lW(t){var e=this._runtime.scales;return K(e,t)||z("Unrecognized scale or projection: "+t),e[t].value}var kC="width",AC="height",dy="padding",Nb={skip:!0};function EC(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===dy?r.left+r.right:0)}function CC(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===dy?r.top+r.bottom:0)}function fW(t){var e=t._signals,n=e[kC],r=e[AC],i=e[dy];function a(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,u=>{t._width=u.size,t._viewWidth=EC(t,u.size),a()},{size:n}),t._resizeHeight=t.add(null,u=>{t._height=u.size,t._viewHeight=CC(t,u.size),a()},{size:r});const o=t.add(null,a,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,o.rank=i.rank+1}function cW(t,e,n,r,i,a){this.runAfter(o=>{let u=0;o._autosize=0,o.width()!==n&&(u=1,o.signal(kC,n,Nb),o._resizeWidth.skip(!0)),o.height()!==r&&(u=1,o.signal(AC,r,Nb),o._resizeHeight.skip(!0)),o._viewWidth!==t&&(o._resize=1,o._viewWidth=t),o._viewHeight!==e&&(o._resize=1,o._viewHeight=e),(o._origin[0]!==i[0]||o._origin[1]!==i[1])&&(o._resize=1,o._origin=i),u&&o.run("enter"),a&&o.runAfter(s=>s.resize())},!1,1)}function hW(t){return this._runtime.getState(t||{data:dW,signals:gW,recurse:!0})}function dW(t,e){return e.modified&&G(e.input.value)&&t.indexOf("_:vega:_")}function gW(t,e){return!(t==="parent"||e instanceof Ca.proxy)}function pW(t){return this.runAsync(null,e=>{e._trigger=!1,e._runtime.setState(t)},e=>{e._trigger=!0}),this}function mW(t,e){function n(r){t({timestamp:Date.now(),elapsed:r})}this._timers.push(AY(n,e))}function yW(t,e,n,r){const i=t.element();i&&i.setAttribute("title",vW(r))}function vW(t){return t==null?"":G(t)?SC(t):et(t)&&!Ur(t)?xW(t):t+""}function xW(t){return Object.keys(t).map(e=>{const n=t[e];return e+": "+(G(n)?SC(n):DC(n))}).join(`
`)}function SC(t){return"["+t.map(DC).join(", ")+"]"}function DC(t){return G(t)?"[…]":et(t)&&!Ur(t)?"{…}":t}function $C(t,e){const n=this;if(e=e||{},ya.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),e.logLevel!=null&&n.logLevel(e.logLevel),e.locale||t.locale){const a=tt({},t.locale,e.locale);n.locale(s3(a.number,a.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||Or.Canvas,n._scenegraph=new Ip;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||yW,n._redraw=!0,n._handler=new ts().scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=BY(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=sW(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map(a=>({state:null,param:tt({},a)})),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=EC(n,n._width),n._viewHeight=CC(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,fW(n),CY(n),SY(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind)}function Hs(t,e){return K(t._signals,e)?t._signals[e]:z("Unrecognized signal name: "+V(e))}function FC(t,e){const n=(t._targets||[]).filter(r=>r._update&&r._update.handler===e);return n.length?n[0]:null}function Ob(t,e,n,r){let i=FC(n,r);return i||(i=cy(t,()=>r(e,n.value)),i.handler=r,t.on(n,null,i)),t}function zb(t,e,n){const r=FC(e,n);return r&&e._targets.remove(r),t}P($C,ya,{async evaluate(t,e,n){if(await ya.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,TY(this)),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(r){this.error(r)}return n&&Qs(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=t!=null?t+"":null;return e!==this._desc&&xC(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=Hs(this,t);return arguments.length===1?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",Rb(t)):Rb(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(Mc(t)||z("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(ya.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Hs(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:cW,addEventListener(t,e,n){let r=e;return n&&n.trap===!1||(r=cy(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n=this._handler.handlers(t),r=n.length,i,a;--r>=0;)if(a=n[r].type,i=n[r].handler,t===a&&(e===i||e===i.raw)){this._handler.off(a,i);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.indexOf(t)<0&&e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return Ob(this,t,Hs(this,t),e)},removeSignalListener(t,e){return zb(this,Hs(this,t),e)},addDataListener(t,e){return Ob(this,t,Sf(this,t).values,e)},removeDataListener(t,e){return zb(this,Sf(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=ag(this,null);this._globalCursor=!!t,e&&ag(this,e)}return this}else return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:mW,events:UY,finalize:qY,hover:IY,data:DY,change:Lc,insert:$Y,remove:FY,scale:lW,initialize:nW,toImageURL:iW,toCanvas:oW,toSVG:uW,getState:hW,setState:pW});const bW="view",$f="[",Ff="]",TC="{",RC="}",wW=":",NC=",",_W="@",MW=">",kW=/[[\]{}]/,AW={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let OC,zC;function LC(t,e,n){return OC=e||bW,zC=n||AW,BC(t.trim()).map(og)}function EW(t){return zC[t]}function ou(t,e,n,r,i){const a=t.length;let o=0,u;for(;e<a;++e){if(u=t[e],!o&&u===n)return e;i&&i.indexOf(u)>=0?--o:r&&r.indexOf(u)>=0&&++o}return e}function BC(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=ou(t,i,NC,$f+TC,Ff+RC),e.push(t.substring(r,i).trim()),r=++i;if(e.length===0)throw"Empty event selector: "+t;return e}function og(t){return t[0]==="["?CW(t):SW(t)}function CW(t){const e=t.length;let n=1,r;if(n=ou(t,n,Ff,$f,Ff),n===e)throw"Empty between selector: "+t;if(r=BC(t.substring(1,n)),r.length!==2)throw"Between selector must have two elements: "+t;if(t=t.slice(n+1).trim(),t[0]!==MW)throw"Expected '>' after between selector: "+t;r=r.map(og);const i=og(t.slice(1).trim());return i.between?{between:r,stream:i}:(i.between=r,i)}function SW(t){const e={source:OC},n=[];let r=[0,0],i=0,a=0,o=t.length,u=0,s,l;if(t[o-1]===RC){if(u=t.lastIndexOf(TC),u>=0){try{r=DW(t.substring(u+1,o-1))}catch(f){throw"Invalid throttle specification: "+t}t=t.slice(0,u).trim(),o=t.length}else throw"Unmatched right brace: "+t;u=0}if(!o)throw t;if(t[0]===_W&&(i=++u),s=ou(t,u,wW),s<o&&(n.push(t.substring(a,s).trim()),a=u=++s),u=ou(t,u,$f),u===o)n.push(t.substring(a,o).trim());else if(n.push(t.substring(a,u).trim()),l=[],a=++u,a===o)throw"Unmatched left bracket: "+t;for(;u<o;){if(u=ou(t,u,Ff),u===o)throw"Unmatched left bracket: "+t;if(l.push(t.substring(a,u).trim()),u<o-1&&t[++u]!==$f)throw"Expected left bracket: "+t;a=++u}if(!(o=n.length)||kW.test(n[o-1]))throw"Invalid event selector: "+t;return o>1?(e.type=n[1],i?e.markname=n[0].slice(1):EW(n[0])?e.marktype=n[0]:e.source=n[0]):e.type=n[0],e.type.slice(-1)==="!"&&(e.consume=!0,e.type=e.type.slice(0,-1)),l!=null&&(e.filter=l),r[0]&&(e.throttle=r[0]),r[1]&&(e.debounce=r[1]),e}function DW(t){const e=t.split(NC);if(!t.length||e.length>2)throw t;return e.map(n=>{const r=+n;if(r!==r)throw t;return r})}function $W(t){return et(t)?t:{type:t||"pad"}}const Mo=t=>+t||0,FW=t=>({top:t,bottom:t,left:t,right:t});function TW(t){return et(t)?t.signal?t:{top:Mo(t.top),bottom:Mo(t.bottom),left:Mo(t.left),right:Mo(t.right)}:FW(Mo(t))}const Gt=t=>et(t)&&!G(t)?tt({},t):{value:t};function Lb(t,e,n,r){return n!=null?(et(n)&&!G(n)||G(n)&&n.length&&et(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1):0}function ee(t,e,n){for(const r in e)Lb(t,r,e[r]);for(const r in n)Lb(t,r,n[r],"update")}function Ka(t,e,n){for(const r in e)n&&K(n,r)||(t[r]=tt(t[r]||{},e[r]));return t}function ua(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const gy="mark",py="frame",my="scope",RW="axis",NW="axis-domain",OW="axis-grid",zW="axis-label",LW="axis-tick",BW="axis-title",PW="legend",UW="legend-band",IW="legend-entry",qW="legend-gradient",PC="legend-label",jW="legend-symbol",YW="legend-title",WW="title",HW="title-text",GW="title-subtitle";function VW(t,e,n,r,i){const a={},o={};let u,s,l,f;s="lineBreak",e==="text"&&i[s]!=null&&!ua(s,t)&&f0(a,s,i[s]),(n=="legend"||String(n).startsWith("axis"))&&(n=null),f=n===py?i.group:n===gy?tt({},i.mark,i[e]):null;for(s in f)l=ua(s,t)||(s==="fill"||s==="stroke")&&(ua("fill",t)||ua("stroke",t)),l||f0(a,s,f[s]);Z(r).forEach(c=>{const h=i.style&&i.style[c];for(const d in h)ua(d,t)||f0(a,d,h[d])}),t=tt({},t);for(s in a)f=a[s],f.signal?(u=u||{})[s]=f:o[s]=f;return t.enter=tt(o,t.enter),u&&(t.update=tt(u,t.update)),t}function f0(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const UC=t=>Ct(t)?V(t):t.signal?"(".concat(t.signal,")"):IC(t);function Pc(t){if(t.gradient!=null)return ZW(t);let e=t.signal?"(".concat(t.signal,")"):t.color?XW(t.color):t.field!=null?IC(t.field):t.value!==void 0?V(t.value):void 0;return t.scale!=null&&(e=KW(t,e)),e===void 0&&(e=null),t.exponent!=null&&(e="pow(".concat(e,",").concat(hl(t.exponent),")")),t.mult!=null&&(e+="*".concat(hl(t.mult))),t.offset!=null&&(e+="+".concat(hl(t.offset))),t.round&&(e="round(".concat(e,")")),e}const Gs=(t,e,n,r)=>"(".concat(t,"(").concat([e,n,r].map(Pc).join(","),")+'')");function XW(t){return t.c?Gs("hcl",t.h,t.c,t.l):t.h||t.s?Gs("hsl",t.h,t.s,t.l):t.l||t.a?Gs("lab",t.l,t.a,t.b):t.r||t.g||t.b?Gs("rgb",t.r,t.g,t.b):null}function ZW(t){const e=[t.start,t.stop,t.count].map(n=>n==null?null:V(n));for(;e.length&&ot(e)==null;)e.pop();return e.unshift(UC(t.gradient)),"gradient(".concat(e.join(","),")")}function hl(t){return et(t)?"("+Pc(t)+")":t}function IC(t){return qC(et(t)?t:{datum:t})}function qC(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):z("Invalid field reference: "+V(t));return t.signal||(r=Ct(r)?Bf(r).map(V).join("]["):qC(r)),e+"["+r+"]"}function KW(t,e){const n=UC(t.scale);return t.range!=null?e="lerp(_range(".concat(n,"), ").concat(+t.range,")"):(e!==void 0&&(e="_scale(".concat(n,", ").concat(e,")")),t.band&&(e=(e?e+"+":"")+"_bandwidth(".concat(n,")")+(+t.band==1?"":"*"+hl(t.band)),t.extra&&(e="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(e,")"))),e==null&&(e="0")),e}function QW(t){let e="";return t.forEach(n=>{const r=Pc(n);e+=n.test?"(".concat(n.test,")?").concat(r,":"):r}),ot(e)===":"&&(e+="null"),e}function jC(t,e,n,r,i,a){const o={};a=a||{},a.encoders={$encode:o},t=VW(t,e,n,r,i.config);for(const u in t)o[u]=JW(t[u],e,a,i);return a}function JW(t,e,n,r){const i={},a={};for(const o in t)t[o]!=null&&(i[o]=eH(tH(t[o]),r,n,a));return{$expr:{marktype:e,channels:i},$fields:Object.keys(a),$output:Object.keys(t)}}function tH(t){return G(t)?QW(t):Pc(t)}function eH(t,e,n,r){const i=Kn(t,e);return i.$fields.forEach(a=>r[a]=1),tt(n,i.$params),i.$expr}const nH="outer",rH=["value","update","init","react","bind"];function Bb(t,e){z(t+' for "outer" push: '+V(e))}function YC(t,e){const n=t.name;if(t.push===nH)e.signals[n]||Bb("No prior signal definition",n),rH.forEach(r=>{t[r]!==void 0&&Bb("Invalid property ",r)});else{const r=e.addSignal(n,t.value);t.react===!1&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function ug(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function Uc(t,e,n,r){return new ug(t,e,n,r)}function Tf(t,e){return Uc("operator",t,e)}function W(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function Ru(t,e){return e?{$field:t,$name:e}:{$field:t}}const sg=Ru("key");function Pb(t,e){return{$compare:t,$order:e}}function iH(t,e){const n={$key:t};return e&&(n.$flat=!0),n}const aH="ascending",oH="descending";function uH(t){return et(t)?(t.order===oH?"-":"+")+Ic(t.op,t.field):""}function Ic(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const yy="scope",lg="view";function qt(t){return t&&t.signal}function sH(t){return t&&t.expr}function dl(t){if(qt(t))return!0;if(et(t)){for(const e in t)if(dl(t[e]))return!0}return!1}function gn(t,e){return t!=null?t:e}function wi(t){return t&&t.signal||t}const Ub="timer";function Nu(t,e){return(t.merge?fH:t.stream?cH:t.type?hH:z("Invalid stream specification: "+V(t)))(t,e)}function lH(t){return t===yy?lg:t||lg}function fH(t,e){const n=t.merge.map(i=>Nu(i,e)),r=vy({merge:n},t,e);return e.addStream(r).id}function cH(t,e){const n=Nu(t.stream,e),r=vy({stream:n},t,e);return e.addStream(r).id}function hH(t,e){let n;t.type===Ub?(n=e.event(Ub,t.throttle),t={between:t.between,filter:t.filter}):n=e.event(lH(t.source),t.type);const r=vy({stream:n},t,e);return Object.keys(r).length===1?n:e.addStream(r).id}function vy(t,e,n){let r=e.between;return r&&(r.length!==2&&z('Stream "between" parameter must have 2 entries: '+V(e)),t.between=[Nu(r[0],n),Nu(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(dH(e.marktype,e.markname,e.markrole)),e.source===yy&&r.push("inScope(event.item)"),r.length&&(t.filter=Kn("("+r.join(")&&(")+")",n).$expr),(r=e.throttle)!=null&&(t.throttle=+r),(r=e.debounce)!=null&&(t.debounce=+r),e.consume&&(t.consume=!0),t}function dH(t,e,n){const r="event.item";return r+(t&&t!=="*"?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}const gH={code:"_.$value",ast:{type:"Identifier",value:"value"}};function pH(t,e,n){const r=t.encode,i={target:n};let a=t.events,o=t.update,u=[];a||z("Signal update missing events specification."),Ct(a)&&(a=LC(a,e.isSubscope()?yy:lg)),a=Z(a).filter(s=>s.signal||s.scale?(u.push(s),0):1),u.length>1&&(u=[yH(u)]),a.length&&u.push(a.length>1?{merge:a}:a[0]),r!=null&&(o&&z("Signal encode and update are mutually exclusive."),o="encode(item(),"+V(r)+")"),i.update=Ct(o)?Kn(o,e):o.expr!=null?Kn(o.expr,e):o.value!=null?o.value:o.signal!=null?{$expr:gH,$params:{$value:e.signalRef(o.signal)}}:z("Invalid signal update specification."),t.force&&(i.options={force:!0}),u.forEach(s=>e.addUpdate(tt(mH(s,e),i)))}function mH(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):Nu(t,e)}}function yH(t){return{signal:"["+t.map(e=>e.scale?'scale("'+e.scale+'")':e.signal)+"]"}}function vH(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?z("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=Kn(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach(i=>pH(i,e,n.id))}const xt=t=>(e,n,r)=>Uc(t,n,e||void 0,r),WC=xt("aggregate"),xH=xt("axisticks"),HC=xt("bound"),$n=xt("collect"),Ib=xt("compare"),bH=xt("datajoin"),GC=xt("encode"),wH=xt("expression"),_H=xt("facet"),MH=xt("field"),kH=xt("key"),AH=xt("legendentries"),EH=xt("load"),CH=xt("mark"),SH=xt("multiextent"),DH=xt("multivalues"),$H=xt("overlap"),FH=xt("params"),VC=xt("prefacet"),TH=xt("projection"),RH=xt("proxy"),NH=xt("relay"),XC=xt("render"),OH=xt("scale"),Vi=xt("sieve"),zH=xt("sortitems"),ZC=xt("viewlayout"),LH=xt("values");let BH=0;const KC={min:"min",max:"max",count:"sum"};function PH(t,e){const n=t.type||"linear";E5(n)||z("Unrecognized scale type: "+V(n)),e.addScale(t.name,{type:n,domain:void 0})}function UH(t,e){const n=e.getScale(t.name).params;let r;n.domain=QC(t.domain,t,e),t.range!=null&&(n.range=t6(t,e,n)),t.interpolate!=null&&ZH(t.interpolate,n),t.nice!=null&&(n.nice=XH(t.nice)),t.bins!=null&&(n.bins=VH(t.bins,e));for(r in t)K(n,r)||r==="name"||(n[r]=an(t[r],e))}function an(t,e){return et(t)?t.signal?e.signalRef(t.signal):z("Unsupported object: "+V(t)):t}function gl(t,e){return t.signal?e.signalRef(t.signal):t.map(n=>an(n,e))}function qc(t){z("Can not find data set: "+V(t))}function QC(t,e,n){if(!t){(e.domainMin!=null||e.domainMax!=null)&&z("No scale domain defined for domainMin/domainMax to override.");return}return t.signal?n.signalRef(t.signal):(G(t)?IH:t.fields?jH:qH)(t,e,n)}function IH(t,e,n){return t.map(r=>an(r,n))}function qH(t,e,n){const r=n.getData(t.data);return r||qc(t.data),Fa(e.type)?r.valuesRef(n,t.field,JC(t.sort,!1)):D5(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function jH(t,e,n){const r=t.data,i=t.fields.reduce((a,o)=>(o=Ct(o)?{data:r,field:o}:G(o)||o.signal?YH(o,n):o,a.push(o),a),[]);return(Fa(e.type)?WH:D5(e.type)?HH:GH)(t,n,i)}function YH(t,e){const n="_:vega:_"+BH++,r=$n({});if(G(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+V(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,Vi({})]),{data:n,field:"data"}}function WH(t,e,n){const r=JC(t.sort,!0);let i,a;const o=n.map(l=>{const f=e.getData(l.data);return f||qc(l.data),f.countsRef(e,l.field,r)}),u={groupby:sg,pulse:o};r&&(i=r.op||"count",a=r.field?Ic(i,r.field):"count",u.ops=[KC[i]],u.fields=[e.fieldRef(a)],u.as=[a]),i=e.add(WC(u));const s=e.add($n({pulse:W(i)}));return a=e.add(LH({field:sg,sort:e.sortRef(r),pulse:W(s)})),W(a)}function JC(t,e){return t&&(!t.field&&!t.op?et(t)?t.field="key":t={field:"key"}:!t.field&&t.op!=="count"?z("No field provided for sort aggregate op: "+t.op):e&&t.field&&t.op&&!KC[t.op]&&z("Multiple domain scales can not be sorted using "+t.op)),t}function HH(t,e,n){const r=n.map(i=>{const a=e.getData(i.data);return a||qc(i.data),a.domainRef(e,i.field)});return W(e.add(DH({values:r})))}function GH(t,e,n){const r=n.map(i=>{const a=e.getData(i.data);return a||qc(i.data),a.extentRef(e,i.field)});return W(e.add(SH({extents:r})))}function VH(t,e){return t.signal||G(t)?gl(t,e):e.objectProperty(t)}function XH(t){return et(t)?{interval:an(t.interval),step:an(t.step)}:an(t)}function ZH(t,e){e.interpolate=an(t.type||t),t.gamma!=null&&(e.interpolateGamma=an(t.gamma))}function t6(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if(Ct(i)){if(r&&K(r,i))return t=tt({},t,{range:r[i]}),t6(t,e,n);i==="width"?i=[0,{signal:"width"}]:i==="height"?i=Fa(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:z("Unrecognized scale range value: "+V(i))}else if(i.scheme){n.scheme=G(i.scheme)?gl(i.scheme,e):an(i.scheme,e),i.extent&&(n.schemeExtent=gl(i.extent,e)),i.count&&(n.schemeCount=an(i.count,e));return}else if(i.step){n.rangeStep=an(i.step,e);return}else{if(Fa(t.type)&&!G(i))return QC(i,t,e);G(i)||z("Unsupported range type: "+V(i))}return i.map(a=>(G(a)?gl:an)(a,e))}function KH(t,e){const n=e.config.projection||{},r={};for(const i in t)i!=="name"&&(r[i]=fg(t[i],i,e));for(const i in n)r[i]==null&&(r[i]=fg(n[i],i,e));e.addProjection(t.name,r)}function fg(t,e,n){return G(t)?t.map(r=>fg(r,e,n)):et(t)?t.signal?n.signalRef(t.signal):e==="fit"?t:z("Unsupported parameter object: "+V(t)):t}const Fn="top",Qa="left",Ja="right",Jr="bottom",e6="center",QH="vertical",JH="start",tG="middle",eG="end",cg="index",xy="label",nG="offset",Ia="perc",rG="perc2",on="value",cs="guide-label",by="guide-title",iG="group-title",aG="group-subtitle",qb="symbol",pl="gradient",hg="discrete",dg="size",oG="shape",uG="fill",sG="stroke",lG="strokeWidth",fG="strokeDash",cG="opacity",wy=[dg,oG,uG,sG,lG,fG,cG],hs={name:1,style:1,interactive:1},st={value:0},un={value:1},jc="group",n6="rect",_y="rule",hG="symbol",Xi="text";function Ou(t){return t.type=jc,t.interactive=t.interactive||!1,t}function qe(t,e){const n=(r,i)=>gn(t[r],gn(e[r],i));return n.isVertical=r=>QH===gn(t.direction,e.direction||(r?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>gn(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>gn(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>gn(t.columns,gn(e.columns,+n.isVertical(!0))),n}function r6(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function dG(t,e,n){const r=e.config.style[n];return r&&r[t]}function Yc(t,e,n){return"item.anchor === '".concat(JH,"' ? ").concat(t," : item.anchor === '").concat(eG,"' ? ").concat(e," : ").concat(n)}const My=Yc(V(Qa),V(Ja),V(e6));function gG(t){const e=t("tickBand");let n=t("tickOffset"),r,i;return e?e.signal?(r={signal:"(".concat(e.signal,") === 'extent' ? 1 : 0.5")},i={signal:"(".concat(e.signal,") === 'extent'")},et(n)||(n={signal:"(".concat(e.signal,") === 'extent' ? 0 : ").concat(n)})):e==="extent"?(r=1,i=!0,n=0):(r=.5,i=!1):(r=t("bandPosition"),i=t("tickExtra")),{extra:i,band:r,offset:n}}function i6(t,e){return e?t?et(t)?Object.assign({},t,{offset:i6(t.offset,e)}):{value:t,offset:e}:e:t}function Qe(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=Ka(t.encode,e,hs)):t.interactive=!1,t}function pG(t,e,n,r){const i=qe(t,n),a=i.isVertical(),o=i.gradientThickness(),u=i.gradientLength();let s,l,f,c,h;a?(l=[0,1],f=[0,0],c=o,h=u):(l=[0,0],f=[1,0],c=u,h=o);const d={enter:s={opacity:st,x:st,y:st,width:Gt(c),height:Gt(h)},update:tt({},s,{opacity:un,fill:{gradient:e,start:l,stop:f}}),exit:{opacity:st}};return ee(d,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),Qe({type:n6,role:qW,encode:d},r)}function mG(t,e,n,r,i){const a=qe(t,n),o=a.isVertical(),u=a.gradientThickness(),s=a.gradientLength();let l,f,c,h,d="";o?(l="y",c="y2",f="x",h="width",d="1-"):(l="x",c="x2",f="y",h="height");const g={opacity:st,fill:{scale:e,field:on}};g[l]={signal:d+"datum."+Ia,mult:s},g[f]=st,g[c]={signal:d+"datum."+rG,mult:s},g[h]=Gt(u);const p={enter:g,update:tt({},g,{opacity:un}),exit:{opacity:st}};return ee(p,{stroke:a("gradientStrokeColor"),strokeWidth:a("gradientStrokeWidth")},{opacity:a("gradientOpacity")}),Qe({type:n6,role:UW,key:on,from:i,encode:p},r)}const yG="datum.".concat(Ia,'<=0?"').concat(Qa,'":datum.').concat(Ia,'>=1?"').concat(Ja,'":"').concat(e6,'"'),vG="datum.".concat(Ia,'<=0?"').concat(Jr,'":datum.').concat(Ia,'>=1?"').concat(Fn,'":"').concat(tG,'"');function jb(t,e,n,r){const i=qe(t,e),a=i.isVertical(),o=Gt(i.gradientThickness()),u=i.gradientLength();let s=i("labelOverlap"),l,f,c,h,d="";const g={enter:l={opacity:st},update:f={opacity:un,text:{field:xy}},exit:{opacity:st}};return ee(g,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:gn(t.labelLimit,e.gradientLabelLimit)}),a?(l.align={value:"left"},l.baseline=f.baseline={signal:vG},c="y",h="x",d="1-"):(l.align=f.align={signal:yG},l.baseline={value:"top"},c="x",h="y"),l[c]=f[c]={signal:d+"datum."+Ia,mult:u},l[h]=f[h]=o,o.offset=gn(t.labelOffset,e.gradientLabelOffset)||0,s=s?{separation:i("labelSeparation"),method:s,order:"datum."+cg}:void 0,Qe({type:Xi,role:PC,style:cs,key:on,from:r,encode:g,overlap:s},n)}function xG(t,e,n,r,i){const a=qe(t,e),o=n.entries,u=!!(o&&o.interactive),s=o?o.name:void 0,l=a("clipHeight"),f=a("symbolOffset"),c={data:"value"},h="(".concat(i,") ? datum.").concat(nG," : datum.").concat(dg),d=l?Gt(l):{field:dg},g="datum.".concat(cg),p="max(1, ".concat(i,")");let m,y,v,x,b;d.mult=.5,m={enter:y={opacity:st,x:{signal:h,mult:.5,offset:f},y:d},update:v={opacity:un,x:y.x,y:y.y},exit:{opacity:st}};let _=null,M=null;t.fill||(_=e.symbolBaseFillColor,M=e.symbolBaseStrokeColor),ee(m,{fill:a("symbolFillColor",_),shape:a("symbolType"),size:a("symbolSize"),stroke:a("symbolStrokeColor",M),strokeDash:a("symbolDash"),strokeDashOffset:a("symbolDashOffset"),strokeWidth:a("symbolStrokeWidth")},{opacity:a("symbolOpacity")}),wy.forEach(C=>{t[C]&&(v[C]=y[C]={scale:t[C],field:on})});const w=Qe({type:hG,role:jW,key:on,from:c,clip:l?!0:void 0,encode:m},n.symbols),A=Gt(f);A.offset=a("labelOffset"),m={enter:y={opacity:st,x:{signal:h,offset:A},y:d},update:v={opacity:un,text:{field:xy},x:y.x,y:y.y},exit:{opacity:st}},ee(m,{align:a("labelAlign"),baseline:a("labelBaseline"),fill:a("labelColor"),fillOpacity:a("labelOpacity"),font:a("labelFont"),fontSize:a("labelFontSize"),fontStyle:a("labelFontStyle"),fontWeight:a("labelFontWeight"),limit:a("labelLimit")});const S=Qe({type:Xi,role:PC,style:cs,key:on,from:c,encode:m},n.labels);return m={enter:{noBound:{value:!l},width:st,height:l?Gt(l):st,opacity:st},exit:{opacity:st},update:v={opacity:un,row:{signal:null},column:{signal:null}}},a.isVertical(!0)?(x="ceil(item.mark.items.length / ".concat(p,")"),v.row.signal="".concat(g,"%").concat(x),v.column.signal="floor(".concat(g," / ").concat(x,")"),b={field:["row",g]}):(v.row.signal="floor(".concat(g," / ").concat(p,")"),v.column.signal="".concat(g," % ").concat(p),b={field:g}),v.column.signal="(".concat(i,")?").concat(v.column.signal,":").concat(g),r={facet:{data:r,name:"value",groupby:cg}},Ou({role:my,from:r,encode:Ka(m,o,hs),marks:[w,S],name:s,interactive:u,sort:b})}function bG(t,e){const n=qe(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}const ky='item.orient === "left"',Ay='item.orient === "right"',Wc="(".concat(ky," || ").concat(Ay,")"),wG="datum.vgrad && ".concat(Wc),_G=Yc('"top"','"bottom"','"middle"'),MG=Yc('"right"','"left"','"center"'),kG="datum.vgrad && ".concat(Ay," ? (").concat(MG,") : (").concat(Wc," && !(datum.vgrad && ").concat(ky,')) ? "left" : ').concat(My),AG="item._anchor || (".concat(Wc,' ? "middle" : "start")'),EG="".concat(wG," ? (").concat(ky," ? -90 : 90) : 0"),CG="".concat(Wc," ? (datum.vgrad ? (").concat(Ay,' ? "bottom" : "top") : ').concat(_G,') : "top"');function SG(t,e,n,r){const i=qe(t,e),a={enter:{opacity:st},update:{opacity:un,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:st}};return ee(a,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:AG},angle:{signal:EG},align:{signal:kG},baseline:{signal:CG},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),Qe({type:Xi,role:YW,style:by,from:r,encode:a},n)}function DG(t,e){let n;return et(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+Yb(t.path)+")":t.sphere&&(n="geoShape("+Yb(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function Yb(t){return et(t)&&t.signal?t.signal:V(t)}function a6(t){const e=t.role||"";return!e.indexOf("axis")||!e.indexOf("legend")||!e.indexOf("title")?e:t.type===jc?my:e||gy}function $G(t){return{marktype:t.type,name:t.name||void 0,role:t.role||a6(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function FG(t,e){return t&&t.signal?e.signalRef(t.signal):t!==!1}function Ey(t,e){const n=m3(t.type);n||z("Unrecognized transform type: "+V(t.type));const r=Uc(n.type.toLowerCase(),null,o6(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function o6(t,e,n){const r={},i=t.params.length;for(let a=0;a<i;++a){const o=t.params[a];r[o.name]=TG(o,e,n)}return r}function TG(t,e,n){const r=t.type,i=e[t.name];if(r==="index")return RG(t,e,n);if(i===void 0){t.required&&z("Missing required "+V(e.type)+" parameter: "+V(t.name));return}else{if(r==="param")return NG(t,e,n);if(r==="projection")return n.projectionRef(e[t.name])}return t.array&&!qt(i)?i.map(a=>Wb(t,a,n)):Wb(t,i,n)}function Wb(t,e,n){const r=t.type;if(qt(e))return Gb(r)?z("Expression references can not be signals."):c0(r)?n.fieldRef(e):Vb(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||c0(r);return i&&OG(e)?n.exprRef(e.expr,e.as):i&&zG(e)?Ru(e.field,e.as):Gb(r)?Kn(e,n):LG(r)?W(n.getData(e).values):c0(r)?Ru(e):Vb(r)?n.compareRef(e):e}}function RG(t,e,n){return Ct(e.from)||z('Lookup "from" parameter must be a string literal.'),n.getData(e.from).lookupRef(n,e.key)}function NG(t,e,n){const r=e[t.name];return t.array?(G(r)||z("Expected an array of sub-parameters. Instead: "+V(r)),r.map(i=>Hb(t,i,n))):Hb(t,r,n)}function Hb(t,e,n){const r=t.params.length;let i;for(let o=0;o<r;++o){i=t.params[o];for(const u in i.key)if(i.key[u]!==e[u]){i=null;break}if(i)break}i||z("Unsupported parameter: "+V(e));const a=tt(o6(i,e,n),i.key);return W(n.add(FH(a)))}const OG=t=>t&&t.expr,zG=t=>t&&t.field,LG=t=>t==="data",Gb=t=>t==="expr",c0=t=>t==="field",Vb=t=>t==="compare";function BG(t,e,n){let r,i,a,o,u;return t?(r=t.facet)&&(e||z("Only group marks can be faceted."),r.field!=null?o=u=ml(r,n):(t.data?u=W(n.getData(t.data).aggregate):(a=Ey(tt({type:"aggregate",groupby:Z(r.groupby)},r.aggregate),n),a.params.key=n.keyRef(r.groupby),a.params.pulse=ml(r,n),o=u=W(n.add(a))),i=n.keyRef(r.groupby,!0))):o=W(n.add($n(null,[{}]))),o||(o=ml(t,n)),{key:i,pulse:o,parent:u}}function ml(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:W(e.getData(t.data).output)}function Ri(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}Ri.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let a=e[0],o=null,u=1;for(a&&a.type==="load"&&(a=e[1]),t.add(e[0]);u<n;++u)e[u].params.pulse=W(e[u-1]),t.add(e[u]),e[u].type==="aggregate"&&(o=e[u]);return new Ri(t,a,i,r,o)};function u6(t){return Ct(t)?t:null}function Xb(t,e,n){const r=Ic(n.op,n.field);let i;if(e.ops){for(let a=0,o=e.as.length;a<o;++a)if(e.as[a]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function ko(t,e,n,r,i,a,o){const u=e[n]||(e[n]={}),s=uH(a);let l=u6(i),f,c;if(l!=null&&(t=e.scope,l=l+(s?"|"+s:""),f=u[l]),!f){const h=a?{field:sg,pulse:e.countsRef(t,i,a)}:{field:t.fieldRef(i),pulse:W(e.output)};s&&(h.sort=t.sortRef(a)),c=t.add(Uc(r,void 0,h)),o&&(e.index[i]=c),f=W(c),l!=null&&(u[l]=f)}return f}Ri.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),a=u6(e);let o,u,s;return a!=null&&(t=r.scope,o=i[a]),o?n&&n.field&&Xb(t,o.agg.params,n):(s={groupby:t.fieldRef(e,"key"),pulse:W(r.output)},n&&n.field&&Xb(t,s,n),u=t.add(WC(s)),o=t.add($n({pulse:W(u)})),o={agg:u,ref:W(o)},a!=null&&(i[a]=o)),o.ref},tuplesRef(){return W(this.values)},extentRef(t,e){return ko(t,this,"extent","extent",e,!1)},domainRef(t,e){return ko(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return ko(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return ko(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return ko(t,this,"indata","tupleindex",e,!0,!0)}};function PG(t,e,n){const r=t.from.facet,i=r.name,a=ml(r,e);let o;r.name||z("Facet must have a name: "+V(r)),r.data||z("Facet must reference a data set: "+V(r)),r.field?o=e.add(VC({field:e.fieldRef(r.field),pulse:a})):r.groupby?o=e.add(_H({key:e.keyRef(r.groupby),group:W(e.proxy(n.parent)),pulse:a})):z("Facet must specify groupby or field: "+V(r));const u=e.fork(),s=u.add($n()),l=u.add(Vi({pulse:W(s)}));u.addData(i,new Ri(u,s,s,l)),u.addSignal("parent",null),o.params.subflow={$subflow:u.parse(t).toRuntime()}}function UG(t,e,n){const r=e.add(VC({pulse:n.pulse})),i=e.fork();i.add(Vi()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}function s6(t,e,n){const r=t.remove,i=t.insert,a=t.toggle,o=t.modify,u=t.values,s=e.add(Tf()),l="if("+t.trigger+',modify("'+n+'",'+[i,r,a,o,u].map(c=>c==null?"null":c).join(",")+"),0)",f=Kn(l,e);s.update=f.$expr,s.params=f.$params}function Hc(t,e){const n=a6(t),r=t.type===jc,i=t.from&&t.from.facet,a=t.overlap;let o=t.layout||n===my||n===py,u,s,l,f,c,h,d;const g=n===gy||o||i,p=BG(t.from,r,e);s=e.add(bH({key:p.key||(t.key?Ru(t.key):void 0),pulse:p.pulse,clean:!r}));const m=W(s);s=l=e.add($n({pulse:m})),s=e.add(CH({markdef:$G(t),interactive:FG(t.interactive,e),clip:DG(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:W(s)}));const y=W(s);s=f=e.add(GC(jC(t.encode,t.type,n,t.style,e,{mod:!1,pulse:y}))),s.params.parent=e.encode(),t.transform&&t.transform.forEach(M=>{const w=Ey(M,e),A=w.metadata;(A.generates||A.changes)&&z("Mark transforms should not generate new data."),A.nomod||(f.params.mod=!0),w.params.pulse=W(s),e.add(s=w)}),t.sort&&(s=e.add(zH({sort:e.compareRef(t.sort),pulse:W(s)})));const v=W(s);(i||o)&&(o=e.add(ZC({layout:e.objectProperty(t.layout),legends:e.legends,mark:y,pulse:v})),h=W(o));const x=e.add(HC({mark:y,pulse:h||v}));d=W(x),r&&(g&&(u=e.operators,u.pop(),o&&u.pop()),e.pushState(v,h||d,m),i?PG(t,e,p):g?UG(t,e,p):e.parse(t),e.popState(),g&&(o&&u.push(o),u.push(x))),a&&(d=IG(a,d,e));const b=e.add(XC({pulse:d})),_=e.add(Vi({pulse:W(b)},void 0,e.parent()));t.name!=null&&(c=t.name,e.addData(c,new Ri(e,l,b,_)),t.on&&t.on.forEach(M=>{(M.insert||M.remove||M.toggle)&&z("Marks only support modify triggers."),s6(M,e,c)}))}function IG(t,e,n){const r=t.method,i=t.bound,a=t.separation,o={separation:qt(a)?n.signalRef(a.signal):a,method:qt(r)?n.signalRef(r.signal):r,pulse:e};if(t.order&&(o.sort=n.compareRef({field:t.order})),i){const u=i.tolerance;o.boundTolerance=qt(u)?n.signalRef(u.signal):+u,o.boundScale=n.scaleRef(i.scale),o.boundOrient=i.orient}return W(n.add($H(o)))}function qG(t,e){const n=e.config.legend,r=t.encode||{},i=qe(t,n),a=r.legend||{},o=a.name||void 0,u=a.interactive,s=a.style,l={};let f=0,c,h,d;wy.forEach(x=>t[x]?(l[x]=t[x],f=f||t[x]):0),f||z("Missing valid scale for legend.");const g=jG(t,e.scaleType(f)),p={title:t.title!=null,scales:l,type:g,vgrad:g!=="symbol"&&i.isVertical()},m=W(e.add($n(null,[p]))),y={enter:{x:{value:0},y:{value:0}}},v=W(e.add(AH(h={type:g,scale:e.scaleRef(f),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return g===pl?(d=[pG(t,f,n,r.gradient),jb(t,n,r.labels,v)],h.count=h.count||e.signalRef("max(2,2*floor((".concat(wi(i.gradientLength()),")/100))"))):g===hg?d=[mG(t,f,n,r.gradient,v),jb(t,n,r.labels,v)]:(c=bG(t,n),d=[xG(t,n,r,v,wi(c.columns))],h.size=HG(t,e,d[0].marks)),d=[Ou({role:IW,from:m,encode:y,marks:d,layout:c,interactive:u})],p.title&&d.push(SG(t,n,r.title,m)),Hc(Ou({role:PW,from:m,encode:Ka(WG(i,t,n),a,hs),marks:d,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:o,interactive:u,style:s}),e)}function jG(t,e){let n=t.type||qb;return!t.type&&YG(t)===1&&(t.fill||t.stroke)&&(n=mp(e)?pl:K0(e)?hg:qb),n!==pl?n:K0(e)?hg:pl}function YG(t){return wy.reduce((e,n)=>e+(t[n]?1:0),0)}function WG(t,e,n){const r={enter:{},update:{}};return ee(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function HG(t,e,n){const r=wi(Zb("size",t,n)),i=wi(Zb("strokeWidth",t,n)),a=wi(GG(n[1].encode,e,cs));return Kn("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(a,")"),e)}function Zb(t,e,n){return e[t]?'scale("'.concat(e[t],'",datum)'):r6(t,n[0].encode)}function GG(t,e,n){return r6("fontSize",t)||dG("fontSize",e,n)}const VG='item.orient==="'.concat(Qa,'"?-90:item.orient==="').concat(Ja,'"?90:0');function XG(t,e){t=Ct(t)?{text:t}:t;const n=qe(t,e.config.title),r=t.encode||{},i=r.group||{},a=i.name||void 0,o=i.interactive,u=i.style,s=[],l={},f=W(e.add($n(null,[l])));return s.push(QG(t,n,ZG(t),f)),t.subtitle&&s.push(JG(t,n,r.subtitle,f)),Hc(Ou({role:WW,from:f,encode:KG(n,i),marks:s,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:a,interactive:o,style:u}),e)}function ZG(t){const e=t.encode;return e&&e.title||tt({name:t.name,interactive:t.interactive,style:t.style},e)}function KG(t,e){const n={enter:{},update:{}};return ee(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:My},angle:{signal:VG},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),Ka(n,e,hs)}function QG(t,e,n,r){const i={value:0},a=t.text,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return ee(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),Qe({type:Xi,role:HW,style:iG,from:r,encode:o},n)}function JG(t,e,n,r){const i={value:0},a=t.subtitle,o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return ee(o,{text:a,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),Qe({type:Xi,role:GW,style:aG,from:r,encode:o},n)}function tV(t,e){const n=[];t.transform&&t.transform.forEach(r=>{n.push(Ey(r,e))}),t.on&&t.on.forEach(r=>{s6(r,e,t.name)}),e.addDataPipeline(t.name,eV(t,e,n))}function eV(t,e,n){const r=[];let i=null,a=!1,o=!1,u,s,l,f,c;for(t.values?qt(t.values)||dl(t.format)?(r.push(Kb(e,t)),r.push(i=si())):r.push(i=si({$ingest:t.values,$format:t.format})):t.url?dl(t.url)||dl(t.format)?(r.push(Kb(e,t)),r.push(i=si())):r.push(i=si({$request:t.url,$format:t.format})):t.source&&(i=u=Z(t.source).map(h=>W(e.getData(h).output)),r.push(null)),s=0,l=n.length;s<l;++s)f=n[s],c=f.metadata,!i&&!c.source&&r.push(i=si()),r.push(f),c.generates&&(o=!0),c.modifies&&!o&&(a=!0),c.source?i=f:c.changes&&(i=null);return u&&(l=u.length-1,r[0]=NH({derive:a,pulse:l?u:u[0]}),(a||l)&&r.splice(1,0,si())),i||r.push(si()),r.push(Vi({})),r}function si(t){const e=$n({},t);return e.metadata={source:!0},e}function Kb(t,e){return EH({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const l6=t=>t===Jr||t===Fn,Gc=(t,e,n)=>qt(t)?aV(t.signal,e,n):t===Qa||t===Fn?e:n,Vt=(t,e,n)=>qt(t)?rV(t.signal,e,n):l6(t)?e:n,_n=(t,e,n)=>qt(t)?iV(t.signal,e,n):l6(t)?n:e,f6=(t,e,n)=>qt(t)?oV(t.signal,e,n):t===Fn?{value:e}:{value:n},nV=(t,e,n)=>qt(t)?uV(t.signal,e,n):t===Ja?{value:e}:{value:n},rV=(t,e,n)=>c6("".concat(t," === '").concat(Fn,"' || ").concat(t," === '").concat(Jr,"'"),e,n),iV=(t,e,n)=>c6("".concat(t," !== '").concat(Fn,"' && ").concat(t," !== '").concat(Jr,"'"),e,n),aV=(t,e,n)=>Cy("".concat(t," === '").concat(Qa,"' || ").concat(t," === '").concat(Fn,"'"),e,n),oV=(t,e,n)=>Cy("".concat(t," === '").concat(Fn,"'"),e,n),uV=(t,e,n)=>Cy("".concat(t," === '").concat(Ja,"'"),e,n),c6=(t,e,n)=>(e=e!=null?Gt(e):e,n=n!=null?Gt(n):n,Qb(e)&&Qb(n)?(e=e?e.signal||V(e.value):null,n=n?n.signal||V(n.value):null,{signal:"".concat(t," ? (").concat(e,") : (").concat(n,")")}):[tt({test:t},e)].concat(n||[])),Qb=t=>t==null||Object.keys(t).length===1,Cy=(t,e,n)=>({signal:"".concat(t," ? (").concat(pa(e),") : (").concat(pa(n),")")}),sV=(t,e,n,r,i)=>({signal:(r!=null?"".concat(t," === '").concat(Qa,"' ? (").concat(pa(r),") : "):"")+(n!=null?"".concat(t," === '").concat(Jr,"' ? (").concat(pa(n),") : "):"")+(i!=null?"".concat(t," === '").concat(Ja,"' ? (").concat(pa(i),") : "):"")+(e!=null?"".concat(t," === '").concat(Fn,"' ? (").concat(pa(e),") : "):"")+"(null)"}),pa=t=>qt(t)?t.signal:t==null?null:V(t),lV=(t,e)=>e===0?0:qt(t)?{signal:"(".concat(t.signal,") * ").concat(e)}:{value:t*e},_a=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function ia(t,e,n,r){let i;if(e&&K(e,t))return e[t];if(K(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r[by][i]}else if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r[cs][i]}return null}function Jb(t){const e={};for(const n of t)if(n)for(const r in n)e[r]=1;return Object.keys(e)}function fV(t,e){var n=e.config,r=n.style,i=n.axis,a=e.scaleType(t.scale)==="band"&&n.axisBand,o=t.orient,u,s,l;if(qt(o)){const c=Jb([n.axisX,n.axisY]),h=Jb([n.axisTop,n.axisBottom,n.axisLeft,n.axisRight]);u={};for(l of c)u[l]=Vt(o,ia(l,n.axisX,i,r),ia(l,n.axisY,i,r));s={};for(l of h)s[l]=sV(o.signal,ia(l,n.axisTop,i,r),ia(l,n.axisBottom,i,r),ia(l,n.axisLeft,i,r),ia(l,n.axisRight,i,r))}else u=o===Fn||o===Jr?n.axisX:n.axisY,s=n["axis"+o[0].toUpperCase()+o.slice(1)];return u||s||a?tt({},i,u,s,a):i}function cV(t,e,n,r){const i=qe(t,e),a=t.orient;let o,u;const s={enter:o={opacity:st},update:u={opacity:un},exit:{opacity:st}};ee(s,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const l=tw(t,0),f=tw(t,1);return o.x=u.x=Vt(a,l,st),o.x2=u.x2=Vt(a,f),o.y=u.y=_n(a,l,st),o.y2=u.y2=_n(a,f),Qe({type:_y,role:NW,from:r,encode:s},n)}function tw(t,e){return{scale:t.scale,range:e}}function hV(t,e,n,r,i){const a=qe(t,e),o=t.orient,u=t.gridScale,s=Gc(o,1,-1),l=dV(t.offset,s);let f,c,h;const d={enter:f={opacity:st},update:h={opacity:un},exit:c={opacity:st}};ee(d,{stroke:a("gridColor"),strokeCap:a("gridCap"),strokeDash:a("gridDash"),strokeDashOffset:a("gridDashOffset"),strokeOpacity:a("gridOpacity"),strokeWidth:a("gridWidth")});const g={scale:t.scale,field:on,band:i.band,extra:i.extra,offset:i.offset,round:a("tickRound")},p=Vt(o,{signal:"height"},{signal:"width"}),m=u?{scale:u,range:0,mult:s,offset:l}:{value:0,offset:l},y=u?{scale:u,range:1,mult:s,offset:l}:tt(p,{mult:s,offset:l});return f.x=h.x=Vt(o,g,m),f.y=h.y=_n(o,g,m),f.x2=h.x2=_n(o,y),f.y2=h.y2=Vt(o,y),c.x=Vt(o,g),c.y=_n(o,g),Qe({type:_y,role:OW,key:on,from:r,encode:d},n)}function dV(t,e){if(e!==1)if(!et(t))t=qt(e)?{signal:"(".concat(e.signal,") * (").concat(t||0,")")}:e*(t||0);else{let n=t=tt({},t);for(;n.mult!=null;)if(et(n.mult))n=n.mult=tt({},n.mult);else return n.mult=qt(e)?{signal:"(".concat(n.mult,") * (").concat(e.signal,")")}:n.mult*e,t;n.mult=e}return t}function gV(t,e,n,r,i,a){const o=qe(t,e),u=t.orient,s=Gc(u,-1,1);let l,f,c;const h={enter:l={opacity:st},update:c={opacity:un},exit:f={opacity:st}};ee(h,{stroke:o("tickColor"),strokeCap:o("tickCap"),strokeDash:o("tickDash"),strokeDashOffset:o("tickDashOffset"),strokeOpacity:o("tickOpacity"),strokeWidth:o("tickWidth")});const d=Gt(i);d.mult=s;const g={scale:t.scale,field:on,band:a.band,extra:a.extra,offset:a.offset,round:o("tickRound")};return c.y=l.y=Vt(u,st,g),c.y2=l.y2=Vt(u,d),f.x=Vt(u,g),c.x=l.x=_n(u,st,g),c.x2=l.x2=_n(u,d),f.y=_n(u,g),Qe({type:_y,role:LW,key:on,from:r,encode:h},n)}function h0(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function pV(t,e,n,r,i,a){const o=qe(t,e),u=t.orient,s=t.scale,l=Gc(u,-1,1),f=wi(o("labelFlush")),c=wi(o("labelFlushOffset")),h=o("labelAlign"),d=o("labelBaseline");let g=f===0||!!f,p;const m=Gt(i);m.mult=l,m.offset=Gt(o("labelPadding")||0),m.offset.mult=l;const y={scale:s,field:on,band:.5,offset:i6(a.offset,o("labelOffset"))},v=Vt(u,g?h0(s,f,'"left"','"right"','"center"'):{value:"center"},nV(u,"left","right")),x=Vt(u,f6(u,"bottom","top"),g?h0(s,f,'"top"','"bottom"','"middle"'):{value:"middle"}),b=h0(s,f,"-(".concat(c,")"),c,0);g=g&&c;const _={opacity:st,x:Vt(u,y,m),y:_n(u,y,m)},M={enter:_,update:p={opacity:un,text:{field:xy},x:_.x,y:_.y,align:v,baseline:x},exit:{opacity:st,x:_.x,y:_.y}};ee(M,{dx:!h&&g?Vt(u,b):null,dy:!d&&g?_n(u,b):null}),ee(M,{angle:o("labelAngle"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontWeight:o("labelFontWeight"),fontStyle:o("labelFontStyle"),limit:o("labelLimit"),lineHeight:o("labelLineHeight")},{align:h,baseline:d});const w=o("labelBound");let A=o("labelOverlap");return A=A||w?{separation:o("labelSeparation"),method:A,order:"datum.index",bound:w?{scale:s,orient:u,tolerance:w}:null}:void 0,p.align!==v&&(p.align=_a(p.align,v)),p.baseline!==x&&(p.baseline=_a(p.baseline,x)),Qe({type:Xi,role:zW,style:cs,key:on,from:r,encode:M,overlap:A},n)}function mV(t,e,n,r){const i=qe(t,e),a=t.orient,o=Gc(a,-1,1);let u,s;const l={enter:u={opacity:st,anchor:Gt(i("titleAnchor",null)),align:{signal:My}},update:s=tt({},u,{opacity:un,text:Gt(t.title)}),exit:{opacity:st}},f={signal:'lerp(range("'.concat(t.scale,'"), ').concat(Yc(0,1,.5),")")};return s.x=Vt(a,f),s.y=_n(a,f),u.angle=Vt(a,st,lV(o,90)),u.baseline=Vt(a,f6(a,Jr,Fn),{value:Jr}),s.angle=u.angle,s.baseline=u.baseline,ee(l,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),yV(i,a,l,n),l.update.align=_a(l.update.align,u.align),l.update.angle=_a(l.update.angle,u.angle),l.update.baseline=_a(l.update.baseline,u.baseline),Qe({type:Xi,role:BW,style:by,from:r,encode:l},n)}function yV(t,e,n,r){const i=(u,s)=>u!=null?(n.update[s]=_a(Gt(u),n.update[s]),!1):!ua(s,r),a=i(t("titleX"),"x"),o=i(t("titleY"),"y");n.enter.auto=o===a?Gt(o):Vt(e,Gt(o),Gt(a))}function vV(t,e){const n=fV(t,e),r=t.encode||{},i=r.axis||{},a=i.name||void 0,o=i.interactive,u=i.style,s=qe(t,n),l=gG(s),f={scale:t.scale,ticks:!!s("ticks"),labels:!!s("labels"),grid:!!s("grid"),domain:!!s("domain"),title:t.title!=null},c=W(e.add($n({},[f]))),h=W(e.add(xH({scale:e.scaleRef(t.scale),extra:e.property(l.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),d=[];let g;return f.grid&&d.push(hV(t,n,r.grid,h,l)),f.ticks&&(g=s("tickSize"),d.push(gV(t,n,r.ticks,h,g,l))),f.labels&&(g=f.ticks?g:0,d.push(pV(t,n,r.labels,h,g,l))),f.domain&&d.push(cV(t,n,r.domain,c)),f.title&&d.push(mV(t,n,r.title,c)),Hc(Ou({role:RW,from:c,encode:Ka(xV(s,t),i,hs),marks:d,aria:s("aria"),description:s("description"),zindex:s("zindex"),name:a,interactive:o,style:u}),e)}function xV(t,e){const n={enter:{},update:{}};return ee(n,{orient:t("orient"),offset:t("offset")||0,position:gn(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:'abs(span(range("'.concat(e.scale,'")))')},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function h6(t,e,n){const r=Z(t.signals),i=Z(t.scales);return n||r.forEach(a=>YC(a,e)),Z(t.projections).forEach(a=>KH(a,e)),i.forEach(a=>PH(a,e)),Z(t.data).forEach(a=>tV(a,e)),i.forEach(a=>UH(a,e)),(n||r).forEach(a=>vH(a,e)),Z(t.axes).forEach(a=>vV(a,e)),Z(t.marks).forEach(a=>Hc(a,e)),Z(t.legends).forEach(a=>qG(a,e)),t.title&&XG(t.title,e),e.parseLambdas(),e}const bV=t=>Ka({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function wV(t,e){const n=e.config,r=W(e.root=e.add(Tf())),i=_V(t,n);i.forEach(l=>YC(l,e)),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const a=e.add($n()),o=e.add(GC(jC(bV(t.encode),jc,py,t.style,e,{pulse:W(a)}))),u=e.add(ZC({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:W(o)}));e.operators.pop(),e.pushState(W(o),W(u),null),h6(t,e,i),e.operators.push(u);let s=e.add(HC({mark:r,pulse:W(u)}));return s=e.add(XC({pulse:W(s)})),s=e.add(Vi({pulse:W(s)})),e.addData("root",new Ri(e,a,a,s)),e}function Ao(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function _V(t,e){const n=o=>gn(t[o],e[o]),r=[Ao("background",n("background")),Ao("autosize",$W(n("autosize"))),Ao("padding",TW(n("padding"))),Ao("width",n("width")||0),Ao("height",n("height")||0)],i=r.reduce((o,u)=>(o[u.name]=u,o),{}),a={};return Z(t.signals).forEach(o=>{K(i,o.name)?o=tt(i[o.name],o):r.push(o),a[o.name]=o}),Z(e.signals).forEach(o=>{!K(a,o.name)&&!K(i,o.name)&&r.push(o)}),r}function d6(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function ew(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}d6.prototype=ew.prototype={parse(t){return h6(t,this)},fork(){return new ew(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach(e=>{e.$ref=t.id}),t.refs=null),t},proxy(t){const e=t instanceof ug?W(t):t;return this.add(RH({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;this.root&&(this.root.root=!0);for(t in this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(r,i,a){let o,u;r&&(o=r.data||(r.data={}),u=o[i]||(o[i]=[]),u.push(a))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(W(this.add(Vi({pulse:t})))),this._parent.push(e),this._lookup.push(n?W(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return ot(this._parent)},encode(){return ot(this._encode)},lookup(){return ot(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(Ct(t))return Ru(t,e);t.signal||z("Unsupported field reference: "+V(t));const n=t.signal;let r=this.field[n];if(!r){const i={name:this.signalRef(n)};e&&(i.as=e),this.field[n]=r=W(this.add(MH(i)))}return r},compareRef(t){let e=!1;const n=a=>qt(a)?(e=!0,this.signalRef(a.signal)):sH(a)?(e=!0,this.exprRef(a.expr)):a,r=Z(t.field).map(n),i=Z(t.order).map(n);return e?W(this.add(Ib({fields:r,orders:i}))):Pb(r,i)},keyRef(t,e){let n=!1;const r=a=>qt(a)?(n=!0,W(i[a.signal])):a,i=this.signals;return t=Z(t).map(r),n?W(this.add(kH({fields:t,flat:e}))):iH(t,e)},sortRef(t){if(!t)return t;const e=Ic(t.op,t.field),n=t.order||aH;return n.signal?W(this.add(Ib({fields:e,orders:this.signalRef(n.signal)}))):Pb(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return K(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&z("Duplicate signal name: "+V(t));const n=e instanceof ug?e:this.add(Tf(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||z("Unrecognized signal name: "+V(t)),this.signals[t]},signalRef(t){return this.signals[t]?W(this.signals[t]):(K(this.lambdas,t)||(this.lambdas[t]=this.add(Tf(null))),W(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const r=t[e],i=Kn(r,this),a=this.lambdas[r];a.params=i.$params,a.update=i.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return!t||!et(t)?t:this.signalRef(t.signal||Sy(t))},exprRef(t,e){const n={expr:Kn(t,this)};return e&&(n.expr.$name=e),W(this.add(wH(n)))},addBinding(t,e){this.bindings||z("Nested signals do not support binding: "+V(t)),this.bindings.push(tt({signal:t},e))},addScaleProj(t,e){K(this.scales,t)&&z("Duplicate scale or projection name: "+V(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,OH(e))},addProjection(t,e){this.addScaleProj(t,TH(e))},getScale(t){return this.scales[t]||z("Unrecognized scale name: "+V(t)),this.scales[t]},scaleRef(t){return W(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return K(this.data,t)&&z("Duplicate data set name: "+V(t)),this.data[t]=e},getData(t){return this.data[t]||z("Undefined data set name: "+V(t)),this.data[t]},addDataPipeline(t,e){return K(this.data,t)&&z("Duplicate data set name: "+V(t)),this.addData(t,Ri.fromEntries(this,e))}};function Sy(t){return(G(t)?MV:kV)(t)}function MV(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const i=t[r];n+=(r>0?",":"")+(et(i)?i.signal||Sy(i):V(i))}return n+"]"}function kV(t){let e="{",n=0,r,i;for(r in t)i=t[r],e+=(++n>1?",":"")+V(r)+":"+(et(i)?i.signal||Sy(i):V(i));return e+"}"}function AV(){const t="sans-serif",r="#4c78a8",i="#000",a="#888",o="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:r},area:{fill:r},image:null,line:{stroke:r,strokeWidth:2},path:{stroke:r},rect:{fill:r},rule:{stroke:i},shape:{stroke:r},symbol:{fill:r,size:64},text:{fill:i,font:t,fontSize:11},trail:{fill:r,size:2},style:{"guide-label":{fill:i,font:t,fontSize:10},"guide-title":{fill:i,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:i,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:i,font:t,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:o}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:a,grid:!1,gridWidth:1,gridColor:o,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:a,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:o,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:a,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}function EV(t,e,n){return et(t)||z("Input Vega specification must be an object."),e=Lw(AV(),e,t.config),wV(t,new d6(e,n)).toRuntime()}var CV="vega",SV="5.20.2",DV="The Vega visualization grammar.",$V=["vega","visualization","interaction","dataflow","library","data","d3"],FV="BSD-3-Clause",TV="UW Interactive Data Lab (http://idl.cs.washington.edu)",RV="build/vega-node.js",NV="build/vega.module.js",OV="build/vega.min.js",zV="build/vega.min.js",LV="index.d.ts",BV="vega/vega",PV={bundle:"rollup -c --config-bundle",prebuild:"rimraf build && rimraf build-es5",build:"rollup -c --config-core --config-bundle --config-ie",postbuild:"node schema-copy",pretest:"yarn build --config-test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js'",prepublishOnly:"yarn test && yarn build",postpublish:"./schema-deploy.sh"},UV={"vega-crossfilter":"~4.0.5","vega-dataflow":"~5.7.4","vega-encode":"~4.8.3","vega-event-selector":"~2.0.6","vega-expression":"~4.0.1","vega-force":"~4.0.7","vega-format":"~1.0.4","vega-functions":"~5.12.0","vega-geo":"~4.3.8","vega-hierarchy":"~4.0.9","vega-label":"~1.0.0","vega-loader":"~4.4.0","vega-parser":"~6.1.3","vega-projection":"~1.4.5","vega-regression":"~1.0.9","vega-runtime":"~6.1.3","vega-scale":"~7.1.1","vega-scenegraph":"~4.9.4","vega-statistics":"~1.7.9","vega-time":"~2.0.4","vega-transforms":"~4.9.4","vega-typings":"~0.21.0","vega-util":"~1.16.1","vega-view":"~5.10.1","vega-view-transforms":"~4.5.8","vega-voronoi":"~4.1.5","vega-wordcloud":"~4.1.3"},IV={"vega-schema":"*"},qV="e251dbc61ab6645689d9f349e7dd9d15ddb85bce",jV={name:CV,version:SV,description:DV,keywords:$V,license:FV,author:TV,main:RV,module:NV,unpkg:OV,jsdelivr:zV,types:LV,repository:BV,scripts:PV,dependencies:UV,devDependencies:IV,gitHead:qV};tt(Ca,n9,AO,mz,rB,CB,eU,$P,rU,bU,$U,qU);const YV=jV.version,VV=Object.freeze(Object.defineProperty({__proto__:null,Bounds:jt,CanvasHandler:ts,CanvasRenderer:Yl,DATE:Pe,DAY:se,DAYOFYEAR:Xn,Dataflow:ya,Debug:Ow,Error:Cg,EventStream:Vf,Gradient:Y5,GroupItem:pc,HOURS:Ve,Handler:Kr,Info:Nw,Item:gc,MILLISECONDS:Cn,MINUTES:Xe,MONTH:ce,Marks:Ze,MultiPulse:Qg,None:Tw,Operator:kt,Parameters:Gf,Pulse:Ir,QUARTER:Be,RenderType:Or,Renderer:tr,ResourceLoader:Ap,SECONDS:ln,SVGHandler:jp,SVGRenderer:Xp,SVGStringRenderer:Zp,Scenegraph:Ip,TIME_UNITS:Gg,Transform:R,View:$C,WEEK:It,Warn:Rw,YEAR:te,accessor:Ie,accessorFields:fe,accessorName:Nt,array:Z,ascending:If,bandwidthNRD:r1,bin:b3,bootstrapCI:w3,boundClip:Bk,boundContext:Zu,boundItem:id,boundMark:lk,boundStroke:vr,changeset:Pi,clampRange:Vw,codegenExpression:RE,compare:Tg,constant:ge,cumulativeLogNormal:l1,cumulativeNormal:Zf,cumulativeUniform:d1,dayofyear:D_,debounce:Rg,defaultLocale:Zg,definition:m3,densityLogNormal:s1,densityNormal:i1,densityUniform:h1,domChild:Re,domClear:yn,domCreate:Rr,domFind:qp,dotbin:_3,error:z,expressionFunction:Pt,extend:tt,extent:Vn,extentIndex:Xw,falsy:Mr,fastmap:ja,field:Le,flush:Zw,font:bc,fontFamily:Ju,fontSize:Jn,format:Xs,formatLocale:Sl,formats:Ug,hasOwnProperty:K,id:zu,identity:Ee,inferType:o_,inferTypes:u_,ingest:gt,inherits:P,inrange:sa,interpolate:yp,interpolateColors:hc,interpolateRange:$5,intersect:Nk,intersectBoxLine:ca,intersectPath:Ep,intersectPoint:Cp,intersectRule:Q5,isArray:G,isBoolean:Kw,isDate:Ur,isFunction:nt,isIterable:Qw,isNumber:Yr,isObject:et,isRegExp:Jw,isString:Ct,isTuple:Wf,key:Ng,lerp:t_,lineHeight:Xr,loader:jf,locale:s3,logger:zw,lruCache:e_,markup:Vp,merge:n_,mergeConfig:Lw,multiLineOffset:Bp,one:qa,pad:r_,panLinear:qw,panLog:jw,panPow:Yw,panSymlog:Ww,parse:EV,parseExpression:$E,parseSelector:LC,pathCurves:_p,pathEqual:Pk,pathParse:Ta,pathRectangle:G5,pathRender:vu,pathSymbols:H5,pathTrail:V5,peek:ot,point:_c,projection:mm,quantileLogNormal:f1,quantileNormal:Kf,quantileUniform:g1,quantiles:e1,quantizeInterpolator:F5,quarter:Hw,quartiles:n1,get random(){return fn},randomInteger:e7,randomKDE:o1,randomLCG:t7,randomLogNormal:k3,randomMixture:A3,randomNormal:a1,randomUniform:E3,read:l3,regressionExp:S3,regressionLinear:p1,regressionLoess:F3,regressionLog:C3,regressionPoly:$3,regressionPow:D3,regressionQuad:m1,renderModule:Mc,repeat:So,resetDefaultLocale:l$,resetSVGClipId:Z5,resetSVGDefIds:IN,responseType:c_,runtimeContext:pC,sampleCurve:Jf,sampleLogNormal:u1,sampleNormal:Xf,sampleUniform:c1,scale:dt,sceneEqual:Kp,sceneFromJSON:ck,scenePickVisit:Bl,sceneToJSON:fk,sceneVisit:Sn,sceneZOrder:Sp,scheme:vp,serializeXML:Ek,setRandom:Q$,span:Lu,splitAccessPath:Bf,stringValue:V,textMetrics:qn,timeBin:H_,timeFloor:z_,timeFormatLocale:pu,timeInterval:Ya,timeOffset:P_,timeSequence:q_,timeUnitSpecifier:S_,timeUnits:Vg,toBoolean:Og,toDate:zg,toNumber:le,toSet:En,toString:Lg,transform:y3,transforms:Ca,truncate:i_,truthy:sn,tupleid:H,typeParsers:_0,utcFloor:L_,utcInterval:Wa,utcOffset:U_,utcSequence:j_,utcdayofyear:T_,utcquarter:Gw,utcweek:R_,version:YV,visitArray:Ar,week:$_,writeConfig:Sg,zero:$r,zoomLinear:Dg,zoomLog:$g,zoomPow:Al,zoomSymlog:Fg},Symbol.toStringTag,{value:"Module"}));export{V as $,Rw as W,Ct as a,et as b,Kw as c,G as d,nt as e,Z as f,LC as g,K as h,Yr as i,Ee as j,zw as l,Lw as m,Bf as s,En as t,VV as v,Sg as w};
